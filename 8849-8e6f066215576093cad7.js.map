{"version":3,"file":"8849-8e6f066215576093cad7.js","mappings":";;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;;AAEA,SAASS,UAAT,GAAsB;AAClB,MAAMC,UAAU,GAAGP,8CAAO,CACtB;AAAA;;AAAA,WACI,OAAOQ,MAAP,KAAkB,WAAlB,IACA,CAAC,wBAAC,WAAAA,MAAM,EAACC,UAAR,wEAAC,iCAAoB,4BAApB,CAAD,kDAAC,sBAAmDC,OAApD,CAFL;AAAA,GADsB,EAItB,EAJsB,CAA1B;AAMA,SAAO;AAAEH,IAAAA;AAAF,GAAP;AACH;;AAEc,SAASI,gBAAT,CAA0BC,KAA1B,EAA8C;AACzD,MAAM;AAAEL,IAAAA;AAAF,MAAiBD,UAAU,EAAjC;AACA,MAAM;AAAA,OAACO,OAAD;AAAA,OAAUC;AAAV,MAAwBb,+CAAQ,CAAC,KAAD,CAAtC;AACA,MAAM;AAAA,OAACc,aAAD;AAAA,OAAgBC;AAAhB,MAAoCf,+CAAQ,CAAC,IAAD,CAAlD;AACA,MAAM;AAAEgB,IAAAA;AAAF,MAAsBnB,iDAAU,CAACM,6DAAD,CAAtC;AACA,MAAM;AAAEc,IAAAA;AAAF,MAAiBb,yEAAY,EAAnC,CALyD,CAOzD;;AACAH,EAAAA,0EAAc,EACV;AACA,uBAFU,EAGViB,CAAC,IAAI;AACDD,IAAAA,UAAU,CAAC,mBAAD,CAAV;AACAC,IAAAA,CAAC,CAACC,cAAF;AACAN,IAAAA,UAAU,CAAC,IAAD,CAAV;AACAE,IAAAA,gBAAgB,CAACG,CAAD,CAAhB;AACH,GARS,EASV,KATU,EAUV,EAVU,CAAd,CARyD,CAqBzD;;AACAjB,EAAAA,0EAAc,CAAC,cAAD,EAAwB,MAAM;AACxCgB,IAAAA,UAAU,CAAC,eAAD,CAAV;AACAJ,IAAAA,UAAU,CAAC,KAAD,CAAV;AACAG,IAAAA,eAAe,CAAC,uBAAD,EAA0B,SAA1B,CAAf;AACH,GAJa,CAAd,CAtByD,CA4BzD;;AACAlB,EAAAA,gDAAS,CAAC,MAAM;AAAA;;AACZ,QAAI,OAAOS,MAAP,KAAkB,WAAtB,EAAmC,OADvB,CAGZ;;AACA,QAAMa,IAAI,4BAAG,QAACC,SAAD,EAAmBC,uBAAtB,0DAAG,gCAAb;AACAC,IAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ,EAA8B;AAAEJ,MAAAA;AAAF,KAA9B;AACH,GANQ,EAMN,EANM,CAAT;AAQA,MAAI,CAACR,OAAD,IAAYN,UAAhB,EAA4B,OAAO,IAAP;;AAE5B,MAAMmB,OAAO;AAAA,iHAAG,WAAOC,GAAP,EAAoD;AAChEA,MAAAA,GAAG,CAACP,cAAJ;AACA,YAAML,aAAN,aAAMA,aAAN,uBAAMA,aAAa,CAAEa,MAAf,EAAN;AACH,KAHY;;AAAA,oBAAPF,OAAO;AAAA;AAAA;AAAA,KAAb;;AAIA,sBACI,iDAAC,8DAAD;AACI,kBAAW,qBADf;AAEI,SAAK,EAAC,qBAFV;AAGI,WAAO,EAAEA,OAHb;AAII,WAAO,EAAC;AAJZ,KAKQd,KALR,aADJ;AAWH","sources":["webpack://jacdac-docs/./src/components/ui/InstallPWAButton.tsx"],"sourcesContent":["import React, { useContext, useEffect, useMemo, useState } from \"react\"\nimport useWindowEvent from \"../hooks/useWindowEvent\"\nimport { Button, ButtonProps } from \"@mui/material\"\nimport AppContext from \"../AppContext\"\nimport useAnalytics from \"../hooks/useAnalytics\"\n\nfunction usePWAInfo() {\n    const standAlone = useMemo(\n        () =>\n            typeof window !== \"undefined\" &&\n            !!window.matchMedia?.(\"(display-mode: standalone)\")?.matches,\n        []\n    )\n    return { standAlone }\n}\n\nexport default function InstallPWAButton(props: ButtonProps) {\n    const { standAlone } = usePWAInfo()\n    const [visible, setVisible] = useState(false)\n    const [promptInstall, setPromptInstall] = useState(null)\n    const { enqueueSnackbar } = useContext(AppContext)\n    const { trackEvent } = useAnalytics()\n\n    // listen for prompt\n    useWindowEvent(\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        \"beforeinstallprompt\" as any,\n        e => {\n            trackEvent(\"app.beforeinstall\")\n            e.preventDefault()\n            setVisible(true)\n            setPromptInstall(e)\n        },\n        false,\n        []\n    )\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    useWindowEvent(\"appinstalled\" as any, () => {\n        trackEvent(\"app.installed\")\n        setVisible(false)\n        enqueueSnackbar(\"Jacdac app installed!\", \"success\")\n    })\n\n    // detect installed apps\n    useEffect(() => {\n        if (typeof window === \"undefined\") return\n\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const apps = (navigator as any).getInstalledRelatedApps?.()\n        console.log(\"installed apps\", { apps })\n    }, [])\n\n    if (!visible || standAlone) return null\n\n    const onClick = async (evt: React.MouseEvent<HTMLButtonElement>) => {\n        evt.preventDefault()\n        await promptInstall?.prompt()\n    }\n    return (\n        <Button\n            aria-label=\"Install application\"\n            title=\"Install application\"\n            onClick={onClick}\n            variant=\"outlined\"\n            {...props}\n        >\n            Install\n        </Button>\n    )\n}\n"],"names":["React","useContext","useEffect","useMemo","useState","useWindowEvent","Button","AppContext","useAnalytics","usePWAInfo","standAlone","window","matchMedia","matches","InstallPWAButton","props","visible","setVisible","promptInstall","setPromptInstall","enqueueSnackbar","trackEvent","e","preventDefault","apps","navigator","getInstalledRelatedApps","console","log","onClick","evt","prompt"],"sourceRoot":""}