{"version":3,"file":"b0c593e002fd4a3c4a93eb2dc4c25280c59ba664-3405f9ae01adf15dee41.js","mappings":"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ACT;AACA;AACA,KAAK;AACL;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL,GAAG;AACH;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,WAAW;AACX;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,WAAW;AACX;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW;;AAEX,sDAAsD,OAAO;AAC7D;;AAEA;AACA;AACA;AACA,cAAc;AACd;AACA,SAAS;AACT;AACA;AACA;;AAEA,sBAAsB,cAAc;AACpC;AACA;;AAEA;AACA,SAAS;AACT;AACA;;AAEA,oCAAoC,OAAO;AAC3C;AACA;AACA;AACA,SAAS;AACT,+FAA+F,OAAO;AACtG;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;;AAEA,oCAAoC,OAAO;AAC3C;AACA;;AAEA;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA,SAAS;AACT,OAAO;;AAEP;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA,wBAAwB,cAAc;AACtC;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT,OAAO;;AAEP;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,8CAA8C;AAC9C;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,WAAW;AACX;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,WAAW;AACX;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,WAAW;AACX;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,WAAW;AACX;AACA,SAAS;AACT;AACA,SAAS;AACT,oCAAoC;AACpC,SAAS;AACT;AACA,oBAAoB;AACpB;AACA,oBAAoB;AACpB;;AAEA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,aAAa;;AAEb;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa;;AAEb;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA;AACA,WAAW;AACX,SAAS;AACT,OAAO;;AAEP;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,GAAG;AACH,CAAC;;;;;;;;ACj2CY;;AAEb,8CAA6C;AAC7C;AACA,CAAC,EAAC;AACF,kBAAe;;AAEf,oCAAoC,mBAAO,CAAC,KAAO;;AAEnD,wCAAwC,mBAAO,CAAC,KAAY;;AAE5D,mDAAmD,mBAAO,CAAC,KAAuB;;AAElF;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA,kBAAe;;;;;;;;AC1FF;;AAEb,8CAA6C;AAC7C;AACA,CAAC,EAAC;AACF,kBAAe;;AAEf;AACA;AACA;;AAEA;AACA,wEAAwE,aAAa;AACrF;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;;;;;;;ACjCa;;AAEb,6BAA6C;AAC7C;AACA,CAAC,CAAC;AACF,sCAAsD;AACtD;AACA;AACA;AACA;AACA,CAAC,EAAC;AACF,6BAAmD;AACnD;AACA;AACA;AACA;AACA,CAAC,CAAC;;AAEF,kDAAkD,mBAAO,CAAC,KAAuB;;AAEjF,+CAA+C,mBAAO,CAAC,IAAoB;;AAE3E;AACA;AACA;AACA;AACA;;;;;;;;AC1Ba;;AAEb,8CAA6C;AAC7C;AACA,CAAC,EAAC;AACF,kBAAe;;AAEf,oCAAoC,mBAAO,CAAC,KAAO;;AAEnD,sCAAsC,mBAAO,CAAC,KAAS;;AAEvD,wCAAwC,mBAAO,CAAC,KAAY;;AAE5D;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;;AAEA;AACA,kBAAkB,sBAAsB;AACxC;;AAEA;AACA;AACA;AACA,OAAO;AACP,MAAM;AACN;AACA,MAAM;AACN;AACA;AACA,OAAO;AACP;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,IAAI;AACJ;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,8CAA8C,+BAA+B;AAC7E;;AAEA;AACA;AACA,IAAI;AACJ;AACA;AACA,IAAI;AACJ;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,IAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,sDAAsD;AACtD;;;AAGA;;AAEA;AACA;AACA,GAAG;;AAEH;;AAEA;AACA;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;;AAEA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA,GAAG,wBAAwB;;;AAG3B;AACA,0FAA0F,wCAAwC;AAClI;AACA,KAAK;;AAEL;AACA,gCAAgC;;AAEhC,qCAAqC;;AAErC;AACA;AACA;;AAEA,kDAAkD;;AAElD;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG,UAAU;;;AAGb;AACA;AACA;AACA;AACA,GAAG,+DAA+D;;;AAGlE;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG,wCAAwC;;;AAG3C;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG,qBAAqB;;;AAGxB;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;;AAEA;AACA,kBAAe;;;;;;;;;;;;;AC7RuC;AACI;;AAE1D;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAI;AACJ;;AAEA;AACA,WAAW,+CAAQ;AACnB;AACA;;AAEA,+BAA+B,kDAAW;AAC1C;AACA,GAAG;AACH;AACA;;AAEe;AACf;;AAEA;AACA;AACA;;AAEA,kBAAkB,0EAAoB,CAAC,kDAAW;AAClD;AACA,GAAG;AACH,sBAAsB,6CAAM;;AAE5B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;;;;;;;;;;;;AC9CmD;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,UAAU;AACrB,WAAW,QAAQ;AACnB,yCAAyC;AACzC;AACA,WAAW,QAAQ,WAAW;AAC9B;AACA,WAAW,SAAS;AACpB;AACA,WAAW,QAAQ;AACnB;AACA,WAAW,SAAS;AACpB,aAAa,UAAU;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ,oBAAoB,aAAa;AACjC;AACA;AACA,2DAA2D,iBAAiB;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEe;AACf;;AAEA,qBAAqB,6CAAM;AAC3B,uBAAuB,6CAAM;AAC7B,gBAAgB,6CAAM;AACtB,iBAAiB,6CAAM;AACvB,iBAAiB,6CAAM;AACvB,eAAe,6CAAM;AACrB,gBAAgB,6CAAM;AACtB,gBAAgB,6CAAM;AACtB,0BAA0B;;AAE1B;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,oEAAoE;;AAEpE;AACA;AACA,EAAE,gDAAS;AACX;AACA;AACA;AACA;AACA,GAAG,OAAO;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,kBAAkB,8CAAO;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,+DAA+D;AAC/D;AACA;;AAEA;AACA;;AAEA;AACA,8BAA8B;AAC9B;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,QAAQ;;;AAGR;AACA;AACA,QAAQ;;;AAGR;AACA;AACA;AACA,uGAAuG;;AAEvG;AACA;;AAEA;AACA;;AAEA,uBAAuB,uBAAuB;AAC9C;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,yDAAyD;;AAEzD,0CAA0C;;AAE1C;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,GAAG;AACH;AACA;;;;;;;;;;;;;;;;;;AC5NO,IAAMA,eAAe,GAAG,eAAxB;AACA,IAAMC,aAAa,GAAG,cAAtB;AACA,IAAMC,iBAAiB,GAAG,iBAA1B;AACA,IAAMC,eAAe,GAAG,eAAxB;AACA,IAAMC,gBAAgB,GAAG,kBA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A;AACA;AACA;AACA;AACA;;;ACJA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACwC;;AAExC,oDAA+C;AAC/C;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,MAAM;AACN;;;AAGA,IAAI,2BAAsB;AAC1B;AACA;AACA,IAAI,0BAAqB;AACzB;AACA;;AAEA,iBAAiB,qDAAgD;;AAEjE,qDAAgD;AAChD;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;;ACpDA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACwC;AACxC,8BAA4B;AAC5B;AACA;AACA,YAAY;AACZ;AACA;;AAEA;AACA;AACA,YAAY;AACZ;AACA;;AAEA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA,oBAAoB,oCAAkC;AACtD;AACA,iEAAiE,mCAAiC;AAClG,iDAAiD,qCAAmC;AACpF;AACA;AACA,oBAAoB,0CAAwC;AAC5D,GAAG;;AAEH;AACA;AACA,cAAc,UAAU;AACxB,YAAY;AACZ;AACA;AACA,oBAAoB,oCAA+B;AACnD;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA,aAAa,UAAU;AACvB,YAAY;AACZ;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,0EAA0E,mCAAiC;AAC3G,0DAA0D,qCAAmC;;AAE7F,sBAAsB,yBAAyB;AAC/C,sFAAsF,uCAAqC;AAC3H,sEAAsE,qCAAmC;AACzG;AACA;;AAEA;;AAEA;AACA,oDAAoD,qCAAmC;AACvF;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA,aAAa,qBAAqB;AAClC,cAAc,SAAS;AACvB;AACA;AACA,oBAAoB,2BAA2B;AAC/C;;AAEA;AACA;AACA;AACA;;AAEA;AACA,GAAG;;AAEH;AACA;AACA,aAAa,QAAQ;AACrB;AACA;AACA;AACA,6EAA6E,uCAAqC;AAClH,6DAA6D,qCAAmC;AAChG;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA,aAAa,qBAAqB;AAClC;AACA;AACA;AACA,4BAA4B,2BAAsB;AAClD,oDAAoD,qCAAmC;AACvF;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA,QAAQ;AACR;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,uBAAuB;;AAEvB,oBAAoB,+BAA+B;AACnD;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,wDAAwD;;AAExD;;AAEA;AACA;AACA,MAAM;;;AAGN;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,8BAA8B,mCAAiC;AAC/D;AACA;AACA;AACA;;ACpMA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACwC;AACxC,qCAAmC;AACnC;AACA;AACA,YAAY;AACZ;AACA;;AAEA;AACA;AACA,YAAY;AACZ;AACA;;AAEA;AACA;AACA,YAAY;AACZ;AACA;AACA,oBAAoB,kCAAgC;AACpD;AACA,8CAA8C,2CAAyC;AACvF;AACA;AACA,oBAAoB,kCAAgC;AACpD,GAAG;;AAEH;AACA;AACA,cAAc,UAAU;AACxB,YAAY;AACZ;AACA;AACA,oBAAoB,oCAA+B;AACnD;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA,aAAa,UAAU;AACvB,YAAY;AACZ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,oCAAoC,2CAAyC;AAC7E;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA,aAAa,qBAAqB;AAClC;AACA,cAAc,QAAQ;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,oBAAoB,2BAA2B;AAC/C;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,MAAM;;;AAGN;AACA,GAAG;;AAEH;AACA;AACA,aAAa,qBAAqB;AAClC;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;;AAEA,kEAAkE;AAClE;;AAEA;AACA,sCAAsC,2CAAyC;AAC/E;AACA;AACA;AACA;;ACvJA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACwC;AACxC,uCAAqC;AACrC;AACA;AACA,YAAY;AACZ;AACA;;AAEA;AACA;AACA,YAAY;AACZ;AACA;;AAEA;AACA;AACA,YAAY;AACZ;AACA;AACA,oBAAoB,0CAAwC;AAC5D;AACA,8CAA8C,6CAA2C;AACzF;AACA;AACA,oBAAoB,0CAAwC;AAC5D,GAAG;;AAEH;AACA;AACA,cAAc,UAAU;AACxB,YAAY;AACZ;AACA;AACA,oBAAoB,oCAA+B;AACnD;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA,aAAa,UAAU;AACvB,YAAY;AACZ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,oCAAoC,6CAA2C;AAC/E;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA,aAAa,qBAAqB;AAClC;AACA,cAAc,QAAQ;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,oBAAoB,2BAA2B;AAC/C;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,MAAM;;;AAGN;AACA,GAAG;;AAEH;AACA;AACA,aAAa,qBAAqB;AAClC;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;;AAEA,kEAAkE;AAClE;;AAEA;AACA,sCAAsC,6CAA2C;AACjF;AACA;AACA;AACA;;ACvJA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACiD;AACxB;AACO;AACE;AAC3B;AACP;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACwC;AACxC;AACA;AACA;AACA;A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","sources":["webpack://jacdac-docs/./node_modules/@material-ui/core/esm/DialogContentText/DialogContentText.js","webpack://jacdac-docs/./node_modules/@material-ui/icons/AddCircleOutline.js","webpack://jacdac-docs/./node_modules/@material-ui/icons/Autorenew.js","webpack://jacdac-docs/./node_modules/@material-ui/icons/Done.js","webpack://jacdac-docs/./node_modules/@material-ui/icons/FileCopy.js","webpack://jacdac-docs/./node_modules/@material-ui/icons/OpenInBrowser.js","webpack://jacdac-docs/./node_modules/@material-ui/icons/RemoveCircleOutline.js","webpack://jacdac-docs/./node_modules/@material-ui/icons/ReportProblem.js","webpack://jacdac-docs/./node_modules/@material-ui/icons/SaveAlt.js","webpack://jacdac-docs/./node_modules/@material-ui/icons/Visibility.js","webpack://jacdac-docs/./node_modules/bowser/es5.js","webpack://jacdac-docs/./node_modules/react-blockly/dist/BlocklyWorkspace.js","webpack://jacdac-docs/./node_modules/react-blockly/dist/debounce.js","webpack://jacdac-docs/./node_modules/react-blockly/dist/index.js","webpack://jacdac-docs/./node_modules/react-blockly/dist/useBlocklyWorkspace.js","webpack://jacdac-docs/./node_modules/use-debounce/esm/useDebounce.js","webpack://jacdac-docs/./node_modules/use-debounce/esm/useDebouncedCallback.js","webpack://jacdac-docs/./jacdac-ts/src/vm/events.ts","webpack://jacdac-docs/./jacdac-ts/src/jdom/rolemanager.ts","webpack://jacdac-docs/./src/components/hooks/useRoleManager.ts","webpack://jacdac-docs/./src/components/blockly/blockwarning.ts","webpack://jacdac-docs/./src/components/blockly/dsl/datasolver.ts","webpack://jacdac-docs/./src/components/blockly/useBlocklyEvents.ts","webpack://jacdac-docs/./node_modules/@blockly/field-slider/src/field_slider.js","webpack://jacdac-docs/./node_modules/@blockly/field-slider/src/index.js","webpack://jacdac-docs/./node_modules/@blockly/block-dynamic-connection/src/insertion_marker_manager_monkey_patch.js","webpack://jacdac-docs/./node_modules/@blockly/block-dynamic-connection/src/dynamic_if.js","webpack://jacdac-docs/./node_modules/@blockly/block-dynamic-connection/src/dynamic_text_join.js","webpack://jacdac-docs/./node_modules/@blockly/block-dynamic-connection/src/dynamic_list_create.js","webpack://jacdac-docs/./node_modules/@blockly/block-dynamic-connection/src/index.js","webpack://jacdac-docs/./node_modules/@blockly/disable-top-blocks/src/index.js","webpack://jacdac-docs/./src/components/blockly/useBlocklyPlugins.ts","webpack://jacdac-docs/./src/components/hooks/useAsyncMemo.ts","webpack://jacdac-docs/./src/components/blockly/useToolbox.ts","webpack://jacdac-docs/./src/components/blockly/BlockContext.tsx","webpack://jacdac-docs/./src/components/blockly/BlockDiagnostics.tsx","webpack://jacdac-docs/./node_modules/@blockly/theme-modern/src/index.js","webpack://jacdac-docs/./node_modules/@blockly/theme-dark/src/index.js","webpack://jacdac-docs/./src/components/blockly/BlocklyModalDialogs.tsx","webpack://jacdac-docs/./src/components/blockly/BlockMinimap.tsx","webpack://jacdac-docs/./src/components/ui/BrowserCompatibilityAlert.tsx","webpack://jacdac-docs/./src/components/blockly/BlockEditor.tsx","webpack://jacdac-docs/./src/components/blockly/dsl/chartdsl.ts","webpack://jacdac-docs/./src/components/blockly/dsl/dsl.ts","webpack://jacdac-docs/./src/components/blockly/dsl/fieldsdsl.ts","webpack://jacdac-docs/./src/components/blockly/dsl/workers/csv.proxy.ts","webpack://jacdac-docs/./src/components/blockly/dsl/workspacevisitor.ts","webpack://jacdac-docs/./src/components/blockly/fields/BuiltinDataSetField.tsx","webpack://jacdac-docs/./src/components/blockly/fields/DataPreviewField.tsx","webpack://jacdac-docs/./src/components/blockly/fields/DataTableField.tsx","webpack://jacdac-docs/./src/components/blockly/fields/DataTableWidget.tsx","webpack://jacdac-docs/./src/components/blockly/fields/FileOpenField.ts","webpack://jacdac-docs/./src/components/blockly/fields/FileSaveField.ts","webpack://jacdac-docs/./src/components/blockly/fields/GaugeWidgetField.tsx","webpack://jacdac-docs/./src/components/blockly/fields/IFrameDataChooserField.ts","webpack://jacdac-docs/./src/components/blockly/fields/JDomTreeField.tsx","webpack://jacdac-docs/./src/components/blockly/fields/JSONSettingsField.tsx","webpack://jacdac-docs/./src/components/blockly/fields/KeyboardKeyField.tsx","webpack://jacdac-docs/./src/components/blockly/fields/LEDColorField.tsx","webpack://jacdac-docs/./src/components/blockly/fields/ReactImageField.tsx","webpack://jacdac-docs/./src/components/blockly/fields/LEDMatrixField.tsx","webpack://jacdac-docs/./src/components/blockly/fields/LogViewField.tsx","webpack://jacdac-docs/./src/components/blockly/fields/NoServiceAlert.tsx","webpack://jacdac-docs/./src/components/blockly/fields/NoteField.tsx","webpack://jacdac-docs/./src/components/blockly/fields/PointerBoundary.tsx","webpack://jacdac-docs/./src/components/blockly/fields/ReactField.tsx","webpack://jacdac-docs/./src/components/blockly/fields/ReactFieldBase.ts","webpack://jacdac-docs/./src/components/blockly/fields/ReactInlineField.tsx","webpack://jacdac-docs/./src/components/blockly/fields/SliderField.tsx","webpack://jacdac-docs/./src/components/blockly/fields/ServoAngleField.tsx","webpack://jacdac-docs/./src/components/blockly/fields/TwinField.tsx","webpack://jacdac-docs/./src/components/blockly/fields/UseModelField.ts","webpack://jacdac-docs/./src/components/blockly/fields/ValueContext.tsx","webpack://jacdac-docs/./src/components/blockly/fields/VariablesFields.tsx","webpack://jacdac-docs/./src/components/blockly/fields/WatchValueField.tsx","webpack://jacdac-docs/./src/components/blockly/fields/chart/BarField.tsx","webpack://jacdac-docs/./src/components/blockly/fields/chart/BoxPlotField.tsx","webpack://jacdac-docs/./src/components/blockly/fields/chart/HeatMapField.tsx","webpack://jacdac-docs/./src/components/blockly/fields/chart/HistogramField.tsx","webpack://jacdac-docs/./src/components/blockly/fields/chart/LinePlotField.tsx","webpack://jacdac-docs/./src/components/blockly/fields/chart/ScatterPlotField.tsx","webpack://jacdac-docs/./src/components/blockly/fields/chart/VegaChartField.tsx","webpack://jacdac-docs/./src/components/blockly/fields/chart/VegaLiteWidget.tsx","webpack://jacdac-docs/./src/components/blockly/fields/fields.ts","webpack://jacdac-docs/./src/components/blockly/fields/mb/ConvLayerBlockField.tsx","webpack://jacdac-docs/./src/components/blockly/fields/mb/DataSetBlockButton.tsx","webpack://jacdac-docs/./src/components/blockly/fields/mb/DataSetBlockField.tsx","webpack://jacdac-docs/./src/components/blockly/fields/mb/DenseLayerBlockField.tsx","webpack://jacdac-docs/./src/components/blockly/fields/mb/DropoutLayerBlockField.tsx","webpack://jacdac-docs/./src/components/blockly/fields/mb/ExpandModelBlockField.tsx","webpack://jacdac-docs/./src/components/blockly/fields/mb/FlattenLayerBlockField.tsx","webpack://jacdac-docs/./src/components/blockly/fields/mb/NeuralNetworkBlockButtons.tsx","webpack://jacdac-docs/./src/components/blockly/fields/mb/NeuralNetworkBlockField.tsx","webpack://jacdac-docs/./src/components/blockly/fields/mb/PoolingLayerBlockField.tsx","webpack://jacdac-docs/./src/components/blockly/fields/mb/RecordingBlockField.tsx","webpack://jacdac-docs/./src/components/blockly/fields/mb/TrainedModelBlockField.tsx","webpack://jacdac-docs/./src/components/blockly/jsongenerator.ts","webpack://jacdac-docs/./node_modules/use-debounce/esm/useThrottledCallback.js","webpack://jacdac-docs/./src/jacdac/useChangeThrottled.ts","webpack://jacdac-docs/./src/components/blockly/useDragDebounce.ts","webpack://jacdac-docs/./src/components/blockly/useBlockData.ts","webpack://jacdac-docs/./src/components/fs/FileSystemChip.tsx","webpack://jacdac-docs/./src/components/fs/FileNewFileChip.tsx","webpack://jacdac-docs/./src/components/fs/FileSystemNodeChip.tsx","webpack://jacdac-docs/./src/components/fs/FileTabs.tsx","webpack://jacdac-docs/./src/components/hooks/useArrowKeys.ts","webpack://jacdac-docs/./src/components/hooks/useKeyboardNavigation.ts","webpack://jacdac-docs/./src/components/hooks/useKeyboardNavigationProps.ts","webpack://jacdac-docs/./src/components/hooks/useServices.ts","webpack://jacdac-docs/./src/components/model-editor/modelblockdsl.ts","webpack://jacdac-docs/./src/components/ui/AppTheme.tsx","webpack://jacdac-docs/./src/components/ui/CopyButton.tsx","webpack://jacdac-docs/./src/components/widgets/svg.ts"],"sourcesContent":["import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport * as React from 'react';\nimport withStyles from '../styles/withStyles';\nimport Typography from '../Typography';\nexport var styles = {\n  /* Styles applied to the root element. */\n  root: {\n    marginBottom: 12\n  }\n};\nvar DialogContentText = /*#__PURE__*/React.forwardRef(function DialogContentText(props, ref) {\n  return /*#__PURE__*/React.createElement(Typography, _extends({\n    component: \"p\",\n    variant: \"body1\",\n    color: \"textSecondary\",\n    ref: ref\n  }, props));\n});\nprocess.env.NODE_ENV !== \"production\" ? void 0 : void 0;\nexport default withStyles(styles, {\n  name: 'MuiDialogContentText'\n})(DialogContentText);","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4V7zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z\"\n}), 'AddCircleOutline');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M12 6v3l4-4-4-4v3c-4.42 0-8 3.58-8 8 0 1.57.46 3.03 1.24 4.26L6.7 14.8c-.45-.83-.7-1.79-.7-2.8 0-3.31 2.69-6 6-6zm6.76 1.74L17.3 9.2c.44.84.7 1.79.7 2.8 0 3.31-2.69 6-6 6v-3l-4 4 4 4v-3c4.42 0 8-3.58 8-8 0-1.57-.46-3.03-1.24-4.26z\"\n}), 'Autorenew');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z\"\n}), 'Done');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z\"\n}), 'FileCopy');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M19 4H5c-1.11 0-2 .9-2 2v12c0 1.1.89 2 2 2h4v-2H5V8h14v10h-4v2h4c1.1 0 2-.9 2-2V6c0-1.1-.89-2-2-2zm-7 6l-4 4h3v6h2v-6h3l-4-4z\"\n}), 'OpenInBrowser');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M7 11v2h10v-2H7zm5-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z\"\n}), 'RemoveCircleOutline');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z\"\n}), 'ReportProblem');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M19 12v7H5v-7H3v7c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zm-6 .67l2.59-2.58L17 11.5l-5 5-5-5 1.41-1.41L11 12.67V3h2z\"\n}), 'SaveAlt');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z\"\n}), 'Visibility');\n\nexports.default = _default;","!function (e, t) {\n  \"object\" == typeof exports && \"object\" == typeof module ? module.exports = t() : \"function\" == typeof define && define.amd ? define([], t) : \"object\" == typeof exports ? exports.bowser = t() : e.bowser = t();\n}(this, function () {\n  return function (e) {\n    var t = {};\n\n    function r(n) {\n      if (t[n]) return t[n].exports;\n      var i = t[n] = {\n        i: n,\n        l: !1,\n        exports: {}\n      };\n      return e[n].call(i.exports, i, i.exports, r), i.l = !0, i.exports;\n    }\n\n    return r.m = e, r.c = t, r.d = function (e, t, n) {\n      r.o(e, t) || Object.defineProperty(e, t, {\n        enumerable: !0,\n        get: n\n      });\n    }, r.r = function (e) {\n      \"undefined\" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, {\n        value: \"Module\"\n      }), Object.defineProperty(e, \"__esModule\", {\n        value: !0\n      });\n    }, r.t = function (e, t) {\n      if (1 & t && (e = r(e)), 8 & t) return e;\n      if (4 & t && \"object\" == typeof e && e && e.__esModule) return e;\n      var n = Object.create(null);\n      if (r.r(n), Object.defineProperty(n, \"default\", {\n        enumerable: !0,\n        value: e\n      }), 2 & t && \"string\" != typeof e) for (var i in e) {\n        r.d(n, i, function (t) {\n          return e[t];\n        }.bind(null, i));\n      }\n      return n;\n    }, r.n = function (e) {\n      var t = e && e.__esModule ? function () {\n        return e.default;\n      } : function () {\n        return e;\n      };\n      return r.d(t, \"a\", t), t;\n    }, r.o = function (e, t) {\n      return Object.prototype.hasOwnProperty.call(e, t);\n    }, r.p = \"\", r(r.s = 90);\n  }({\n    17: function _(e, t, r) {\n      \"use strict\";\n\n      t.__esModule = !0, t.default = void 0;\n\n      var n = r(18),\n          i = function () {\n        function e() {}\n\n        return e.getFirstMatch = function (e, t) {\n          var r = t.match(e);\n          return r && r.length > 0 && r[1] || \"\";\n        }, e.getSecondMatch = function (e, t) {\n          var r = t.match(e);\n          return r && r.length > 1 && r[2] || \"\";\n        }, e.matchAndReturnConst = function (e, t, r) {\n          if (e.test(t)) return r;\n        }, e.getWindowsVersionName = function (e) {\n          switch (e) {\n            case \"NT\":\n              return \"NT\";\n\n            case \"XP\":\n              return \"XP\";\n\n            case \"NT 5.0\":\n              return \"2000\";\n\n            case \"NT 5.1\":\n              return \"XP\";\n\n            case \"NT 5.2\":\n              return \"2003\";\n\n            case \"NT 6.0\":\n              return \"Vista\";\n\n            case \"NT 6.1\":\n              return \"7\";\n\n            case \"NT 6.2\":\n              return \"8\";\n\n            case \"NT 6.3\":\n              return \"8.1\";\n\n            case \"NT 10.0\":\n              return \"10\";\n\n            default:\n              return;\n          }\n        }, e.getMacOSVersionName = function (e) {\n          var t = e.split(\".\").splice(0, 2).map(function (e) {\n            return parseInt(e, 10) || 0;\n          });\n          if (t.push(0), 10 === t[0]) switch (t[1]) {\n            case 5:\n              return \"Leopard\";\n\n            case 6:\n              return \"Snow Leopard\";\n\n            case 7:\n              return \"Lion\";\n\n            case 8:\n              return \"Mountain Lion\";\n\n            case 9:\n              return \"Mavericks\";\n\n            case 10:\n              return \"Yosemite\";\n\n            case 11:\n              return \"El Capitan\";\n\n            case 12:\n              return \"Sierra\";\n\n            case 13:\n              return \"High Sierra\";\n\n            case 14:\n              return \"Mojave\";\n\n            case 15:\n              return \"Catalina\";\n\n            default:\n              return;\n          }\n        }, e.getAndroidVersionName = function (e) {\n          var t = e.split(\".\").splice(0, 2).map(function (e) {\n            return parseInt(e, 10) || 0;\n          });\n          if (t.push(0), !(1 === t[0] && t[1] < 5)) return 1 === t[0] && t[1] < 6 ? \"Cupcake\" : 1 === t[0] && t[1] >= 6 ? \"Donut\" : 2 === t[0] && t[1] < 2 ? \"Eclair\" : 2 === t[0] && 2 === t[1] ? \"Froyo\" : 2 === t[0] && t[1] > 2 ? \"Gingerbread\" : 3 === t[0] ? \"Honeycomb\" : 4 === t[0] && t[1] < 1 ? \"Ice Cream Sandwich\" : 4 === t[0] && t[1] < 4 ? \"Jelly Bean\" : 4 === t[0] && t[1] >= 4 ? \"KitKat\" : 5 === t[0] ? \"Lollipop\" : 6 === t[0] ? \"Marshmallow\" : 7 === t[0] ? \"Nougat\" : 8 === t[0] ? \"Oreo\" : 9 === t[0] ? \"Pie\" : void 0;\n        }, e.getVersionPrecision = function (e) {\n          return e.split(\".\").length;\n        }, e.compareVersions = function (t, r, n) {\n          void 0 === n && (n = !1);\n          var i = e.getVersionPrecision(t),\n              s = e.getVersionPrecision(r),\n              a = Math.max(i, s),\n              o = 0,\n              u = e.map([t, r], function (t) {\n            var r = a - e.getVersionPrecision(t),\n                n = t + new Array(r + 1).join(\".0\");\n            return e.map(n.split(\".\"), function (e) {\n              return new Array(20 - e.length).join(\"0\") + e;\n            }).reverse();\n          });\n\n          for (n && (o = a - Math.min(i, s)), a -= 1; a >= o;) {\n            if (u[0][a] > u[1][a]) return 1;\n\n            if (u[0][a] === u[1][a]) {\n              if (a === o) return 0;\n              a -= 1;\n            } else if (u[0][a] < u[1][a]) return -1;\n          }\n        }, e.map = function (e, t) {\n          var r,\n              n = [];\n          if (Array.prototype.map) return Array.prototype.map.call(e, t);\n\n          for (r = 0; r < e.length; r += 1) {\n            n.push(t(e[r]));\n          }\n\n          return n;\n        }, e.find = function (e, t) {\n          var r, n;\n          if (Array.prototype.find) return Array.prototype.find.call(e, t);\n\n          for (r = 0, n = e.length; r < n; r += 1) {\n            var i = e[r];\n            if (t(i, r)) return i;\n          }\n        }, e.assign = function (e) {\n          for (var t, r, n = e, i = arguments.length, s = new Array(i > 1 ? i - 1 : 0), a = 1; a < i; a++) {\n            s[a - 1] = arguments[a];\n          }\n\n          if (Object.assign) return Object.assign.apply(Object, [e].concat(s));\n\n          var o = function o() {\n            var e = s[t];\n            \"object\" == typeof e && null !== e && Object.keys(e).forEach(function (t) {\n              n[t] = e[t];\n            });\n          };\n\n          for (t = 0, r = s.length; t < r; t += 1) {\n            o();\n          }\n\n          return e;\n        }, e.getBrowserAlias = function (e) {\n          return n.BROWSER_ALIASES_MAP[e];\n        }, e.getBrowserTypeByAlias = function (e) {\n          return n.BROWSER_MAP[e] || \"\";\n        }, e;\n      }();\n\n      t.default = i, e.exports = t.default;\n    },\n    18: function _(e, t, r) {\n      \"use strict\";\n\n      t.__esModule = !0, t.ENGINE_MAP = t.OS_MAP = t.PLATFORMS_MAP = t.BROWSER_MAP = t.BROWSER_ALIASES_MAP = void 0;\n      t.BROWSER_ALIASES_MAP = {\n        \"Amazon Silk\": \"amazon_silk\",\n        \"Android Browser\": \"android\",\n        Bada: \"bada\",\n        BlackBerry: \"blackberry\",\n        Chrome: \"chrome\",\n        Chromium: \"chromium\",\n        Electron: \"electron\",\n        Epiphany: \"epiphany\",\n        Firefox: \"firefox\",\n        Focus: \"focus\",\n        Generic: \"generic\",\n        \"Google Search\": \"google_search\",\n        Googlebot: \"googlebot\",\n        \"Internet Explorer\": \"ie\",\n        \"K-Meleon\": \"k_meleon\",\n        Maxthon: \"maxthon\",\n        \"Microsoft Edge\": \"edge\",\n        \"MZ Browser\": \"mz\",\n        \"NAVER Whale Browser\": \"naver\",\n        Opera: \"opera\",\n        \"Opera Coast\": \"opera_coast\",\n        PhantomJS: \"phantomjs\",\n        Puffin: \"puffin\",\n        QupZilla: \"qupzilla\",\n        QQ: \"qq\",\n        QQLite: \"qqlite\",\n        Safari: \"safari\",\n        Sailfish: \"sailfish\",\n        \"Samsung Internet for Android\": \"samsung_internet\",\n        SeaMonkey: \"seamonkey\",\n        Sleipnir: \"sleipnir\",\n        Swing: \"swing\",\n        Tizen: \"tizen\",\n        \"UC Browser\": \"uc\",\n        Vivaldi: \"vivaldi\",\n        \"WebOS Browser\": \"webos\",\n        WeChat: \"wechat\",\n        \"Yandex Browser\": \"yandex\",\n        Roku: \"roku\"\n      };\n      t.BROWSER_MAP = {\n        amazon_silk: \"Amazon Silk\",\n        android: \"Android Browser\",\n        bada: \"Bada\",\n        blackberry: \"BlackBerry\",\n        chrome: \"Chrome\",\n        chromium: \"Chromium\",\n        electron: \"Electron\",\n        epiphany: \"Epiphany\",\n        firefox: \"Firefox\",\n        focus: \"Focus\",\n        generic: \"Generic\",\n        googlebot: \"Googlebot\",\n        google_search: \"Google Search\",\n        ie: \"Internet Explorer\",\n        k_meleon: \"K-Meleon\",\n        maxthon: \"Maxthon\",\n        edge: \"Microsoft Edge\",\n        mz: \"MZ Browser\",\n        naver: \"NAVER Whale Browser\",\n        opera: \"Opera\",\n        opera_coast: \"Opera Coast\",\n        phantomjs: \"PhantomJS\",\n        puffin: \"Puffin\",\n        qupzilla: \"QupZilla\",\n        qq: \"QQ Browser\",\n        qqlite: \"QQ Browser Lite\",\n        safari: \"Safari\",\n        sailfish: \"Sailfish\",\n        samsung_internet: \"Samsung Internet for Android\",\n        seamonkey: \"SeaMonkey\",\n        sleipnir: \"Sleipnir\",\n        swing: \"Swing\",\n        tizen: \"Tizen\",\n        uc: \"UC Browser\",\n        vivaldi: \"Vivaldi\",\n        webos: \"WebOS Browser\",\n        wechat: \"WeChat\",\n        yandex: \"Yandex Browser\"\n      };\n      t.PLATFORMS_MAP = {\n        tablet: \"tablet\",\n        mobile: \"mobile\",\n        desktop: \"desktop\",\n        tv: \"tv\"\n      };\n      t.OS_MAP = {\n        WindowsPhone: \"Windows Phone\",\n        Windows: \"Windows\",\n        MacOS: \"macOS\",\n        iOS: \"iOS\",\n        Android: \"Android\",\n        WebOS: \"WebOS\",\n        BlackBerry: \"BlackBerry\",\n        Bada: \"Bada\",\n        Tizen: \"Tizen\",\n        Linux: \"Linux\",\n        ChromeOS: \"Chrome OS\",\n        PlayStation4: \"PlayStation 4\",\n        Roku: \"Roku\"\n      };\n      t.ENGINE_MAP = {\n        EdgeHTML: \"EdgeHTML\",\n        Blink: \"Blink\",\n        Trident: \"Trident\",\n        Presto: \"Presto\",\n        Gecko: \"Gecko\",\n        WebKit: \"WebKit\"\n      };\n    },\n    90: function _(e, t, r) {\n      \"use strict\";\n\n      t.__esModule = !0, t.default = void 0;\n      var n,\n          i = (n = r(91)) && n.__esModule ? n : {\n        default: n\n      },\n          s = r(18);\n\n      function a(e, t) {\n        for (var r = 0; r < t.length; r++) {\n          var n = t[r];\n          n.enumerable = n.enumerable || !1, n.configurable = !0, \"value\" in n && (n.writable = !0), Object.defineProperty(e, n.key, n);\n        }\n      }\n\n      var o = function () {\n        function e() {}\n\n        var t, r, n;\n        return e.getParser = function (e, t) {\n          if (void 0 === t && (t = !1), \"string\" != typeof e) throw new Error(\"UserAgent should be a string\");\n          return new i.default(e, t);\n        }, e.parse = function (e) {\n          return new i.default(e).getResult();\n        }, t = e, n = [{\n          key: \"BROWSER_MAP\",\n          get: function get() {\n            return s.BROWSER_MAP;\n          }\n        }, {\n          key: \"ENGINE_MAP\",\n          get: function get() {\n            return s.ENGINE_MAP;\n          }\n        }, {\n          key: \"OS_MAP\",\n          get: function get() {\n            return s.OS_MAP;\n          }\n        }, {\n          key: \"PLATFORMS_MAP\",\n          get: function get() {\n            return s.PLATFORMS_MAP;\n          }\n        }], (r = null) && a(t.prototype, r), n && a(t, n), e;\n      }();\n\n      t.default = o, e.exports = t.default;\n    },\n    91: function _(e, t, r) {\n      \"use strict\";\n\n      t.__esModule = !0, t.default = void 0;\n      var n = u(r(92)),\n          i = u(r(93)),\n          s = u(r(94)),\n          a = u(r(95)),\n          o = u(r(17));\n\n      function u(e) {\n        return e && e.__esModule ? e : {\n          default: e\n        };\n      }\n\n      var d = function () {\n        function e(e, t) {\n          if (void 0 === t && (t = !1), null == e || \"\" === e) throw new Error(\"UserAgent parameter can't be empty\");\n          this._ua = e, this.parsedResult = {}, !0 !== t && this.parse();\n        }\n\n        var t = e.prototype;\n        return t.getUA = function () {\n          return this._ua;\n        }, t.test = function (e) {\n          return e.test(this._ua);\n        }, t.parseBrowser = function () {\n          var e = this;\n          this.parsedResult.browser = {};\n          var t = o.default.find(n.default, function (t) {\n            if (\"function\" == typeof t.test) return t.test(e);\n            if (t.test instanceof Array) return t.test.some(function (t) {\n              return e.test(t);\n            });\n            throw new Error(\"Browser's test function is not valid\");\n          });\n          return t && (this.parsedResult.browser = t.describe(this.getUA())), this.parsedResult.browser;\n        }, t.getBrowser = function () {\n          return this.parsedResult.browser ? this.parsedResult.browser : this.parseBrowser();\n        }, t.getBrowserName = function (e) {\n          return e ? String(this.getBrowser().name).toLowerCase() || \"\" : this.getBrowser().name || \"\";\n        }, t.getBrowserVersion = function () {\n          return this.getBrowser().version;\n        }, t.getOS = function () {\n          return this.parsedResult.os ? this.parsedResult.os : this.parseOS();\n        }, t.parseOS = function () {\n          var e = this;\n          this.parsedResult.os = {};\n          var t = o.default.find(i.default, function (t) {\n            if (\"function\" == typeof t.test) return t.test(e);\n            if (t.test instanceof Array) return t.test.some(function (t) {\n              return e.test(t);\n            });\n            throw new Error(\"Browser's test function is not valid\");\n          });\n          return t && (this.parsedResult.os = t.describe(this.getUA())), this.parsedResult.os;\n        }, t.getOSName = function (e) {\n          var t = this.getOS().name;\n          return e ? String(t).toLowerCase() || \"\" : t || \"\";\n        }, t.getOSVersion = function () {\n          return this.getOS().version;\n        }, t.getPlatform = function () {\n          return this.parsedResult.platform ? this.parsedResult.platform : this.parsePlatform();\n        }, t.getPlatformType = function (e) {\n          void 0 === e && (e = !1);\n          var t = this.getPlatform().type;\n          return e ? String(t).toLowerCase() || \"\" : t || \"\";\n        }, t.parsePlatform = function () {\n          var e = this;\n          this.parsedResult.platform = {};\n          var t = o.default.find(s.default, function (t) {\n            if (\"function\" == typeof t.test) return t.test(e);\n            if (t.test instanceof Array) return t.test.some(function (t) {\n              return e.test(t);\n            });\n            throw new Error(\"Browser's test function is not valid\");\n          });\n          return t && (this.parsedResult.platform = t.describe(this.getUA())), this.parsedResult.platform;\n        }, t.getEngine = function () {\n          return this.parsedResult.engine ? this.parsedResult.engine : this.parseEngine();\n        }, t.getEngineName = function (e) {\n          return e ? String(this.getEngine().name).toLowerCase() || \"\" : this.getEngine().name || \"\";\n        }, t.parseEngine = function () {\n          var e = this;\n          this.parsedResult.engine = {};\n          var t = o.default.find(a.default, function (t) {\n            if (\"function\" == typeof t.test) return t.test(e);\n            if (t.test instanceof Array) return t.test.some(function (t) {\n              return e.test(t);\n            });\n            throw new Error(\"Browser's test function is not valid\");\n          });\n          return t && (this.parsedResult.engine = t.describe(this.getUA())), this.parsedResult.engine;\n        }, t.parse = function () {\n          return this.parseBrowser(), this.parseOS(), this.parsePlatform(), this.parseEngine(), this;\n        }, t.getResult = function () {\n          return o.default.assign({}, this.parsedResult);\n        }, t.satisfies = function (e) {\n          var t = this,\n              r = {},\n              n = 0,\n              i = {},\n              s = 0;\n\n          if (Object.keys(e).forEach(function (t) {\n            var a = e[t];\n            \"string\" == typeof a ? (i[t] = a, s += 1) : \"object\" == typeof a && (r[t] = a, n += 1);\n          }), n > 0) {\n            var a = Object.keys(r),\n                u = o.default.find(a, function (e) {\n              return t.isOS(e);\n            });\n\n            if (u) {\n              var d = this.satisfies(r[u]);\n              if (void 0 !== d) return d;\n            }\n\n            var c = o.default.find(a, function (e) {\n              return t.isPlatform(e);\n            });\n\n            if (c) {\n              var f = this.satisfies(r[c]);\n              if (void 0 !== f) return f;\n            }\n          }\n\n          if (s > 0) {\n            var l = Object.keys(i),\n                h = o.default.find(l, function (e) {\n              return t.isBrowser(e, !0);\n            });\n            if (void 0 !== h) return this.compareVersion(i[h]);\n          }\n        }, t.isBrowser = function (e, t) {\n          void 0 === t && (t = !1);\n          var r = this.getBrowserName().toLowerCase(),\n              n = e.toLowerCase(),\n              i = o.default.getBrowserTypeByAlias(n);\n          return t && i && (n = i.toLowerCase()), n === r;\n        }, t.compareVersion = function (e) {\n          var t = [0],\n              r = e,\n              n = !1,\n              i = this.getBrowserVersion();\n          if (\"string\" == typeof i) return \">\" === e[0] || \"<\" === e[0] ? (r = e.substr(1), \"=\" === e[1] ? (n = !0, r = e.substr(2)) : t = [], \">\" === e[0] ? t.push(1) : t.push(-1)) : \"=\" === e[0] ? r = e.substr(1) : \"~\" === e[0] && (n = !0, r = e.substr(1)), t.indexOf(o.default.compareVersions(i, r, n)) > -1;\n        }, t.isOS = function (e) {\n          return this.getOSName(!0) === String(e).toLowerCase();\n        }, t.isPlatform = function (e) {\n          return this.getPlatformType(!0) === String(e).toLowerCase();\n        }, t.isEngine = function (e) {\n          return this.getEngineName(!0) === String(e).toLowerCase();\n        }, t.is = function (e, t) {\n          return void 0 === t && (t = !1), this.isBrowser(e, t) || this.isOS(e) || this.isPlatform(e);\n        }, t.some = function (e) {\n          var t = this;\n          return void 0 === e && (e = []), e.some(function (e) {\n            return t.is(e);\n          });\n        }, e;\n      }();\n\n      t.default = d, e.exports = t.default;\n    },\n    92: function _(e, t, r) {\n      \"use strict\";\n\n      t.__esModule = !0, t.default = void 0;\n      var n,\n          i = (n = r(17)) && n.__esModule ? n : {\n        default: n\n      };\n      var s = /version\\/(\\d+(\\.?_?\\d+)+)/i,\n          a = [{\n        test: [/googlebot/i],\n        describe: function describe(e) {\n          var t = {\n            name: \"Googlebot\"\n          },\n              r = i.default.getFirstMatch(/googlebot\\/(\\d+(\\.\\d+))/i, e) || i.default.getFirstMatch(s, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/opera/i],\n        describe: function describe(e) {\n          var t = {\n            name: \"Opera\"\n          },\n              r = i.default.getFirstMatch(s, e) || i.default.getFirstMatch(/(?:opera)[\\s/](\\d+(\\.?_?\\d+)+)/i, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/opr\\/|opios/i],\n        describe: function describe(e) {\n          var t = {\n            name: \"Opera\"\n          },\n              r = i.default.getFirstMatch(/(?:opr|opios)[\\s/](\\S+)/i, e) || i.default.getFirstMatch(s, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/SamsungBrowser/i],\n        describe: function describe(e) {\n          var t = {\n            name: \"Samsung Internet for Android\"\n          },\n              r = i.default.getFirstMatch(s, e) || i.default.getFirstMatch(/(?:SamsungBrowser)[\\s/](\\d+(\\.?_?\\d+)+)/i, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/Whale/i],\n        describe: function describe(e) {\n          var t = {\n            name: \"NAVER Whale Browser\"\n          },\n              r = i.default.getFirstMatch(s, e) || i.default.getFirstMatch(/(?:whale)[\\s/](\\d+(?:\\.\\d+)+)/i, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/MZBrowser/i],\n        describe: function describe(e) {\n          var t = {\n            name: \"MZ Browser\"\n          },\n              r = i.default.getFirstMatch(/(?:MZBrowser)[\\s/](\\d+(?:\\.\\d+)+)/i, e) || i.default.getFirstMatch(s, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/focus/i],\n        describe: function describe(e) {\n          var t = {\n            name: \"Focus\"\n          },\n              r = i.default.getFirstMatch(/(?:focus)[\\s/](\\d+(?:\\.\\d+)+)/i, e) || i.default.getFirstMatch(s, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/swing/i],\n        describe: function describe(e) {\n          var t = {\n            name: \"Swing\"\n          },\n              r = i.default.getFirstMatch(/(?:swing)[\\s/](\\d+(?:\\.\\d+)+)/i, e) || i.default.getFirstMatch(s, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/coast/i],\n        describe: function describe(e) {\n          var t = {\n            name: \"Opera Coast\"\n          },\n              r = i.default.getFirstMatch(s, e) || i.default.getFirstMatch(/(?:coast)[\\s/](\\d+(\\.?_?\\d+)+)/i, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/opt\\/\\d+(?:.?_?\\d+)+/i],\n        describe: function describe(e) {\n          var t = {\n            name: \"Opera Touch\"\n          },\n              r = i.default.getFirstMatch(/(?:opt)[\\s/](\\d+(\\.?_?\\d+)+)/i, e) || i.default.getFirstMatch(s, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/yabrowser/i],\n        describe: function describe(e) {\n          var t = {\n            name: \"Yandex Browser\"\n          },\n              r = i.default.getFirstMatch(/(?:yabrowser)[\\s/](\\d+(\\.?_?\\d+)+)/i, e) || i.default.getFirstMatch(s, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/ucbrowser/i],\n        describe: function describe(e) {\n          var t = {\n            name: \"UC Browser\"\n          },\n              r = i.default.getFirstMatch(s, e) || i.default.getFirstMatch(/(?:ucbrowser)[\\s/](\\d+(\\.?_?\\d+)+)/i, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/Maxthon|mxios/i],\n        describe: function describe(e) {\n          var t = {\n            name: \"Maxthon\"\n          },\n              r = i.default.getFirstMatch(s, e) || i.default.getFirstMatch(/(?:Maxthon|mxios)[\\s/](\\d+(\\.?_?\\d+)+)/i, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/epiphany/i],\n        describe: function describe(e) {\n          var t = {\n            name: \"Epiphany\"\n          },\n              r = i.default.getFirstMatch(s, e) || i.default.getFirstMatch(/(?:epiphany)[\\s/](\\d+(\\.?_?\\d+)+)/i, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/puffin/i],\n        describe: function describe(e) {\n          var t = {\n            name: \"Puffin\"\n          },\n              r = i.default.getFirstMatch(s, e) || i.default.getFirstMatch(/(?:puffin)[\\s/](\\d+(\\.?_?\\d+)+)/i, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/sleipnir/i],\n        describe: function describe(e) {\n          var t = {\n            name: \"Sleipnir\"\n          },\n              r = i.default.getFirstMatch(s, e) || i.default.getFirstMatch(/(?:sleipnir)[\\s/](\\d+(\\.?_?\\d+)+)/i, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/k-meleon/i],\n        describe: function describe(e) {\n          var t = {\n            name: \"K-Meleon\"\n          },\n              r = i.default.getFirstMatch(s, e) || i.default.getFirstMatch(/(?:k-meleon)[\\s/](\\d+(\\.?_?\\d+)+)/i, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/micromessenger/i],\n        describe: function describe(e) {\n          var t = {\n            name: \"WeChat\"\n          },\n              r = i.default.getFirstMatch(/(?:micromessenger)[\\s/](\\d+(\\.?_?\\d+)+)/i, e) || i.default.getFirstMatch(s, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/qqbrowser/i],\n        describe: function describe(e) {\n          var t = {\n            name: /qqbrowserlite/i.test(e) ? \"QQ Browser Lite\" : \"QQ Browser\"\n          },\n              r = i.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\\d+(\\.?_?\\d+)+)/i, e) || i.default.getFirstMatch(s, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/msie|trident/i],\n        describe: function describe(e) {\n          var t = {\n            name: \"Internet Explorer\"\n          },\n              r = i.default.getFirstMatch(/(?:msie |rv:)(\\d+(\\.?_?\\d+)+)/i, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/\\sedg\\//i],\n        describe: function describe(e) {\n          var t = {\n            name: \"Microsoft Edge\"\n          },\n              r = i.default.getFirstMatch(/\\sedg\\/(\\d+(\\.?_?\\d+)+)/i, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/edg([ea]|ios)/i],\n        describe: function describe(e) {\n          var t = {\n            name: \"Microsoft Edge\"\n          },\n              r = i.default.getSecondMatch(/edg([ea]|ios)\\/(\\d+(\\.?_?\\d+)+)/i, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/vivaldi/i],\n        describe: function describe(e) {\n          var t = {\n            name: \"Vivaldi\"\n          },\n              r = i.default.getFirstMatch(/vivaldi\\/(\\d+(\\.?_?\\d+)+)/i, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/seamonkey/i],\n        describe: function describe(e) {\n          var t = {\n            name: \"SeaMonkey\"\n          },\n              r = i.default.getFirstMatch(/seamonkey\\/(\\d+(\\.?_?\\d+)+)/i, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/sailfish/i],\n        describe: function describe(e) {\n          var t = {\n            name: \"Sailfish\"\n          },\n              r = i.default.getFirstMatch(/sailfish\\s?browser\\/(\\d+(\\.\\d+)?)/i, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/silk/i],\n        describe: function describe(e) {\n          var t = {\n            name: \"Amazon Silk\"\n          },\n              r = i.default.getFirstMatch(/silk\\/(\\d+(\\.?_?\\d+)+)/i, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/phantom/i],\n        describe: function describe(e) {\n          var t = {\n            name: \"PhantomJS\"\n          },\n              r = i.default.getFirstMatch(/phantomjs\\/(\\d+(\\.?_?\\d+)+)/i, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/slimerjs/i],\n        describe: function describe(e) {\n          var t = {\n            name: \"SlimerJS\"\n          },\n              r = i.default.getFirstMatch(/slimerjs\\/(\\d+(\\.?_?\\d+)+)/i, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/blackberry|\\bbb\\d+/i, /rim\\stablet/i],\n        describe: function describe(e) {\n          var t = {\n            name: \"BlackBerry\"\n          },\n              r = i.default.getFirstMatch(s, e) || i.default.getFirstMatch(/blackberry[\\d]+\\/(\\d+(\\.?_?\\d+)+)/i, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/(web|hpw)[o0]s/i],\n        describe: function describe(e) {\n          var t = {\n            name: \"WebOS Browser\"\n          },\n              r = i.default.getFirstMatch(s, e) || i.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\\/(\\d+(\\.?_?\\d+)+)/i, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/bada/i],\n        describe: function describe(e) {\n          var t = {\n            name: \"Bada\"\n          },\n              r = i.default.getFirstMatch(/dolfin\\/(\\d+(\\.?_?\\d+)+)/i, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/tizen/i],\n        describe: function describe(e) {\n          var t = {\n            name: \"Tizen\"\n          },\n              r = i.default.getFirstMatch(/(?:tizen\\s?)?browser\\/(\\d+(\\.?_?\\d+)+)/i, e) || i.default.getFirstMatch(s, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/qupzilla/i],\n        describe: function describe(e) {\n          var t = {\n            name: \"QupZilla\"\n          },\n              r = i.default.getFirstMatch(/(?:qupzilla)[\\s/](\\d+(\\.?_?\\d+)+)/i, e) || i.default.getFirstMatch(s, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/firefox|iceweasel|fxios/i],\n        describe: function describe(e) {\n          var t = {\n            name: \"Firefox\"\n          },\n              r = i.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\\s/](\\d+(\\.?_?\\d+)+)/i, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/electron/i],\n        describe: function describe(e) {\n          var t = {\n            name: \"Electron\"\n          },\n              r = i.default.getFirstMatch(/(?:electron)\\/(\\d+(\\.?_?\\d+)+)/i, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/MiuiBrowser/i],\n        describe: function describe(e) {\n          var t = {\n            name: \"Miui\"\n          },\n              r = i.default.getFirstMatch(/(?:MiuiBrowser)[\\s/](\\d+(\\.?_?\\d+)+)/i, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/chromium/i],\n        describe: function describe(e) {\n          var t = {\n            name: \"Chromium\"\n          },\n              r = i.default.getFirstMatch(/(?:chromium)[\\s/](\\d+(\\.?_?\\d+)+)/i, e) || i.default.getFirstMatch(s, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/chrome|crios|crmo/i],\n        describe: function describe(e) {\n          var t = {\n            name: \"Chrome\"\n          },\n              r = i.default.getFirstMatch(/(?:chrome|crios|crmo)\\/(\\d+(\\.?_?\\d+)+)/i, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/GSA/i],\n        describe: function describe(e) {\n          var t = {\n            name: \"Google Search\"\n          },\n              r = i.default.getFirstMatch(/(?:GSA)\\/(\\d+(\\.?_?\\d+)+)/i, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: function test(e) {\n          var t = !e.test(/like android/i),\n              r = e.test(/android/i);\n          return t && r;\n        },\n        describe: function describe(e) {\n          var t = {\n            name: \"Android Browser\"\n          },\n              r = i.default.getFirstMatch(s, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/playstation 4/i],\n        describe: function describe(e) {\n          var t = {\n            name: \"PlayStation 4\"\n          },\n              r = i.default.getFirstMatch(s, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/safari|applewebkit/i],\n        describe: function describe(e) {\n          var t = {\n            name: \"Safari\"\n          },\n              r = i.default.getFirstMatch(s, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/.*/i],\n        describe: function describe(e) {\n          var t = -1 !== e.search(\"\\\\(\") ? /^(.*)\\/(.*)[ \\t]\\((.*)/ : /^(.*)\\/(.*) /;\n          return {\n            name: i.default.getFirstMatch(t, e),\n            version: i.default.getSecondMatch(t, e)\n          };\n        }\n      }];\n      t.default = a, e.exports = t.default;\n    },\n    93: function _(e, t, r) {\n      \"use strict\";\n\n      t.__esModule = !0, t.default = void 0;\n      var n,\n          i = (n = r(17)) && n.__esModule ? n : {\n        default: n\n      },\n          s = r(18);\n      var a = [{\n        test: [/Roku\\/DVP/],\n        describe: function describe(e) {\n          var t = i.default.getFirstMatch(/Roku\\/DVP-(\\d+\\.\\d+)/i, e);\n          return {\n            name: s.OS_MAP.Roku,\n            version: t\n          };\n        }\n      }, {\n        test: [/windows phone/i],\n        describe: function describe(e) {\n          var t = i.default.getFirstMatch(/windows phone (?:os)?\\s?(\\d+(\\.\\d+)*)/i, e);\n          return {\n            name: s.OS_MAP.WindowsPhone,\n            version: t\n          };\n        }\n      }, {\n        test: [/windows /i],\n        describe: function describe(e) {\n          var t = i.default.getFirstMatch(/Windows ((NT|XP)( \\d\\d?.\\d)?)/i, e),\n              r = i.default.getWindowsVersionName(t);\n          return {\n            name: s.OS_MAP.Windows,\n            version: t,\n            versionName: r\n          };\n        }\n      }, {\n        test: [/Macintosh(.*?) FxiOS(.*?)\\//],\n        describe: function describe(e) {\n          var t = {\n            name: s.OS_MAP.iOS\n          },\n              r = i.default.getSecondMatch(/(Version\\/)(\\d[\\d.]+)/, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/macintosh/i],\n        describe: function describe(e) {\n          var t = i.default.getFirstMatch(/mac os x (\\d+(\\.?_?\\d+)+)/i, e).replace(/[_\\s]/g, \".\"),\n              r = i.default.getMacOSVersionName(t),\n              n = {\n            name: s.OS_MAP.MacOS,\n            version: t\n          };\n          return r && (n.versionName = r), n;\n        }\n      }, {\n        test: [/(ipod|iphone|ipad)/i],\n        describe: function describe(e) {\n          var t = i.default.getFirstMatch(/os (\\d+([_\\s]\\d+)*) like mac os x/i, e).replace(/[_\\s]/g, \".\");\n          return {\n            name: s.OS_MAP.iOS,\n            version: t\n          };\n        }\n      }, {\n        test: function test(e) {\n          var t = !e.test(/like android/i),\n              r = e.test(/android/i);\n          return t && r;\n        },\n        describe: function describe(e) {\n          var t = i.default.getFirstMatch(/android[\\s/-](\\d+(\\.\\d+)*)/i, e),\n              r = i.default.getAndroidVersionName(t),\n              n = {\n            name: s.OS_MAP.Android,\n            version: t\n          };\n          return r && (n.versionName = r), n;\n        }\n      }, {\n        test: [/(web|hpw)[o0]s/i],\n        describe: function describe(e) {\n          var t = i.default.getFirstMatch(/(?:web|hpw)[o0]s\\/(\\d+(\\.\\d+)*)/i, e),\n              r = {\n            name: s.OS_MAP.WebOS\n          };\n          return t && t.length && (r.version = t), r;\n        }\n      }, {\n        test: [/blackberry|\\bbb\\d+/i, /rim\\stablet/i],\n        describe: function describe(e) {\n          var t = i.default.getFirstMatch(/rim\\stablet\\sos\\s(\\d+(\\.\\d+)*)/i, e) || i.default.getFirstMatch(/blackberry\\d+\\/(\\d+([_\\s]\\d+)*)/i, e) || i.default.getFirstMatch(/\\bbb(\\d+)/i, e);\n          return {\n            name: s.OS_MAP.BlackBerry,\n            version: t\n          };\n        }\n      }, {\n        test: [/bada/i],\n        describe: function describe(e) {\n          var t = i.default.getFirstMatch(/bada\\/(\\d+(\\.\\d+)*)/i, e);\n          return {\n            name: s.OS_MAP.Bada,\n            version: t\n          };\n        }\n      }, {\n        test: [/tizen/i],\n        describe: function describe(e) {\n          var t = i.default.getFirstMatch(/tizen[/\\s](\\d+(\\.\\d+)*)/i, e);\n          return {\n            name: s.OS_MAP.Tizen,\n            version: t\n          };\n        }\n      }, {\n        test: [/linux/i],\n        describe: function describe() {\n          return {\n            name: s.OS_MAP.Linux\n          };\n        }\n      }, {\n        test: [/CrOS/],\n        describe: function describe() {\n          return {\n            name: s.OS_MAP.ChromeOS\n          };\n        }\n      }, {\n        test: [/PlayStation 4/],\n        describe: function describe(e) {\n          var t = i.default.getFirstMatch(/PlayStation 4[/\\s](\\d+(\\.\\d+)*)/i, e);\n          return {\n            name: s.OS_MAP.PlayStation4,\n            version: t\n          };\n        }\n      }];\n      t.default = a, e.exports = t.default;\n    },\n    94: function _(e, t, r) {\n      \"use strict\";\n\n      t.__esModule = !0, t.default = void 0;\n      var n,\n          i = (n = r(17)) && n.__esModule ? n : {\n        default: n\n      },\n          s = r(18);\n      var a = [{\n        test: [/googlebot/i],\n        describe: function describe() {\n          return {\n            type: \"bot\",\n            vendor: \"Google\"\n          };\n        }\n      }, {\n        test: [/huawei/i],\n        describe: function describe(e) {\n          var t = i.default.getFirstMatch(/(can-l01)/i, e) && \"Nova\",\n              r = {\n            type: s.PLATFORMS_MAP.mobile,\n            vendor: \"Huawei\"\n          };\n          return t && (r.model = t), r;\n        }\n      }, {\n        test: [/nexus\\s*(?:7|8|9|10).*/i],\n        describe: function describe() {\n          return {\n            type: s.PLATFORMS_MAP.tablet,\n            vendor: \"Nexus\"\n          };\n        }\n      }, {\n        test: [/ipad/i],\n        describe: function describe() {\n          return {\n            type: s.PLATFORMS_MAP.tablet,\n            vendor: \"Apple\",\n            model: \"iPad\"\n          };\n        }\n      }, {\n        test: [/Macintosh(.*?) FxiOS(.*?)\\//],\n        describe: function describe() {\n          return {\n            type: s.PLATFORMS_MAP.tablet,\n            vendor: \"Apple\",\n            model: \"iPad\"\n          };\n        }\n      }, {\n        test: [/kftt build/i],\n        describe: function describe() {\n          return {\n            type: s.PLATFORMS_MAP.tablet,\n            vendor: \"Amazon\",\n            model: \"Kindle Fire HD 7\"\n          };\n        }\n      }, {\n        test: [/silk/i],\n        describe: function describe() {\n          return {\n            type: s.PLATFORMS_MAP.tablet,\n            vendor: \"Amazon\"\n          };\n        }\n      }, {\n        test: [/tablet(?! pc)/i],\n        describe: function describe() {\n          return {\n            type: s.PLATFORMS_MAP.tablet\n          };\n        }\n      }, {\n        test: function test(e) {\n          var t = e.test(/ipod|iphone/i),\n              r = e.test(/like (ipod|iphone)/i);\n          return t && !r;\n        },\n        describe: function describe(e) {\n          var t = i.default.getFirstMatch(/(ipod|iphone)/i, e);\n          return {\n            type: s.PLATFORMS_MAP.mobile,\n            vendor: \"Apple\",\n            model: t\n          };\n        }\n      }, {\n        test: [/nexus\\s*[0-6].*/i, /galaxy nexus/i],\n        describe: function describe() {\n          return {\n            type: s.PLATFORMS_MAP.mobile,\n            vendor: \"Nexus\"\n          };\n        }\n      }, {\n        test: [/[^-]mobi/i],\n        describe: function describe() {\n          return {\n            type: s.PLATFORMS_MAP.mobile\n          };\n        }\n      }, {\n        test: function test(e) {\n          return \"blackberry\" === e.getBrowserName(!0);\n        },\n        describe: function describe() {\n          return {\n            type: s.PLATFORMS_MAP.mobile,\n            vendor: \"BlackBerry\"\n          };\n        }\n      }, {\n        test: function test(e) {\n          return \"bada\" === e.getBrowserName(!0);\n        },\n        describe: function describe() {\n          return {\n            type: s.PLATFORMS_MAP.mobile\n          };\n        }\n      }, {\n        test: function test(e) {\n          return \"windows phone\" === e.getBrowserName();\n        },\n        describe: function describe() {\n          return {\n            type: s.PLATFORMS_MAP.mobile,\n            vendor: \"Microsoft\"\n          };\n        }\n      }, {\n        test: function test(e) {\n          var t = Number(String(e.getOSVersion()).split(\".\")[0]);\n          return \"android\" === e.getOSName(!0) && t >= 3;\n        },\n        describe: function describe() {\n          return {\n            type: s.PLATFORMS_MAP.tablet\n          };\n        }\n      }, {\n        test: function test(e) {\n          return \"android\" === e.getOSName(!0);\n        },\n        describe: function describe() {\n          return {\n            type: s.PLATFORMS_MAP.mobile\n          };\n        }\n      }, {\n        test: function test(e) {\n          return \"macos\" === e.getOSName(!0);\n        },\n        describe: function describe() {\n          return {\n            type: s.PLATFORMS_MAP.desktop,\n            vendor: \"Apple\"\n          };\n        }\n      }, {\n        test: function test(e) {\n          return \"windows\" === e.getOSName(!0);\n        },\n        describe: function describe() {\n          return {\n            type: s.PLATFORMS_MAP.desktop\n          };\n        }\n      }, {\n        test: function test(e) {\n          return \"linux\" === e.getOSName(!0);\n        },\n        describe: function describe() {\n          return {\n            type: s.PLATFORMS_MAP.desktop\n          };\n        }\n      }, {\n        test: function test(e) {\n          return \"playstation 4\" === e.getOSName(!0);\n        },\n        describe: function describe() {\n          return {\n            type: s.PLATFORMS_MAP.tv\n          };\n        }\n      }, {\n        test: function test(e) {\n          return \"roku\" === e.getOSName(!0);\n        },\n        describe: function describe() {\n          return {\n            type: s.PLATFORMS_MAP.tv\n          };\n        }\n      }];\n      t.default = a, e.exports = t.default;\n    },\n    95: function _(e, t, r) {\n      \"use strict\";\n\n      t.__esModule = !0, t.default = void 0;\n      var n,\n          i = (n = r(17)) && n.__esModule ? n : {\n        default: n\n      },\n          s = r(18);\n      var a = [{\n        test: function test(e) {\n          return \"microsoft edge\" === e.getBrowserName(!0);\n        },\n        describe: function describe(e) {\n          if (/\\sedg\\//i.test(e)) return {\n            name: s.ENGINE_MAP.Blink\n          };\n          var t = i.default.getFirstMatch(/edge\\/(\\d+(\\.?_?\\d+)+)/i, e);\n          return {\n            name: s.ENGINE_MAP.EdgeHTML,\n            version: t\n          };\n        }\n      }, {\n        test: [/trident/i],\n        describe: function describe(e) {\n          var t = {\n            name: s.ENGINE_MAP.Trident\n          },\n              r = i.default.getFirstMatch(/trident\\/(\\d+(\\.?_?\\d+)+)/i, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: function test(e) {\n          return e.test(/presto/i);\n        },\n        describe: function describe(e) {\n          var t = {\n            name: s.ENGINE_MAP.Presto\n          },\n              r = i.default.getFirstMatch(/presto\\/(\\d+(\\.?_?\\d+)+)/i, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: function test(e) {\n          var t = e.test(/gecko/i),\n              r = e.test(/like gecko/i);\n          return t && !r;\n        },\n        describe: function describe(e) {\n          var t = {\n            name: s.ENGINE_MAP.Gecko\n          },\n              r = i.default.getFirstMatch(/gecko\\/(\\d+(\\.?_?\\d+)+)/i, e);\n          return r && (t.version = r), t;\n        }\n      }, {\n        test: [/(apple)?webkit\\/537\\.36/i],\n        describe: function describe() {\n          return {\n            name: s.ENGINE_MAP.Blink\n          };\n        }\n      }, {\n        test: [/(apple)?webkit/i],\n        describe: function describe(e) {\n          var t = {\n            name: s.ENGINE_MAP.WebKit\n          },\n              r = i.default.getFirstMatch(/webkit\\/(\\d+(\\.?_?\\d+)+)/i, e);\n          return r && (t.version = r), t;\n        }\n      }];\n      t.default = a, e.exports = t.default;\n    }\n  });\n});","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _useBlocklyWorkspace2 = _interopRequireDefault(require(\"./useBlocklyWorkspace\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nvar propTypes = {\n  initialXml: _propTypes.default.string,\n  toolboxConfiguration: _propTypes.default.object,\n  // eslint-disable-line react/forbid-prop-types\n  workspaceConfiguration: _propTypes.default.object,\n  // eslint-disable-line react/forbid-prop-types\n  className: _propTypes.default.string,\n  onWorkspaceChange: _propTypes.default.func,\n  onImportXmlError: _propTypes.default.func,\n  onXmlChange: _propTypes.default.func,\n  onInject: _propTypes.default.func,\n  onDispose: _propTypes.default.func\n};\nvar defaultProps = {\n  initialXml: null,\n  toolboxConfiguration: null,\n  workspaceConfiguration: null,\n  className: null,\n  onWorkspaceChange: null,\n  onImportXmlError: null,\n  onXmlChange: null,\n  onInject: null,\n  onDispose: null\n};\n\nfunction BlocklyWorkspace(_ref) {\n  var initialXml = _ref.initialXml,\n      toolboxConfiguration = _ref.toolboxConfiguration,\n      workspaceConfiguration = _ref.workspaceConfiguration,\n      className = _ref.className,\n      onWorkspaceChange = _ref.onWorkspaceChange,\n      onXmlChange = _ref.onXmlChange,\n      onImportXmlError = _ref.onImportXmlError,\n      onInject = _ref.onInject,\n      onDispose = _ref.onDispose;\n\n  var editorDiv = _react.default.useRef(null);\n\n  var _useBlocklyWorkspace = (0, _useBlocklyWorkspace2.default)({\n    ref: editorDiv,\n    initialXml: initialXml,\n    toolboxConfiguration: toolboxConfiguration,\n    workspaceConfiguration: workspaceConfiguration,\n    onWorkspaceChange: onWorkspaceChange,\n    onImportXmlError: onImportXmlError,\n    onInject: onInject,\n    onDispose: onDispose\n  }),\n      xml = _useBlocklyWorkspace.xml;\n\n  var onXmlChangeRef = _react.default.useRef(onXmlChange);\n\n  _react.default.useEffect(function () {\n    onXmlChangeRef.current = onXmlChange;\n  }, [onXmlChange]);\n\n  _react.default.useEffect(function () {\n    if (onXmlChangeRef.current && xml) {\n      onXmlChangeRef.current(xml);\n    }\n  }, [xml]);\n\n  return /*#__PURE__*/_react.default.createElement(\"div\", {\n    className: className,\n    ref: editorDiv\n  });\n}\n\nBlocklyWorkspace.propTypes = propTypes;\nBlocklyWorkspace.defaultProps = defaultProps;\nvar _default = BlocklyWorkspace;\nexports.default = _default;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = debounce;\n\nfunction debounce(func, wait) {\n  var timeout = null;\n  var later = null;\n\n  var debouncedFunction = function debouncedFunction() {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    later = function later() {\n      timeout = null;\n      func.apply(void 0, args);\n    };\n\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n  };\n\n  var cancel = function cancel() {\n    if (timeout !== null) {\n      clearTimeout(timeout);\n      later();\n    }\n  };\n\n  return [debouncedFunction, cancel];\n}","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nObject.defineProperty(exports, \"useBlocklyWorkspace\", {\n  enumerable: true,\n  get: function get() {\n    return _useBlocklyWorkspace.default;\n  }\n});\nObject.defineProperty(exports, \"BlocklyWorkspace\", {\n  enumerable: true,\n  get: function get() {\n    return _BlocklyWorkspace.default;\n  }\n});\n\nvar _useBlocklyWorkspace = _interopRequireDefault(require(\"./useBlocklyWorkspace\"));\n\nvar _BlocklyWorkspace = _interopRequireDefault(require(\"./BlocklyWorkspace\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _blockly = _interopRequireDefault(require(\"blockly\"));\n\nvar _debounce3 = _interopRequireDefault(require(\"./debounce\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === \"[object Arguments]\")) {\n    return;\n  }\n\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction importFromXml(xml, workspace, onImportXmlError) {\n  try {\n    _blockly.default.Xml.domToWorkspace(_blockly.default.Xml.textToDom(xml), workspace);\n\n    return true;\n  } catch (e) {\n    if (onImportXmlError) {\n      onImportXmlError(e);\n    }\n\n    return false;\n  }\n}\n\nvar useBlocklyWorkspace = function useBlocklyWorkspace(_ref) {\n  var ref = _ref.ref,\n      initialXml = _ref.initialXml,\n      toolboxConfiguration = _ref.toolboxConfiguration,\n      workspaceConfiguration = _ref.workspaceConfiguration,\n      onWorkspaceChange = _ref.onWorkspaceChange,\n      onImportXmlError = _ref.onImportXmlError,\n      onInject = _ref.onInject,\n      onDispose = _ref.onDispose;\n\n  var _React$useState = _react.default.useState(null),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      workspace = _React$useState2[0],\n      setWorkspace = _React$useState2[1];\n\n  var _React$useState3 = _react.default.useState(initialXml),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      xml = _React$useState4[0],\n      setXml = _React$useState4[1];\n\n  var _React$useState5 = _react.default.useState(false),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      didInitialImport = _React$useState6[0],\n      setDidInitialImport = _React$useState6[1];\n\n  var _React$useState7 = _react.default.useState(false),\n      _React$useState8 = _slicedToArray(_React$useState7, 2),\n      didHandleNewWorkspace = _React$useState8[0],\n      setDidHandleNewWorkspace = _React$useState8[1]; // we explicitly don't want to recreate the workspace when the configuration changes\n  // so, we'll keep it in a ref and update as necessary in an effect hook\n\n\n  var workspaceConfigurationRef = _react.default.useRef(workspaceConfiguration);\n\n  _react.default.useEffect(function () {\n    workspaceConfigurationRef.current = workspaceConfiguration;\n  }, [workspaceConfiguration]);\n\n  var toolboxConfigurationRef = _react.default.useRef(toolboxConfiguration);\n\n  _react.default.useEffect(function () {\n    toolboxConfigurationRef.current = toolboxConfiguration;\n\n    if (toolboxConfiguration && workspace) {\n      workspace.updateToolbox(toolboxConfiguration);\n    }\n  }, [toolboxConfiguration, workspace]);\n\n  var onInjectRef = _react.default.useRef(onInject);\n\n  var onDisposeRef = _react.default.useRef(onDispose);\n\n  _react.default.useEffect(function () {\n    onInjectRef.current = onInject;\n  }, [onInject]);\n\n  _react.default.useEffect(function () {\n    onDisposeRef.current = onDispose;\n  }, [onDispose]);\n\n  var handleWorkspaceChanged = _react.default.useCallback(function (newWorkspace) {\n    if (onWorkspaceChange) {\n      onWorkspaceChange(newWorkspace);\n    }\n  }, [onWorkspaceChange]); // Workspace creation\n\n\n  _react.default.useEffect(function () {\n    var newWorkspace = _blockly.default.inject(ref.current, _objectSpread(_objectSpread({}, workspaceConfigurationRef.current), {}, {\n      toolbox: toolboxConfigurationRef.current\n    }));\n\n    setWorkspace(newWorkspace);\n    setDidInitialImport(false); // force a re-import if we recreate the workspace\n\n    setDidHandleNewWorkspace(false); // Singal that a workspace change event needs to be sent.\n\n    if (onInjectRef.current) {\n      onInjectRef.current(newWorkspace);\n    }\n\n    var onDisposeFunction = onDisposeRef.current; // Dispose of the workspace when our div ref goes away (Equivalent to didComponentUnmount)\n\n    return function () {\n      newWorkspace.dispose();\n\n      if (onDisposeFunction) {\n        onDisposeFunction(newWorkspace);\n      }\n    };\n  }, [ref]); // Send a workspace change event when the workspace is created\n\n\n  _react.default.useEffect(function () {\n    if (workspace && !didHandleNewWorkspace) {\n      handleWorkspaceChanged(workspace);\n    }\n  }, [handleWorkspaceChanged, didHandleNewWorkspace, workspace]); // Workspace change listener\n\n\n  _react.default.useEffect(function () {\n    if (workspace == null) {\n      return undefined;\n    }\n\n    var listener = function listener() {\n      handleWorkspaceChanged(workspace);\n    };\n\n    workspace.addChangeListener(listener);\n    return function () {\n      workspace.removeChangeListener(listener);\n    };\n  }, [workspace, handleWorkspaceChanged]); // xmlDidChange callback\n\n\n  _react.default.useEffect(function () {\n    if (workspace == null) {\n      return undefined;\n    }\n\n    var _debounce = (0, _debounce3.default)(function () {\n      var newXml = _blockly.default.Xml.domToText(_blockly.default.Xml.workspaceToDom(workspace));\n\n      if (newXml === xml) {\n        return;\n      }\n\n      setXml(newXml);\n    }, 200),\n        _debounce2 = _slicedToArray(_debounce, 2),\n        callback = _debounce2[0],\n        cancel = _debounce2[1];\n\n    workspace.addChangeListener(callback);\n    return function () {\n      workspace.removeChangeListener(callback);\n      cancel();\n    };\n  }, [workspace, xml]); // Initial Xml Changes\n\n\n  _react.default.useEffect(function () {\n    if (xml && workspace && !didInitialImport) {\n      var success = importFromXml(xml, workspace, onImportXmlError);\n\n      if (!success) {\n        setXml(null);\n      }\n\n      setDidInitialImport(true);\n    }\n  }, [xml, workspace, didInitialImport, onImportXmlError]);\n\n  return {\n    workspace: workspace,\n    xml: xml\n  };\n};\n\nvar _default = useBlocklyWorkspace;\nexports.default = _default;","import { useCallback, useRef, useState } from 'react';\nimport useDebouncedCallback from './useDebouncedCallback';\n\nfunction valueEquality(left, right) {\n  return left === right;\n}\n\nfunction adjustFunctionValueOfSetState(value) {\n  return typeof value === 'function' ? function () {\n    return value;\n  } : value;\n}\n\nfunction useStateIgnoreCallback(initialState) {\n  var _a = useState(adjustFunctionValueOfSetState(initialState)),\n      state = _a[0],\n      setState = _a[1];\n\n  var setStateIgnoreCallback = useCallback(function (value) {\n    return setState(adjustFunctionValueOfSetState(value));\n  }, []);\n  return [state, setStateIgnoreCallback];\n}\n\nexport default function useDebounce(value, delay, options) {\n  var eq = options && options.equalityFn || valueEquality;\n\n  var _a = useStateIgnoreCallback(value),\n      state = _a[0],\n      dispatch = _a[1];\n\n  var debounced = useDebouncedCallback(useCallback(function (value) {\n    return dispatch(value);\n  }, [dispatch]), delay, options);\n  var previousValue = useRef(value);\n\n  if (!eq(previousValue.current, value)) {\n    debounced(value);\n    previousValue.current = value;\n  }\n\n  return [state, {\n    cancel: debounced.cancel,\n    isPending: debounced.isPending,\n    flush: debounced.flush\n  }];\n}","import { useRef, useEffect, useMemo } from 'react';\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked, or until the next browser frame is drawn. The debounced function\n * comes with a `cancel` method to cancel delayed `func` invocations and a\n * `flush` method to immediately invoke them. Provide `options` to indicate\n * whether `func` should be invoked on the leading and/or trailing edge of the\n * `wait` timeout. The `func` is invoked with the last arguments provided to the\n * debounced function. Subsequent calls to the debounced function return the\n * result of the last `func` invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * If `wait` is omitted in an environment with `requestAnimationFrame`, `func`\n * invocation will be deferred until the next frame is drawn (typically about\n * 16ms).\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `debounce` and `throttle`.\n *\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0]\n *  The number of milliseconds to delay; if omitted, `requestAnimationFrame` is\n *  used (if available, otherwise it will be setTimeout(...,0)).\n * @param {Object} [options={}] The options object.\n *  Specify invoking on the leading edge of the timeout.\n * @param {boolean} [options.leading=false]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {number} [options.maxWait]\n *  Specify invoking on the trailing edge of the timeout.\n * @param {boolean} [options.trailing=true]\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * const resizeHandler = useDebouncedCallback(calculateLayout, 150);\n * window.addEventListener('resize', resizeHandler)\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * const clickHandler = useDebouncedCallback(sendMail, 300, {\n *   leading: true,\n *   trailing: false,\n * })\n * <button onClick={clickHandler}>click me</button>\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * const debounced = useDebouncedCallback(batchLog, 250, { 'maxWait': 1000 })\n * const source = new EventSource('/stream')\n * source.addEventListener('message', debounced)\n *\n * // Cancel the trailing debounced invocation.\n * window.addEventListener('popstate', debounced.cancel)\n *\n * // Check for pending invocations.\n * const status = debounced.pending() ? \"Pending...\" : \"Ready\"\n */\n\nexport default function useDebouncedCallback(func, wait, options) {\n  var _this = this;\n\n  var lastCallTime = useRef(null);\n  var lastInvokeTime = useRef(0);\n  var timerId = useRef(null);\n  var lastArgs = useRef([]);\n  var lastThis = useRef();\n  var result = useRef();\n  var funcRef = useRef(func);\n  var mounted = useRef(true);\n  funcRef.current = func; // Bypass `requestAnimationFrame` by explicitly setting `wait=0`.\n\n  var useRAF = !wait && wait !== 0 && typeof window !== 'undefined';\n\n  if (typeof func !== 'function') {\n    throw new TypeError('Expected a function');\n  }\n\n  wait = +wait || 0;\n  options = options || {};\n  var leading = !!options.leading;\n  var trailing = 'trailing' in options ? !!options.trailing : true; // `true` by default\n\n  var maxing = ('maxWait' in options);\n  var maxWait = maxing ? Math.max(+options.maxWait || 0, wait) : null;\n  useEffect(function () {\n    mounted.current = true;\n    return function () {\n      mounted.current = false;\n    };\n  }, []); // You may have a question, why we have so many code under the useMemo definition.\n  //\n  // This was made as we want to escape from useCallback hell and\n  // not to initialize a number of functions each time useDebouncedCallback is called.\n  //\n  // It means that we have less garbage for our GC calls which improves performance.\n  // Also, it makes this library smaller.\n  //\n  // And the last reason, that the code without lots of useCallback with deps is easier to read.\n  // You have only one place for that.\n\n  var debounced = useMemo(function () {\n    var invokeFunc = function invokeFunc(time) {\n      var args = lastArgs.current;\n      var thisArg = lastThis.current;\n      lastArgs.current = lastThis.current = null;\n      lastInvokeTime.current = time;\n      return result.current = funcRef.current.apply(thisArg, args);\n    };\n\n    var startTimer = function startTimer(pendingFunc, wait) {\n      if (useRAF) cancelAnimationFrame(timerId.current);\n      timerId.current = useRAF ? requestAnimationFrame(pendingFunc) : setTimeout(pendingFunc, wait);\n    };\n\n    var shouldInvoke = function shouldInvoke(time) {\n      if (!mounted.current) return false;\n      var timeSinceLastCall = time - lastCallTime.current;\n      var timeSinceLastInvoke = time - lastInvokeTime.current; // Either this is the first call, activity has stopped and we're at the\n      // trailing edge, the system time has gone backwards and we're treating\n      // it as the trailing edge, or we've hit the `maxWait` limit.\n\n      return !lastCallTime.current || timeSinceLastCall >= wait || timeSinceLastCall < 0 || maxing && timeSinceLastInvoke >= maxWait;\n    };\n\n    var trailingEdge = function trailingEdge(time) {\n      timerId.current = null; // Only invoke if we have `lastArgs` which means `func` has been\n      // debounced at least once.\n\n      if (trailing && lastArgs.current) {\n        return invokeFunc(time);\n      }\n\n      lastArgs.current = lastThis.current = null;\n      return result.current;\n    };\n\n    var timerExpired = function timerExpired() {\n      var time = Date.now();\n\n      if (shouldInvoke(time)) {\n        return trailingEdge(time);\n      } // https://github.com/xnimorz/use-debounce/issues/97\n\n\n      if (!mounted.current) {\n        return;\n      } // Remaining wait calculation\n\n\n      var timeSinceLastCall = time - lastCallTime.current;\n      var timeSinceLastInvoke = time - lastInvokeTime.current;\n      var timeWaiting = wait - timeSinceLastCall;\n      var remainingWait = maxing ? Math.min(timeWaiting, maxWait - timeSinceLastInvoke) : timeWaiting; // Restart the timer\n\n      startTimer(timerExpired, remainingWait);\n    };\n\n    var func = function func() {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      var time = Date.now();\n      var isInvoking = shouldInvoke(time);\n      lastArgs.current = args;\n      lastThis.current = _this;\n      lastCallTime.current = time;\n\n      if (isInvoking) {\n        if (!timerId.current && mounted.current) {\n          // Reset any `maxWait` timer.\n          lastInvokeTime.current = lastCallTime.current; // Start the timer for the trailing edge.\n\n          startTimer(timerExpired, wait); // Invoke the leading edge.\n\n          return leading ? invokeFunc(lastCallTime.current) : result.current;\n        }\n\n        if (maxing) {\n          // Handle invocations in a tight loop.\n          startTimer(timerExpired, wait);\n          return invokeFunc(lastCallTime.current);\n        }\n      }\n\n      if (!timerId.current) {\n        startTimer(timerExpired, wait);\n      }\n\n      return result.current;\n    };\n\n    func.cancel = function () {\n      if (timerId.current) {\n        useRAF ? cancelAnimationFrame(timerId.current) : clearTimeout(timerId.current);\n      }\n\n      lastInvokeTime.current = 0;\n      lastArgs.current = lastCallTime.current = lastThis.current = timerId.current = null;\n    };\n\n    func.isPending = function () {\n      return !!timerId.current;\n    };\n\n    func.flush = function () {\n      return !timerId.current ? result.current : trailingEdge(Date.now());\n    };\n\n    return func;\n  }, [leading, maxing, wait, maxWait, trailing, useRAF]);\n  return debounced;\n}","export const VM_WATCH_CHANGE = \"vmWatchChange\"\nexport const VM_BREAKPOINT = \"vmBreakpoint\"\nexport const VM_COMMAND_FAILED = \"vmCommandFailed\"\nexport const VM_ROLE_MISSING = \"vmRoleMissing\"\nexport const VM_GLOBAL_CHANGE = \"vmVariableChange\"\nexport const VM_GLOBAL_TYPE_MISMATCH = \"vmDynamicTypeError\"\nexport const VM_INTERNAL_ERROR = \"vmInternalError\"\nexport const VM_LOG_ENTRY = \"vmLogEntry\"\n","import {\n    BOUND,\n    CHANGE,\n    DEVICE_ANNOUNCE,\n    DEVICE_DISCONNECT,\n    ROLE_BOUND,\n    ROLE_UNBOUND,\n    UNBOUND,\n} from \"./constants\"\nimport JDBus from \"./bus\"\nimport JDDevice from \"./device\"\nimport JDService from \"./service\"\nimport { serviceSpecificationFromClassIdentifier } from \"./spec\"\nimport { JDClient } from \"./client\"\n\n/**\n * A binding from a name to a service\n * @category Roles\n */\nexport interface RoleBinding {\n    role: string\n    serviceClass: number\n    preferredDeviceId?: string\n    service?: JDService\n}\n\n/**\n * A role manager\n * @category Roles\n */\nexport class RoleManager extends JDClient {\n    private readonly _roles: RoleBinding[] = []\n\n    /**\n     * Gets the bus for this role\n     */\n    public readonly bus: JDBus\n\n    constructor(bus: JDBus) {\n        super()\n        this.bus = bus\n        this.mount(\n            this.bus.subscribe(DEVICE_ANNOUNCE, this.addServices.bind(this))\n        )\n        this.mount(\n            this.bus.subscribe(\n                DEVICE_DISCONNECT,\n                this.removeServices.bind(this)\n            )\n        )\n\n        this.bindServices()\n    }\n\n    /**\n     * Indicates if all roles are bound.\n     */\n    get isBound() {\n        return this._roles.every(({ service }) => !!service)\n    }\n\n    /**\n     * Gets the list of roles tracked by the manager\n     */\n    roles(bound: boolean = undefined) {\n        if (bound !== undefined)\n            return this._roles.filter(({ service }) => !!service === bound)\n        else return this._roles.slice(0)\n    }\n\n    /**\n     * Updates the list of roles\n     * @param newRoles\n     */\n    updateRoles(newRoles: RoleBinding[]) {\n        const oldBound = this.isBound\n        let changed = false\n\n        // remove unknown roles\n        const supportedNewRoles = newRoles.filter(({ serviceClass }) =>\n            serviceSpecificationFromClassIdentifier(serviceClass)\n        )\n\n        // unbind removed roles\n        let i = 0\n        while (i < this._roles.length) {\n            const role = this._roles[i]\n            if (!supportedNewRoles.find(r => r.role === role.role)) {\n                changed = true\n                this._roles.splice(i, 1)\n                this.emit(ROLE_UNBOUND, role.role)\n            } else {\n                i++\n            }\n        }\n\n        // update or add roles\n        for (const newRole of supportedNewRoles) {\n            const existingRole = this._roles.find(r => r.role === newRole.role)\n            if (!existingRole) {\n                // added role\n                changed = true\n                this._roles.push({ ...newRole })\n            } else if (existingRole.serviceClass !== newRole.serviceClass) {\n                // modified type, force rebinding\n                changed = true\n                existingRole.serviceClass = newRole.serviceClass\n                if (existingRole.service) {\n                    existingRole.service = undefined\n                    this.emit(ROLE_UNBOUND, existingRole.role)\n                }\n            } // else unmodifed role\n        }\n        // bound services\n        this.bindServices(changed)\n        this.emitBoundEvents(oldBound)\n    }\n\n    /**\n     * Resolves the service bound to a given role.\n     * @param role\n     * @returns\n     */\n    public service(role: string): JDService {\n        return this._roles.find(r => r.role === role)?.service\n    }\n\n    /**\n     * Updates or creates a new role\n     * @param role name of the role\n     * @param serviceClass desired service class\n     * @param preferredDeviceId optional preferred device id\n     * @returns\n     */\n    public updateRole(\n        role: string,\n        serviceClass: number,\n        preferredDeviceId?: string\n    ) {\n        if (!serviceSpecificationFromClassIdentifier(serviceClass)) return // unknown role type\n\n        let binding = this._roles.find(r => r.role === role)\n\n        // check if we already have this role\n        if (binding && serviceClass === binding.serviceClass) {\n            if (!binding.service && preferredDeviceId) {\n                binding.preferredDeviceId = preferredDeviceId\n            }\n            return\n        }\n        const oldBound = this.isBound\n        // new role\n        binding = { role, serviceClass, preferredDeviceId }\n        this._roles.push(binding)\n        if (!this.bindRole(binding)) {\n            this.emit(ROLE_UNBOUND, role)\n        }\n        this.emit(CHANGE)\n        this.emitBoundEvents(oldBound)\n    }\n\n    private emitBoundEvents(oldBound: boolean) {\n        const bound = this.isBound\n        if (oldBound !== bound) this.emit(bound ? BOUND : UNBOUND)\n    }\n\n    // TODO: need to respect other (unbound) role's preferredDeviceId\n    private bindRole(role: RoleBinding) {\n        const ret = this.bus\n            .services({\n                ignoreInfrastructure: true,\n                serviceClass: role.serviceClass,\n            })\n            .filter(s => !this.roles(true).find(r => r.service === s))\n        if (ret.length) {\n            let theOne = ret[0]\n            if (role.preferredDeviceId) {\n                const newOne = ret.find(\n                    s => s.device.deviceId === role.preferredDeviceId\n                )\n                if (newOne) theOne = newOne\n            }\n            role.service = theOne\n            this.emit(ROLE_BOUND, role.role)\n            return true\n        }\n        return false\n    }\n\n    private bindServices(changed?: boolean) {\n        this.roles(false).forEach(binding => {\n            if (this.bindRole(binding)) changed = true\n        })\n        if (changed) this.emit(CHANGE)\n    }\n\n    private addServices(dev: JDDevice) {\n        if (dev === this.bus.selfDevice) return\n        this.bindServices()\n    }\n\n    private removeServices(dev: JDDevice) {\n        let changed = false\n        this._roles\n            .filter(r => r.service?.device === dev)\n            .forEach(r => {\n                r.service = undefined\n                this.emit(ROLE_UNBOUND, r.role)\n                changed = true\n            })\n        this.bindServices(changed)\n    }\n\n    toString() {\n        return this._roles\n            .map(({ role, service }) => `${role}->${service || \"?\"}`)\n            .join(\",\")\n    }\n}\nexport default RoleManager\n\n/**\n * Tracks a set of roles\n * @param bus bus hosting the devices\n * @param bindings map of role names to device service pairs\n * @param onUpdate callback to run whenver role assignments change\n * @param options Additional options\n * @returns A unsubscribe callback to cleanup handlers\n * @category Roles\n */\nexport function startRoles<\n    TRoles extends Record<\n        string,\n        { serviceClass: number; preferredDeviceId?: string }\n    >\n>(\n    bus: JDBus,\n    bindings: TRoles,\n    onUpdate: (roles: Record<keyof TRoles, JDService>) => void,\n    options?: {\n        /**\n         * Calls update even if not all role around bound\n         */\n        incomplete?: boolean\n    }\n): () => void {\n    const { incomplete } = options || {}\n    const roleManager = new RoleManager(bus)\n    roleManager.updateRoles(\n        Object.keys(bindings).map(role => ({\n            role,\n            serviceClass: bindings[role].serviceClass,\n            preferredDeviceId: bindings[role].preferredDeviceId,\n        }))\n    )\n    const roles = () => {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const r: Record<keyof TRoles, JDService> = {} as any\n        for (const key in bindings) {\n            const srv = roleManager.service(key)\n            if (srv) r[key] = srv\n        }\n        return r\n    }\n    const update = () => {\n        if (!incomplete && !roleManager.isBound) return\n        onUpdate(roles())\n    }\n    const unsubscribe = roleManager.subscribe(CHANGE, update)\n    update()\n    return unsubscribe\n}\n\n/*\nfunction test(bus: JDBus) {\n    const bindings = {\n        thermo1: { serviceClass: SRV_BUTTON },\n        thermo2: { serviceClass: SRV_BUTTON },\n    }\n    trackRoles(\n        bus,\n        bindings,\n        ({ thermo1, thermo2 }) => {\n            console.log({ thermo1, thermo2 })\n        },\n        { incomplete: true }\n    )\n}\n*/\n","import { useContext, useMemo } from \"react\"\nimport JacdacContext, { JacdacContextProps } from \"../../jacdac/Context\"\nimport RoleManager from \"../../../jacdac-ts/src/jdom/rolemanager\"\n\nexport default function useRoleManager() {\n    const { bus } = useContext<JacdacContextProps>(JacdacContext)\n    const roleManager = useMemo(() => bus && new RoleManager(bus), [bus])\n    return roleManager\n}\n","import { WorkspaceJSON } from \"./dsl/workspacejson\"\nimport { visitWorkspace } from \"./dsl/workspacevisitor\"\n\nexport interface BlockWarning {\n    sourceId?: string\n    message: string\n}\n\nexport function collectWarnings(workspace: WorkspaceJSON): BlockWarning[] {\n    const warnings: BlockWarning[] = []\n    visitWorkspace(workspace, {\n        visitBlock: b => {\n            if (b.warning) warnings.push({ sourceId: b.id, message: b.warning })\n        },\n    })\n    return warnings\n}\n","import { CHANGE } from \"../../../../jacdac-ts/src/jdom/constants\"\nimport { identityTransformData, resolveBlockDefinition } from \"../toolbox\"\nimport { BlockWithServices, resolveBlockServices } from \"../WorkspaceContext\"\nimport { start, done } from \"nprogress\"\n\nconst PROGRESS_DELAY = 200\n\nexport function registerDataSolver(block: BlockWithServices) {\n    const { jacdacServices: services } = block\n    // register data transforms\n    const { transformData } = resolveBlockDefinition(block.type) || {}\n    if (!transformData) return\n\n    const applyTransform = async () => {\n        if (!block.isEnabled() || block.isInFlyout) return\n\n        // transfer data to the next block\n        const nextServices = resolveBlockServices(\n            block.nextConnection?.targetBlock()\n        )\n        try {\n            services.setDataWarning(undefined)\n            // eslint-disable-next-line @typescript-eslint/ban-types\n            let newData: object[]\n            if (transformData === identityTransformData) newData = services.data\n            else {\n                let progressid = setTimeout(() => {\n                    progressid = undefined\n                    start()\n                }, PROGRESS_DELAY)\n                try {\n                    //const start = performance.now()\n                    newData = await transformData(\n                        block,\n                        services.data,\n                        nextServices?.data\n                    )\n                    //const end = performance.now()\n                    //console.debug(\n                    //    `data ${block.type}: ${roundWithPrecision(\n                    //        (end - start) / 1000,\n                    //        3\n                    //    )}s`\n                    //)\n                } finally {\n                    if (progressid) clearTimeout(progressid)\n                    else done()\n                }\n            }\n\n            // propagate\n            services.transformedData = newData\n\n            // check if pass through\n            const def = resolveBlockDefinition(block.type)\n            if (def?.passthroughData) newData = services.data\n\n            if (nextServices) nextServices.data = newData\n        } catch (e) {\n            console.debug(e)\n        }\n    }\n    // apply transform, then register for change\n    applyTransform().then(() => services.on(CHANGE, applyTransform))\n}\n","import Blockly from \"blockly\"\nimport { useCallback } from \"react\"\nimport ReactField from \"./fields/ReactField\"\nimport useWorkspaceEvent from \"./useWorkspaceEvent\"\n\n// do not use block context\n\nexport default function useBlocklyEvents(workspace: Blockly.WorkspaceSvg) {\n    const handleChange = useCallback(\n        (event: Blockly.Events.Abstract & { type: string }) => {\n            const { type } = event\n            switch (type) {\n                case Blockly.Events.BLOCK_CHANGE: {\n                    const change = event as Blockly.Events.Change\n                    const block = workspace.getBlockById(change.blockId)\n                    // notify twin that the value changed\n                    const twinInput = block.inputList[1]\n                    const twinField = twinInput?.fieldRow.find(\n                        f => f.name === \"twin\"\n                    ) as ReactField<unknown>\n                    twinField?.emitChange?.()\n                    break\n                }\n            }\n        },\n        [workspace]\n    )\n    useWorkspaceEvent(workspace, handleChange)\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * @fileoverview Number slider input field.\n * @author kozbial@google.com (Monica Kozbial)\n */\nimport * as Blockly from 'blockly/core';\n/**\n * Slider field.\n */\n\nexport class FieldSlider extends Blockly.FieldNumber {\n  /**\n   * Class for an number slider field.\n   * @param {string|number=} value The initial value of the field. Should\n   *    cast to a number. Defaults to 0.\n   * @param {?(string|number)=} min Minimum value.\n   * @param {?(string|number)=} max Maximum value.\n   * @param {?(string|number)=} precision Precision for value.\n   * @param {?Function=} validator A function that is called to validate\n   *    changes to the field's value. Takes in a number & returns a validated\n   *    number, or null to abort the change.\n   * @param {Object=} config A map of options used to configure the field.\n   *    See the [field creation documentation]{@link\n   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/number#creation}\n   *    for a list of properties this parameter supports.\n   * @extends {Blockly.FieldNumber}\n   * @constructor\n   */\n  constructor() {\n    var value = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : undefined;\n    var min = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : undefined;\n    var max = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : undefined;\n    var precision = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : undefined;\n    var validator = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : undefined;\n    var config = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : undefined;\n    super(value, min, max, precision, validator, config);\n    /**\n     * Array holding info needed to unbind events.\n     * Used for disposing.\n     * Ex: [[node, name, func], [node, name, func]].\n     * @type {!Array.<Array<?>>}\n     * @private\n     */\n\n    this.boundEvents_ = [];\n    /**\n     * The HTML range input element.\n     * @type {?HTMLInputElement}\n     * @private\n     */\n\n    this.sliderInput_ = null;\n  }\n  /**\n   * Constructs a FieldSlider from a JSON arg object.\n   * @param {!Object} options A JSON object with options (value, min, max, and\n   *                          precision).\n   * @return {!FieldSlider} The new field instance.\n   * @package\n   * @nocollapse\n   */\n\n\n  static fromJson(options) {\n    return new FieldSlider(options['value'], undefined, undefined, undefined, undefined, options);\n  }\n  /**\n   * Show the inline free-text editor on top of the text along with the slider\n   *    editor.\n   * @param {Event=} e Optional mouse event that triggered the field to\n   *     open, or undefined if triggered programmatically.\n   * @param {boolean=} _quietInput Quiet input.\n   * @protected\n   * @override\n   */\n\n\n  showEditor_() {\n    var e = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : undefined;\n\n    var _quietInput = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : undefined;\n\n    // Mobile browsers have issues with in-line textareas (focus & keyboards).\n    var noFocus = Blockly.utils.userAgent.MOBILE || Blockly.utils.userAgent.ANDROID || Blockly.utils.userAgent.IPAD;\n    super.showEditor_(e, noFocus); // Build the DOM.\n\n    var editor = this.dropdownCreate_();\n    Blockly.DropDownDiv.getContentDiv().appendChild(editor);\n    Blockly.DropDownDiv.setColour(this.sourceBlock_.style.colourPrimary, this.sourceBlock_.style.colourTertiary);\n    Blockly.DropDownDiv.showPositionedByField(this, this.dropdownDispose_.bind(this));\n  }\n  /**\n   * Updates the slider when the field rerenders.\n   * @protected\n   * @override\n   */\n\n\n  render_() {\n    super.render_();\n    this.updateSlider_();\n  }\n  /**\n   * Creates the slider editor and add event listeners.\n   * @return {!Element} The newly created slider.\n   * @private\n   */\n\n\n  dropdownCreate_() {\n    var wrapper = document.createElement('div');\n    wrapper.className = 'fieldSliderContainer';\n    var sliderInput = document.createElement('input');\n    sliderInput.setAttribute('type', 'range');\n    sliderInput.setAttribute('min', this.min_);\n    sliderInput.setAttribute('max', this.max_);\n    sliderInput.setAttribute('step', this.precision_);\n    sliderInput.setAttribute('value', this.getValue());\n    sliderInput.className = 'fieldSlider';\n    wrapper.appendChild(sliderInput);\n    this.sliderInput_ = sliderInput;\n    this.boundEvents_.push(Blockly.bindEventWithChecks_(sliderInput, 'input', this, this.onSliderChange_));\n    return wrapper;\n  }\n  /**\n   * Disposes of events belonging to the slider editor.\n   * @private\n   */\n\n\n  dropdownDispose_() {\n    for (var event of this.boundEvents_) {\n      Blockly.unbindEvent_(event);\n    }\n\n    this.sliderInput_ = null;\n  }\n  /**\n   * Sets the text to match the slider's position.\n   * @private\n   */\n\n\n  onSliderChange_() {\n    this.setEditorValue_(this.sliderInput_.value);\n  }\n  /**\n   * Updates the slider when the field rerenders.\n   * @private\n   */\n\n\n  updateSlider_() {\n    if (!this.sliderInput_) {\n      return;\n    }\n\n    this.sliderInput_.setAttribute('value', this.getValue());\n  }\n\n}\nBlockly.fieldRegistry.register('field_slider', FieldSlider);\n/**\n * CSS for slider field.\n */\n\nBlockly.Css.register([\n/* eslint-disable indent */\n\".fieldSliderContainer {\\n      align-items: center;\\n      display: flex;\\n      height: 32px;\\n      justify-content: center;\\n      width: 150px;\\n    }\\n    .fieldSlider {\\n      -webkit-appearance: none;\\n      background: transparent; /* override white in chrome */\\n      margin: 4px;\\n      padding: 0;\\n      width: 100%;\\n    }\\n    .fieldSlider:focus {\\n      outline: none;\\n    }\\n    /* Webkit */\\n    .fieldSlider::-webkit-slider-runnable-track {\\n      background: #ddd;\\n      border-radius: 5px;\\n      height: 10px;\\n    }\\n    .fieldSlider::-webkit-slider-thumb {\\n      -webkit-appearance: none;\\n      background: #fff;\\n      border-radius: 50%;\\n      box-shadow: 0 0 0 4px rgba(255,255,255,.15);\\n      cursor: pointer;\\n      height: 24px;\\n      margin-top: -7px;\\n      width: 24px;\\n    }\\n    /* Firefox */\\n    .fieldSlider::-moz-range-track {\\n      background: #ddd;\\n      border-radius: 5px;\\n      height: 10px;\\n    }\\n    .fieldSlider::-moz-range-thumb {\\n      background: #fff;\\n      border: none;\\n      border-radius: 50%;\\n      box-shadow: 0 0 0 4px rgba(255,255,255,.15);\\n      cursor: pointer;\\n      height: 24px;\\n      width: 24px;\\n    }\\n    .fieldSlider::-moz-focus-outer {\\n      /* override the focus border style */\\n      border: 0;\\n    }\\n    /* IE */\\n    .fieldSlider::-ms-track {\\n      /* IE wont let the thumb overflow the track, so fake it */\\n      background: transparent;\\n      border-color: transparent;\\n      border-width: 15px 0;\\n      /* remove default tick marks */\\n      color: transparent;\\n      height: 10px;\\n      width: 100%;\\n      margin: -4px 0;\\n    }\\n    .fieldSlider::-ms-fill-lower  {\\n      background: #ddd;\\n      border-radius: 5px;\\n    }\\n    .fieldSlider::-ms-fill-upper  {\\n      background: #ddd;\\n      border-radius: 5px;\\n    }\\n    .fieldSlider::-ms-thumb {\\n      background: #fff;\\n      border: none;\\n      border-radius: 50%;\\n      box-shadow: 0 0 0 4px rgba(255,255,255,.15);\\n      cursor: pointer;\\n      height: 24px;\\n      width: 24px;\\n    }\"\n/* eslint-enable indent */\n]);","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\nexport * from './field_slider';","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * @fileoverview Overrides methods on Blockly.InsertionMarkerManager to\n * allow blocks to hook in dynamic functionality when they have pending\n * connections.\n * @author anjali@code.org (Anjali Pal)\n */\nimport * as Blockly from 'blockly/core';\n\nBlockly.InsertionMarkerManager.prototype.update = function (dxy, deleteArea) {\n  var candidate = this.getCandidate_(dxy);\n  this.wouldDeleteBlock_ = this.shouldDelete_(candidate, deleteArea);\n  var shouldUpdate = this.wouldDeleteBlock_ || this.shouldUpdatePreviews_(candidate, dxy);\n\n  if (shouldUpdate) {\n    // Begin monkey patch\n    if (candidate.closest && candidate.closest.sourceBlock_.onPendingConnection) {\n      candidate.closest.sourceBlock_.onPendingConnection(candidate.closest);\n\n      if (!this.pendingBlocks) {\n        this.pendingBlocks = new Set();\n      }\n\n      this.pendingBlocks.add(candidate.closest.sourceBlock_);\n    } // End monkey patch\n    // Don't fire events for insertion marker creation or movement.\n\n\n    Blockly.Events.disable();\n    this.maybeHidePreview_(candidate);\n    this.maybeShowPreview_(candidate);\n    Blockly.Events.enable();\n  }\n};\n\nvar oldDispose = Blockly.InsertionMarkerManager.prototype.dispose;\n\nBlockly.InsertionMarkerManager.prototype.dispose = function () {\n  if (this.pendingBlocks) {\n    this.pendingBlocks.forEach(block => {\n      if (block.finalizeConnections) {\n        block.finalizeConnections();\n      }\n    });\n  }\n\n  oldDispose.call(this);\n};","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * @fileoverview Defines a version of the if block with dyanmic\n *     inputs that appear when a block is dragged over inputs on the block.\n */\nimport * as Blockly from 'blockly/core';\nBlockly.Blocks['dynamic_if'] = {\n  /**\n   * Counter for the next input to add to this block.\n   * @type {number}\n   */\n  inputCounter: 1,\n\n  /**\n   * Minimum number of inputs for this block.\n   * @type {number}\n   */\n  minInputs: 1,\n\n  /**\n   * Block for if/elseif/else statements. Must have one if input.\n   * Can have any number of elseif inputs and optionally one else input.\n   * @this {Blockly.Block}\n   */\n  init: function init() {\n    this.setHelpUrl(Blockly.Msg['CONTROLS_IF_HELPURL']);\n    this.setStyle('logic_blocks');\n    this.appendValueInput('IF0').setCheck('Boolean').appendField(Blockly.Msg['CONTROLS_IF_MSG_IF'], 'if');\n    this.appendStatementInput('DO0').appendField(Blockly.Msg['CONTROLS_IF_MSG_THEN']);\n    this.setNextStatement(true);\n    this.setPreviousStatement(true);\n    this.setTooltip(Blockly.Msg['LISTS_CREATE_WITH_TOOLTIP']);\n  },\n\n  /**\n   * Create XML to represent if/elseif/else inputs.\n   * @return {!Element} XML storage element.\n   * @this {Blockly.Block}\n   */\n  mutationToDom: function mutationToDom() {\n    var container = Blockly.utils.xml.createElement('mutation');\n    var inputNames = this.inputList.filter(input => input.name.includes('IF')).map(input => input.name.replace('IF', '')).join(',');\n    container.setAttribute('inputs', inputNames);\n    var hasElse = !!this.getInput('ELSE');\n    container.setAttribute('else', hasElse);\n    container.setAttribute('next', this.inputCounter);\n    return container;\n  },\n\n  /**\n   * Parse XML to restore the inputs.\n   * @param {!Element} xmlElement XML storage element.\n   * @this {Blockly.Block}\n   */\n  domToMutation: function domToMutation(xmlElement) {\n    var inputs = xmlElement.getAttribute('inputs');\n\n    if (inputs) {\n      var inputNumbers = inputs.split(',');\n\n      if (this.getInput('IF0')) {\n        this.removeInput('IF0');\n      }\n\n      if (this.getInput('DO0')) {\n        this.removeInput('DO0');\n      }\n\n      var first = inputNumbers[0];\n      this.appendValueInput('IF' + first).setCheck('Boolean').appendField(Blockly.Msg['CONTROLS_IF_MSG_IF'], 'if');\n      this.appendStatementInput('DO' + first).appendField(Blockly.Msg['CONTROLS_IF_MSG_THEN']);\n\n      for (var i = 1; i < inputNumbers.length; i++) {\n        this.appendValueInput('IF' + inputNumbers[i]).setCheck('Boolean').appendField(Blockly.Msg['CONTROLS_IF_MSG_ELSEIF'], 'elseif');\n        this.appendStatementInput('DO' + inputNumbers[i]).appendField(Blockly.Msg['CONTROLS_IF_MSG_THEN']);\n      }\n    }\n\n    var hasElse = xmlElement.getAttribute('else');\n\n    if (hasElse == 'true') {\n      this.appendStatementInput('ELSE').appendField(Blockly.Msg['CONTROLS_IF_MSG_ELSE'], 'else');\n    }\n\n    var next = parseInt(xmlElement.getAttribute('next'));\n    this.inputCounter = next;\n  },\n\n  /**\n   * Finds the index of a connection. Used to determine where in the block to\n   * insert new inputs.\n   * @param {!Blockly.Connection} connection A connection on this block.\n   * @return {?number} The index of the connection in the this.inputList.\n   */\n  findInputIndexForConnection: function findInputIndexForConnection(connection) {\n    for (var i = 0; i < this.inputList.length; i++) {\n      var input = this.inputList[i];\n\n      if (input.connection == connection) {\n        return i;\n      }\n    }\n\n    return null;\n  },\n\n  /**\n   * Inserts a boolean value input and statement input at the specified index.\n   * @param {number} index Index of the input before which to add new inputs.\n   */\n  insertElseIf: function insertElseIf(index) {\n    var caseNumber = this.inputCounter;\n    this.appendValueInput('IF' + caseNumber).setCheck('Boolean').appendField(Blockly.Msg['CONTROLS_IF_MSG_ELSEIF'], 'elseif');\n    this.appendStatementInput('DO' + caseNumber).appendField(Blockly.Msg['CONTROLS_IF_MSG_THEN']);\n    this.moveInputBefore('IF' + caseNumber, this.inputList[index].name);\n    this.moveInputBefore('DO' + caseNumber, this.inputList[index + 1].name);\n    this.inputCounter++;\n  },\n\n  /**\n   * Called when a block is dragged over one of the connections on this block.\n   * @param {!Blockly.Connection} connection The connection on this block that\n   * has a pending connection.\n   */\n  onPendingConnection: function onPendingConnection(connection) {\n    if (connection.type === Blockly.NEXT_STATEMENT && !this.getInput('ELSE')) {\n      this.appendStatementInput('ELSE').appendField(Blockly.Msg['CONTROLS_IF_MSG_ELSE'], 'else');\n    }\n\n    var inputIndex = this.findInputIndexForConnection(connection);\n\n    if (inputIndex === null) {\n      return;\n    }\n\n    var input = this.inputList[inputIndex];\n\n    if (connection.targetConnection && input.name.includes('IF')) {\n      var nextIfInput = this.inputList[inputIndex + 2];\n\n      if (!nextIfInput || nextIfInput.name == 'ELSE') {\n        this.insertElseIf(inputIndex + 2);\n      } else {\n        var nextIfConnection = nextIfInput && nextIfInput.connection.targetConnection;\n\n        if (nextIfConnection && !nextIfConnection.sourceBlock_.isInsertionMarker()) {\n          this.insertElseIf(inputIndex + 2);\n        }\n      }\n    }\n  },\n\n  /**\n   * Called when a block drag ends if the dragged block had a pending connection\n   * with this block.\n   */\n  finalizeConnections: function finalizeConnections() {\n    var toRemove = []; // Remove Else If inputs if neither the if nor the do has a connected block.\n\n    for (var i = 2; i < this.inputList.length - 1; i += 2) {\n      var ifConnection = this.inputList[i];\n      var doConnection = this.inputList[i + 1];\n\n      if (!ifConnection.connection.targetConnection && !doConnection.connection.targetConnection) {\n        toRemove.push(ifConnection.name);\n        toRemove.push(doConnection.name);\n      }\n    }\n\n    toRemove.forEach(input => this.removeInput(input)); // Remove Else input if it doesn't have a connected block.\n\n    var elseInput = this.getInput('ELSE');\n\n    if (elseInput && !elseInput.connection.targetConnection) {\n      this.removeInput(elseInput.name);\n    } // Remove the If input if it is empty and there is at least one Else If\n\n\n    if (this.inputList.length > 2) {\n      var ifInput = this.inputList[0];\n      var doInput = this.inputList[1];\n      var nextInput = this.inputList[2];\n\n      if (nextInput.name.includes('IF') && !ifInput.connection.targetConnection && !doInput.connection.targetConnection) {\n        this.removeInput(ifInput.name);\n        this.removeInput(doInput.name);\n        nextInput.removeField('elseif');\n        nextInput.appendField(Blockly.Msg['CONTROLS_IF_MSG_IF'], 'if');\n      }\n    }\n  }\n};","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * @fileoverview Defines a version of the text_join block with dyanmic\n *    inputs that appear when a block is dragged over inputs on the block.\n */\nimport * as Blockly from 'blockly/core';\nBlockly.Blocks['dynamic_text_join'] = {\n  /**\n   * Counter for the next input to add to this block.\n   * @type {number}\n   */\n  inputCounter: 2,\n\n  /**\n   * Minimum number of inputs for this block.\n   * @type {number}\n   */\n  minInputs: 2,\n\n  /**\n   * Block for concatenating any number of strings.\n   * @this {Blockly.Block}\n   */\n  init: function init() {\n    this.setHelpUrl(Blockly.Msg['TEXT_JOIN_HELPURL']);\n    this.setStyle('text_blocks');\n    this.appendValueInput('ADD0').appendField(Blockly.Msg['TEXT_JOIN_TITLE_CREATEWITH']);\n    this.appendValueInput('ADD1');\n    this.setOutput(true, 'String');\n    this.setTooltip(Blockly.Msg['TEXT_JOIN_TOOLTIP']);\n  },\n\n  /**\n   * Create XML to represent number of text inputs.\n   * @return {!Element} XML storage element.\n   * @this {Blockly.Block}\n   */\n  mutationToDom: function mutationToDom() {\n    var container = Blockly.utils.xml.createElement('mutation');\n    var inputNames = this.inputList.map(input => input.name).join(',');\n    container.setAttribute('inputs', inputNames);\n    container.setAttribute('next', this.inputCounter);\n    return container;\n  },\n\n  /**\n   * Parse XML to restore the text inputs.\n   * @param {!Element} xmlElement XML storage element.\n   * @this {Blockly.Block}\n   */\n  domToMutation: function domToMutation(xmlElement) {\n    var items = xmlElement.getAttribute('inputs');\n\n    if (items) {\n      var inputNames = items.split(',');\n      this.inputList = [];\n      inputNames.forEach(name => this.appendValueInput(name));\n      this.inputList[0].appendField(Blockly.Msg['TEXT_JOIN_TITLE_CREATEWITH']);\n    }\n\n    var next = parseInt(xmlElement.getAttribute('next'));\n    this.inputCounter = next;\n  },\n\n  /**\n   * Check whether a new input should be added and determine where it should go.\n   * @param {!Blockly.Connection} connection The connection that has a\n   *     pending connection.\n   * @return {number} The index before which to insert a new input,\n   *     or null if no input should be added.\n   */\n  getIndexForNewInput: function getIndexForNewInput(connection) {\n    if (!connection.targetConnection) {\n      // this connection is available\n      return null;\n    }\n\n    var connectionIndex;\n\n    for (var i = 0; i < this.inputList.length; i++) {\n      if (this.inputList[i].connection == connection) {\n        connectionIndex = i;\n      }\n    }\n\n    if (connectionIndex == this.inputList.length - 1) {\n      // this connection is the last one and already has a block in it, so\n      // we should add a new connection at the end.\n      return this.inputList.length + 1;\n    }\n\n    var nextInput = this.inputList[connectionIndex + 1];\n    var nextConnection = nextInput && nextInput.connection.targetConnection;\n\n    if (nextConnection && !nextConnection.sourceBlock_.isInsertionMarker()) {\n      return connectionIndex + 1;\n    } // Don't add new connection\n\n\n    return null;\n  },\n\n  /**\n   * Called when a block is dragged over one of the connections on this block.\n   * @param {!Blockly.Connection} connection The connection on this block that\n   *     has a pending connection.\n   */\n  onPendingConnection: function onPendingConnection(connection) {\n    var insertIndex = this.getIndexForNewInput(connection);\n\n    if (insertIndex == null) {\n      return;\n    }\n\n    this.appendValueInput('ADD' + this.inputCounter++);\n    this.moveNumberedInputBefore(this.inputList.length - 1, insertIndex);\n  },\n\n  /**\n   * Called when a block drag ends if the dragged block had a pending connection\n   * with this block.\n   */\n  finalizeConnections: function finalizeConnections() {\n    if (this.inputList.length > this.minInputs) {\n      var toRemove = [];\n      this.inputList.forEach(input => {\n        var targetConnection = input.connection.targetConnection;\n\n        if (!targetConnection) {\n          toRemove.push(input.name);\n        }\n      });\n\n      if (this.inputList.length - toRemove.length < this.minInputs) {\n        // Always show at least two inputs\n        toRemove = toRemove.slice(this.minInputs);\n      }\n\n      toRemove.forEach(inputName => this.removeInput(inputName)); // The first input should have the block text. If we removed the\n      // first input, add the block text to the new first input.\n\n      if (this.inputList[0].fieldRow.length == 0) {\n        this.inputList[0].appendField(Blockly.Msg['TEXT_JOIN_TITLE_CREATEWITH']);\n      }\n    }\n  }\n};","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * @fileoverview Defines a version of the list_create block with dyanmic\n *     inputs that appear when a block is dragged over inputs on the block.\n */\nimport * as Blockly from 'blockly/core';\nBlockly.Blocks['dynamic_list_create'] = {\n  /**\n   * Counter for the next input to add to this block.\n   * @type {number}\n   */\n  inputCounter: 2,\n\n  /**\n   * Minimum number of inputs for this block.\n   * @type {number}\n   */\n  minInputs: 2,\n\n  /**\n   * Block for concatenating any number of strings.\n   * @this {Blockly.Block}\n   */\n  init: function init() {\n    this.setHelpUrl(Blockly.Msg['LISTS_CREATE_WITH_HELPURL']);\n    this.setStyle('list_blocks');\n    this.appendValueInput('ADD0').appendField(Blockly.Msg['LISTS_CREATE_WITH_INPUT_WITH']);\n    this.appendValueInput('ADD1');\n    this.setOutput(true, 'Array');\n    this.setTooltip(Blockly.Msg['LISTS_CREATE_WITH_TOOLTIP']);\n  },\n\n  /**\n   * Create XML to represent number of text inputs.\n   * @return {!Element} XML storage element.\n   * @this {Blockly.Block}\n   */\n  mutationToDom: function mutationToDom() {\n    var container = Blockly.utils.xml.createElement('mutation');\n    var inputNames = this.inputList.map(input => input.name).join(',');\n    container.setAttribute('inputs', inputNames);\n    container.setAttribute('next', this.inputCounter);\n    return container;\n  },\n\n  /**\n   * Parse XML to restore the text inputs.\n   * @param {!Element} xmlElement XML storage element.\n   * @this {Blockly.Block}\n   */\n  domToMutation: function domToMutation(xmlElement) {\n    var items = xmlElement.getAttribute('inputs');\n\n    if (items) {\n      var inputNames = items.split(',');\n      this.inputList = [];\n      inputNames.forEach(name => this.appendValueInput(name));\n      this.inputList[0].appendField(Blockly.Msg['LISTS_CREATE_WITH_INPUT_WITH']);\n    }\n\n    var next = parseInt(xmlElement.getAttribute('next'));\n    this.inputCounter = next;\n  },\n\n  /**\n   * Check whether a new input should be added and determine where it should go.\n   * @param {!Blockly.Connection} connection The connection that has a\n   *     pending connection.\n   * @return {number} The index before which to insert a new input,\n   *     or null if no input should be added.\n   */\n  getIndexForNewInput: function getIndexForNewInput(connection) {\n    if (!connection.targetConnection) {\n      // this connection is available\n      return null;\n    }\n\n    var connectionIndex;\n\n    for (var i = 0; i < this.inputList.length; i++) {\n      if (this.inputList[i].connection == connection) {\n        connectionIndex = i;\n      }\n    }\n\n    if (connectionIndex == this.inputList.length - 1) {\n      // this connection is the last one and already has a block in it, so\n      // we should add a new connection at the end.\n      return this.inputList.length + 1;\n    }\n\n    var nextInput = this.inputList[connectionIndex + 1];\n    var nextConnection = nextInput && nextInput.connection.targetConnection;\n\n    if (nextConnection && !nextConnection.sourceBlock_.isInsertionMarker()) {\n      return connectionIndex + 1;\n    } // Don't add new connection\n\n\n    return null;\n  },\n\n  /**\n   * Called when a block is dragged over one of the connections on this block.\n   * @param {!Blockly.Connection} connection The connection on this block that\n   * has a pending connection.\n   */\n  onPendingConnection: function onPendingConnection(connection) {\n    var insertIndex = this.getIndexForNewInput(connection);\n\n    if (insertIndex == null) {\n      return;\n    }\n\n    this.appendValueInput('ADD' + this.inputCounter++);\n    this.moveNumberedInputBefore(this.inputList.length - 1, insertIndex);\n  },\n\n  /**\n   * Called when a block drag ends if the dragged block had a pending connection\n   * with this block.\n   */\n  finalizeConnections: function finalizeConnections() {\n    if (this.inputList.length > this.minInputs) {\n      var toRemove = [];\n      this.inputList.forEach(input => {\n        var targetConnection = input.connection.targetConnection;\n\n        if (!targetConnection) {\n          toRemove.push(input.name);\n        }\n      });\n\n      if (this.inputList.length - toRemove.length < this.minInputs) {\n        // Always show at least two inputs\n        toRemove = toRemove.slice(this.minInputs);\n      }\n\n      toRemove.forEach(inputName => this.removeInput(inputName)); // The first input should have the block text. If we removed the\n      // first input, add the block text to the new first input.\n\n      if (this.inputList[0].fieldRow.length == 0) {\n        this.inputList[0].appendField(Blockly.Msg['LISTS_CREATE_WITH_INPUT_WITH']);\n      }\n    }\n  }\n};","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * @fileoverview Adds blocks that replace the built-in mutator UI with dynamic\n *     connections that appear when a block is dragged over inputs on the block.\n */\nimport './insertion_marker_manager_monkey_patch';\nimport './dynamic_if.js';\nimport './dynamic_text_join.js';\nimport './dynamic_list_create.js';\nexport var overrideOldBlockDefinitions = function overrideOldBlockDefinitions() {\n  Blockly.Blocks['list_create'] = Blockly.Blocks['dynamic_list_create'];\n  Blockly.Blocks['text_join'] = Blockly.Blocks['dynamic_text_join'];\n  Blockly.Blocks['controls_if'] = Blockly.Blocks['dynamic_if'];\n};","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * @fileoverview Plugin for changing the context menu to match the\n * `disableOrphans` event handler.\n */\nimport * as Blockly from 'blockly/core';\n/**\n * This plugin changes the logic of the enable/disable context menu item. It is\n * enabled for all blocks except top-level blocks that have output or\n * previous connections. In other words, the option is disabled for orphan\n * blocks. Using this plugin allows users to disable valid non-orphan blocks,\n * but not re-enable blocks that have been automatically disabled by\n * `disableOrphans`.\n */\n\nexport class DisableTopBlocks {\n  /**\n   * Modifies the context menu 'disable' option as described above.\n   */\n  init() {\n    var disableMenuItem = Blockly.ContextMenuRegistry.registry.getItem('blockDisable');\n    this.oldPreconditionFn = disableMenuItem.preconditionFn;\n\n    disableMenuItem.preconditionFn = function (\n    /** @type {!Blockly.ContextMenuRegistry.Scope} */\n    scope) {\n      var block = scope.block;\n\n      if (!block.isInFlyout && block.workspace.options.disable && block.isEditable()) {\n        if (block.getInheritedDisabled() || isOrphan(block)) {\n          return 'disabled';\n        }\n\n        return 'enabled';\n      }\n\n      return 'hidden';\n    };\n  }\n  /**\n   * Turn off the effects of this plugin and restore the initial behavior.\n   * This is never required to be called. It is optional in case you need to\n   * disable the plugin.\n   */\n\n\n  dispose() {\n    var disableMenuItem = Blockly.ContextMenuRegistry.registry.getItem('blockDisable');\n    disableMenuItem.preconditionFn = this.oldPreconditionFn;\n  }\n\n}\n/**\n * A block is an orphan if its parent is an orphan, or if it doesn't have a\n * parent but it does have a previous or output connection (so it expects to be\n * attached to something). This means all children of orphan blocks are also\n * orphans and cannot be manually re-enabled.\n * @param {!Blockly.BlockSvg} block Block to check.\n * @return {boolean} Whether the block is an orphan.\n */\n\nfunction isOrphan(block) {\n  // If the parent is an orphan block, this block should also be considered\n  // an orphan so it cannot be manually re-enabled.\n  var parent = block.getParent();\n\n  if (parent && isOrphan(parent)) {\n    return true;\n  }\n\n  return !parent && !!(block.outputConnection || block.previousConnection);\n}","import Blockly, { ContextMenuRegistry } from \"blockly\"\nimport \"@blockly/field-slider\"\nimport \"@blockly/block-dynamic-connection\"\nimport { useEffect } from \"react\"\nimport { DisableTopBlocks } from \"@blockly/disable-top-blocks\"\n\n// do not use block context\n\nexport default function useBlocklyPlugins(workspace: Blockly.WorkspaceSvg) {\n    //plugins\n    useEffect(() => {\n        if (!workspace) return\n\n        // context menu stuff\n        if (ContextMenuRegistry.registry.getItem(\"blockInline\"))\n            ContextMenuRegistry.registry.unregister(\"blockInline\")\n        if (ContextMenuRegistry.registry.getItem(\"cleanWorkspace\"))\n            ContextMenuRegistry.registry.unregister(\"cleanWorkspace\")\n\n        // Add the disableOrphans event handler. This is not done automatically by\n        // the plugin and should be handled by your application.\n        workspace.addChangeListener(Blockly.Events.disableOrphans)\n\n        // The plugin must be initialized before it has any effect.\n        const disableTopBlocksPlugin = new DisableTopBlocks()\n        disableTopBlocksPlugin.init()\n        return () =>\n            workspace.removeChangeListener(Blockly.Events.disableOrphans)\n    }, [workspace])\n}\n","import { DependencyList, useState } from \"react\"\nimport useEffectAsync from \"../useEffectAsync\"\n\nexport default function useAsyncMemo<T>(\n    factory: () => T | Promise<T>,\n    deps?: DependencyList\n) {\n    const [value, setValue] = useState<T>()\n    useEffectAsync(async mounted => {\n        const v = await factory()\n        if (mounted()) setValue(v)\n    }, deps || [])\n    return value\n}\n","import Blockly from \"blockly\"\nimport { useEffect, useMemo } from \"react\"\nimport { arrayConcatMany } from \"../../../jacdac-ts/src/jdom/utils\"\nimport useServices from \"../hooks/useServices\"\nimport Flags from \"../../../jacdac-ts/src/jdom/flags\"\nimport { Theme, useTheme } from \"@material-ui/core\"\nimport { registerFields } from \"./fields/fields\"\nimport {\n    BlockDefinition,\n    BlockReference,\n    ButtonDefinition,\n    CategoryDefinition,\n    ServiceBlockDefinitionFactory,\n    ToolboxConfiguration,\n    visitToolbox,\n} from \"./toolbox\"\nimport BlockDomainSpecificLanguage from \"./dsl/dsl\"\nimport { addDataPreviewField } from \"./fields/DataPreviewField\"\nimport { WorkspaceJSON } from \"./dsl/workspacejson\"\nimport useAsyncMemo from \"../hooks/useAsyncMemo\"\n\n// overrides blockly emboss filter for svg elements\nBlockly.BlockSvg.prototype.setHighlighted = function (highlighted) {\n    if (!this.rendered) {\n        return\n    }\n    if (highlighted) {\n        this.addSelect()\n    } else {\n        this.removeSelect()\n    }\n}\n\ntype CachedBlockDefinitions = {\n    blocks: BlockDefinition[]\n}\n\nasync function loadBlocks(\n    dsls: BlockDomainSpecificLanguage[],\n    theme: Theme\n): Promise<CachedBlockDefinitions> {\n    const blocks: BlockDefinition[] = []\n    for (const dsl of dsls) {\n        const dslBlocks = await dsl?.createBlocks?.({ theme })\n        if (dslBlocks)\n            for (const b of dslBlocks) {\n                addDataPreviewField(b)\n                b.dsl = dsl.id // ensure DSL is set\n                blocks.push(b)\n            }\n    }\n    // register field editors\n    registerFields()\n    // re-register blocks with blocklys\n    blocks.forEach(\n        block =>\n            (Blockly.Blocks[block.type] = <\n                ServiceBlockDefinitionFactory<BlockDefinition>\n            >{\n                jacdacDefinition: block,\n                init: function () {\n                    this.jsonInit(block)\n                },\n            })\n    )\n\n    return {\n        blocks,\n    }\n}\n\nfunction patchCategoryJSONtoXML(cat: CategoryDefinition): CategoryDefinition {\n    cat.contents\n        ?.filter(node => node.kind === \"block\")\n        .map(node => <BlockReference>node)\n        .filter(block => {\n            const exists = Blockly.Blocks[block.type]\n            if (!exists && Flags.diagnostics)\n                console.warn(\n                    `block type '${block.type}' not found, consider refreshing page...`\n                )\n            return !!block.values && exists\n        }) // avoid broken blocks\n        .forEach(block => {\n            // yup, this suck but we have to go through it\n            block.blockxml = `<block type=\"${block.type}\">${Object.keys(\n                block.values\n            )\n                .map(name => {\n                    const { type } = block.values[name]\n                    const shadow = type !== \"variables_get\"\n                    return `<value name=\"${name}\"><${\n                        shadow ? \"shadow\" : \"field\"\n                    } type=\"${type}\" /></value>`\n                })\n                .join(\"\\n\")}</block>`\n            delete block.type\n        })\n    return cat\n}\n\nexport default function useToolbox(\n    dsls: BlockDomainSpecificLanguage[],\n    source: WorkspaceJSON\n): ToolboxConfiguration {\n    const liveServices = useServices({ specification: true })\n    const theme = useTheme()\n\n    const blocks = useAsyncMemo(async () => {\n        const r = await loadBlocks(dsls, theme)\n        if (Flags.diagnostics) console.debug(`blocks`, r)\n        return r\n    }, [theme, dsls])\n    const toolboxConfiguration = useMemo(() => {\n        if (!blocks) return undefined\n\n        const dslsCategories = arrayConcatMany(\n            dsls.map(dsl =>\n                dsl?.createCategory?.({ theme, source, liveServices })\n            )\n        )\n            .filter(cat => !!cat)\n            .sort((l, r) => -((l.order || 0) - (r.order || 0)))\n        const contents = dslsCategories.map(node =>\n            node.kind === \"category\"\n                ? patchCategoryJSONtoXML(node as CategoryDefinition)\n                : node\n        )\n        // remove trailing separators\n        while (contents[0]?.kind === \"sep\") contents.shift()\n        while (contents[contents.length - 1]?.kind === \"sep\") contents.pop()\n        //\n        return <ToolboxConfiguration>{\n            kind: \"categoryToolbox\",\n            contents,\n        }\n    }, [\n        blocks,\n        theme,\n        dsls,\n        source,\n        (liveServices || []).map(srv => srv.id).join(\",\"),\n    ])\n\n    return toolboxConfiguration\n}\n\n// do not use block context\n\nexport function useToolboxButtons(\n    workspace: Blockly.WorkspaceSvg,\n    toolboxConfiguration: ToolboxConfiguration\n) {\n    // track workspace changes and update callbacks\n    useEffect(() => {\n        if (!workspace) return\n\n        // collect buttons\n        const buttons: ButtonDefinition[] = []\n        visitToolbox(toolboxConfiguration, {\n            visitButton: btn => buttons.push(btn),\n        })\n        // register buttons\n        buttons.forEach(button =>\n            workspace.registerButtonCallback(button.callbackKey, () =>\n                button.callback(workspace)\n            )\n        )\n        // cleanup\n        return () =>\n            buttons.forEach(button =>\n                workspace.removeButtonCallback(button.callbackKey)\n            )\n    }, [workspace, toolboxConfiguration])\n}\n","import { Events, WorkspaceSvg, Xml } from \"blockly\"\nimport React, {\n    createContext,\n    ReactNode,\n    useContext,\n    useEffect,\n    useState,\n} from \"react\"\nimport { CHANGE } from \"../../../jacdac-ts/src/jdom/constants\"\nimport { arrayConcatMany, toMap } from \"../../../jacdac-ts/src/jdom/utils\"\nimport RoleManager from \"../../../jacdac-ts/src/jdom/rolemanager\"\nimport bus from \"../../jacdac/providerbus\"\nimport useRoleManager from \"../hooks/useRoleManager\"\nimport useLocalStorage from \"../hooks/useLocalStorage\"\nimport { BlockWarning, collectWarnings } from \"./blockwarning\"\nimport { registerDataSolver } from \"./dsl/datasolver\"\nimport BlockDomainSpecificLanguage from \"./dsl/dsl\"\nimport { workspaceToJSON } from \"./jsongenerator\"\nimport {\n    JSON_WARNINGS_CATEGORY,\n    NEW_PROJET_XML,\n    ToolboxConfiguration,\n    WORKSPACE_FILENAME,\n} from \"./toolbox\"\nimport useBlocklyEvents from \"./useBlocklyEvents\"\nimport useBlocklyPlugins from \"./useBlocklyPlugins\"\nimport useToolbox, { useToolboxButtons } from \"./useToolbox\"\nimport {\n    BlockServices,\n    BlockWithServices,\n    FieldWithServices,\n    resolveWorkspaceServices,\n    WorkspaceServices,\n    WorkspaceWithServices,\n} from \"./WorkspaceContext\"\nimport AppContext from \"../AppContext\"\nimport { WorkspaceFile, WorkspaceJSON } from \"./dsl/workspacejson\"\nimport useEffectAsync from \"../useEffectAsync\"\nimport useChange from \"../../jacdac/useChange\"\nimport FileSystemContext from \"../FileSystemContext\"\nimport { resolveBlockWarnings } from \"./WorkspaceContext\"\nimport useWindowEvent from \"../hooks/useWindowEvent\"\nimport {\n    DslMessage,\n    DslOptionsMessage,\n    DslWorkspaceFileMessage,\n} from \"./dsl/iframedsl\"\nimport { AllOptions } from \"./fields/IFrameDataChooserField\"\n\nexport interface BlockProps {\n    editorId: string\n    setEditorId: (id: string) => void\n\n    dsls: BlockDomainSpecificLanguage[]\n    workspace: WorkspaceSvg\n    workspaceXml: string\n    workspaceJSON: WorkspaceJSON\n    toolboxConfiguration: ToolboxConfiguration\n    roleManager: RoleManager\n    dragging: boolean\n    setWorkspace: (ws: WorkspaceSvg) => void\n    setWorkspaceXml: (value: string) => void\n    setWarnings: (category: string, warnings: BlockWarning[]) => void\n}\n\nconst BlockContext = createContext<BlockProps>({\n    editorId: \"\",\n    setEditorId: () => {},\n    dsls: [],\n    workspace: undefined,\n    workspaceXml: undefined,\n    workspaceJSON: undefined,\n    toolboxConfiguration: undefined,\n    roleManager: undefined,\n    dragging: false,\n    setWarnings: () => {},\n    setWorkspace: () => {},\n    setWorkspaceXml: () => {},\n})\nBlockContext.displayName = \"Block\"\n\nconst DEFAULT_XML = '<xml xmlns=\"http://www.w3.org/1999/xhtml\"></xml>'\n\nexport default BlockContext\n\n// eslint-disable-next-line react/prop-types\nexport function BlockProvider(props: {\n    storageKey: string\n    dsls: BlockDomainSpecificLanguage[]\n    onBeforeSaveWorkspaceFile?: (file: WorkspaceFile) => void\n    children: ReactNode\n}) {\n    const { storageKey, dsls, children, onBeforeSaveWorkspaceFile } = props\n    const { setError } = useContext(AppContext)\n    const { fileSystem } = useContext(FileSystemContext)\n    const workspaceDirectory = useChange(fileSystem, _ => _?.workingDirectory)\n    const workspaceFile = useChange(workspaceDirectory, _ =>\n        _?.file(WORKSPACE_FILENAME, { create: true })\n    )\n    const [storedXml, setStoredXml] = useLocalStorage(\n        storageKey,\n        NEW_PROJET_XML\n    )\n    const roleManager = useRoleManager()\n    const [workspace, setWorkspace] = useState<WorkspaceSvg>(undefined)\n    const [workspaceXml, _setWorkspaceXml] = useState<string>(storedXml)\n    const [workspaceJSON, setWorkspaceJSON] = useState<WorkspaceJSON>(undefined)\n    const [warnings, _setWarnings] = useState<\n        {\n            category: string\n            entries: BlockWarning[]\n        }[]\n    >([])\n    const [dragging, setDragging] = useState(false)\n    const [editorId, setEditorId] = useState(\"\")\n\n    const setWorkspaceXml = (xml: string) => {\n        _setWorkspaceXml(xml)\n        setStoredXml(xml)\n    }\n\n    const setWarnings = (category: string, entries: BlockWarning[]) => {\n        const i = warnings.findIndex(w => w.category === category)\n        _setWarnings([\n            ...warnings.slice(0, i),\n            {\n                category,\n                entries,\n            },\n            ...warnings.slice(i + 1),\n        ])\n    }\n    const loadWorkspaceFile = (file: WorkspaceFile) => {\n        const { editor, xml } = file || {}\n        if (editor !== editorId)\n            throw new Error(`wrong block editor (${editor} != ${editorId}`)\n        // try loading xml into a dummy blockly workspace\n        const dom = Xml.textToDom(xml || DEFAULT_XML)\n        // all good, load in workspace\n        workspace.clear()\n        Xml.domToWorkspace(dom, workspace)\n    }\n\n    const toolboxConfiguration = useToolbox(dsls, workspaceJSON)\n    const initializeBlockServices = (block: BlockWithServices) => {\n        if (block?.jacdacServices?.initialized) return\n\n        let services = block.jacdacServices\n        if (!services) {\n            services = block.jacdacServices = new BlockServices()\n            block.inputList?.forEach(i =>\n                i.fieldRow?.forEach(f =>\n                    (\n                        f as unknown as FieldWithServices\n                    ).notifyServicesChanged?.()\n                )\n            )\n        }\n        services.initialized = true\n        registerDataSolver(block)\n    }\n\n    const handleBlockChange = (blockId: string) => {\n        const block = workspace.getBlockById(blockId) as BlockWithServices\n        const services = block?.jacdacServices\n        if (block && !block.isEnabled()) {\n            services?.clearData()\n        } else services?.emit(CHANGE)\n    }\n\n    const handleWorkspaceEvent = (event: {\n        type: string\n        workspaceId: string\n    }) => {\n        const { type, workspaceId } = event\n        if (workspaceId !== workspace.id) return\n        //console.log(`blockly: ${type}`, event)\n        if (type === Events.BLOCK_DRAG) {\n            const dragEvent = event as Events.BlockDrag\n            setDragging(!!dragEvent.isStart)\n        } else if (type === Events.FINISHED_LOADING) {\n            workspace\n                .getAllBlocks(false)\n                .forEach(b => initializeBlockServices(b as BlockWithServices))\n        } else if (type === Events.BLOCK_CREATE) {\n            const bev = event as unknown as Events.BlockCreate\n            const block = workspace.getBlockById(\n                bev.blockId\n            ) as BlockWithServices\n            initializeBlockServices(block)\n        } else if (type === Events.BLOCK_MOVE) {\n            const cev = event as unknown as Events.BlockMove\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            const parentId = (cev as any).newParentId\n            if (parentId) handleBlockChange(parentId)\n        } else if (type === Events.BLOCK_CHANGE) {\n            const cev = event as unknown as Events.BlockChange\n            handleBlockChange(cev.blockId)\n        }\n    }\n\n    // mounting dsts\n    useEffect(() => {\n        const unmounnts = dsls\n            .map(dsl => dsl.mount?.(workspace))\n            .filter(u => !!u)\n        return () => {\n            unmounnts.forEach(u => u())\n        }\n    }, [workspace])\n\n    // plugins\n    useBlocklyPlugins(workspace)\n    useBlocklyEvents(workspace)\n    useToolboxButtons(workspace, toolboxConfiguration)\n\n    // role manager\n    useEffect(() => {\n        const services = resolveWorkspaceServices(workspace)\n        if (services) services.roleManager = roleManager\n    }, [workspace, roleManager])\n    useEffect(() => {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const wws = workspace as unknown as WorkspaceWithServices\n        if (wws && !wws.jacdacServices) {\n            wws.jacdacServices = new WorkspaceServices()\n            wws.jacdacServices.roleManager = roleManager\n        }\n    }, [workspace])\n    useEffect(() => {\n        const services = resolveWorkspaceServices(workspace)\n        if (services) services.workingDirectory = workspaceDirectory\n    }, [workspace, workspaceDirectory])\n    useEffect(() => {\n        if (!workspace || dragging) return\n\n        const newWorkspaceJSON = workspaceToJSON(workspace, dsls)\n        setWorkspaceJSON(newWorkspaceJSON)\n        const newWarnings = collectWarnings(newWorkspaceJSON)\n        setWarnings(JSON_WARNINGS_CATEGORY, newWarnings)\n    }, [dsls, workspace, dragging, workspaceXml])\n    useEffectAsync(\n        async mounted => {\n            if (!workspaceFile) return\n            try {\n                const text = await workspaceFile.textAsync()\n                if (!mounted()) return\n\n                const json = JSON.parse(text) as WorkspaceFile\n                loadWorkspaceFile(json)\n            } catch (e) {\n                if (mounted()) setError(e)\n                if (fileSystem) fileSystem.workingDirectory = undefined\n            }\n        },\n        [workspaceFile]\n    )\n    useEffectAsync(async () => {\n        const file: WorkspaceFile = {\n            editor: editorId,\n            xml: workspaceXml,\n            json: workspaceJSON,\n        }\n        dsls.forEach(dsl => dsl.onBeforeSaveWorkspaceFile?.(file))\n        onBeforeSaveWorkspaceFile?.(file)\n        dsls.forEach(dsl => dsl.onSave?.(file))\n        if (workspaceFile) {\n            const fileContent = JSON.stringify(file)\n            workspaceFile?.write(fileContent)\n        }\n    }, [editorId, workspaceFile, workspaceXml, workspaceJSON])\n    useEffect(() => {\n        const services = resolveWorkspaceServices(workspace)\n        if (services) services.workspaceJSON = workspaceJSON\n    }, [workspace, workspaceJSON])\n\n    // apply errors\n    useEffect(() => {\n        if (!workspace) return\n        const allErrors = toMap(\n            arrayConcatMany(\n                warnings\n                    .map(w => w.entries)\n                    .filter(entries => !!entries?.length)\n            ),\n            e => e.sourceId || \"\",\n            e => e.message\n        )\n        workspace\n            .getAllBlocks(false)\n            .forEach(b =>\n                b.setWarningText(allErrors[b.id] || resolveBlockWarnings(b))\n            )\n    }, [workspace, warnings])\n\n    // register block creation\n    useEffect(() => {\n        const handlers = [\n            handleWorkspaceEvent,\n            ...dsls.map(dsl => dsl.createWorkspaceChangeListener?.(workspace)),\n        ].filter(c => !!c)\n        handlers.forEach(handler => workspace?.addChangeListener(handler))\n        return () =>\n            handlers?.forEach(handler =>\n                workspace?.removeChangeListener(handler)\n            )\n    }, [workspace, dsls])\n    // don't refresh registers while dragging\n    useEffect(() => {\n        bus.backgroundRefreshRegisters = !dragging\n    }, [dragging])\n\n    // load message from parent\n    useWindowEvent(\n        \"message\",\n        (msg: MessageEvent<DslMessage>) => {\n            const { data } = msg\n            const { type, action } = data\n            if (type === \"dsl\") {\n                switch (action) {\n                    case \"load\":\n                        console.debug(`dsl load`, data)\n                        try {\n                            loadWorkspaceFile(data as DslWorkspaceFileMessage)\n                        } catch (e) {\n                            console.error(e)\n                        }\n                        break\n                    case \"options\": {\n                        const options: Record<string, [string, string][]> = (\n                            data as DslOptionsMessage\n                        ).options\n                        console.debug(`dsl: received options`, options)\n                        Object.entries(options || {}).forEach(\n                            ([key, value]) => (AllOptions[key] = value)\n                        )\n                    }\n                }\n            }\n        },\n        false,\n        []\n    )\n\n    return (\n        <BlockContext.Provider\n            value={{\n                editorId,\n                setEditorId,\n                dsls,\n                workspace,\n                workspaceXml,\n                workspaceJSON,\n                toolboxConfiguration,\n                roleManager,\n                dragging,\n                setWarnings,\n                setWorkspace,\n                setWorkspaceXml,\n            }}\n        >\n            {children}\n        </BlockContext.Provider>\n    )\n}\n","import { Grid, Typography } from \"@material-ui/core\"\nimport React, { useContext } from \"react\"\nimport CodeBlock from \"../CodeBlock\"\nimport BlockContext from \"./BlockContext\"\n\nexport default function BlockDiagnostics() {\n    const { workspaceXml, workspaceJSON } = useContext(BlockContext)\n    return (\n        <>\n            <Grid item xs={12}>\n                <Typography variant=\"subtitle1\">Blockly JSON</Typography>\n                <CodeBlock\n                    className=\"json\"\n                    downloadName={\"test.json\"}\n                    downloadText={JSON.stringify(workspaceJSON, null, 2)}\n                >\n                    {JSON.stringify(workspaceJSON, null, 2)}\n                </CodeBlock>\n            </Grid>\n            <Grid item xs={12}>\n                <Typography variant=\"subtitle1\">Blockly XML</Typography>\n                <CodeBlock className=\"xml\">{workspaceXml}</CodeBlock>\n            </Grid>\n        </>\n    )\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * @fileoverview Modern theme.\n */\nimport Blockly from 'blockly/core';\nexport default Blockly.Theme.defineTheme('modern', {\n  'base': Blockly.Themes.Classic,\n  'blockStyles': {\n    'colour_blocks': {\n      'colourPrimary': '#a5745b',\n      'colourSecondary': '#dbc7bd',\n      'colourTertiary': '#845d49'\n    },\n    'list_blocks': {\n      'colourPrimary': '#745ba5',\n      'colourSecondary': '#c7bddb',\n      'colourTertiary': '#5d4984'\n    },\n    'logic_blocks': {\n      'colourPrimary': '#5b80a5',\n      'colourSecondary': '#bdccdb',\n      'colourTertiary': '#496684'\n    },\n    'loop_blocks': {\n      'colourPrimary': '#5ba55b',\n      'colourSecondary': '#bddbbd',\n      'colourTertiary': '#498449'\n    },\n    'math_blocks': {\n      'colourPrimary': '#5b67a5',\n      'colourSecondary': '#bdc2db',\n      'colourTertiary': '#495284'\n    },\n    'procedure_blocks': {\n      'colourPrimary': '#995ba5',\n      'colourSecondary': '#d6bddb',\n      'colourTertiary': '#7a4984'\n    },\n    'text_blocks': {\n      'colourPrimary': '#5ba58c',\n      'colourSecondary': '#bddbd1',\n      'colourTertiary': '#498470'\n    },\n    'variable_blocks': {\n      'colourPrimary': '#a55b99',\n      'colourSecondary': '#dbbdd6',\n      'colourTertiary': '#84497a'\n    },\n    'variable_dynamic_blocks': {\n      'colourPrimary': '#a55b99',\n      'colourSecondary': '#dbbdd6',\n      'colourTertiary': '#84497a'\n    },\n    'hat_blocks': {\n      'colourPrimary': '#a55b99',\n      'colourSecondary': '#dbbdd6',\n      'colourTertiary': '#84497a',\n      'hat': 'cap'\n    }\n  },\n  'categoryStyles': {\n    'colour_category': {\n      'colour': '#a5745b'\n    },\n    'list_category': {\n      'colour': '#745ba5'\n    },\n    'logic_category': {\n      'colour': '#5b80a5'\n    },\n    'loop_category': {\n      'colour': '#5ba55b'\n    },\n    'math_category': {\n      'colour': '#5b67a5'\n    },\n    'procedure_category': {\n      'colour': '#995ba5'\n    },\n    'text_category': {\n      'colour': '#5ba58c'\n    },\n    'variable_category': {\n      'colour': '#a55b99'\n    },\n    'variable_dynamic_category': {\n      'colour': '#a55b99'\n    }\n  },\n  'componentStyles': {},\n  'fontStyle': {},\n  'startHats': null\n});","/**\n * @license\n * Copyright 2021 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * @fileoverview Dark theme.\n */\nimport Blockly from 'blockly/core'; // Temporarily required to ensure there's no conflict with\n// Blockly.Themes.Dark\n\nBlockly.registry.unregister('theme', 'dark');\n/**\n * Dark theme.\n */\n\nexport default Blockly.Theme.defineTheme('dark', {\n  'base': Blockly.Themes.Classic,\n  'componentStyles': {\n    'workspaceBackgroundColour': '#1e1e1e',\n    'toolboxBackgroundColour': 'blackBackground',\n    'toolboxForegroundColour': '#fff',\n    'flyoutBackgroundColour': '#252526',\n    'flyoutForegroundColour': '#ccc',\n    'flyoutOpacity': 1,\n    'scrollbarColour': '#797979',\n    'insertionMarkerColour': '#fff',\n    'insertionMarkerOpacity': 0.3,\n    'scrollbarOpacity': 0.4,\n    'cursorColour': '#d0d0d0',\n    'blackBackground': '#333'\n  }\n});","import {\n    Dialog,\n    DialogActions,\n    DialogContent,\n    DialogContentText,\n    TextField,\n} from \"@material-ui/core\"\nimport Blockly from \"blockly\"\nimport { Button } from \"gatsby-theme-material-ui\"\nimport React, { ChangeEvent, useEffect, useRef, useState } from \"react\"\nimport { useId } from \"react-use-id-hook\"\n\nexport default function BlocklyModalDialogs() {\n    const [dialogType, setDialogType] = useState<\n        \"alert\" | \"confirm\" | \"prompt\"\n    >()\n    const [message, setMessage] = useState(\"\")\n    const [value, setValue] = useState(\"\")\n    const valueId = useId()\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const callback = useRef<any>()\n    const showDialog = !!dialogType\n\n    useEffect(() => {\n        // store older\n        const previous = {\n            alert: Blockly.alert,\n            confirm: Blockly.confirm,\n            prompt: Blockly.prompt,\n        }\n\n        // replace\n        Blockly.alert = (message, cb) => {\n            setMessage(message)\n            callback.current = cb\n            setDialogType(\"alert\")\n        }\n        Blockly.confirm = (message, cb) => {\n            setMessage(message)\n            callback.current = cb\n            setDialogType(\"confirm\")\n        }\n        Blockly.prompt = (message, defaultValue, cb) => {\n            setMessage(message)\n            setValue(defaultValue)\n            callback.current = cb\n            setDialogType(\"prompt\")\n        }\n\n        // cleanup\n        return () => {\n            Blockly.alert = previous.alert\n            Blockly.confirm = previous.confirm\n            Blockly.prompt = previous.prompt\n        }\n    }, [])\n\n    const handleCloseConfirm = () => setDialogType(undefined)\n    const handleCancel = () => {\n        callback.current?.(undefined)\n        setDialogType(undefined)\n    }\n    const handleOk = () => {\n        switch (dialogType) {\n            case \"alert\":\n                callback.current?.()\n                break\n            case \"confirm\":\n                callback.current(true)\n                break\n            case \"prompt\":\n                callback.current(value)\n                break\n        }\n        setDialogType(undefined)\n    }\n    const handleValueChange = (event: ChangeEvent<HTMLInputElement>) => {\n        setValue(event.target.value)\n    }\n\n    return (\n        <Dialog open={showDialog} onClose={handleCloseConfirm}>\n            <DialogContent>\n                <DialogContentText>{message}</DialogContentText>\n                {dialogType === \"prompt\" && (\n                    <TextField\n                        id={valueId}\n                        value={value}\n                        label=\"Value\"\n                        fullWidth={true}\n                        onChange={handleValueChange}\n                    />\n                )}\n            </DialogContent>\n            <DialogActions>\n                {dialogType !== \"alert\" && (\n                    <Button variant=\"contained\" onClick={handleCancel}>\n                        Cancel\n                    </Button>\n                )}\n                <Button variant=\"contained\" color=\"primary\" onClick={handleOk}>\n                    Ok\n                </Button>\n            </DialogActions>\n        </Dialog>\n    )\n}\n","import { useTheme } from \"@material-ui/core\"\nimport {\n    BlockSvg,\n    Events,\n    IPositionable,\n    MetricsManager,\n    utils,\n    WorkspaceSvg,\n    TOOLBOX_AT_LEFT,\n    Scrollbar,\n    ComponentManager,\n} from \"blockly\"\nimport React, { useCallback, useEffect, useRef, useState } from \"react\"\nimport ReactDOM from \"react-dom\"\nimport { arrayConcatMany } from \"../../../jacdac-ts/src/jdom/utils\"\nimport { svgPointerPoint } from \"../widgets/svgutils\"\nimport useWorkspaceEvent from \"./useWorkspaceEvent\"\n\nconst MINI_RADIUS = 16\nconst MARGIN_VERTICAL_ = 20\nconst MARGIN_HORIZONTAL_ = 20\nconst MIN_SCALE = 0.05\nconst MAX_WIDTH = 200\nconst MAX_HEIGHT = 96\n\nfunction MiniBlock(props: {\n    x: number\n    y: number\n    width: number\n    height: number\n    color: string\n}) {\n    const { x, y, width, height, color } = props\n    return (\n        <rect\n            x={x}\n            y={y}\n            width={width}\n            height={height}\n            fill={color}\n            rx={MINI_RADIUS}\n            ry={MINI_RADIUS}\n        />\n    )\n}\n\nfunction MiniViewport(props: {\n    scroll: MetricsManager.ContainerRegion\n    view: MetricsManager.ContainerRegion\n}) {\n    const { view } = props\n    const { top, left, width, height } = view\n    const { palette } = useTheme()\n    const vx = left\n    const vy = top\n\n    return (\n        <rect\n            x={vx}\n            y={vy}\n            width={width}\n            height={height}\n            strokeWidth={MINI_RADIUS >> 1}\n            stroke={palette.text.primary}\n            fill={palette.grey[400]}\n            opacity={0.2}\n            rx={MINI_RADIUS}\n            ry={MINI_RADIUS}\n        />\n    )\n}\n\nfunction BlockMiniMap(props: {\n    workspace: WorkspaceSvg\n    onSizeUpdate: (width: number, height: number) => void\n}) {\n    const { workspace, onSizeUpdate } = props\n    const svgRef = useRef<SVGSVGElement>()\n    const [metrics, setMetrics] = useState<{\n        scroll: MetricsManager.ContainerRegion\n        contents: MetricsManager.ContainerRegion\n        blocks: {\n            blockId: string\n            rect: utils.Rect\n            color: string\n        }[]\n    }>()\n    const [view, setView] = useState<MetricsManager.ContainerRegion>()\n    const handleMetrics = () => {\n        const metricsManager = workspace.getMetricsManager()\n        const view = metricsManager.getViewMetrics(true)\n        const contents = metricsManager.getContentMetrics(true)\n        const scroll = metricsManager.getScrollMetrics(true, view, contents)\n        const tops: BlockSvg[] = arrayConcatMany(\n            (workspace.getTopBlocks(false) as BlockSvg[]).map(top => [\n                top,\n                ...(top.childBlocks_ as BlockSvg[]),\n            ])\n        )\n        const blocks = tops.map(b => ({\n            blockId: b.id,\n            rect: b.getBoundingRectangle(),\n            color: b.getColour(),\n        }))\n        setMetrics({ scroll, contents, blocks })\n        setView(view)\n        onSizeUpdate(scroll.width, scroll.height)\n    }\n    const handleView = () => {\n        const metricsManager = workspace.getMetricsManager()\n        const view = metricsManager.getViewMetrics(true)\n        setView(view)\n    }\n    const handleChange = useCallback(\n        (event: { type: string } & Events.Abstract) => {\n            const { type } = event\n            switch (type) {\n                case Events.BLOCK_CREATE:\n                case Events.BLOCK_DELETE:\n                case Events.BLOCK_MOVE:\n                case Events.BLOCK_CHANGE:\n                case Events.FINISHED_LOADING:\n                    handleMetrics()\n                    break\n                case Events.VIEWPORT_CHANGE:\n                    handleView()\n                    break\n            }\n        },\n        [workspace]\n    )\n    useWorkspaceEvent(workspace, handleChange)\n    const handleCenterView = (event: React.PointerEvent<Element>) => {\n        event.preventDefault()\n        event.stopPropagation()\n        if (event.buttons < 1) return\n        const pos = svgPointerPoint(svgRef.current, event)\n        // viewHeight and viewWidth are in pixels.\n        const halfViewWidth = view.width / 2\n        const halfViewHeight = view.height / 2\n        // Put the block in the center of the visible workspace instead.\n        const scrollToCenterX = pos.x - halfViewWidth + scroll.left\n        const scrollToCenterY = pos.y - halfViewHeight + scroll.top\n        // Convert from workspace directions to canvas directions.\n        // move to center of view\n        const x = -scrollToCenterX\n        const y = -scrollToCenterY\n\n        workspace.scroll(x, y)\n    }\n    // nothing to see\n    if (!metrics || !view) return null\n\n    const { scroll, blocks } = metrics\n    const cleft = scroll.left\n    const ctop = scroll.top\n    const cwidth = scroll.width\n    const cheight = scroll.height\n\n    return (\n        <svg\n            ref={svgRef}\n            viewBox={`0 0 ${cwidth} ${cheight}`}\n            width={cwidth}\n            height={cheight}\n        >\n            <g transform={`translate(${-cleft},${-ctop})`}>\n                {blocks?.map(({ blockId, rect, color }) => (\n                    <MiniBlock\n                        key={blockId}\n                        x={rect.left}\n                        y={rect.top}\n                        width={rect.right - rect.left}\n                        height={rect.bottom - rect.top}\n                        color={color}\n                    />\n                ))}\n                {view && <MiniViewport scroll={scroll} view={view} />}\n            </g>\n            <rect\n                x={0}\n                y={0}\n                width={cwidth}\n                height={cheight}\n                fill=\"transparent\"\n                stroke={\"#aaa\"}\n                strokeWidth={24}\n                onPointerDown={handleCenterView}\n                onPointerMove={handleCenterView}\n            />\n        </svg>\n    )\n}\n\nclass MinimapPlugin implements IPositionable {\n    readonly id = 'minimap';    \n    private top_ = 0\n    private left_ = 0\n    private width_ = MAX_WIDTH\n    private height_ = MAX_HEIGHT\n    private scale_ = MIN_SCALE\n    private svgGroup_: SVGGElement\n\n    constructor(readonly workspace_: WorkspaceSvg) {\n        this.init()\n    }\n\n    private init() {\n        const componentManager = this.workspace_.getComponentManager()\n        componentManager.addComponent({\n            component: this,\n            weight: 2,\n            capabilities: [ComponentManager.Capability.POSITIONABLE],\n        })\n        this.createDom_()\n        this.workspace_.resize()\n    }\n\n    private createDom_() {\n        this.svgGroup_ = utils.dom.createSvgElement(utils.Svg.G, {\n            class: \"minimap\",\n        })\n        utils.dom.insertAfter(this.svgGroup_, this.workspace_.getBubbleCanvas())\n        ReactDOM.render(this.render(), this.svgGroup_)\n    }\n\n    private render() {\n        return (\n            <BlockMiniMap\n                workspace={this.workspace_}\n                onSizeUpdate={this.handleSizeUpdate.bind(this)}\n            />\n        )\n    }\n\n    position(metrics: MetricsManager.UiMetrics): void {\n        const hasVerticalScrollbars =\n            this.workspace_.scrollbar &&\n            this.workspace_.scrollbar.canScrollHorizontally()\n\n        if (\n            metrics.toolboxMetrics.position === TOOLBOX_AT_LEFT ||\n            (this.workspace_.horizontalLayout && !this.workspace_.RTL)\n        ) {\n            // Right corner placement.\n            this.left_ =\n                metrics.absoluteMetrics.left +\n                metrics.viewMetrics.width -\n                this.width_ -\n                MARGIN_HORIZONTAL_\n            if (hasVerticalScrollbars && !this.workspace_.RTL) {\n                this.left_ -= Scrollbar.scrollbarThickness\n            }\n        } else {\n            // Left corner placement.\n            this.left_ = MARGIN_HORIZONTAL_\n            if (hasVerticalScrollbars && this.workspace_.RTL) {\n                this.left_ += Scrollbar.scrollbarThickness\n            }\n        }\n\n        // Upper corner placement\n        this.top_ = metrics.absoluteMetrics.top + MARGIN_VERTICAL_\n\n        this.positionSvgGroup()\n    }\n\n    private positionSvgGroup() {\n        this.svgGroup_.setAttribute(\n            \"transform\",\n            `translate(${this.left_},${this.top_}) scale(${this.scale_})`\n        )\n    }\n\n    getBoundingRectangle(): utils.Rect {\n        return new utils.Rect(\n            this.top_,\n            this.top_ + this.height_,\n            this.left_,\n            this.left_ + this.width_\n        )\n    }\n\n    private handleSizeUpdate(width: number, height: number) {\n        if (width !== this.width_ || height !== this.height_) {\n            this.scale_ = Math.min(\n                MIN_SCALE,\n                Math.min(MAX_HEIGHT / height, MAX_WIDTH / width)\n            )\n            const dw = width * this.scale_ - this.width_\n            this.width_ = width * this.scale_\n            this.height_ = height * this.scale_\n            this.left_ -= dw\n            this.positionSvgGroup()\n        }\n    }\n}\n\nexport function useBlockMinimap(workspace: WorkspaceSvg) {\n    useEffect(() => {\n        if (workspace) {\n            new MinimapPlugin(workspace)\n        }\n    }, [workspace])\n}\n","import React, { useMemo } from \"react\"\nimport { getParser, Parser } from \"bowser\"\nimport Alert from \"./Alert\"\nimport { AlertTitle } from \"@material-ui/lab\"\n\nexport default function BrowserCompatibilityAlert(props: {\n    filter: Parser.checkTree,\n    label: string\n}) {\n    const { filter, label } = props\n    const compatible = useMemo(() => {\n        if (typeof window !== undefined) {\n            const browser = getParser(window.navigator.userAgent)\n            return browser.satisfies(filter)\n        }\n        return true // SSR\n    }, [JSON.stringify(filter)])\n\n    if (compatible) return null\n\n    return (\n        <Alert severity=\"warning\">\n            <AlertTitle>Browser not compatible.</AlertTitle>\n            {label}\n        </Alert>\n    )\n}\n","import React, { useContext, useEffect, useRef } from \"react\"\nimport { useBlocklyWorkspace } from \"react-blockly\"\nimport { WorkspaceSvg } from \"blockly\"\nimport Theme from \"@blockly/theme-modern\"\nimport DarkTheme from \"@blockly/theme-dark\"\nimport BlocklyModalDialogs from \"./BlocklyModalDialogs\"\nimport DarkModeContext from \"../ui/DarkModeContext\"\nimport AppContext from \"../AppContext\"\nimport { createStyles, makeStyles } from \"@material-ui/core\"\nimport clsx from \"clsx\"\nimport { withPrefix } from \"gatsby\"\nimport Flags from \"../../../jacdac-ts/src/jdom/flags\"\nimport BlockContext from \"./BlockContext\"\nimport { useBlockMinimap } from \"./BlockMinimap\"\nimport BrowserCompatibilityAlert from \"../ui/BrowserCompatibilityAlert\"\nimport { UIFlags } from \"../../jacdac/providerbus\"\n\nconst useStyles = makeStyles((theme: Theme) =>\n    createStyles({\n        editor: {\n            height: `calc(100vh - ${\n                UIFlags.hosted ? 3.5 : Flags.diagnostics ? 15 : 10\n            }rem)`,\n            \"& .blocklyTreeLabel\": {\n                fontFamily: theme.typography.fontFamily,\n            },\n            \"& .blocklyText\": {\n                fontWeight: `normal !important`,\n                fontFamily: `${theme.typography.fontFamily} !important`,\n            },\n            \"& .blocklyTreeIconOpen, & .blocklyTreeIconClosed\": {\n                opacity: 0.5,\n            },\n            \"& .blocklyFieldButton.blocklyEditableText\": {\n                cursor: \"pointer\",\n            },\n            \"& .blocklyFieldButton.blocklyEditableText > text\": {\n                fill: \"#ffffff\",\n            },\n            \"& .blocklyFieldButton.blocklyEditableText > .blocklyFieldRect\": {\n                fill: \"transparent !important\",\n            },\n        },\n    })\n)\n\nfunction SuspendedBlockEditor(props: { editorId: string; className?: string }) {\n    const { editorId, className } = props\n    const {\n        toolboxConfiguration,\n        workspaceXml,\n        setWorkspace,\n        setWorkspaceXml,\n        setEditorId,\n    } = useContext(BlockContext)\n    const classes = useStyles()\n    const { darkMode } = useContext(DarkModeContext)\n    const { setError } = useContext(AppContext)\n    const theme = darkMode === \"dark\" ? DarkTheme : Theme\n\n    // setup editor id in context\n    useEffect(() => {\n        setEditorId(editorId)\n        return () => setEditorId(\"\")\n    }, [editorId])\n\n    // ReactBlockly\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const blocklyRef = useRef(null)\n    const { workspace, xml } = useBlocklyWorkspace({\n        ref: blocklyRef,\n        toolboxConfiguration,\n        workspaceConfiguration: {\n            collapse: false,\n            disable: false,\n            comments: true,\n            css: true,\n            trashcan: false,\n            sounds: false,\n            renderer: \"zelos\",\n            theme,\n            oneBasedIndex: false,\n            move: {\n                scrollbars: {\n                    vertical: true,\n                    horizontal: true,\n                },\n            },\n            media: withPrefix(\"blockly/media/\"),\n            zoom: {\n                controls: true,\n                wheel: false,\n                startScale: 1.0,\n                maxScale: 3,\n                minScale: 0.08,\n                scaleSpeed: 1.1,\n                pinch: true,\n            },\n        },\n        initialXml: workspaceXml,\n        onImportXmlError: () => {\n            console.error(`error loading blocks`)\n            setError(\"Error loading blocks...\")\n        },\n    }) as { workspace: WorkspaceSvg; xml: string }\n\n    // store ref\n    useEffect(() => setWorkspace(workspace), [workspace])\n    useEffect(() => setWorkspaceXml(xml), [xml])\n\n    // resize blockly\n    useEffect(() => {\n        if (typeof ResizeObserver !== \"undefined\") {\n            const observer = new ResizeObserver(() => workspace?.resize())\n            observer.observe(blocklyRef.current)\n            return () => observer.disconnect()\n        }\n    }, [workspace, blocklyRef.current])\n\n    useBlockMinimap(workspace)\n\n    return (\n        <div>\n            <BrowserCompatibilityAlert\n                filter={{\n                    chrome: \"> 90\",\n                    edge: \"> 90\",\n                    firefox: \"> 90\",\n                }}\n                label=\"Please use Microsoft Edge 90+ or Google Chrome 90+ for this page.\"\n            />\n            <div className={clsx(classes.editor, className)} ref={blocklyRef} />\n            <BlocklyModalDialogs />\n        </div>\n    )\n}\n\nexport default function BlockEditor(props: {\n    editorId: string\n    className?: string\n}) {\n    const { toolboxConfiguration } = useContext(BlockContext)\n\n    if (!toolboxConfiguration) return null\n    return <SuspendedBlockEditor {...props} />\n}\n","import ScatterPlotField from \"../fields/chart/ScatterPlotField\"\nimport {\n    BlockDefinition,\n    BlockReference,\n    CategoryDefinition,\n    DataColumnInputDefinition,\n    DATA_SCIENCE_STATEMENT_TYPE,\n    DummyInputDefinition,\n    identityTransformData,\n    LabelDefinition,\n    OptionsInputDefinition,\n    SeparatorDefinition,\n    StatementInputDefinition,\n} from \"../toolbox\"\nimport BlockDomainSpecificLanguage from \"./dsl\"\nimport DataColumnChooserField from \"../fields/DataColumnChooserField\"\nimport LinePlotField from \"../fields/chart/LinePlotField\"\nimport BarChartField from \"../fields/chart/BarField\"\nimport HistogramField from \"../fields/chart/HistogramField\"\nimport DataTableField from \"../fields/DataTableField\"\nimport { paletteColorByIndex } from \"./palette\"\nimport BoxPlotField from \"../fields/chart/BoxPlotField\"\nimport VegaChartField from \"../fields/chart/VegaChartField\"\nimport type { VisualizationSpec } from \"react-vega\"\nimport type { Mark } from \"vega-lite/build/src/mark\"\nimport { tidyHeaders, tidyResolveFieldColumn } from \"../fields/tidy\"\nimport { Block } from \"blockly\"\nimport type { JSONSchema4 } from \"json-schema\"\nimport JSONSettingsField, {\n    JSONSettingsInputDefinition,\n} from \"../fields/JSONSettingsField\"\nimport HeatMapPlotField from \"../fields/chart/HeatMapField\"\n\nconst SCATTERPLOT_BLOCK = \"chart_scatterplot\"\nconst LINEPLOT_BLOCK = \"chart_lineplot\"\nconst HEATMAP_BLOCK = \"chart_heatmap\"\nconst BARCHART_BLOCK = \"chart_bar\"\nconst HISTOGRAM_BLOCK = \"chart_histogram\"\nconst BOX_PLOT_BLOCK = \"chart_box_plot\"\nconst CHART_SHOW_TABLE_BLOCK = \"chart_show_table\"\n\nconst VEGA_LAYER_BLOCK = \"vega_layer\"\nconst VEGA_ENCODING_BLOCK = \"vega_encoding\"\nconst VEGA_STATEMENT_TYPE = \"vegaStatementType\"\n\nconst chartSettingsSchema: JSONSchema4 = {\n    type: \"object\",\n    properties: {\n        title: {\n            type: \"string\",\n            title: \"Chart title\",\n        },\n    },\n}\nconst axisSchema: JSONSchema4 = {\n    type: \"object\",\n    properties: {\n        title: {\n            type: \"string\",\n            title: \"Title\",\n        },\n    },\n}\nconst scaleSchema: JSONSchema4 = {\n    type: \"object\",\n    properties: {\n        domainMin: {\n            type: \"number\",\n            title: \"minimum\",\n            description: \"Sets the minimum value in the scale domain\",\n        },\n        domainMax: {\n            type: \"number\",\n            title: \"maximum\",\n            description: \"Sets the maximum value in the scale domain\",\n        },\n    },\n}\nconst encodingSettingsSchema: JSONSchema4 = {\n    type: \"object\",\n    properties: {\n        axis: axisSchema,\n    },\n}\nconst encodingNumberSettingsSchema: JSONSchema4 = {\n    type: \"object\",\n    properties: {\n        scale: scaleSchema,\n        axis: axisSchema,\n    },\n}\nconst char2DSettingsSchema: JSONSchema4 = {\n    type: \"object\",\n    properties: {\n        title: {\n            type: \"string\",\n            title: \"Chart title\",\n        },\n        encoding: {\n            type: \"object\",\n            properties: {\n                x: {\n                    title: \"X\",\n                    ...encodingNumberSettingsSchema,\n                },\n                y: {\n                    title: \"Y\",\n                    ...encodingNumberSettingsSchema,\n                },\n            },\n        },\n    },\n}\nconst charMapSettingsSchema: JSONSchema4 = {\n    type: \"object\",\n    properties: {\n        title: {\n            type: \"string\",\n            title: \"Chart title\",\n        },\n        encoding: {\n            index: {\n                title: \"Index\",\n                ...encodingSettingsSchema,\n            },\n            value: {\n                title: \"Value\",\n                ...encodingNumberSettingsSchema,\n            },\n        },\n    },\n}\n\nconst colour = paletteColorByIndex(4)\nconst chartDsl: BlockDomainSpecificLanguage = {\n    id: \"chart\",\n    createBlocks: () => [\n        <BlockDefinition>{\n            kind: \"block\",\n            type: CHART_SHOW_TABLE_BLOCK,\n            tooltip: \"Displays the block data as a table\",\n            message0: \"show table %1 %2 %3 %4 %5 %6\",\n            args0: [\n                {\n                    type: DataColumnChooserField.KEY,\n                    name: \"column0\",\n                },\n                {\n                    type: DataColumnChooserField.KEY,\n                    name: \"column1\",\n                },\n                {\n                    type: DataColumnChooserField.KEY,\n                    name: \"column2\",\n                },\n                {\n                    type: DataColumnChooserField.KEY,\n                    name: \"column3\",\n                },\n                <DummyInputDefinition>{\n                    type: \"input_dummy\",\n                },\n                {\n                    type: DataTableField.KEY,\n                    name: \"table\",\n                    selectColumns: true,\n                },\n            ],\n            previousStatement: DATA_SCIENCE_STATEMENT_TYPE,\n            nextStatement: DATA_SCIENCE_STATEMENT_TYPE,\n            colour,\n            template: \"meta\",\n            inputsInline: false,\n            dataPreviewField: false,\n            transformData: identityTransformData,\n        },\n        <BlockDefinition>{\n            kind: \"block\",\n            type: SCATTERPLOT_BLOCK,\n            tooltip: \"Renders the block data in a scatter plot\",\n            message0: \"scatterplot of x %1 y %2 size %3 group %4 %5 %6 %7\",\n            args0: [\n                <DataColumnInputDefinition>{\n                    type: DataColumnChooserField.KEY,\n                    name: \"x\",\n                    dataType: \"number\",\n                },\n                <DataColumnInputDefinition>{\n                    type: DataColumnChooserField.KEY,\n                    name: \"y\",\n                    dataType: \"number\",\n                },\n                <DataColumnInputDefinition>{\n                    type: DataColumnChooserField.KEY,\n                    name: \"size\",\n                    dataType: \"number\",\n                },\n                <DataColumnInputDefinition>{\n                    type: DataColumnChooserField.KEY,\n                    name: \"group\",\n                },\n                <JSONSettingsInputDefinition>{\n                    type: JSONSettingsField.KEY,\n                    name: \"settings\",\n                    schema: char2DSettingsSchema,\n                },\n                <DummyInputDefinition>{\n                    type: \"input_dummy\",\n                },\n                {\n                    type: ScatterPlotField.KEY,\n                    name: \"plot\",\n                },\n            ],\n            previousStatement: DATA_SCIENCE_STATEMENT_TYPE,\n            nextStatement: DATA_SCIENCE_STATEMENT_TYPE,\n            colour,\n            template: \"meta\",\n            inputsInline: false,\n            dataPreviewField: false,\n            transformData: identityTransformData,\n        },\n        <BlockDefinition>{\n            kind: \"block\",\n            type: BARCHART_BLOCK,\n            tooltip: \"Renders the block data in a bar chart\",\n            message0: \"bar chart of index %1 value %2 %3 %4 %5\",\n            args0: [\n                <DataColumnInputDefinition>{\n                    type: DataColumnChooserField.KEY,\n                    name: \"index\",\n                },\n                <DataColumnInputDefinition>{\n                    type: DataColumnChooserField.KEY,\n                    name: \"value\",\n                    dataType: \"number\",\n                },\n                <JSONSettingsInputDefinition>{\n                    type: JSONSettingsField.KEY,\n                    name: \"settings\",\n                    schema: charMapSettingsSchema,\n                },\n                <DummyInputDefinition>{\n                    type: \"input_dummy\",\n                },\n                {\n                    type: BarChartField.KEY,\n                    name: \"plot\",\n                },\n            ],\n            previousStatement: DATA_SCIENCE_STATEMENT_TYPE,\n            nextStatement: DATA_SCIENCE_STATEMENT_TYPE,\n            colour,\n            template: \"meta\",\n            inputsInline: false,\n            dataPreviewField: false,\n            transformData: identityTransformData,\n        },\n        <BlockDefinition>{\n            kind: \"block\",\n            type: LINEPLOT_BLOCK,\n            tooltip: \"Renders the block data in a line chart\",\n            message0: \"line chart of x %1 y %2 group %3 %4 %5 %6\",\n            args0: [\n                <DataColumnInputDefinition>{\n                    type: DataColumnChooserField.KEY,\n                    name: \"x\",\n                    dataType: \"number\",\n                },\n                <DataColumnInputDefinition>{\n                    type: DataColumnChooserField.KEY,\n                    name: \"y\",\n                    dataType: \"number\",\n                },\n                <DataColumnInputDefinition>{\n                    type: DataColumnChooserField.KEY,\n                    name: \"group\",\n                },\n                <JSONSettingsInputDefinition>{\n                    type: JSONSettingsField.KEY,\n                    name: \"settings\",\n                    schema: char2DSettingsSchema,\n                },\n                <DummyInputDefinition>{\n                    type: \"input_dummy\",\n                },\n                {\n                    type: LinePlotField.KEY,\n                    name: \"plot\",\n                },\n            ],\n            previousStatement: DATA_SCIENCE_STATEMENT_TYPE,\n            nextStatement: DATA_SCIENCE_STATEMENT_TYPE,\n            colour,\n            template: \"meta\",\n            inputsInline: false,\n            dataPreviewField: false,\n            transformData: identityTransformData,\n        },\n        <BlockDefinition>{\n            kind: \"block\",\n            type: HEATMAP_BLOCK,\n            tooltip: \"Renders the block data in a 2D heatmap\",\n            message0: \"heatmap of x %1 y %2 color %3 %4 %5 %6\",\n            args0: [\n                <DataColumnInputDefinition>{\n                    type: DataColumnChooserField.KEY,\n                    name: \"x\",\n                    dataType: \"number\",\n                },\n                <DataColumnInputDefinition>{\n                    type: DataColumnChooserField.KEY,\n                    name: \"y\",\n                    dataType: \"number\",\n                },\n                <DataColumnInputDefinition>{\n                    type: DataColumnChooserField.KEY,\n                    name: \"color\",\n                },\n                <JSONSettingsInputDefinition>{\n                    type: JSONSettingsField.KEY,\n                    name: \"settings\",\n                    schema: char2DSettingsSchema,\n                },\n                <DummyInputDefinition>{\n                    type: \"input_dummy\",\n                },\n                {\n                    type: HeatMapPlotField.KEY,\n                    name: \"plot\",\n                },\n            ],\n            previousStatement: DATA_SCIENCE_STATEMENT_TYPE,\n            nextStatement: DATA_SCIENCE_STATEMENT_TYPE,\n            colour,\n            template: \"meta\",\n            inputsInline: false,\n            dataPreviewField: false,\n            transformData: identityTransformData,\n        },\n        <BlockDefinition>{\n            kind: \"block\",\n            type: HISTOGRAM_BLOCK,\n            tooltip: \"Renders the block data as a histogram\",\n            message0: \"histogram of %1 group %2 %3 %4 %5\",\n            args0: [\n                {\n                    type: DataColumnChooserField.KEY,\n                    name: \"index\",\n                    dataType: \"number\",\n                },\n                {\n                    type: DataColumnChooserField.KEY,\n                    name: \"group\",\n                },\n                <JSONSettingsInputDefinition>{\n                    type: JSONSettingsField.KEY,\n                    name: \"settings\",\n                    schema: chartSettingsSchema,\n                },\n                <DummyInputDefinition>{\n                    type: \"input_dummy\",\n                },\n                {\n                    type: HistogramField.KEY,\n                    name: \"plot\",\n                },\n            ],\n            previousStatement: DATA_SCIENCE_STATEMENT_TYPE,\n            nextStatement: DATA_SCIENCE_STATEMENT_TYPE,\n            colour,\n            template: \"meta\",\n            inputsInline: false,\n            dataPreviewField: false,\n            transformData: identityTransformData,\n        },\n        {\n            kind: \"block\",\n            type: BOX_PLOT_BLOCK,\n            message0: \"boxplot of index %1 value %2 group %3 %4 %5 %6\",\n            args0: [\n                {\n                    type: DataColumnChooserField.KEY,\n                    name: \"index\",\n                },\n                {\n                    type: DataColumnChooserField.KEY,\n                    name: \"value\",\n                    dataType: \"number\",\n                },\n                {\n                    type: DataColumnChooserField.KEY,\n                    name: \"group\",\n                },\n                <JSONSettingsInputDefinition>{\n                    type: JSONSettingsField.KEY,\n                    name: \"settings\",\n                    schema: charMapSettingsSchema,\n                },\n                <DummyInputDefinition>{\n                    type: \"input_dummy\",\n                },\n                {\n                    type: BoxPlotField.KEY,\n                    name: \"plot\",\n                },\n            ],\n            previousStatement: DATA_SCIENCE_STATEMENT_TYPE,\n            nextStatement: DATA_SCIENCE_STATEMENT_TYPE,\n            colour,\n            template: \"meta\",\n            inputsInline: false,\n            dataPreviewField: false,\n            transformData: identityTransformData,\n        },\n        {\n            kind: \"block\",\n            type: VEGA_LAYER_BLOCK,\n            message0: \"chart %1 %2 %3 %4 %5 %6\",\n            args0: [\n                <OptionsInputDefinition>{\n                    type: \"field_dropdown\",\n                    options: [\n                        \"arc\",\n                        \"area\",\n                        \"bar\",\n                        \"boxplot\",\n                        \"circle\",\n                        \"errorband\",\n                        \"errorbar\",\n                        \"line\",\n                        \"point\",\n                        \"rect\",\n                        \"rule\",\n                        \"square\",\n                        \"text\",\n                        \"tick\",\n                        \"trail\",\n                    ].map(s => [s, s]),\n                    name: \"mark\",\n                },\n                <JSONSettingsInputDefinition>{\n                    type: JSONSettingsField.KEY,\n                    name: \"settings\",\n                    schema: chartSettingsSchema,\n                },\n                <DummyInputDefinition>{\n                    type: \"input_dummy\",\n                },\n                <StatementInputDefinition>{\n                    type: \"input_statement\",\n                    name: \"fields\",\n                    check: VEGA_STATEMENT_TYPE,\n                },\n                <DummyInputDefinition>{\n                    type: \"input_dummy\",\n                },\n                {\n                    type: VegaChartField.KEY,\n                    name: \"chart\",\n                },\n            ],\n            previousStatement: DATA_SCIENCE_STATEMENT_TYPE,\n            nextStatement: DATA_SCIENCE_STATEMENT_TYPE,\n            colour,\n            template: \"meta\",\n            inputsInline: false,\n            dataPreviewField: false,\n            transformData: identityTransformData,\n        },\n        {\n            kind: \"block\",\n            type: VEGA_ENCODING_BLOCK,\n            message0: \"encoding %1 as %2 type %3\",\n            args0: [\n                <OptionsInputDefinition>{\n                    type: \"field_dropdown\",\n                    options: [\n                        \"x\",\n                        \"y\",\n                        \"x2\",\n                        \"y2\",\n                        \"xError\",\n                        \"yError\",\n                        \"xError2\",\n                        \"yError2\",\n                        \"theta\",\n                        \"theta2\",\n                        \"radius\",\n                        \"radius2\",\n                        \"color\",\n                        \"angle\",\n                        \"opacity\",\n                        \"fillOpacity\",\n                        \"strokeOpacity\",\n                        \"shape\",\n                        \"size\",\n                        \"strokeDash\",\n                        \"strokeWidth\",\n                        \"text\",\n                    ].map(s => [s, s]),\n                    name: \"channel\",\n                },\n                <DataColumnInputDefinition>{\n                    type: DataColumnChooserField.KEY,\n                    name: \"field\",\n                    parentData: true\n                },\n                <OptionsInputDefinition>{\n                    type: \"field_dropdown\",\n                    options: [\n                        \"quantitative\",\n                        \"ordinal\",\n                        \"nominal\",\n                        \"temporal\",\n                    ].map(s => [s, s]),\n                    name: \"type\",\n                },\n            ],\n            previousStatement: VEGA_STATEMENT_TYPE,\n            nextStatement: VEGA_STATEMENT_TYPE,\n            colour,\n            template: \"meta\",\n            inputsInline: false,\n            dataPreviewField: false,\n            transformData: identityTransformData,\n        },\n    ],\n\n    createCategory: () => [\n        <CategoryDefinition>{\n            kind: \"category\",\n            name: \"Charts\",\n            contents: [\n                <BlockReference>{ kind: \"block\", type: SCATTERPLOT_BLOCK },\n                <BlockReference>{ kind: \"block\", type: HISTOGRAM_BLOCK },\n                <BlockReference>{ kind: \"block\", type: BOX_PLOT_BLOCK },\n                <BlockReference>{ kind: \"block\", type: BARCHART_BLOCK },\n                <BlockReference>{ kind: \"block\", type: LINEPLOT_BLOCK },\n                <BlockReference>{ kind: \"block\", type: HEATMAP_BLOCK },\n                <BlockReference>{ kind: \"block\", type: CHART_SHOW_TABLE_BLOCK },\n                <SeparatorDefinition>{\n                    kind: \"sep\",\n                },\n                <LabelDefinition>{\n                    kind: \"label\",\n                    text: \"Advanced\",\n                },\n                <BlockReference>{\n                    kind: \"block\",\n                    type: VEGA_LAYER_BLOCK,\n                },\n                <BlockReference>{\n                    kind: \"block\",\n                    type: VEGA_ENCODING_BLOCK,\n                },\n            ],\n            colour,\n        },\n    ],\n}\n\nexport default chartDsl\n\nexport function blockToVisualizationSpec(\n    sourceBlock: Block,\n    // eslint-disable-next-line @typescript-eslint/ban-types\n    data: object[]\n): VisualizationSpec {\n    const { headers, types } = tidyHeaders(data)\n    const mark: Mark = sourceBlock.getFieldValue(\"mark\")\n    const title: string = sourceBlock.getFieldValue(\"title\")\n    const spec: VisualizationSpec = {\n        title,\n        mark: { type: mark, tooltip: true },\n        encoding: {},\n        data: { name: \"values\" },\n    }\n\n    let child = sourceBlock.getInputTargetBlock(\"fields\")\n    while (child) {\n        switch (child.type) {\n            case VEGA_ENCODING_BLOCK: {\n                const channel: string = child.getFieldValue(\"channel\")\n                const field = tidyResolveFieldColumn(data, child, \"field\")\n                const type: string = child.getFieldValue(\"type\")\n                if (channel && field) {\n                    const fieldType = types[headers.indexOf(field)]\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                    spec.encoding[channel] = {\n                        field,\n                        type:\n                            type ||\n                            (fieldType === \"number\"\n                                ? \"quantitative\"\n                                : \"nominal\"),\n                    }\n                }\n                break\n            }\n        }\n\n        child = child.getNextBlock()\n    }\n\n    return spec\n}\n","import jsep from \"jsep\"\nimport { Theme } from \"@material-ui/core\"\nimport Blockly, { Block, Workspace, WorkspaceSvg } from \"blockly\"\nimport JDService from \"../../../../jacdac-ts/src/jdom/service\"\nimport { RoleEvent } from \"../../../../jacdac-ts/src/vm/compile\"\nimport { VMError } from \"../../../../jacdac-ts/src/vm/ir\"\nimport {\n    BlockDefinition,\n    ContentDefinition,\n    resolveBlockDefinition,\n    ServiceBlockDefinition,\n} from \"../toolbox\"\nimport { CmdWithErrors, ExpressionWithErrors } from \"../../vm/VMgenerator\"\nimport { BlockJSON, WorkspaceFile, WorkspaceJSON } from \"./workspacejson\"\n\nexport interface CreateBlocksOptions {\n    theme: Theme\n}\n\nexport interface CreateCategoryOptions {\n    theme: Theme\n    source: WorkspaceJSON\n    liveServices: JDService[]\n}\n\nexport interface CompileEventToVMOptions {\n    block: BlockJSON\n    definition: ServiceBlockDefinition\n    blockToExpression: (ev: RoleEvent, block: BlockJSON) => ExpressionWithErrors\n}\n\nexport interface CompileEventToVMResult {\n    event?: RoleEvent\n    expression?: jsep.Expression\n    errors?: VMError[]\n    meta?: boolean\n}\n\nexport interface CompileExpressionToVMOptions {\n    event: RoleEvent\n    block: BlockJSON\n    definition: ServiceBlockDefinition\n    blockToExpressionInner: (ev: RoleEvent, block: BlockJSON) => jsep.Expression\n}\n\nexport interface CompileCommandToVMOptions {\n    event: RoleEvent\n    block: BlockJSON\n    definition: ServiceBlockDefinition\n    blockToExpression: (ev: RoleEvent, block: BlockJSON) => ExpressionWithErrors\n}\n\nexport default interface BlockDomainSpecificLanguage {\n    /**\n     * A unique identifier used to route blocks back to the DSL\n     */\n    id: string\n\n    /**\n     * A list of builtin block types, typically provided by Blockly\n     */\n    types?: string[]\n\n    /**\n     * Optional API to be called when mounted in the React context, returns unmounted\n     */\n    mount?: (workspace: Workspace) => () => void\n\n    /**\n     * Creates blocks for the DSL\n     */\n    createBlocks?: (\n        options: CreateBlocksOptions\n    ) => BlockDefinition[] | Promise<BlockDefinition[]>\n\n    /***\n     * Creates a JSON category to populate the toolbox\n     */\n    createCategory?: (options: CreateCategoryOptions) => ContentDefinition[]\n\n    /**\n     * Shorthand to convert block JSON into a primitive value\n     */\n    blockToValue?: (block: Block) => string | number | boolean\n\n    /**\n     * Returns a change listener if needed\n     */\n    createWorkspaceChangeListener?: (\n        workspace: WorkspaceSvg\n    ) => (event: Blockly.Events.Abstract) => void\n\n    /**\n     * After a successfull parse and save, opportunity to walk the JSON tree\n     * and attach warnings\n     */\n    visitWorkspaceJSON?: (\n        workspace: Workspace,\n        workspaceJSON: WorkspaceJSON\n    ) => void\n\n    // VM support\n    compileEventToVM?: (\n        options: CompileEventToVMOptions\n    ) => CompileEventToVMResult\n\n    compileCommandToVM?: (options: CompileCommandToVMOptions) => CmdWithErrors\n\n    compileExpressionToVM?: (\n        options: CompileExpressionToVMOptions\n    ) => ExpressionWithErrors\n\n    onWorkspaceJSONChange?: (workspaceJSON: WorkspaceJSON) => void\n\n    onSave?: (file: WorkspaceFile) => void\n\n    onBeforeSaveWorkspaceFile?: (file: WorkspaceFile) => void\n}\n\nexport function resolveDsl(dsls: BlockDomainSpecificLanguage[], type: string) {\n    const dsl = dsls?.find(dsl => dsl.types?.indexOf(type) > -1)\n    if (dsl) return dsl\n\n    const { dsl: dslName } = resolveBlockDefinition(type) || {}\n    if (!dslName) {\n        console.warn(`unknown dsl for ${type}`)\n        return undefined\n    }\n    return dsls?.find(dsl => dsl.id === dslName)\n}\n","import { fieldShadows } from \"../fields/fields\"\nimport BlockDomainSpecificLanguage from \"./dsl\"\n\nconst fieldsDsl: BlockDomainSpecificLanguage = {\n    id: \"fields\",\n    createBlocks: () => fieldShadows(),\n}\nexport default fieldsDsl\n","/* eslint-disable @typescript-eslint/ban-types */\nimport workerProxy from \"./proxy\"\nimport type {\n    CsvDownloadRequest,\n    CsvSaveRequest,\n    CsvParseRequest,\n    CsvFile,\n    CsvFileResponse,\n    CsvUnparseRequest,\n    CsvUnparseResponse,\n    CsvMessage,\n} from \"../../../../workers/csv/dist/node_modules/csv.worker\"\n\nexport async function downloadCSV(url: string): Promise<CsvFile> {\n    const worker = workerProxy(\"csv\")\n    const res = await worker.postMessage<CsvDownloadRequest, CsvFileResponse>({\n        worker: \"csv\",\n        type: \"download\",\n        url,\n    })\n    return res?.file\n}\n\nexport async function saveCSV(\n    fileHandle: FileSystemFileHandle,\n    data: object[]\n): Promise<void> {\n    const worker = workerProxy(\"csv\")\n    await worker.postMessage<CsvSaveRequest, CsvMessage>({\n        worker: \"csv\",\n        type: \"save\",\n        fileHandle,\n        data,\n    })\n}\n\nexport async function unparseCSV(data: object[]): Promise<string> {\n    const worker = workerProxy(\"csv\")\n    const resp = await worker.postMessage<\n        CsvUnparseRequest,\n        CsvUnparseResponse\n    >({\n        worker: \"csv\",\n        type: \"unparse\",\n        data,\n    })\n    return resp?.text\n}\n\nexport async function parseCSV(source: string): Promise<CsvFile> {\n    const worker = workerProxy(\"csv\")\n    const resp = await worker.postMessage<CsvParseRequest, CsvFileResponse>({\n        worker: \"csv\",\n        type: \"parse\",\n        source,\n    })\n    return resp?.file\n}\n","import { BlockJSON, FieldJSON, InputJSON, WorkspaceJSON } from \"./workspacejson\"\n\nexport interface WorkspaceVisitor {\n    visitBlock?: (block: BlockJSON) => void\n    visitInput?: (input: InputJSON) => void\n    visitField?: (name: string, field: FieldJSON) => void\n}\n\nexport function visitBlock(block: BlockJSON, visitor: WorkspaceVisitor) {\n    if (!block) return\n    visitor.visitBlock?.(block)\n    const { inputs, children } = block\n    inputs?.forEach(input => visitInput(input, visitor))\n    children?.forEach(child => visitBlock(child, visitor))\n}\n\nexport function visitInput(input: InputJSON, visitor: WorkspaceVisitor) {\n    if (!input) return\n    visitor.visitInput?.(input)\n    const { fields, child } = input\n    if (fields) Object.keys(fields).map(k => visitField(k, fields[k], visitor))\n    visitBlock(child, visitor)\n}\n\nexport function visitField(\n    name: string,\n    field: FieldJSON,\n    visitor: WorkspaceVisitor\n) {\n    if (!field) return\n    visitor.visitField?.(name, field)\n}\n\nexport function visitWorkspace(\n    workspace: WorkspaceJSON,\n    visitor: WorkspaceVisitor\n) {\n    workspace?.blocks?.forEach(block => visitBlock(block, visitor))\n}\n","import { BlockWithServices, FieldWithServices } from \"../WorkspaceContext\"\nimport { Block, FieldDropdown } from \"blockly\"\nimport { withPrefix } from \"gatsby\"\nimport { downloadCSV } from \"../dsl/workers/csv.proxy\"\n\nconst builtins = {\n    cereal: withPrefix(\"/datasets/cereal.csv\"),\n    penguins: withPrefix(\"/datasets/penguins.csv\"),\n}\n\nexport default class BuiltinDataSetField\n    extends FieldDropdown\n    implements FieldWithServices\n{\n    static KEY = \"jacdac_field_data_builtin_dataset\"\n    private initialized = false\n\n    // eslint-disable-next-line @typescript-eslint/ban-types\n    static fromJson(options: object) {\n        return new BuiltinDataSetField(options)\n    }\n\n    // eslint-disable-next-line @typescript-eslint/ban-types\n    constructor(options: object) {\n        super(() => Object.keys(builtins).map(k => [k, k]), undefined, options)\n    }\n\n    init() {\n        super.init()\n        this.initialized = true\n        this.updateData()\n    }\n\n    private async updateData() {\n        if (!this.initialized) return\n\n        const url = builtins[this.getValue()]\n        if (!url) return\n\n        // load dataset as needed\n        const sourceBlock = this.getSourceBlock() as BlockWithServices\n        const marker = !!sourceBlock?.isInsertionMarker()\n        if (!sourceBlock || marker) return\n\n        const services = sourceBlock.jacdacServices\n        if (!services || services.cache[BuiltinDataSetField.KEY] === url) return // already downloaded\n        // avoid races\n        services.cache[BuiltinDataSetField.KEY] = url\n\n        const { data, errors } = await downloadCSV(url)\n        if (errors?.length)\n            console.debug(`csv parse errors`, {\n                id: sourceBlock.id,\n                marker,\n                data,\n                errors,\n                services,\n                url,\n            })\n        services.data = data\n    }\n\n    setSourceBlock(block: Block) {\n        super.setSourceBlock(block)\n        this.updateData()\n    }\n\n    doValueUpdate_(newValue) {\n        super.doValueUpdate_(newValue)\n        this.updateData()\n    }\n\n    notifyServicesChanged() {\n        this.updateData()\n    }\n}\n","import React, { lazy, ReactNode } from \"react\"\nimport ReactField, { ReactFieldJSON } from \"./ReactField\"\nimport {\n    BlockDefinition,\n    DataPreviewInputDefinition,\n    identityTransformData,\n} from \"../toolbox\"\nimport Suspense from \"../../ui/Suspense\"\nconst DataTablePreviewWidget = lazy(() => import(\"./DataTablePreviewWidget\"))\n\nexport interface DataPreviewOptions extends ReactFieldJSON {\n    compare?: boolean\n}\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport default class DataPreviewField extends ReactField<ReactFieldJSON> {\n    static KEY = \"jacdac_field_data_preview\"\n    compare: boolean\n\n    static fromJson(options: DataPreviewOptions) {\n        return new DataPreviewField(options?.value, undefined, options)\n    }\n\n    // the first argument is a dummy and never used\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    constructor(value: string, validator?: any, options?: DataPreviewOptions) {\n        super(value, validator, options)\n        this.compare = !!options?.compare\n    }\n\n    protected initCustomView(): SVGElement {\n        const group = this.fieldGroup_\n        group.classList.add(\"blocklyFieldButton\")\n        return undefined\n    }\n\n    getText_() {\n        return \"\"\n    }\n\n    renderField(): ReactNode {\n        return (\n            <Suspense>\n                <DataTablePreviewWidget compare={this.compare} />\n            </Suspense>\n        )\n    }\n}\n\nexport function addDataPreviewField(block: BlockDefinition): BlockDefinition {\n    const preview = block?.dataPreviewField\n    if (preview) {\n        // don't add twice\n        block.dataPreviewField = false\n        // parse args and add one more arg\n        const { message0 } = block\n        const i = message0.lastIndexOf(\"%\")\n        const index = parseInt(message0.substr(i + 1)) || 0\n        block.message0 += ` %${index + 1}`\n\n        // does this mutate the data?\n        const identity =\n            preview === \"after\" || block.transformData === identityTransformData\n\n        // add field\n        block.args0.push({\n            type: DataPreviewField.KEY,\n            name: \"preview\",\n            compare: !identity,\n        } as DataPreviewInputDefinition)\n    }\n    return block\n}\n","import React from \"react\"\nimport { ReactFieldJSON } from \"./ReactField\"\nimport ReactInlineField from \"./ReactInlineField\"\nimport DataTableWidget from \"./DataTableWidget\"\nimport { SMALL_TABLE_HEIGHT } from \"../toolbox\"\n\nexport interface DataPreviewOptions extends ReactFieldJSON {\n    transformed?: boolean\n    small?: boolean\n    selectColumns?: boolean\n}\n\nconst MAX_ITEMS = 256\nexport default class DataTableField extends ReactInlineField {\n    static KEY = \"jacdac_field_data_table\"\n    EDITABLE = false\n    transformed: boolean\n    small: boolean\n    selectColumns: boolean\n\n    static fromJson(options: DataPreviewOptions) {\n        return new DataTableField(options)\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    constructor(options?: DataPreviewOptions) {\n        super(options)\n        this.transformed = !!options?.transformed\n        this.small = !!options?.small\n        this.selectColumns = !!options?.selectColumns\n    }\n\n    protected createContainer(): HTMLDivElement {\n        const c = document.createElement(\"div\")\n        c.style.display = \"block\"\n        c.style.minWidth = \"388px\"\n        c.style.maxWidth = \"80vh\"\n        c.style.maxHeight = \"60vh\"\n        return c\n    }\n\n    renderInlineField() {\n        const tableHeight = this.small ? SMALL_TABLE_HEIGHT : undefined\n        return (\n            <DataTableWidget\n                maxItems={MAX_ITEMS}\n                tableHeight={tableHeight}\n                transformed={this.transformed}\n                selectColumns={this.selectColumns}\n            />\n        )\n    }\n}\n","import React, { ReactNode, useContext } from \"react\"\nimport WorkspaceContext from \"../WorkspaceContext\"\nimport useBlockData from \"../useBlockData\"\nimport { Grid, makeStyles, Typography } from \"@material-ui/core\"\nimport { TABLE_HEIGHT, TABLE_WIDTH } from \"../toolbox\"\nimport { PointerBoundary } from \"./PointerBoundary\"\nimport CopyButton from \"../../ui/CopyButton\"\nimport { unparseCSV } from \"../dsl/workers/csv.proxy\"\nimport { roundWithPrecision, toMap } from \"../../../../jacdac-ts/src/jdom/utils\"\nimport { tidyHeaders, tidyResolveHeader } from \"./tidy\"\nimport { humanify } from \"../../../../jacdac-ts/jacdac-spec/spectool/jdspec\"\n\ninterface StylesProps {\n    tableHeight: number\n}\n\nconst useStyles = makeStyles(() => ({\n    empty: {\n        paddingLeft: \"0.5rem\",\n        paddingRight: \"0.5rem\",\n        background: \"#fff\",\n        color: \"#000\",\n        borderRadius: \"0.25rem\",\n    },\n    button: {\n        color: \"grey\",\n    },\n    root: (props: StylesProps) => ({\n        marginTop: \"0.25rem\",\n        paddingLeft: \"0.5rem\",\n        paddingRight: \"0.5rem\",\n        background: \"#fff\",\n        color: \"#000\",\n        borderRadius: \"0.25rem\",\n        width: `calc(${TABLE_WIDTH}px - 0.25rem)`,\n        height: `calc(${props.tableHeight}px - 0.25rem)`,\n        overflow: \"auto\",\n    }),\n    table: {\n        margin: 0,\n        fontSize: \"0.8rem\",\n        lineHeight: \"1rem\",\n\n        \"& th, td\": {\n            backgroundClip: \"padding-box\",\n            \"scroll-snap-align\": \"start\",\n        },\n        \"& th\": {\n            position: \"sticky\",\n            top: 0,\n            background: \"white\",\n        },\n        \"& td\": {\n            borderColor: \"#ccc\",\n            borderRightStyle: \"solid 1px\",\n        },\n    },\n}))\n\nexport default function DataTableWidget(props: {\n    label?: string\n    transformed?: boolean\n    tableHeight?: number\n    empty?: ReactNode\n    maxItems?: number\n    selectColumns?: boolean\n}): JSX.Element {\n    const {\n        label,\n        transformed,\n        tableHeight = TABLE_HEIGHT,\n        empty,\n        maxItems,\n        selectColumns,\n    } = props\n    const { sourceBlock } = useContext(WorkspaceContext)\n    const { data, transformedData } = useBlockData<{ id?: string } & unknown>(\n        sourceBlock\n    )\n    const raw = transformed ? transformedData : data\n    const classes = useStyles({ tableHeight })\n\n    if (!raw?.length)\n        return empty ? <span className={classes.empty}>{empty}</span> : null\n\n    const selectedColumns = selectColumns\n        ? [0, 1, 2, 3]\n              .map(i => `column${i}`)\n              .map(n => tidyResolveHeader(raw, sourceBlock?.getFieldValue(n)))\n              .filter(c => !!c)\n        : []\n    const columns = selectedColumns.length\n        ? selectedColumns\n        : tidyHeaders(raw).headers\n    const table =\n        raw.length > maxItems\n            ? [\n                  ...raw.slice(0, maxItems),\n                  toMap(\n                      columns,\n                      c => c,\n                      () => \"...\"\n                  ),\n              ]\n            : raw\n\n    // console.log({\n    //     raw,\n    //     transformed,\n    //     transformedData,\n    //     data,\n    //     table,\n    //     selectedColumns,\n    //     columns,\n    // })\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const renderCell = (v: any) =>\n        typeof v === \"boolean\"\n            ? v\n                ? \"true\"\n                : \"false\"\n            : typeof v === \"number\"\n            ? roundWithPrecision(v, 3)\n            : v + \"\"\n\n    const handleCopy = async () => {\n        const text = unparseCSV(raw)\n        return text\n    }\n\n    return (\n        <PointerBoundary className={classes.root}>\n            <Grid container direction=\"column\" spacing={1}>\n                <Grid item xs={12}>\n                    <Grid\n                        container\n                        direction=\"row\"\n                        justifyContent=\"flex-start\"\n                        alignItems=\"center\"\n                        spacing={1}\n                    >\n                        {label && (\n                            <Grid item>\n                                <Typography variant=\"h6\">{label}</Typography>\n                            </Grid>\n                        )}\n                        <Grid item>\n                            <CopyButton\n                                size=\"small\"\n                                className={classes.button}\n                                onCopy={handleCopy}\n                            />\n                        </Grid>\n                        {raw.length > 1 && (\n                            <Grid item>\n                                <Typography variant=\"caption\">\n                                    {raw.length} rows x {columns.length} columns\n                                </Typography>\n                            </Grid>\n                        )}\n                    </Grid>\n                </Grid>\n                <Grid item xs={12}>\n                    <table className={classes.table}>\n                        <thead>\n                            <tr>\n                                {columns.map(c => (\n                                    <th key={c}>{humanify(c)}</th>\n                                ))}\n                            </tr>\n                        </thead>\n                        <tbody>\n                            {table.map((r, i) => (\n                                <tr key={r.id || i}>\n                                    {columns.map(c => (\n                                        <td key={c}>{renderCell(r[c])}</td>\n                                    ))}\n                                </tr>\n                            ))}\n                        </tbody>\n                    </table>\n                </Grid>\n            </Grid>\n        </PointerBoundary>\n    )\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { Block, FieldDropdown } from \"blockly\"\nimport { CHANGE } from \"../../../../jacdac-ts/src/jdom/constants\"\nimport { parseCSV } from \"../dsl/workers/csv.proxy\"\nimport {\n    resolveBlockServices,\n    resolveWorkspaceServices,\n} from \"../WorkspaceContext\"\nimport { ReactFieldJSON } from \"./ReactField\"\n\nexport default class FileOpenField extends FieldDropdown {\n    static KEY = \"jacdac_field_file_open\"\n    SERIALIZABLE = true\n    // eslint-disable-next-line @typescript-eslint/ban-types\n    private _data: object[]\n    private _unmount: () => void\n\n    static fromJson(options: ReactFieldJSON) {\n        return new FileOpenField(options)\n    }\n\n    constructor(options?: ReactFieldJSON) {\n        super(() => [[\"\", \"\"]], undefined, options)\n    }\n\n    fromXml(fieldElement: Element) {\n        this.setValue(fieldElement.textContent)\n    }\n\n    getOptions(): string[][] {\n        const options = this.resolveFiles()?.map(f => [f.name, f.name]) || []\n        const value = this.getValue()\n\n        return options.length < 1\n            ? [[value || \"\", value || \"\"]]\n            : [...options, [\"\", \"\"]]\n    }\n\n    doClassValidation_(newValue?: string) {\n        // skip super class validationervices chan\n        return newValue\n    }\n\n    init() {\n        super.init()\n        this.updateData()\n    }\n\n    setSourceBlock(block: Block) {\n        super.setSourceBlock(block)\n        this.updateData()\n    }\n\n    doValueUpdate_(newValue) {\n        super.doValueUpdate_(newValue)\n        this.parseSource()\n    }\n\n    notifyServicesChanged() {\n        this.updateData()\n    }\n\n    dispose() {\n        super.dispose()\n        this.unmount()\n    }\n\n    private resolveFiles() {\n        const sourceBlock = this.getSourceBlock()\n        const services = resolveWorkspaceServices(sourceBlock?.workspace)\n        const directory = services?.workingDirectory\n        return directory?.files.filter(f => /\\.csv$/i.test(f.name))\n    }\n\n    private async parseSource() {\n        const filename = this.getValue()\n        const file = this.resolveFiles()?.find(f => f.name === filename)\n        if (file) {\n            try {\n                console.debug(`file: loading ${file.name}`)\n                const source = await file.textAsync()\n                console.debug(`file: loaded ${(source?.length || 0) / 1024}kb`)\n                if (source) {\n                    const csv = await parseCSV(source)\n                    this._data = csv?.data\n                    this.updateData()\n                }\n            } catch (e) {\n                console.log(e)\n                this.value_ = undefined\n            }\n        }\n    }\n\n    private async updateData() {\n        const sourceBlock = this.getSourceBlock()\n        // update current data\n        const blockServices = resolveBlockServices(sourceBlock)\n        if (blockServices) blockServices.data = this._data\n\n        // register file system changes\n        this.unmount()\n        const wsServices = resolveWorkspaceServices(sourceBlock?.workspace)\n        if (wsServices) {\n            const { workingDirectory } = wsServices\n            this._unmount = workingDirectory?.subscribe(CHANGE, () =>\n                this.updateData()\n            )\n        }\n    }\n\n    private unmount() {\n        if (this._unmount) {\n            this._unmount()\n            this._unmount = undefined\n        }\n    }\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { Field } from \"blockly\"\n\nexport default class FileSaveField extends Field {\n    static KEY = \"jacdac_field_file_save\"\n    SERIALIZABLE = true\n    private fileType: string\n\n    constructor(options?: any) {\n        super(\"...\", null, options)\n        this.fileType = options?.fileType || \"csv\"\n    }\n    fileHandle: FileSystemFileHandle\n\n    static fromJson(options: any) {\n        return new FileSaveField(options)\n    }\n\n    showEditor_() {\n        this.openFileHandle()\n    }\n\n    private async openFileHandle() {\n        const options: SaveFilePickerOptions = {\n            types: [\n                {\n                    id: \"text\",\n                    description: \"Text Files\",\n                    accept: {\n                        \"text/plain\": [\".txt\"],\n                    },\n                },\n                {\n                    id: \"csv\",\n                    description: \"CSV Files\",\n                    accept: {\n                        \"text/csv\": [\".csv\"],\n                    },\n                },\n                {\n                    id: \"json\",\n                    description: \"JSON Files\",\n                    accept: {\n                        \"application/json\": [\".json\"],\n                    },\n                },\n            ].filter(({ id }) => this.fileType === id),\n            excludeAcceptAllOption: true,\n        }\n        this.fileHandle = await window.showSaveFilePicker?.(options)\n        this.setValue(this.fileHandle?.name || \"\")\n    }\n}\n","import React, { lazy, useContext } from \"react\"\nimport { ReactFieldJSON } from \"./ReactField\"\nimport WorkspaceContext from \"../WorkspaceContext\"\nimport ReactInlineField from \"./ReactInlineField\"\nimport useBlockData from \"../useBlockData\"\nimport Suspense from \"../../ui/Suspense\"\nimport { tidyFindLastValue } from \"./tidy\"\nimport { tidy, min as tidyMin, max as tidyMax, summarize } from \"@tidyjs/tidy\"\nimport { Grid } from \"@material-ui/core\"\nimport { roundWithPrecision } from \"../../../../jacdac-ts/src/jdom/utils\"\nconst GaugeWidget = lazy(() => import(\"../../widgets/GaugeWidget\"))\n\nfunction GaugeWidgetView() {\n    const { sourceBlock } = useContext(WorkspaceContext)\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const { data } = useBlockData<any>(sourceBlock)\n    if (!data?.length) return null\n\n    const field = sourceBlock?.getFieldValue(\"field\") as string\n    let value = tidyFindLastValue(data, field)\n    if (value === undefined) return null\n\n    let min = Number(sourceBlock?.getFieldValue(\"min\"))\n    let max = Number(sourceBlock?.getFieldValue(\"max\"))\n    if (min === max) {\n        min = undefined\n        max = undefined\n    }\n\n    if (isNaN(min)) min = tidy(data, summarize({ min: tidyMin(field) }))[0].min\n    if (isNaN(max)) max = tidy(data, summarize({ max: tidyMax(field) }))[0].max\n\n    // round with precision\n    const step = Math.ceil(Math.abs(value)) / 10\n    const precision = step < 1 ? Math.ceil(-Math.log10(step)) : 0\n    value = roundWithPrecision(value, precision)\n\n    // clamp values\n    value = Math.min(max, Math.max(min, value))\n\n    return (\n        <Grid\n            container\n            justifyContent=\"center\"\n            alignContent=\"center\"\n            alignItems=\"center\"\n        >\n            <Grid item>\n                <Suspense>\n                    <GaugeWidget value={value} min={min} max={max} />\n                </Suspense>\n            </Grid>\n        </Grid>\n    )\n}\n\nexport default class GaugeWidgetField extends ReactInlineField {\n    static KEY = \"jacdac_field_gauge_widget\"\n    EDITABLE = false\n\n    static fromJson(options: ReactFieldJSON) {\n        return new GaugeWidgetField(options)\n    }\n\n    protected createContainer(): HTMLDivElement {\n        const c = document.createElement(\"div\")\n        c.style.width = \"20rem\"\n        return c\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    constructor(options?: any) {\n        super(options)\n    }\n\n    renderInlineField() {\n        return <GaugeWidgetView />\n    }\n}\n","import { ReactFieldJSON } from \"./ReactField\"\nimport { FieldDropdown } from \"blockly\"\n\nexport interface IFrameDataChooserOptions extends ReactFieldJSON {\n    dataId: string\n}\n\nexport const AllOptions: Record<string, [string, string][]> = {}\n\nexport default class IFrameDataChooserField extends FieldDropdown {\n    static KEY = \"jacdac_field_iframe_data_chooser\"\n    SERIALIZABLE = true\n    dataId: string\n\n    static fromJson(options: ReactFieldJSON) {\n        return new IFrameDataChooserField(options)\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    // the first argument is a dummy and never used\n    constructor(options?: IFrameDataChooserOptions) {\n        super(() => [[\"\", \"\"]], undefined, options)\n        this.dataId = options.dataId || \"\"\n    }\n\n    fromXml(fieldElement: Element) {\n        this.setValue(fieldElement.textContent)\n    }\n\n    getOptions(): string[][] {\n        const options = AllOptions[this.dataId]?.slice(0)\n        return !options?.length ? [[\"\", \"\"]] : options\n    }\n\n    doClassValidation_(newValue?: string) {\n        // skip super class validationervices chan\n        return newValue\n    }\n}\n","import React, { lazy, useContext, PointerEvent } from \"react\"\nimport { ReactFieldJSON } from \"./ReactField\"\nimport WorkspaceContext from \"../WorkspaceContext\"\nimport ReactInlineField from \"./ReactInlineField\"\nimport Suspense from \"../../ui/Suspense\"\nimport NoServiceAlert from \"./NoServiceAlert\"\n\nconst JDomServiceTreeView = lazy(\n    () => import(\"../../tools/JDomServiceTreeView\")\n)\n\nfunction JDomTreeWidget() {\n    const { roleService, flyout } = useContext(WorkspaceContext)\n    const onPointerStopPropagation = (event: PointerEvent<HTMLDivElement>) => {\n        // make sure blockly does not handle drags when interacting with UI\n        event.stopPropagation()\n    }\n\n    if (flyout) return null\n    if (!roleService) return <NoServiceAlert />\n\n    return (\n        <div\n            style={{ minWidth: \"12rem\", cursor: \"inherit\" }}\n            onPointerDown={onPointerStopPropagation}\n            onPointerUp={onPointerStopPropagation}\n            onPointerMove={onPointerStopPropagation}\n        >\n            {roleService && (\n                <Suspense>\n                    <JDomServiceTreeView\n                        service={roleService}\n                        defaultExpanded={[roleService.id]}\n                    />\n                </Suspense>\n            )}\n        </div>\n    )\n}\n\nexport default class JDomTreeField extends ReactInlineField {\n    static KEY = \"jacdac_field_jdom_service_tree\"\n    EDITABLE = false\n\n    static fromJson(options: ReactFieldJSON) {\n        return new JDomTreeField(options)\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    constructor(options?: any) {\n        super(options)\n    }\n\n    renderInlineField() {\n        return <JDomTreeWidget />\n    }\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable @typescript-eslint/ban-types */\nimport React, { lazy, ReactNode, useEffect, useState } from \"react\"\nimport ReactField, { ReactFieldJSON, UNMOUNT } from \"./ReactField\"\nimport type { JSONSchema4 } from \"json-schema\"\nimport Suspense from \"../../ui/Suspense\"\nimport { InputDefinition } from \"../toolbox\"\nimport { assert } from \"../../../../jacdac-ts/src/jdom/utils\"\nimport JDEventSource from \"../../../../jacdac-ts/src/jdom/eventsource\"\nconst JSONSchemaForm = lazy(() => import(\"../../ui/JSONSchemaForm\"))\n\nexport interface JSONSettingsOptions extends ReactFieldJSON {\n    schema?: JSONSchema4\n}\n\nexport interface JSONSettingsInputDefinition extends InputDefinition {\n    type: \"jacdac_field_json_settings\"\n    schema: JSONSchema4\n}\n\nfunction JSONSettingsWidget(props: {\n    schema: JSONSchema4\n    value: any\n    events: JDEventSource\n    setValue: (newValue: any) => void\n}) {\n    const { schema, value, setValue, events } = props\n    const [editValue, setEditValue] = useState(value)\n\n    useEffect(\n        () => events.subscribe(UNMOUNT, () => setValue(editValue)),\n        [editValue]\n    )\n\n    return (\n        <div\n            style={{\n                maxWidth: \"22rem\",\n                minHeight: \"20rem\",\n                padding: \"0.5rem\",\n            }}\n        >\n            <Suspense>\n                <JSONSchemaForm\n                    schema={schema}\n                    value={editValue}\n                    setValue={setEditValue}\n                />\n            </Suspense>\n        </div>\n    )\n}\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport default class JSONSettingsField extends ReactField<ReactFieldJSON> {\n    static KEY = \"jacdac_field_json_settings\"\n    SERIALIZABLE = true\n    schema: JSONSchema4\n\n    static fromJson(options: ReactFieldJSON) {\n        return new JSONSettingsField(options?.value, undefined, options)\n    }\n\n    // the first argument is a dummy and never used\n    constructor(value: string, validator?: any, options?: JSONSettingsOptions) {\n        super(value, validator, options)\n        this.schema = options?.schema || {}\n        this.darkMode = \"light\"\n        assert(!!this.schema, \"schema missing\")\n    }\n\n    protected initCustomView(): SVGElement {\n        const group = this.fieldGroup_\n        group.classList.add(\"blocklyFieldButton\")\n        return undefined\n    }\n\n    get defaultValue() {\n        return {}\n    }\n\n    getText_() {\n        return \"\"\n    }\n\n    renderField(): ReactNode {\n        const { schema, value = {}, events } = this\n        const setValue = (v: any) => (this.value = v)\n        return (\n            <JSONSettingsWidget\n                schema={schema}\n                value={value}\n                events={events}\n                setValue={setValue}\n            />\n        )\n    }\n}\n","import React, { lazy, ReactNode } from \"react\"\nimport { HidKeyboardModifiers } from \"../../../../jacdac-ts/src/jdom/constants\"\nimport ReactField, { ReactFieldJSON } from \"./ReactField\"\nimport Suspense from \"../../ui/Suspense\"\nimport { renderKeyboardKey } from \"../../../../jacdac-ts/src/servers/hidkeyboardserver\"\nconst KeyboardKeyInput = lazy(() => import(\"../../ui/KeyboardKeyInput\"))\n\nexport interface KeyboardFieldValue {\n    selector: number\n    modifiers: HidKeyboardModifiers\n}\n\nexport default class KeyboardKeyField extends ReactField<KeyboardFieldValue> {\n    static KEY = \"jacdac_field_keyboard_key\"\n\n    static fromJson(options: ReactFieldJSON) {\n        return new KeyboardKeyField(options?.value, undefined, options)\n    }\n\n    get defaultValue() {\n        return { selector: 4, modifiers: 0 }\n    }\n\n    getText_() {\n        const { selector, modifiers } = this.value\n        return renderKeyboardKey(selector, modifiers, true)\n    }\n\n    renderField(): ReactNode {\n        const { selector, modifiers } = this.value\n        const handleChange = (\n            newSelector: number,\n            newModifiers: HidKeyboardModifiers\n        ) => {\n            this.value = { selector: newSelector, modifiers: newModifiers }\n        }\n        return (\n            <Suspense>\n                <KeyboardKeyInput\n                    initialSelector={selector}\n                    initialModifiers={modifiers}\n                    onChange={handleChange}\n                />\n            </Suspense>\n        )\n    }\n}\n","import React, { lazy, ReactNode, useContext } from \"react\"\nimport Suspense from \"../../ui/Suspense\"\nimport ReactField, { ReactFieldJSON, toShadowDefinition } from \"./ReactField\"\nimport { rgbToHtmlColor } from \"../../../../jacdac-ts/src/jdom/utils\"\nimport { child } from \"../../widgets/svg\"\nimport ValueContext, { ValueContextProps } from \"./ValueContext\"\n\nconst LEDWidget = lazy(() => import(\"../../widgets/LEDWidget\"))\n\nfunction LEDColorFieldWidget() {\n    const { value, onValueChange } =\n        useContext<ValueContextProps<number>>(ValueContext)\n    return (\n        <Suspense>\n            <LEDWidget\n                ledColor={value}\n                onLedColorChange={onValueChange}\n                ledCount={3}\n                color=\"secondary\"\n            />\n        </Suspense>\n    )\n}\n\nexport default class LEDColorField extends ReactField<number> {\n    static KEY = \"jacdac_field_led_color\"\n    static SHADOW = toShadowDefinition(LEDColorField)\n\n    static fromJson(options: ReactFieldJSON) {\n        return new LEDColorField(options)\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    constructor(options?: any) {\n        super(options?.value, undefined, options, { width: 28, height: 28 })\n    }\n\n    protected initCustomView() {\n        const { width } = this.size_\n        const r = width >> 1\n        return child(this.fieldGroup_, \"circle\", {\n            r: width >> 1,\n            cx: r,\n            cy: r,\n            strokeWidth: 2,\n            stroke: \"#777\",\n        }) as SVGCircleElement\n    }\n\n    updateView() {\n        const c = rgbToHtmlColor(this.value)\n        const circle = this.view as SVGCircleElement\n        if (c) {\n            circle?.setAttribute(\"fill\", c)\n        }\n    }\n\n    getText_() {\n        return rgbToHtmlColor(this.value)\n    }\n\n    renderField(): ReactNode {\n        return <LEDColorFieldWidget />\n    }\n}\n","import ReactField from \"./ReactField\"\nimport { child } from \"../../widgets/svg\"\nimport { utils } from \"blockly\"\n\nexport default class ReactImageField<T> extends ReactField<T> {\n    constructor(value: string, width = 32, height = 32) {\n        super(value, undefined, undefined, { width, height })\n    }\n\n    setSize(width: number, height: number) {\n        this.size_ = new utils.Size(width, height)\n        const img = this.view as SVGImageElement\n        if (img) {\n            img.setAttribute(\"width\", width + \"\")\n            img.setAttribute(\"height\", height + \"\")\n        }\n    }\n\n    protected updateView() {\n        const imgUri = this.renderValue()\n        const img = this.view as SVGImageElement\n        if (imgUri) {\n            img?.setAttributeNS(\n                \"http://www.w3.org/1999/xlink\",\n                \"xlink:href\",\n                imgUri\n            )\n            img?.setAttribute(\"alt\", this.getText())\n        }\n    }\n\n    /**\n     * Renders the value to a data uri string\n     */\n    protected renderValue(): string {\n        return undefined\n    }\n\n    protected initCustomView() {\n        const { width, height } = this.size_\n        return child(this.fieldGroup_, \"image\", {\n            height,\n            width,\n            alt: this.getText(),\n        }) as SVGImageElement\n    }\n}\n","import React, { lazy, ReactNode } from \"react\"\nimport { fromHex, toHex } from \"../../../../jacdac-ts/src/jdom/utils\"\nimport Suspense from \"../../ui/Suspense\"\nimport { ReactFieldJSON, VALUE_CHANGE } from \"./ReactField\"\nimport ReactImageField from \"./ReactImageField\"\nconst LEDMatrixWidget = lazy(() => import(\"../../widgets/LEDMatrixWidget\"))\n\nexport interface LEDMatrixFieldValue {\n    // hex data\n    leds: string\n    rows: number\n    columns: number\n}\n\nexport default class LEDMatrixField extends ReactImageField<LEDMatrixFieldValue> {\n    static KEY = \"jacdac_field_led_matrix\"\n\n    constructor(value: string) {\n        super(value)\n\n        this.events.on(VALUE_CHANGE, () => {\n            const { rows, columns } = this.value\n            this.setSize(32, (32 / columns) * rows)\n        })\n    }\n\n    static fromJson(options: ReactFieldJSON) {\n        return new LEDMatrixField(options?.value)\n    }\n\n    get defaultValue() {\n        return {\n            leds: toHex(new Uint8Array(0)),\n            rows: 5,\n            columns: 5,\n        }\n    }\n\n    getText_() {\n        const { leds, rows, columns } = this.value\n        return `${leds} (${rows}x${columns})`\n    }\n\n    renderValue(): string {\n        const { leds, rows, columns } = this.value\n        // render current state to LEDmatrix field\n        const columnspadded = columns + (8 - (columns % 8))\n        const ledsBytes = fromHex(leds)\n        const cvs = document.createElement(\"canvas\")\n        const b = 3\n        const pw = 8\n        const ph = 8\n        const w = rows * pw + (rows - 1) * b\n        const h = columns * ph + (columns - 1) * b\n        cvs.width = w + 2 * b\n        cvs.height = h + 2 * b\n        const ctx = cvs.getContext(\"2d\")\n        ctx.fillStyle = \"#444\"\n        ctx.fillRect(b, b, w, h)\n        ctx.fillStyle = \"blue\"\n        for (let x = 0; x < columns; ++x) {\n            for (let y = 0; y < rows; ++y) {\n                const bitindex = y * columnspadded + x\n                const byte = ledsBytes[bitindex >> 3]\n                const bit = bitindex % 8\n                const on = 1 === ((byte >> bit) & 1)\n                ctx.fillStyle = on ? \"#ffc400\" : \"#000\"\n                ctx.fillRect(x * (pw + b) + b, y * (ph + b) + b, pw, ph)\n            }\n        }\n        const dataUri = cvs.toDataURL(\"image/png\")\n        return dataUri\n    }\n\n    renderField(): ReactNode {\n        const { leds, rows, columns } = this.value\n        const ledsBytes = fromHex(leds)\n        console.log(`led bytes`, { leds, ledsBytes })\n        const onChange = (newLeds: Uint8Array) =>\n            (this.value = {\n                leds: toHex(newLeds),\n                rows,\n                columns,\n            })\n        return (\n            <Suspense>\n                <LEDMatrixWidget\n                    color=\"secondary\"\n                    brightness={1}\n                    leds={ledsBytes}\n                    rows={rows}\n                    columns={columns}\n                    onChange={onChange}\n                />\n            </Suspense>\n        )\n    }\n}\n","import React, { lazy } from \"react\"\nimport Suspense from \"../../ui/Suspense\"\nimport { ReactFieldJSON } from \"./ReactField\"\nimport ReactInlineField from \"./ReactInlineField\"\nconst LogViewWidget = lazy(() => import(\"./LogViewWidget\"))\n\nexport default class LogViewField extends ReactInlineField {\n    static KEY = \"jacdac_field_log_view\"\n    EDITABLE = false\n\n    static fromJson(options: ReactFieldJSON) {\n        return new LogViewField(options)\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    constructor(options?: any) {\n        super(options)\n    }\n\n    renderInlineField() {\n        return (\n            <Suspense>\n                <LogViewWidget />\n            </Suspense>\n        )\n    }\n}\n","import React, { useContext } from \"react\"\nimport { Button } from \"@material-ui/core\"\nimport AddIcon from \"@material-ui/icons/Add\"\nimport { startServiceProviderFromServiceClass } from \"../../../../jacdac-ts/src/servers/servers\"\nimport JacdacContext, { JacdacContextProps } from \"../../../jacdac/Context\"\nimport WorkspaceContext from \"../WorkspaceContext\"\nimport { serviceSpecificationFromClassIdentifier } from \"../../../../jacdac-ts/src/jdom/spec\"\nimport { Alert } from \"@material-ui/lab\"\n\nexport default function NoServiceAlert() {\n    const { bus } = useContext<JacdacContextProps>(JacdacContext)\n    const { roleService, roleServiceClass, flyout } =\n        useContext(WorkspaceContext)\n    const spec = serviceSpecificationFromClassIdentifier(roleServiceClass)\n    const handleStartSimulator = () =>\n        startServiceProviderFromServiceClass(bus, spec.classIdentifier)\n\n    // nothing to do here\n    if (roleService || flyout) return null\n\n    // unresolved, unknown service\n    if (!roleService && !roleServiceClass) return null\n\n    // unknown spec\n    if (!spec) return <Alert severity=\"warning\">Unknown service</Alert>\n\n    return (\n        <Button\n            variant=\"outlined\"\n            color=\"default\"\n            startIcon={<AddIcon />}\n            onClick={handleStartSimulator}\n        >\n            start {spec.name}\n        </Button>\n    )\n}\n","import React, { lazy, ReactNode } from \"react\"\nimport { createToneContext, ToneContext } from \"../../ui/WebAudioContext\"\nimport Suspense from \"../../ui/Suspense\"\nimport ReactField, {\n    ReactFieldJSON,\n    toShadowDefinition,\n} from \"./ReactField\"\nconst PianoWidget = lazy(() => import(\"../../widgets/PianoWidget\"))\n\nexport default class NoteField extends ReactField<number> {\n    static KEY = \"jacdac_field_note\"\n    static SHADOW = toShadowDefinition(NoteField)\n    toneContext: ToneContext\n\n    static fromJson(options: ReactFieldJSON) {\n        return new NoteField(options)\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    constructor(options?: any) {\n        super(options?.value, undefined, options)\n    }\n\n    get defaultValue() {\n        return 440\n    }\n\n    getText_() {\n        return (this.value | 0) + \"\"\n    }\n\n    renderField(): ReactNode {\n        const handlePlayTone = async (newFrequency: number) => {\n            this.value = newFrequency\n            if (!this.toneContext) this.toneContext = createToneContext()\n            this.toneContext?.playTone(newFrequency, 400, 0.5)\n        }\n        return (\n            <Suspense>\n                <PianoWidget playTone={handlePlayTone} />\n            </Suspense>\n        )\n    }\n}\n","import React, { PointerEvent, ReactNode, useContext } from \"react\"\nimport WorkspaceContext from \"../WorkspaceContext\"\n\nexport function PointerBoundary(props: {\n    className?: string\n    children: ReactNode\n}) {\n    const { dragging } = useContext(WorkspaceContext)\n    const { className, children } = props\n    const onPointerStopPropagation = (event: PointerEvent<HTMLDivElement>) => {\n        // make sure blockly does not handle drags when interacting with UI\n        if (!dragging) event.stopPropagation()\n    }\n    return (\n        <div\n            className={className}\n            style={dragging ? undefined : { cursor: \"inherit\" }}\n            onPointerDown={dragging ? undefined : onPointerStopPropagation}\n            onPointerUp={dragging ? undefined : onPointerStopPropagation}\n            onPointerMove={dragging ? undefined : onPointerStopPropagation}\n        >\n            {children}\n        </div>\n    )\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\nimport React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport Blockly from \"blockly\"\nimport JacdacProvider from \"../../../jacdac/Provider\"\nimport { ReactNode } from \"react\"\nimport { IdProvider } from \"react-use-id-hook\"\nimport DarkModeProvider from \"../../ui/DarkModeProvider\"\nimport AppTheme from \"../../ui/AppTheme\"\nimport { Box } from \"@material-ui/core\"\nimport { BlockDefinition } from \"../toolbox\"\nimport { assert } from \"../../../../jacdac-ts/src/jdom/utils\"\nimport { ValueProvider } from \"./ValueContext\"\nimport JDEventSource from \"../../../../jacdac-ts/src/jdom/eventsource\"\nimport { CHANGE } from \"../../../../jacdac-ts/src/jdom/constants\"\nimport {\n    BlockServices,\n    BlockWithServices,\n    FieldWithServices,\n    WorkspaceProvider,\n} from \"../WorkspaceContext\"\nimport { WebAudioProvider } from \"../../ui/WebAudioContext\"\nimport { ReactFieldBase } from \"./ReactFieldBase\"\n\ndeclare module \"blockly\" {\n    interface Block {\n        getColourTertiary(): string\n    }\n}\n\nexport type ReactFieldJSON = any\n\nexport const SOURCE_BLOCK_CHANGE = \"sourceBlockChange\"\nexport const VALUE_CHANGE = \"valueChange\"\nexport const MOUNT = \"mount\"\nexport const UNMOUNT = \"unmount\"\n\n\nexport default class ReactField<T> extends ReactFieldBase<T> {\n    SERIALIZABLE = true\n    public readonly events = new JDEventSource()\n    protected div_: Element\n    protected view: SVGElement\n    protected darkMode: \"light\" | \"dark\" = \"dark\"\n\n\n    // override to support custom view\n    protected initCustomView(): SVGElement {\n        return null\n    }\n\n    // override to update view\n    protected updateView() {}\n\n    getText_() {\n        return JSON.stringify(this.value)\n    }\n\n    toXml(fieldElement: Element) {\n        fieldElement.textContent = JSON.stringify(this.value)\n        return fieldElement\n    }\n\n    fromXml(fieldElement: Element) {\n        try {\n            const v = JSON.parse(fieldElement.textContent)\n            this.value = v\n        } catch (e) {\n            console.log(e, { text: fieldElement.textContent })\n            this.value = undefined\n        }\n    }\n\n    emitChange() {\n        this.events.emit(CHANGE)\n    }\n\n    setSourceBlock(block: Blockly.Block) {\n        const changed = block !== this.sourceBlock_\n        super.setSourceBlock(block)\n        if (changed && !block?.isInsertionMarker()) {\n            const bs = block as unknown as BlockWithServices\n            if (!bs.jacdacServices) {\n                bs.jacdacServices = new BlockServices()\n                bs.inputList?.forEach(i =>\n                    i.fieldRow?.forEach(f =>\n                        (\n                            f as unknown as FieldWithServices\n                        ).notifyServicesChanged?.()\n                    )\n                )\n            }\n            this.events.emit(SOURCE_BLOCK_CHANGE, block)\n            this.emitChange()\n        }\n    }\n\n    initView() {\n        this.view = this.initCustomView()\n        if (this.view) this.updateView()\n        else super.initView()\n    }\n\n    updateSize_() {\n        if (!this.view) super.updateSize_()\n    }\n\n    doValueUpdate_(newValue: string) {\n        const change = this.value_ !== newValue\n        if (this.view) {\n            this.value_ = newValue\n            this.updateView()\n        } else super.doValueUpdate_(newValue)\n        if (change) {\n            this.events.emit(VALUE_CHANGE, this.value)\n            this.emitChange()\n        }\n    }\n\n    showEditor_() {\n        this.div_ = Blockly.DropDownDiv.getContentDiv()\n        ReactDOM.render(this.render(), this.div_)\n        const border = this.sourceBlock_.getColourTertiary()\n        Blockly.DropDownDiv.setColour(this.sourceBlock_.getColour(), border)\n\n        // the div_ size has not been computed yet, so let the browse handle this\n        setTimeout(() => {\n            Blockly.DropDownDiv.showPositionedByField(\n                this,\n                this.dropdownDispose_.bind(this)\n            )\n            this.events.emit(MOUNT)\n        }, 200)\n    }\n\n    hide() {\n        Blockly.DropDownDiv.hideIfOwner(this, true)\n    }\n\n    dropdownDispose_() {\n        // this blows on hot reloads\n        try {\n            this.events.emit(UNMOUNT)\n            ReactDOM.unmountComponentAtNode(this.div_)\n        } catch (e) {\n            console.error(e)\n        }\n    }\n\n    render() {\n        const onValueChange = (newValue: any) => (this.value = newValue)\n        return (\n            <WorkspaceProvider field={this}>\n                <DarkModeProvider fixedDarkMode={this.darkMode}>\n                    <IdProvider>\n                        <WebAudioProvider>\n                            <JacdacProvider>\n                                <AppTheme>\n                                    <ValueProvider\n                                        value={this.value}\n                                        onValueChange={onValueChange}\n                                    >\n                                        <Box\n                                            m={0.5}\n                                            borderRadius={\"0.25rem\"}\n                                            bgcolor=\"background.paper\"\n                                        >\n                                            {this.renderField()}\n                                        </Box>\n                                    </ValueProvider>\n                                </AppTheme>\n                            </JacdacProvider>\n                        </WebAudioProvider>\n                    </IdProvider>\n                </DarkModeProvider>\n            </WorkspaceProvider>\n        )\n    }\n\n    renderField(): ReactNode {\n        return <span>not implemented</span>\n    }\n\n    dispose() {\n        this.view = undefined\n        super.dispose()\n    }\n}\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport function toShadowDefinition(fieldType: any): BlockDefinition {\n    assert(!!fieldType.KEY)\n    const type = fieldType.KEY + \"_shadow\"\n    return {\n        kind: \"block\",\n        type,\n        message0: `%1`,\n        args0: [\n            {\n                type: fieldType.KEY,\n                name: \"value\",\n            },\n        ],\n        style: \"math_blocks\",\n        output: \"Number\",\n        template: \"shadow\",\n    }\n}\n","import Blockly from \"blockly\"\n\nexport class ReactFieldBase<T> extends Blockly.Field {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    constructor(\n        value: string,\n        validator?: any,\n        options?: any,\n        size?: { width: number; height: number }\n    ) {\n        super(value, validator, options)\n        if (size) this.size_ = new Blockly.utils.Size(size.width, size.height)\n    }\n\n    get defaultValue(): T {\n        return {} as T\n    }\n\n    get value(): T {\n        try {\n            const v = JSON.parse(this.getValue())\n            return (v || this.defaultValue) as T\n        } catch (e) {\n            console.warn(e)\n            return this.defaultValue\n        }\n    }\n\n    set value(v: T) {\n        this.setValue(JSON.stringify(v))\n    }\n}","import React, { ReactNode } from \"react\"\nimport ReactDOM from \"react-dom\"\nimport ReactField from \"./ReactField\"\nimport { child } from \"../../widgets/svg\"\nimport DarkModeProvider from \"../../ui/DarkModeProvider\"\nimport { IdProvider } from \"react-use-id-hook\"\nimport JacdacProvider from \"../../../jacdac/Provider\"\nimport AppTheme from \"../../ui/AppTheme\"\nimport Blockly, { Events } from \"blockly\"\nimport { WorkspaceProvider } from \"../WorkspaceContext\"\nimport { WebAudioProvider } from \"../../ui/WebAudioContext\"\n\nexport default class ReactInlineField extends ReactField<unknown> {\n    protected container: HTMLDivElement\n    protected resizeObserver: ResizeObserver\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    constructor(options?: any) {\n        super(options?.value, undefined, options, { width: 1, height: 1 })\n    }\n\n    protected createContainer(): HTMLDivElement {\n        const c = document.createElement(\"div\")\n        c.style.display = \"inline-block\"\n        c.style.minWidth = \"14rem\"\n        return c\n    }\n\n    protected initCustomView() {\n        const { width, height } = this.size_\n        const fo = child(this.fieldGroup_, \"foreignObject\", {\n            x: 0,\n            y: 0,\n            width,\n            height,\n        }) as SVGForeignObjectElement\n\n        this.container = this.createContainer()\n        fo.appendChild(this.container)\n\n        this.resizeObserver = new ResizeObserver(\n            (entries: ResizeObserverEntry[]) => {\n                const entry = entries[0]\n                const { contentRect } = entry\n                this.size_.width = contentRect.width\n                this.size_.height = contentRect.height\n                fo.setAttribute(\"width\", this.size_.width + \"\")\n                fo.setAttribute(\"height\", this.size_.height + \"\")\n                this.forceRerender()\n                const b = this.sourceBlock_\n                if (b?.workspace) {\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                    const ev = new (Events.get(Events.BLOCK_MOVE) as any)(b)\n                    Events.fire(ev)\n                }\n            }\n        )\n        this.resizeObserver.observe(this.container)\n\n        ReactDOM.render(this.renderBlock(), this.container)\n        return fo\n    }\n\n    dispose() {\n        if (this.container) {\n            ReactDOM.unmountComponentAtNode(this.container)\n            this.container = undefined\n        }\n        if (this.resizeObserver) {\n            this.resizeObserver.disconnect()\n            this.resizeObserver = undefined\n        }\n        super.dispose()\n    }\n\n    renderField(): ReactNode {\n        return <div>not used</div>\n    }\n\n    renderInlineField(): ReactNode {\n        return null\n    }\n\n    renderBlock(): ReactNode {\n        return (\n            <WorkspaceProvider field={this}>\n                <DarkModeProvider fixedDarkMode=\"dark\">\n                    <IdProvider>\n                        <WebAudioProvider>\n                            <JacdacProvider>\n                                <AppTheme>{this.renderInlineField()}</AppTheme>\n                            </JacdacProvider>\n                        </WebAudioProvider>\n                    </IdProvider>\n                </DarkModeProvider>\n            </WorkspaceProvider>\n        )\n    }\n\n    getText_() {\n        return \"...\"\n    }\n\n    // don't bind any mouse event\n    bindEvents_() {\n        Blockly.Tooltip.bindMouseEvents(this.getClickTarget_())\n    }\n}\n","import { Grid, Slider } from \"@material-ui/core\"\nimport React, { ReactNode, useContext } from \"react\"\nimport ReactField from \"./ReactField\"\nimport ValueContext, { ValueContextProps } from \"./ValueContext\"\n\nfunction FieldWithSlider(props: { children: ReactNode }) {\n    const { children } = props\n    const { value, onValueChange } =\n        useContext<ValueContextProps<number>>(ValueContext)\n    const handleChange = async (ev: unknown, nv: number | number[]) => {\n        const newValue = nv as number\n        onValueChange(newValue)\n    }\n    return (\n        <Grid container spacing={1}>\n            <Grid item xs={12}>\n                {children}\n            </Grid>\n            <Grid item xs={12}>\n                <Slider\n                    color=\"secondary\"\n                    valueLabelDisplay=\"auto\"\n                    valueLabelFormat={`${Math.round(value)}`}\n                    min={-90}\n                    max={90}\n                    step={5}\n                    value={value}\n                    onChange={handleChange}\n                    aria-label=\"angle\"\n                />\n            </Grid>\n        </Grid>\n    )\n}\n\nexport default class SliderField extends ReactField<number> {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    constructor(value: string, options?: any) {\n        super(value, undefined, options)\n    }\n\n    get defaultValue() {\n        return 0\n    }\n\n    getText_() {\n        return this.value + \"\"\n    }\n\n    renderField(): ReactNode {\n        return <FieldWithSlider>{this.renderWidget()}</FieldWithSlider>\n    }\n\n    renderWidget(): ReactNode {\n        return null\n    }\n}\n","import React, { lazy, ReactNode, useContext } from \"react\"\nimport SliderField from \"./SliderField\"\nimport Suspense from \"../../ui/Suspense\"\nimport { ReactFieldJSON, toShadowDefinition } from \"./ReactField\"\nimport ValueContext, { ValueContextProps } from \"./ValueContext\"\n\nconst ServoWidget = lazy(() => import(\"../../widgets/ServoWidget\"))\n\nfunction ServiceFieldWidget() {\n    const { value } =\n        useContext<ValueContextProps<number>>(ValueContext)\n    return (\n        <Suspense>\n            <ServoWidget\n                angle={value}\n                offset={0}\n                color=\"secondary\"\n                enabled={true}\n            />\n        </Suspense>\n    )\n}\n\nexport default class ServoAngleField extends SliderField {\n    static KEY = \"jacdac_field_servo_angle\"\n    static SHADOW = toShadowDefinition(ServoAngleField)\n\n    static fromJson(options: ReactFieldJSON) {\n        return new ServoAngleField(options?.value, options)\n    }\n\n    getText_() {\n        return this.value + \"\"\n    }\n\n    renderWidget(): ReactNode {\n        return <ServiceFieldWidget />\n    }\n}\n","import React, { lazy } from \"react\"\nimport Suspense from \"../../ui/Suspense\"\nimport { ReactFieldJSON } from \"./ReactField\"\nimport ReactInlineField from \"./ReactInlineField\"\nconst TwinWidget = lazy(() => import(\"./TwinWidget\"))\n\nexport default class TwinField extends ReactInlineField {\n    static KEY = \"jacdac_field_twin\"\n    EDITABLE = false\n\n    static fromJson(options: ReactFieldJSON) {\n        return new TwinField(options)\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    constructor(options?: any) {\n        super(options)\n    }\n\n    renderInlineField() {\n        return (\n            <Suspense>\n                <TwinWidget />\n            </Suspense>\n        )\n    }\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { Block, FieldDropdown } from \"blockly\"\nimport { CHANGE } from \"../../../../jacdac-ts/src/jdom/constants\"\nimport type { TFModelObj } from \"../../../workers/tf/dist/node_modules/tf.worker\"\n\nimport { resolveWorkspaceServices } from \"../WorkspaceContext\"\nimport { ReactFieldJSON } from \"./ReactField\"\n\nexport default class UseModelField extends FieldDropdown {\n    static KEY = \"jacdac_field_mlblocks_model_open\"\n    SERIALIZABLE = true\n    // eslint-disable-next-line @typescript-eslint/ban-types\n    private _models: Record<string, TFModelObj>\n    private _unmount: () => void\n\n    static fromJson(options: ReactFieldJSON) {\n        return new UseModelField(options)\n    }\n\n    constructor(options?: ReactFieldJSON) {\n        super(() => [[\"\", \"\"]], undefined, options)\n        this._models = {}\n    }\n\n    fromXml(fieldElement: Element) {\n        this.setValue(fieldElement.textContent)\n    }\n\n    getOptions(): string[][] {\n        let options = []\n        if (this._models) options = Object.keys(this._models).map(m => [m, m])\n        const value = this.getValue()\n\n        return options.length < 1\n            ? [[value || \"\", value || \"\"]]\n            : [...options, [\"\", \"\"]]\n    }\n\n    doClassValidation_(newValue?: string) {\n        // skip super class validation\n        return newValue\n    }\n\n    init() {\n        super.init()\n        this.populateModels()\n    }\n\n    setSourceBlock(block: Block) {\n        super.setSourceBlock(block)\n        this.populateModels()\n    }\n\n    doValueUpdate_(newValue) {\n        super.doValueUpdate_(newValue)\n    }\n\n    notifyServicesChanged() {\n        this.populateModels()\n    }\n\n    dispose() {\n        super.dispose()\n        this.unmount()\n    }\n\n    private resolveFiles() {\n        const sourceBlock = this.getSourceBlock()\n        const services = resolveWorkspaceServices(sourceBlock?.workspace)\n        const directory = services?.workingDirectory\n        return directory?.files.filter(f => /\\.json$/i.test(f.name))\n    }\n\n    private async populateModels() {\n        const files = this.resolveFiles()\n        if (!files) return\n\n        files.forEach(async file => {\n            if (file) {\n                try {\n                    // grab the content of the JSON file\n                    const source = await file.textAsync()\n                    const model = JSON.parse(source)\n\n                    if (model && model.status == \"trained\")\n                        this._models[file.name] = model\n                } catch (e) {\n                    console.log(e)\n                }\n            }\n        })\n    }\n\n    async getModel() {\n        const filename = this.getValue()\n\n        let selectedModel = this._models[filename]\n        if (!selectedModel) {\n            // if that did not work, refresh model list and try again\n            this.populateModels()\n            selectedModel = this._models[filename]\n        }\n\n        // if that did not work, this model cannot be loaded\n        if (!selectedModel) this.value_ = undefined\n\n        return selectedModel\n    }\n\n    private unmount() {\n        if (this._unmount) {\n            this._unmount()\n            this._unmount = undefined\n        }\n    }\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\nimport React, { createContext, ReactNode, useState } from \"react\"\n\nexport interface ValueContextProps<T = any> {\n    value: T\n    onValueChange: (value: T) => void\n}\n\nexport const ValueContext = createContext<ValueContextProps>({\n    value: undefined,\n    onValueChange: undefined,\n})\nValueContext.displayName = \"Value\"\n\nexport default ValueContext\n\nexport function ValueProvider(props: {\n    value: any\n    onValueChange?: (newValue: any) => any\n    children: ReactNode\n}) {\n    const {\n        children,\n        value: initialValue,\n        onValueChange: onFieldValueChange,\n    } = props\n    const [value, setValue] = useState<any>(initialValue)\n    const onValueChange = (newValue: any) => {\n        setValue(newValue)\n        onFieldValueChange?.(newValue)\n    }\n    return (\n        // eslint-disable-next-line react/react-in-jsx-scope\n        <ValueContext.Provider value={{ value, onValueChange }}>\n            {children}\n        </ValueContext.Provider>\n    )\n}\n","import { createStyles, makeStyles, Theme } from \"@material-ui/core\"\nimport React, { useContext, useEffect, useState } from \"react\"\nimport { VM_GLOBAL_CHANGE } from \"../../../../jacdac-ts/src/vm/events\"\nimport { atomic } from \"../../../../jacdac-ts/src/vm/runner\"\nimport WorkspaceContext from \"../WorkspaceContext\"\nimport { ReactFieldJSON } from \"./ReactField\"\nimport ReactInlineField from \"./ReactInlineField\"\n\nconst useStyles = makeStyles((theme: Theme) =>\n    createStyles({\n        table: {\n            padding: 0,\n            margin: 0,\n            fontSize: \"0.9rem\",\n            lineHeight: \"1rem\",\n            color: theme.palette.text.primary,\n\n            \"& td\": {\n                borderColor: \"#ccc\",\n            },\n        },\n    })\n)\n\nfunction VariablesWidget() {\n    const { runner } = useContext(WorkspaceContext)\n    const classes = useStyles()\n    const [variables, setVariables] = useState<\n        { name: string; value: atomic }[]\n    >(runner?.globals())\n    useEffect(\n        () =>\n            runner?.subscribe(VM_GLOBAL_CHANGE, () =>\n                setVariables(runner.globals())\n            ),\n        [runner]\n    )\n\n    return (\n        <>\n            {variables && (\n                <table className={classes.table}>\n                    <tbody>\n                        {variables?.map(({ name, value }) => (\n                            <tr key={name}>\n                                <td>{name}</td>\n                                <td>{value}</td>\n                            </tr>\n                        ))}\n                    </tbody>\n                </table>\n            )}\n        </>\n    )\n}\n\nexport default class VariablesField extends ReactInlineField {\n    static KEY = \"jacdac_field_variables_view\"\n    EDITABLE = false\n\n    static fromJson(options: ReactFieldJSON) {\n        return new VariablesField(options)\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    constructor(options?: any) {\n        super(options)\n    }\n\n    renderInlineField() {\n        return <VariablesWidget />\n    }\n}\n","import React, { useContext, useEffect, useState } from \"react\"\nimport { ReactFieldJSON } from \"./ReactField\"\nimport { Box, Grid, Typography, useTheme } from \"@material-ui/core\"\nimport WorkspaceContext from \"../WorkspaceContext\"\nimport ReactInlineField from \"./ReactInlineField\"\nimport { PointerBoundary } from \"./PointerBoundary\"\nimport { WatchValueType } from \"../../../../jacdac-ts/src/vm/runner\"\nimport { VM_WATCH_CHANGE } from \"../../../../jacdac-ts/src/vm/events\"\nimport { roundWithPrecision } from \"../../../../jacdac-ts/src/jdom/utils\"\nimport useBlockData from \"../useBlockData\"\nimport JacdacContext, { JacdacContextProps } from \"../../../jacdac/Context\"\nimport SwitchWithLabel from \"../../ui/SwitchWithLabel\"\n\nconst HORIZON = 10\nfunction WatchValueWidget() {\n    const { bus } = useContext<JacdacContextProps>(JacdacContext)\n    const { runner, sourceId, sourceBlock } = useContext(WorkspaceContext)\n    const { data, setData } = useBlockData<{\n        time: number\n        value: number\n    }>(sourceBlock, [])\n    const theme = useTheme()\n\n    // track changes\n    const [value, setValue] = useState<WatchValueType>(\n        runner?.lookupWatch(sourceId)\n    )\n\n    useEffect(\n        () =>\n            runner?.subscribe(VM_WATCH_CHANGE, (watchSourceId: string) => {\n                if (watchSourceId === sourceId) {\n                    const newValue = runner.lookupWatch(sourceId)\n                    setValue(newValue)\n                    if (!isNaN(newValue)) {\n                        const newData = [\n                            ...(data || []),\n                            { time: bus.timestamp / 1000, value: newValue },\n                        ].slice(-HORIZON)\n                        setData(newData)\n                    }\n                }\n            }),\n        [runner, sourceId, data]\n    )\n\n    let valueNumber = typeof value === \"number\" ? (value as number) : undefined\n    if (!isNaN(valueNumber)) {\n        const step = Math.ceil(Math.abs(valueNumber)) / 10\n        const precision = step < 1 ? Math.ceil(-Math.log10(step)) : 0\n        valueNumber = roundWithPrecision(valueNumber, precision)\n    }\n\n    return (\n        <Box\n            bgcolor={theme.palette.background.paper}\n            borderRadius={theme.spacing(1)}\n            color={theme.palette.text.primary}\n        >\n            <Grid\n                container\n                alignItems=\"flex-end\"\n                alignContent=\"center\"\n                justifyContent=\"center\"\n                spacing={1}\n            >\n                <Grid item>\n                    <PointerBoundary>\n                        {!isNaN(valueNumber) ? (\n                            <Typography variant=\"body1\">\n                                {valueNumber}\n                            </Typography>\n                        ) : typeof value === \"boolean\" ? (\n                            <Box pl={1}>\n                                <SwitchWithLabel\n                                    readOnly={true}\n                                    checked={!!value}\n                                    label={value ? \"true\" : \"false\"}\n                                />\n                            </Box>\n                        ) : (\n                            <Typography variant=\"body1\">\n                                {value === undefined ? \"...\" : value + \"\"}\n                            </Typography>\n                        )}\n                    </PointerBoundary>\n                </Grid>\n            </Grid>\n        </Box>\n    )\n}\n\nexport default class WatchValueField extends ReactInlineField {\n    static KEY = \"jacdac_field_watch_value\"\n    EDITABLE = false\n\n    static fromJson(options: ReactFieldJSON) {\n        return new WatchValueField(options)\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    constructor(options?: any) {\n        super(options)\n    }\n\n    protected createContainer(): HTMLDivElement {\n        const c = document.createElement(\"div\")\n        c.style.display = \"inline-block\"\n        c.style.minWidth = \"4rem\"\n        return c\n    }\n\n    renderInlineField() {\n        return <WatchValueWidget />\n    }\n}\n","import React, { useContext } from \"react\"\nimport WorkspaceContext from \"../../WorkspaceContext\"\nimport { ReactFieldJSON } from \"../ReactField\"\nimport ReactInlineField from \"../ReactInlineField\"\nimport useBlockData from \"../../useBlockData\"\nimport type { VisualizationSpec } from \"react-vega\"\nimport VegaLiteWidget from \"./VegaLiteWidget\"\nimport { tidyResolveHeader } from \"../tidy\"\nimport { BAR_CORNER_RADIUS, BAR_MAX_ITEMS } from \"../../toolbox\"\n\nfunction BarWidget() {\n    const { sourceBlock } = useContext(WorkspaceContext)\n    const { data } = useBlockData(sourceBlock)\n    const index = tidyResolveHeader(data, sourceBlock?.getFieldValue(\"index\"))\n    const value = tidyResolveHeader(\n        data,\n        sourceBlock?.getFieldValue(\"value\"),\n        \"number\"\n    )\n    if (!index || !value) return null\n\n    const sliceOptions = {\n        sliceMax: BAR_MAX_ITEMS,\n    }\n    const spec: VisualizationSpec = {\n        mark: { type: \"bar\", cornerRadius: BAR_CORNER_RADIUS, tooltip: true },\n        encoding: {\n            x: { field: index, type: \"nominal\" },\n            y: { field: value, type: \"quantitative\" },\n        },\n        data: { name: \"values\" },\n    }\n    return <VegaLiteWidget spec={spec} slice={sliceOptions} />\n}\n\nexport default class BarField extends ReactInlineField {\n    static KEY = \"jacdac_field_bar_plot\"\n    EDITABLE = false\n\n    static fromJson(options: ReactFieldJSON) {\n        return new BarField(options)\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    constructor(options?: any) {\n        super(options)\n    }\n\n    renderInlineField() {\n        return <BarWidget />\n    }\n}\n","import React, { useContext } from \"react\"\nimport WorkspaceContext from \"../../WorkspaceContext\"\nimport { ReactFieldJSON } from \"../ReactField\"\nimport ReactInlineField from \"../ReactInlineField\"\nimport useBlockData from \"../../useBlockData\"\nimport type { VisualizationSpec } from \"react-vega\"\nimport VegaLiteWidget from \"./VegaLiteWidget\"\nimport { tidyResolveHeader } from \"../tidy\"\nimport { BAR_CORNER_RADIUS } from \"../../toolbox\"\n\nfunction BoxPlotWidget() {\n    const { sourceBlock } = useContext(WorkspaceContext)\n    const { data } = useBlockData(sourceBlock)\n    const index = tidyResolveHeader(data, sourceBlock?.getFieldValue(\"index\"))\n    const value = tidyResolveHeader(\n        data,\n        sourceBlock?.getFieldValue(\"value\"),\n        \"number\"\n    )\n    if (!index || !value) return null\n\n    const spec: VisualizationSpec = {\n        mark: {\n            type: \"boxplot\",\n            cornerRadius: BAR_CORNER_RADIUS,\n            tooltip: true,\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        } as any,\n        encoding: {\n            x: { field: index, type: \"nominal\", scale: { zero: false } },\n            y: { field: value, type: \"quantitative\", scale: { zero: false } },\n        },\n        data: { name: \"values\" },\n    }\n\n    return <VegaLiteWidget spec={spec} />\n}\n\nexport default class BoxPlotField extends ReactInlineField {\n    static KEY = \"jacdac_field_box_plot\"\n    EDITABLE = false\n\n    static fromJson(options: ReactFieldJSON) {\n        return new BoxPlotField(options)\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    constructor(options?: any) {\n        super(options)\n    }\n\n    renderInlineField() {\n        return <BoxPlotWidget />\n    }\n}\n","import React, { useContext } from \"react\"\nimport WorkspaceContext from \"../../WorkspaceContext\"\nimport { ReactFieldJSON } from \"../ReactField\"\nimport ReactInlineField from \"../ReactInlineField\"\nimport useBlockData from \"../../useBlockData\"\nimport type { VisualizationSpec } from \"react-vega\"\nimport VegaLiteWidget from \"./VegaLiteWidget\"\nimport { tidyResolveHeader } from \"../tidy\"\nimport { LINE_MAX_ITEMS } from \"../../toolbox\"\n\nfunction HeatMapWidget() {\n    const { sourceBlock } = useContext(WorkspaceContext)\n    const { data } = useBlockData(sourceBlock)\n    const x = tidyResolveHeader(data, sourceBlock?.getFieldValue(\"x\"))\n    const y = tidyResolveHeader(data, sourceBlock?.getFieldValue(\"y\"))\n    const color = tidyResolveHeader(\n        data,\n        sourceBlock?.getFieldValue(\"color\"),\n        \"number\"\n    )\n    if (!x || !y || !color) return null\n\n    const sliceOptions = {\n        sliceHead: LINE_MAX_ITEMS,\n    }\n    const spec: VisualizationSpec = {\n        mark: { type: \"rect\", tooltip: true },\n        encoding: {\n            x: { field: x, type: \"ordinal\" },\n            y: { field: y, type: \"ordinal\" },\n            color: {\n                field: color,\n                type: \"quantitative\",\n                scale: { zero: false },\n            },\n        },\n        data: { name: \"values\" },\n    }\n    return <VegaLiteWidget spec={spec} slice={sliceOptions} />\n}\n\nexport default class HeatMapPlotField extends ReactInlineField {\n    static KEY = \"jacdac_field_heat_map\"\n    EDITABLE = false\n\n    static fromJson(options: ReactFieldJSON) {\n        return new HeatMapPlotField(options)\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    constructor(options?: any) {\n        super(options)\n    }\n\n    renderInlineField() {\n        return <HeatMapWidget />\n    }\n}\n","import React, { useContext } from \"react\"\nimport WorkspaceContext from \"../../WorkspaceContext\"\nimport { ReactFieldJSON } from \"../ReactField\"\nimport ReactInlineField from \"../ReactInlineField\"\nimport useBlockData from \"../../useBlockData\"\nimport type { VisualizationSpec } from \"react-vega\"\nimport VegaLiteWidget from \"./VegaLiteWidget\"\nimport { tidyResolveHeader } from \"../tidy\"\nimport { BAR_CORNER_RADIUS } from \"../../toolbox\"\n\nfunction HistogramWidget() {\n    const { sourceBlock } = useContext(WorkspaceContext)\n    const { data } = useBlockData(sourceBlock)\n    const index = tidyResolveHeader(data, sourceBlock?.getFieldValue(\"index\"))\n\n    if (!index) return null\n\n    const spec: VisualizationSpec = {\n        mark: { type: \"bar\", cornerRadius: BAR_CORNER_RADIUS, tooltip: true },\n        encoding: {\n            x: { bin: true, field: index },\n            y: { aggregate: \"count\" },\n        },\n        data: { name: \"values\" },\n    }\n\n    return <VegaLiteWidget spec={spec} />\n}\n\nexport default class HistogramField extends ReactInlineField {\n    static KEY = \"jacdac_field_histogram\"\n    EDITABLE = false\n\n    static fromJson(options: ReactFieldJSON) {\n        return new HistogramField(options)\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    constructor(options?: any) {\n        super(options)\n    }\n\n    renderInlineField() {\n        return <HistogramWidget />\n    }\n}\n","import React, { useContext } from \"react\"\nimport WorkspaceContext from \"../../WorkspaceContext\"\nimport { ReactFieldJSON } from \"../ReactField\"\nimport ReactInlineField from \"../ReactInlineField\"\nimport useBlockData from \"../../useBlockData\"\nimport type { VisualizationSpec } from \"react-vega\"\nimport VegaLiteWidget from \"./VegaLiteWidget\"\nimport { tidyResolveHeader } from \"../tidy\"\nimport { LINE_MAX_ITEMS } from \"../../toolbox\"\n\nfunction LinePlotWidget() {\n    const { sourceBlock } = useContext(WorkspaceContext)\n    const { data } = useBlockData(sourceBlock)\n    const x = tidyResolveHeader(data, sourceBlock?.getFieldValue(\"x\"), \"number\")\n    const y = tidyResolveHeader(data, sourceBlock?.getFieldValue(\"y\"), \"number\")\n    if (!x || !y) return null\n\n    const sliceOptions = {\n        sliceHead: LINE_MAX_ITEMS,\n    }\n    const spec: VisualizationSpec = {\n        mark: { type: \"line\", tooltip: true },\n        encoding: {\n            x: { field: x, type: \"quantitative\", scale: { zero: false } },\n            y: { field: y, type: \"quantitative\", scale: { zero: false } },\n        },\n        data: { name: \"values\" },\n    }\n    return <VegaLiteWidget spec={spec} slice={sliceOptions} />\n}\n\nexport default class LinePlotField extends ReactInlineField {\n    static KEY = \"jacdac_field_line_plot\"\n    EDITABLE = false\n\n    static fromJson(options: ReactFieldJSON) {\n        return new LinePlotField(options)\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    constructor(options?: any) {\n        super(options)\n    }\n\n    renderInlineField() {\n        return <LinePlotWidget />\n    }\n}\n","import React, { useContext } from \"react\"\nimport WorkspaceContext from \"../../WorkspaceContext\"\nimport { ReactFieldJSON } from \"../ReactField\"\nimport ReactInlineField from \"../ReactInlineField\"\nimport useBlockData from \"../../useBlockData\"\nimport VegaLiteWidget from \"./VegaLiteWidget\"\nimport { tidyResolveHeader } from \"../tidy\"\nimport { SCATTER_MAX_ITEMS } from \"../../toolbox\"\nimport { humanify } from \"../../../../../jacdac-ts/jacdac-spec/spectool/jdspec\"\n\nfunction ScatterPlotWidget(props: { linearRegression?: boolean }) {\n    const { linearRegression } = props\n    const { sourceBlock } = useContext(WorkspaceContext)\n    const { data, transformedData } = useBlockData(sourceBlock)\n    const x = tidyResolveHeader(data, sourceBlock?.getFieldValue(\"x\"), \"number\")\n    const y = tidyResolveHeader(data, sourceBlock?.getFieldValue(\"y\"), \"number\")\n    const size = tidyResolveHeader(\n        data,\n        sourceBlock?.getFieldValue(\"size\"),\n        \"number\"\n    )\n\n    if (!x || !y) return null\n\n    const sliceOptions = {\n        sliceSample: SCATTER_MAX_ITEMS,\n    }\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    let spec: any = {\n        mark: { type: \"point\", filled: true, tooltip: true },\n        encoding: {\n            x: {\n                field: x,\n                type: \"quantitative\",\n                scale: { zero: false },\n                title: humanify(x),\n            },\n            y: {\n                field: y,\n                title: humanify(y),\n                type: \"quantitative\",\n                scale: { zero: false },\n            },\n        },\n    }\n    if (size)\n        spec.encoding.size = {\n            field: size,\n            type: \"quantitative\",\n            scale: { zero: false },\n        }\n\n    if (linearRegression) {\n        const { slope, intercept } = (transformedData?.[0] || {}) as any\n        spec = {\n            title:\n                slope !== undefined\n                    ? `slope: ${slope}, intercept: ${intercept}`\n                    : undefined,\n            layer: [\n                spec,\n                {\n                    mark: {\n                        type: \"line\",\n                        color: \"firebrick\",\n                    },\n                    transform: [\n                        {\n                            regression: y,\n                            on: x,\n                        },\n                    ],\n                    encoding: {\n                        x: {\n                            field: x,\n                            type: \"quantitative\",\n                        },\n                        y: {\n                            field: y,\n                            type: \"quantitative\",\n                        },\n                    },\n                },\n            ],\n        }\n    }\n    spec.data = { name: \"values\" }\n\n    return <VegaLiteWidget spec={spec} slice={sliceOptions} />\n}\n\nexport interface ScatterPlotFieldProps {\n    linearRegression?: boolean\n}\n\nexport default class ScatterPlotField extends ReactInlineField {\n    static KEY = \"jacdac_field_scatter_plot\"\n    EDITABLE = false\n    linearRegression: boolean\n\n    static fromJson(options: ReactFieldJSON) {\n        return new ScatterPlotField(options)\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    constructor(options?: ScatterPlotFieldProps) {\n        super(options)\n        this.linearRegression = !!options?.linearRegression\n    }\n\n    renderInlineField() {\n        return <ScatterPlotWidget linearRegression={this.linearRegression} />\n    }\n}\n","import React, { useContext, useState } from \"react\"\nimport WorkspaceContext, {\n    WorkspaceServices,\n    WorkspaceWithServices,\n} from \"../../WorkspaceContext\"\nimport { ReactFieldJSON } from \"../ReactField\"\nimport ReactInlineField from \"../ReactInlineField\"\nimport useBlockData from \"../../useBlockData\"\nimport VegaLiteWidget from \"./VegaLiteWidget\"\nimport { blockToVisualizationSpec } from \"../../dsl/chartdsl\"\nimport { useEffect } from \"react\"\n\nfunction VegaChartWidget() {\n    const { sourceBlock, workspace } = useContext(WorkspaceContext)\n    const { data } = useBlockData(sourceBlock)\n    const services = (workspace as any as WorkspaceWithServices)?.jacdacServices\n\n    // track workspace changes and re-render\n    const [, setWorkspaceJSON] = useState(services?.workspaceJSON)\n    useEffect(\n        () =>\n            services?.subscribe(WorkspaceServices.WORKSPACE_CHANGE, () =>\n                setWorkspaceJSON(services.workspaceJSON)\n            ),\n        [services]\n    )\n\n    const spec = blockToVisualizationSpec(sourceBlock, data)\n\n    return <VegaLiteWidget spec={spec} />\n}\n\nexport default class VegaChartField extends ReactInlineField {\n    static KEY = \"jacdac_field_vega_chart\"\n    EDITABLE = false\n\n    static fromJson(options: ReactFieldJSON) {\n        return new VegaChartField(options)\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    constructor(options?: any) {\n        super(options)\n    }\n\n    renderInlineField() {\n        return <VegaChartWidget />\n    }\n}\n","import React, { lazy, useContext, useMemo, useRef, useState } from \"react\"\nimport WorkspaceContext from \"../../WorkspaceContext\"\nimport useBlockData from \"../../useBlockData\"\nimport { PointerBoundary } from \"../PointerBoundary\"\nimport Suspense from \"../../../ui/Suspense\"\nimport { Grid, makeStyles, NoSsr } from \"@material-ui/core\"\nimport { CHART_HEIGHT, CHART_SVG_MAX_ITEMS, CHART_WIDTH } from \"../../toolbox\"\nimport type { View, VisualizationSpec } from \"react-vega\"\nimport type { DataSliceOptions } from \"../../../../workers/data/dist/node_modules/data.worker\"\nimport useEffectAsync from \"../../../useEffectAsync\"\nimport { tidyResolveHeader, tidySlice } from \"./../tidy\"\nimport { JSONTryParse } from \"../../../../../jacdac-ts/src/jdom/utils\"\nimport { humanify } from \"../../../../../jacdac-ts/jacdac-spec/spectool/jdspec\"\nimport CopyButton from \"../../../ui/CopyButton\"\nimport IconButtonWithTooltip from \"../../../ui/IconButtonWithTooltip\"\nimport { UIFlags } from \"../../../../jacdac/providerbus\"\nimport SaveAltIcon from \"@material-ui/icons/SaveAlt\"\nconst VegaLite = lazy(() => import(\"./VegaLite\"))\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction clone(v: any) {\n    return v ? JSON.parse(JSON.stringify(v)) : v\n}\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction isKV(v: any) {\n    return !!v && typeof v === \"object\" && !Array.isArray(v)\n}\n// eslint-disable-next-line @typescript-eslint/ban-types\nfunction jsonMergeFrom(trg: object, src: object) {\n    if (!src) return\n    Object.keys(src).forEach(k => {\n        if (isKV(trg[k]) && isKV(src[k])) jsonMergeFrom(trg[k], src[k])\n        else trg[k] = clone(src[k])\n    })\n}\n\nconst useStyles = makeStyles(() => ({\n    button: {\n        color: \"grey\",\n    },\n}))\n\nexport type VegaLiteChart = unknown\n\nexport default function VegaLiteWidget(props: {\n    spec: VisualizationSpec\n    slice?: DataSliceOptions\n}) {\n    const { spec, slice } = props\n    const { sourceBlock } = useContext(WorkspaceContext)\n    const { data } = useBlockData(sourceBlock)\n    const classes = useStyles()\n    // eslint-disable-next-line @typescript-eslint/ban-types\n    const [vegaData, setVegaData] = useState<{ values: object[] }>(undefined)\n    const viewRef = useRef<View>()\n\n    const group = tidyResolveHeader(data, sourceBlock?.getFieldValue(\"group\"))\n    const settings = JSONTryParse(sourceBlock?.getFieldValue(\"settings\"))\n    const handleNewView = (view: View) => (viewRef.current = view)\n\n    const fullSpec: VegaLiteChart = useMemo(() => {\n        if (!settings) return spec\n        const s = clone(spec)\n        if (s.encoding)\n            Object.values(s.encoding)\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                .filter((e: any) => !e.title)\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                .forEach((e: any) => (e.title = humanify(e.field)))\n        jsonMergeFrom(s, settings)\n        if (\n            Object.values(s.encoding || {}).some(\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                (encoding: any) =>\n                    encoding?.scale?.domainMin !== undefined ||\n                    encoding?.scale?.domainMax !== undefined\n            )\n        ) {\n            s.mark.clip = true\n        }\n        if (group) {\n            s.encoding.color = {\n                field: group,\n                title: humanify(group),\n                type: \"nominal\",\n            }\n            s.encoding.strokeDash = {\n                field: group,\n                title: humanify(group),\n                type: \"nominal\",\n            }\n        }\n        return s\n    }, [spec, group, settings])\n\n    useEffectAsync(\n        async mounted => {\n            if (!slice) {\n                setVegaData({ values: data })\n            } else {\n                const sliced = await tidySlice(data, slice)\n                if (mounted()) setVegaData({ values: sliced })\n            }\n        },\n        [data]\n    )\n\n    if (!vegaData?.values?.length || !spec) return null\n\n    const renderer =\n        vegaData.values.length < CHART_SVG_MAX_ITEMS ? \"svg\" : \"canvas\"\n    const handleCopy = UIFlags.hosted\n        ? undefined\n        : async () => {\n              const view = viewRef.current\n              const canvas = await view?.toCanvas(2)\n              return canvas\n          }\n    const handleExport = UIFlags.hosted\n        ? async () => {\n              window.parent?.postMessage({\n                  type: \"dsl\",\n                  action: \"chartexport\",\n                  vega: fullSpec,\n                  slice,\n                  dataset: data,\n                  vegaDataset: vegaData,\n              })\n          }\n        : async () => {\n              const view = viewRef.current\n              const canvas = await view?.toCanvas(2)\n              return canvas\n          }\n    const showToolbar = !!handleCopy || !!handleExport\n\n    return (\n        <NoSsr>\n            <PointerBoundary>\n                <div style={{ background: \"#fff\", borderRadius: \"0.25rem\" }}>\n                    <Grid container direction=\"column\" spacing={1}>\n                        {showToolbar && (\n                            <Grid item xs={12}>\n                                <Grid\n                                    container\n                                    direction=\"row\"\n                                    justifyContent=\"flex-start\"\n                                    alignItems=\"center\"\n                                    spacing={1}\n                                >\n                                    {!!handleCopy && (\n                                        <Grid item>\n                                            <CopyButton\n                                                size=\"small\"\n                                                className={classes.button}\n                                                onCopy={handleCopy}\n                                            />\n                                        </Grid>\n                                    )}\n                                    {!!handleExport && (\n                                        <Grid item>\n                                            <IconButtonWithTooltip\n                                                title=\"save\"\n                                                size=\"small\"\n                                                className={classes.button}\n                                                onClick={handleExport}\n                                            >\n                                                <SaveAltIcon />\n                                            </IconButtonWithTooltip>\n                                        </Grid>\n                                    )}\n                                </Grid>\n                            </Grid>\n                        )}\n                        <Grid item xs={12}>\n                            <Suspense>\n                                <VegaLite\n                                    actions={false}\n                                    width={CHART_WIDTH}\n                                    height={CHART_HEIGHT}\n                                    spec={fullSpec}\n                                    data={vegaData}\n                                    renderer={renderer}\n                                    tooltip={true}\n                                    onNewView={handleNewView}\n                                />\n                            </Suspense>\n                        </Grid>\n                    </Grid>\n                </div>\n            </PointerBoundary>\n        </NoSsr>\n    )\n}\n","import Blockly from \"blockly\"\nimport NoteField from \"./NoteField\"\nimport KeyboardKeyField from \"./KeyboardKeyField\"\nimport LEDMatrixField from \"./LEDMatrixField\"\nimport ServoAngleField from \"./ServoAngleField\"\nimport { BlockDefinition } from \"../toolbox\"\nimport { assert } from \"../../../../jacdac-ts/src/jdom/utils\"\nimport LEDColorField from \"./LEDColorField\"\nimport TwinField from \"./TwinField\"\nimport JDomTreeField from \"./JDomTreeField\"\nimport WatchValueField from \"./WatchValueField\"\nimport LogViewField from \"./LogViewField\"\nimport VariablesField from \"./VariablesFields\"\nimport DataTableField from \"./DataTableField\"\nimport DataColumnChooserField from \"./DataColumnChooserField\"\nimport BuiltinDataSetField from \"./BuiltinDataSetField\"\nimport DataPreviewField from \"./DataPreviewField\"\n\nimport LinePlotField from \"./chart/LinePlotField\"\nimport GaugeWidgetField from \"./GaugeWidgetField\"\nimport ScatterPlotField from \"./chart/ScatterPlotField\"\nimport BarChartField from \"./chart/BarField\"\nimport HistogramField from \"./chart/HistogramField\"\nimport BoxPlotField from \"./chart/BoxPlotField\"\nimport HeatMapPlotField from \"./chart/HeatMapField\"\nimport VegaChartField from \"./chart/VegaChartField\"\n\nimport FileSaveField from \"./FileSaveField\"\nimport FileOpenField from \"./FileOpenField\"\nimport UseModelField from \"./UseModelField\"\n\nimport ExpandModelBlockField from \"./mb/ExpandModelBlockField\"\nimport DataSetBlockField from \"./mb/DataSetBlockField\"\nimport DataSetBlockButton from \"./mb/DataSetBlockButton\"\nimport RecordingBlockField from \"./mb/RecordingBlockField\"\nimport NeuralNetworkBlockField from \"./mb/NeuralNetworkBlockField\"\nimport NeuralNetworkBlockButton from \"./mb/NeuralNetworkBlockButtons\"\nimport ConvLayerBlockField from \"./mb/ConvLayerBlockField\"\nimport PoolingLayerBlockField from \"./mb/PoolingLayerBlockField\"\nimport DropoutLayerBlockField from \"./mb/DropoutLayerBlockField\"\nimport FlattenLayerBlockField from \"./mb/FlattenLayerBlockField\"\nimport DenseLayerBlockField from \"./mb/DenseLayerBlockField\"\nimport TrainedModelBlockField from \"./mb/TrainedModelBlockField\"\n\nimport JSONSettingsField from \"./JSONSettingsField\"\nimport IFrameDataChooserField from \"./IFrameDataChooserField\"\n\nlet reactFieldShadows: BlockDefinition[]\nexport function registerFields() {\n    if (reactFieldShadows) return\n\n    reactFieldShadows = []\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const registerType = (fieldType: any) => {\n        const key = fieldType.KEY\n        assert(!!key)\n        try {\n            Blockly.fieldRegistry.unregister(key) // hot reload issues\n        } catch (e) {\n            // ignore hot reload issues\n        }\n        Blockly.fieldRegistry.register(key, fieldType)\n        if (fieldType.SHADOW) reactFieldShadows.push(fieldType.SHADOW)\n    }\n    const fieldTypes = [\n        KeyboardKeyField,\n        NoteField,\n        LEDMatrixField,\n        ServoAngleField,\n        LEDColorField,\n\n        TwinField,\n        JDomTreeField,\n\n        GaugeWidgetField,\n\n        WatchValueField,\n        LogViewField,\n\n        VariablesField,\n        DataTableField,\n        DataPreviewField,\n        DataColumnChooserField,\n\n        BuiltinDataSetField,\n\n        ScatterPlotField,\n        LinePlotField,\n        BarChartField,\n        HistogramField,\n        BoxPlotField,\n        HeatMapPlotField,\n        VegaChartField,\n\n        ExpandModelBlockField,\n        DataSetBlockField,\n        DataSetBlockButton,\n        RecordingBlockField,\n        NeuralNetworkBlockField,\n        NeuralNetworkBlockButton,\n        ConvLayerBlockField,\n        PoolingLayerBlockField,\n        DropoutLayerBlockField,\n        FlattenLayerBlockField,\n        DenseLayerBlockField,\n        TrainedModelBlockField,\n\n        FileSaveField,\n        FileOpenField,\n        UseModelField,\n\n        JSONSettingsField,\n\n        IFrameDataChooserField,\n    ]\n    fieldTypes.forEach(registerType)\n}\n\nexport function fieldShadows() {\n    registerFields()\n    return reactFieldShadows.slice(0)\n}\n","import React, { ReactNode, useContext, useEffect, useState } from \"react\"\nimport {\n    Box,\n    Grid,\n    MenuItem,\n    Select,\n    TextField,\n    Tooltip,\n    makeStyles,\n    Theme,\n    createStyles,\n} from \"@material-ui/core\"\n\nimport { ReactFieldJSON } from \"../ReactField\"\nimport ReactInlineField from \"../ReactInlineField\"\nimport { PointerBoundary } from \"../PointerBoundary\"\n\nimport WorkspaceContext from \"../../WorkspaceContext\"\n\nimport { useId } from \"react-use-id-hook\"\nimport ExpandModelBlockField from \"./ExpandModelBlockField\"\n\nexport interface ConvLayerFieldValue {\n    percentParams: number\n    percentSize: number\n    runTimeInMs: number\n    outputShape: number[]\n    numFilters: number\n    kernelSize: number\n    strideSize: number\n    activation: string\n}\n\nconst useStyles = makeStyles((theme: Theme) =>\n    createStyles({\n        fieldContainer: {\n            lineHeight: \"2.5rem\",\n            width: \"15rem\",\n        },\n        field: {\n            width: theme.spacing(10),\n        },\n    })\n)\n\nfunction LayerParameterWidget(props: { initFieldValue: ConvLayerFieldValue }) {\n    const { initFieldValue } = props\n    const { sourceBlock } = useContext(WorkspaceContext)\n    const classes = useStyles()\n\n    const { percentSize, percentParams, outputShape, runTimeInMs } =\n        initFieldValue\n    let { numFilters, kernelSize, strideSize, activation } = initFieldValue\n\n    const updateParameters = () => {\n        // push changes to field values to the parent\n        const updatedValue = {\n            numFilters: numFilters,\n            kernelSize: kernelSize,\n            strideSize: strideSize,\n            activation: activation,\n        }\n\n        // send new value to the parameter holder\n        const expandField = sourceBlock.getField(\n            \"EXPAND_BUTTON\"\n        ) as ExpandModelBlockField\n        expandField.updateFieldValue(updatedValue)\n    }\n\n    const handleChangedFilters = (\n        event: React.ChangeEvent<HTMLInputElement>\n    ) => {\n        const newValue = event.target.valueAsNumber\n        if (newValue && !isNaN(newValue)) {\n            numFilters = newValue\n            updateParameters()\n        }\n    }\n\n    const handleChangedKernelSize = (\n        event: React.ChangeEvent<HTMLInputElement>\n    ) => {\n        const newValue = event.target.valueAsNumber\n        if (newValue && !isNaN(newValue)) {\n            kernelSize = newValue\n            updateParameters()\n        }\n    }\n\n    const handleChangedStrides = (\n        event: React.ChangeEvent<HTMLInputElement>\n    ) => {\n        const newValue = event.target.valueAsNumber\n        if (newValue && !isNaN(newValue)) {\n            strideSize = newValue\n            updateParameters()\n        }\n    }\n\n    const handleChangedActivation = event => {\n        const newValue = event.target.value\n        if (newValue) {\n            activation = newValue\n            updateParameters()\n        }\n    }\n\n    return (\n        <PointerBoundary>\n            <Grid container spacing={1} direction={\"column\"}>\n                <Grid item className={classes.fieldContainer}>\n                    <Box color=\"text.secondary\">\n                        filters&emsp;\n                        <Tooltip title=\"Update the kernel size\">\n                            <TextField\n                                id={useId() + \"filters\"}\n                                type=\"number\"\n                                size=\"small\"\n                                variant=\"outlined\"\n                                defaultValue={numFilters}\n                                onChange={handleChangedFilters}\n                                className={classes.field}\n                            />\n                        </Tooltip>\n                    </Box>\n                    <Box color=\"text.secondary\">\n                        kernel size&emsp;\n                        <Tooltip title=\"Update the kernel size\">\n                            <TextField\n                                id={useId() + \"kernelSize\"}\n                                type=\"number\"\n                                size=\"small\"\n                                variant=\"outlined\"\n                                defaultValue={kernelSize}\n                                onChange={handleChangedKernelSize}\n                                className={classes.field}\n                            />\n                        </Tooltip>\n                    </Box>\n                    <Box color=\"text.secondary\">\n                        stride&emsp;\n                        <Tooltip title=\"Update the stride\">\n                            <TextField\n                                id={useId() + \"stride\"}\n                                type=\"number\"\n                                size=\"small\"\n                                variant=\"outlined\"\n                                defaultValue={strideSize}\n                                onChange={handleChangedStrides}\n                                className={classes.field}\n                            />\n                        </Tooltip>\n                    </Box>\n                    <Box color=\"text.secondary\">\n                        activation&emsp;\n                        <Tooltip title=\"Update the activation function\">\n                            <Select\n                                id={useId() + \"activation\"}\n                                variant=\"outlined\"\n                                defaultValue={activation}\n                                onChange={handleChangedActivation}\n                            >\n                                <MenuItem value=\"softmax\">softmax</MenuItem>\n                                <MenuItem value=\"linear\">linear</MenuItem>\n                                <MenuItem value=\"relu\">relu</MenuItem>\n                            </Select>\n                        </Tooltip>\n                    </Box>\n                </Grid>\n                <Grid item>\n                    <Box color=\"text.secondary\">\n                        Output shape: [{outputShape.join(\", \")}]<br />\n                        Percent of total size: {percentSize.toPrecision(2)}%\n                        <br />\n                        Percent of total params: {percentParams.toPrecision(2)}%\n                        <br />\n                        Run time: {runTimeInMs.toPrecision(2)} ms <br />\n                    </Box>\n                </Grid>\n            </Grid>\n        </PointerBoundary>\n    )\n}\n\nexport default class ConvLayerBlockField extends ReactInlineField {\n    static KEY = \"conv_layer_block_field_key\"\n\n    constructor(value: string, previousValue?: any) {\n        super(value)\n        if (previousValue)\n            this.value = { ...this.defaultValue, ...previousValue }\n    }\n\n    static fromJson(options: ReactFieldJSON) {\n        return new ConvLayerBlockField(options?.value)\n    }\n\n    /* This default value is specified here and in modelblockdsl.ts */\n    get defaultValue() {\n        return {\n            percentParams: 0,\n            percentSize: 0,\n            runTimeInMs: 0,\n            outputShape: [0, 0],\n            numFilters: 16,\n            kernelSize: 2,\n            strideSize: 1,\n        }\n    }\n\n    getText_() {\n        return ``\n    }\n\n    renderInlineField(): ReactNode {\n        return <LayerParameterWidget initFieldValue={this.value} />\n    }\n}\n","import React, { ReactNode, useContext } from \"react\"\nimport { Button, Grid, Tooltip } from \"@material-ui/core\"\nimport ViewIcon from \"@material-ui/icons/Visibility\"\n// tslint:disable-next-line: no-submodule-imports match-default-export-name\nimport DownloadIcon from \"@material-ui/icons/GetApp\"\n// tslint:disable-next-line: no-submodule-imports match-default-export-name\n\nimport { ReactFieldJSON } from \"../ReactField\"\nimport ReactInlineField from \"../ReactInlineField\"\nimport WorkspaceContext from \"../../WorkspaceContext\"\n\nfunction DataSetButtonWidget() {\n    const { sourceBlock } = useContext(WorkspaceContext)\n\n    const handleViewDataSet = () => {\n        console.log(\"View and edit dataset modal\")\n        sourceBlock.data = \"click.edit\"\n    }\n    const handleDownloadDataSet = () => {\n        console.log(\"Download dataset\")\n        sourceBlock.data = \"click.download\"\n    }\n\n    return (\n        <Grid container spacing={1} direction={\"row\"}>\n            <Grid item style={{ display: \"inline-flex\", width: 300 }}>\n                <Tooltip title=\"View this data set and perform actions like splitting it\">\n                    <Button\n                        onClick={handleViewDataSet}\n                        startIcon={<ViewIcon />}\n                        variant=\"outlined\"\n                        size=\"small\"\n                    >\n                        View\n                    </Button>\n                </Tooltip>\n                &ensp;\n                <Tooltip title=\"Download dataset as csv file\">\n                    <Button\n                        onClick={handleDownloadDataSet}\n                        startIcon={<DownloadIcon />}\n                        variant=\"outlined\"\n                        size=\"small\"\n                    >\n                        Download\n                    </Button>\n                </Tooltip>\n            </Grid>\n        </Grid>\n    )\n}\n\nexport default class DataSetBlockButtons extends ReactInlineField {\n    static KEY = \"ds_block_buttons_key\"\n\n    constructor(value: string) {\n        super(value)\n    }\n\n    static fromJson(options: ReactFieldJSON) {\n        return new DataSetBlockButtons(options?.value)\n    }\n\n    getText_() {\n        return `nn`\n    }\n\n    renderInlineField(): ReactNode {\n        return <DataSetButtonWidget />\n    }\n}\n","import React, { ReactNode, useContext, useEffect, useState } from \"react\"\nimport {\n    Box,\n    Grid,\n    MenuItem,\n    Select,\n    TextField,\n    Tooltip,\n    makeStyles,\n    Theme,\n    createStyles,\n} from \"@material-ui/core\"\n\nimport { ReactFieldJSON } from \"../ReactField\"\nimport ReactInlineField from \"../ReactInlineField\"\nimport { PointerBoundary } from \"../PointerBoundary\"\n\nimport WorkspaceContext, {\n    resolveBlockServices,\n    WorkspaceWithServices,\n    WorkspaceServices,\n} from \"../../WorkspaceContext\"\nimport { CHANGE } from \"../../../../../jacdac-ts/src/jdom/constants\"\n\nimport { useId } from \"react-use-id-hook\"\nimport ExpandModelBlockField from \"./ExpandModelBlockField\"\n\nexport interface DataSetBlockFieldValue {\n    numRecordings: number\n    numSamples: number\n    inputClasses: string[]\n    inputTypes: string[]\n}\n\nfunction DataSetParameterWidget(props: {\n    initFieldValue: DataSetBlockFieldValue\n}) {\n    const { initFieldValue } = props\n\n    const { inputClasses, inputTypes } = initFieldValue\n\n    const { sourceBlock } = useContext(WorkspaceContext)\n    const services = resolveBlockServices(sourceBlock)\n\n    // track workspace changes and re-render\n    const [, setBlockData] = useState(services.data)\n    useEffect(\n        () =>\n            services?.subscribe(CHANGE, () => {\n                setBlockData(services.data)\n            }),\n        [services]\n    )\n\n    return (\n        <PointerBoundary>\n            <Grid container spacing={1} direction={\"column\"}>\n                <Grid item>\n                    <Box color=\"text.secondary\">\n                        Classes:{\" \"}\n                        {inputClasses.length ? inputClasses.join(\", \") : \"none\"}{\" \"}\n                        <br />\n                        Input type(s):{\" \"}\n                        {inputTypes.length ? inputTypes.join(\", \") : \"none\"}\n                    </Box>\n                </Grid>\n            </Grid>\n        </PointerBoundary>\n    )\n}\n\nexport default class DataSetBlockField extends ReactInlineField {\n    static KEY = \"dataset_block_field_key\"\n\n    constructor(value: string, previousValue?: any) {\n        super(value)\n        if (previousValue)\n            this.value = { ...this.defaultValue, ...previousValue }\n    }\n\n    static fromJson(options: ReactFieldJSON) {\n        return new DataSetBlockField(options?.value)\n    }\n\n    /* This default value is specified here and in modelblockdsl.ts */\n    get defaultValue() {\n        return {\n            numRecordings: 0,\n            numSamples: 0,\n            inputClasses: [],\n            inputTypes: [],\n        }\n    }\n\n    getText_() {\n        const totalRecordings = this.value.numRecordings\n\n        return `${totalRecordings} recording(s)`\n    }\n\n    renderInlineField(): ReactNode {\n        return <DataSetParameterWidget initFieldValue={this.value} />\n    }\n}\n","import React, { ReactNode, useContext, useEffect, useState } from \"react\"\nimport {\n    Box,\n    Grid,\n    MenuItem,\n    Select,\n    TextField,\n    Tooltip,\n    makeStyles,\n    Theme,\n    createStyles,\n} from \"@material-ui/core\"\n\nimport { ReactFieldJSON } from \"../ReactField\"\nimport ReactInlineField from \"../ReactInlineField\"\nimport { PointerBoundary } from \"../PointerBoundary\"\n\nimport WorkspaceContext, { resolveBlockServices } from \"../../WorkspaceContext\"\n\nimport { useId } from \"react-use-id-hook\"\nimport ExpandModelBlockField from \"./ExpandModelBlockField\"\n\nexport interface DenseLayerFieldValue {\n    percentParams: number\n    percentSize: number\n    runTimeInMs: number\n    outputShape: number[]\n    numUnits: number\n    activation: string\n}\n\nconst useStyles = makeStyles((theme: Theme) =>\n    createStyles({\n        fieldContainer: {\n            lineHeight: \"2.5rem\",\n            width: \"15rem\",\n        },\n        field: {\n            width: theme.spacing(10),\n        },\n    })\n)\n\nfunction LayerParameterWidget(props: {\n    initFieldValue: DenseLayerFieldValue\n    setFieldValue: (f: DenseLayerFieldValue) => void\n}) {\n    const { initFieldValue } = props\n    const { sourceBlock } = useContext(WorkspaceContext)\n    const classes = useStyles()\n\n    const { percentSize, percentParams, outputShape, runTimeInMs } =\n        initFieldValue\n    let { numUnits, activation } = initFieldValue\n\n    const updateParameters = () => {\n        // push changes to field values to the parent\n        const updatedValue = {\n            numUnits: numUnits,\n            activation: activation,\n        }\n\n        // send new value to the parameter holder\n        const expandField = sourceBlock.getField(\n            \"EXPAND_BUTTON\"\n        ) as ExpandModelBlockField\n        expandField.updateFieldValue(updatedValue)\n    }\n\n    const handleChangedUnits = (event: React.ChangeEvent<HTMLInputElement>) => {\n        const newValue = event.target.valueAsNumber\n        if (newValue && !isNaN(newValue)) {\n            numUnits = newValue\n            updateParameters()\n        }\n    }\n\n    const handleChangedActivation = event => {\n        const newValue = event.target.value\n        if (newValue) {\n            activation = newValue\n            updateParameters()\n        }\n    }\n\n    return (\n        <PointerBoundary>\n            <Grid container spacing={1} direction={\"column\"}>\n                <Grid item className={classes.fieldContainer}>\n                    <Box color=\"text.secondary\">\n                        units&emsp;\n                        <Tooltip title=\"Update the number of units\">\n                            <TextField\n                                id={useId() + \"filters\"}\n                                type=\"number\"\n                                size=\"small\"\n                                variant=\"outlined\"\n                                defaultValue={numUnits}\n                                onChange={handleChangedUnits}\n                                className={classes.field}\n                            />\n                        </Tooltip>\n                    </Box>\n                    <Box color=\"text.secondary\">\n                        activation&emsp;\n                        <Tooltip title=\"Update the activation function\">\n                            <Select\n                                id={useId() + \"activation\"}\n                                variant=\"outlined\"\n                                defaultValue={activation}\n                                onChange={handleChangedActivation}\n                            >\n                                <MenuItem value=\"softmax\">softmax</MenuItem>\n                                <MenuItem value=\"linear\">linear</MenuItem>\n                                <MenuItem value=\"relu\">relu</MenuItem>\n                            </Select>\n                        </Tooltip>\n                    </Box>\n                </Grid>\n                <Grid item>\n                    <Box color=\"text.secondary\">\n                        Output shape: [{outputShape.join(\", \")}]<br />\n                        Percent of total size: {percentSize.toPrecision(2)}%\n                        <br />\n                        Percent of total params: {percentParams.toPrecision(2)}%\n                        <br />\n                        Run time: {runTimeInMs.toPrecision(2)} ms <br />\n                    </Box>\n                </Grid>\n            </Grid>\n        </PointerBoundary>\n    )\n}\n\nexport default class DenseLayerBlockField extends ReactInlineField {\n    static KEY = \"dense_layer_block_field_key\"\n\n    constructor(value: string, previousValue?: any) {\n        super(value)\n        if (previousValue)\n            this.value = { ...this.defaultValue, ...previousValue }\n    }\n\n    static fromJson(options: ReactFieldJSON) {\n        return new DenseLayerBlockField(options?.value)\n    }\n\n    /* This default value is specified here and in modelblockdsl.ts */\n    get defaultValue() {\n        return {\n            percentParams: 0,\n            percentSize: 0,\n            runTimeInMs: 0,\n            outputShape: [0],\n            numUnits: 4,\n            activation: \"relu\",\n        }\n    }\n\n    getText_() {\n        return ``\n    }\n\n    renderInlineField(): ReactNode {\n        return <LayerParameterWidget initFieldValue={this.value} />\n    }\n}\n","import React, { ReactNode, useContext, useEffect, useState } from \"react\"\nimport {\n    Box,\n    Grid,\n    TextField,\n    Tooltip,\n    makeStyles,\n    Theme,\n    createStyles,\n} from \"@material-ui/core\"\n\nimport { ReactFieldJSON } from \"../ReactField\"\nimport ReactInlineField from \"../ReactInlineField\"\nimport { PointerBoundary } from \"../PointerBoundary\"\n\nimport WorkspaceContext from \"../../WorkspaceContext\"\n\nimport { useId } from \"react-use-id-hook\"\nimport ExpandModelBlockField from \"./ExpandModelBlockField\"\n\nexport interface DropoutLayerFieldValue {\n    percentParams: number\n    percentSize: number\n    runTimeInMs: number\n    outputShape: number[]\n    rate: string\n}\n\nconst useStyles = makeStyles((theme: Theme) =>\n    createStyles({\n        fieldContainer: {\n            lineHeight: \"2.5rem\",\n            width: \"15rem\",\n        },\n        field: {\n            width: theme.spacing(10),\n        },\n    })\n)\n\nfunction LayerParameterWidget(props: {\n    initFieldValue: DropoutLayerFieldValue\n}) {\n    const { initFieldValue } = props\n    const { sourceBlock } = useContext(WorkspaceContext)\n    const classes = useStyles()\n\n    const { percentSize, percentParams, outputShape, runTimeInMs } =\n        initFieldValue\n    let rate = initFieldValue.rate\n\n    const updateParameters = () => {\n        let rateAsNum\n        if (rate == \"0.\") rateAsNum = 0\n        else rateAsNum = parseFloat(rate)\n        // push changes to field values to the parent\n        const updatedValue = {\n            rate: rateAsNum,\n        }\n\n        // send new value to the parameter holder\n        const expandField = sourceBlock.getField(\n            \"EXPAND_BUTTON\"\n        ) as ExpandModelBlockField\n        expandField.updateFieldValue(updatedValue)\n    }\n\n    const handleChangedRate = (event: React.ChangeEvent<HTMLInputElement>) => {\n        const newValue = event.target.value\n        if (newValue) {\n            let valueAsNum\n\n            // catch edge case?\n            if (newValue == \"0.\") valueAsNum = 0\n            else valueAsNum = parseFloat(newValue)\n\n            if (valueAsNum >= 0 && valueAsNum < 1) {\n                rate = newValue\n                updateParameters()\n            }\n        }\n    }\n\n    return (\n        <PointerBoundary>\n            <Grid container spacing={1} direction={\"column\"}>\n                <Grid item className={classes.fieldContainer}>\n                    <Box color=\"text.secondary\">\n                        rate&emsp;\n                        <Tooltip title=\"Update the dropout rate\">\n                            <TextField\n                                id={useId() + \"rate\"}\n                                type=\"text\"\n                                size=\"small\"\n                                variant=\"outlined\"\n                                defaultValue={rate}\n                                onChange={handleChangedRate}\n                                className={classes.field}\n                            />\n                        </Tooltip>\n                    </Box>\n                </Grid>\n                <Grid item>\n                    <Box color=\"text.secondary\">\n                        Output shape: [{outputShape.join(\", \")}]<br />\n                        Percent of total size: {percentSize.toPrecision(2)}%\n                        <br />\n                        Percent of total params: {percentParams.toPrecision(2)}%\n                        <br />\n                        Run time: {runTimeInMs.toPrecision(2)} ms <br />\n                    </Box>\n                </Grid>\n            </Grid>\n        </PointerBoundary>\n    )\n}\n\nexport default class DropoutLayerBlockField extends ReactInlineField {\n    static KEY = \"dropout_layer_block_field_key\"\n\n    constructor(value: string, previousValue?: any) {\n        super(value)\n        if (previousValue)\n            this.value = { ...this.defaultValue, ...previousValue }\n    }\n\n    static fromJson(options: ReactFieldJSON) {\n        return new DropoutLayerBlockField(options?.value)\n    }\n\n    /* This default value is specified here and in modelblockdsl.ts */\n    get defaultValue() {\n        return {\n            percentParams: 0,\n            percentSize: 0,\n            runTimeInMs: 0,\n            outputShape: [0, 0],\n            rate: \"0.1\",\n        }\n    }\n\n    getText_() {\n        return ``\n    }\n\n    renderInlineField(): ReactNode {\n        return <LayerParameterWidget initFieldValue={this.value} />\n    }\n}\n","import React, { useContext, useState } from \"react\"\n\nimport { Grid } from \"@material-ui/core\"\nimport AddCircleIcon from \"@material-ui/icons/AddCircleOutline\"\nimport RemoveCircleIcon from \"@material-ui/icons/RemoveCircleOutline\"\nimport IconButtonWithTooltip from \"../../../ui/IconButtonWithTooltip\"\n\nimport { ReactFieldJSON } from \"../ReactField\"\nimport ReactInlineField from \"../ReactInlineField\"\nimport WorkspaceContext from \"../../WorkspaceContext\"\n\nimport { MODEL_BLOCKS } from \"../../../model-editor/modelblockdsl\"\n\nimport DenseLayerBlockField from \"./DenseLayerBlockField\"\nimport DataSetBlockField from \"./DataSetBlockField\"\nimport RecordingBlockField from \"./RecordingBlockField\"\nimport NeuralNetworkBlockField from \"./NeuralNetworkBlockField\"\nimport ConvLayerBlockField from \"./ConvLayerBlockField\"\nimport PoolingLayerBlockField from \"./PoolingLayerBlockField\"\nimport DropoutLayerBlockField from \"./DropoutLayerBlockField\"\nimport FlattenLayerBlockField from \"./FlattenLayerBlockField\"\nimport { Block } from \"blockly\"\n\nconst REMOVABLE_INPUT = \"REMOVABLE_INPUT\"\nconst LAYER_INPUT = \"LAYER_INPUTS\"\n\nfunction ExpandIconWidget() {\n    const { sourceBlock } = useContext(WorkspaceContext)\n\n    const getCurrentValue = () => {\n        const expandField = sourceBlock.getField(\"EXPAND_BUTTON\")\n        if (expandField.getValue()) {\n            const value = JSON.parse(expandField.getValue())\n            return value\n        }\n        return null\n    }\n\n    const updateCurrentValue = (paramName: string, paramValue: any) => {\n        const expandField = sourceBlock.getField(\n            \"EXPAND_BUTTON\"\n        ) as ExpandModelBlockField\n\n        expandField.updateFieldValue({ paramName: paramValue })\n    }\n\n    const appendParamInput = (block: Block) => {\n        block\n            .appendDummyInput(REMOVABLE_INPUT)\n            .appendField(getBlockFieldType(block.type), \"BLOCK_PARAMS\")\n\n        // TODO. This is a hack, no moving blocks that are open\n        block.setMovable(false)\n\n        // place the new input before the input statement field\n        if (block.getInput(LAYER_INPUT))\n            block.moveInputBefore(REMOVABLE_INPUT, LAYER_INPUT)\n    }\n\n    const getBlockFieldType = (blockType: string) => {\n        const currentValue = getCurrentValue()\n        switch (blockType) {\n            case MODEL_BLOCKS + \"dataset\":\n                return new DataSetBlockField(\"\", currentValue)\n            case MODEL_BLOCKS + \"recording\":\n                return new RecordingBlockField(\"\", currentValue)\n            case MODEL_BLOCKS + \"nn\":\n                return new NeuralNetworkBlockField(\"\", currentValue)\n            case MODEL_BLOCKS + \"conv1d_layer\":\n                return new ConvLayerBlockField(\"\", currentValue)\n            case MODEL_BLOCKS + \"conv2d_layer\":\n                return new ConvLayerBlockField(\"\", currentValue)\n            case MODEL_BLOCKS + \"dense_layer\":\n                return new DenseLayerBlockField(\"\", currentValue)\n            case MODEL_BLOCKS + \"dropout_layer\":\n                return new DropoutLayerBlockField(\"\", currentValue)\n            case MODEL_BLOCKS + \"flatten_layer\":\n                return new FlattenLayerBlockField(\"\", currentValue)\n            case MODEL_BLOCKS + \"maxpool1d_layer\":\n                return new PoolingLayerBlockField(\"\", currentValue)\n            case MODEL_BLOCKS + \"maxpool2d_layer\":\n                return new PoolingLayerBlockField(\"\", currentValue)\n            case MODEL_BLOCKS + \"avgpool1d_layer\":\n                return new PoolingLayerBlockField(\"\", currentValue)\n            case MODEL_BLOCKS + \"avgpool2d_layer\":\n                return new PoolingLayerBlockField(\"\", currentValue)\n            default:\n                console.error(\"Got inappropriate input for expanding block\")\n                return null\n        }\n    }\n\n    const [parametersVisible, setParametersVisible] = useState(() => {\n        const fieldValue = getCurrentValue()\n        if (fieldValue) {\n            const paramsVisible = fieldValue[\"parametersVisible\"]\n            if (paramsVisible) appendParamInput(sourceBlock)\n            return paramsVisible\n        }\n        return false\n    })\n\n    const handleExpandBlock = () => {\n        const parameterField = sourceBlock.getField(\n            \"BLOCK_PARAMS\"\n        ) as ReactInlineField\n        if (parameterField) {\n            // save the parameters written to that block\n            const paramValues = JSON.parse(parameterField.getValue())\n            Object.keys(paramValues).forEach(key => {\n                updateCurrentValue(key, paramValues[key])\n            })\n\n            // identify which input to remove and remove it\n            parameterField.getParentInput().name = REMOVABLE_INPUT\n            sourceBlock.removeInput(REMOVABLE_INPUT)\n            // TODO this is a hack. Need to implement textToDom and domToText for these mutator blocks\n            sourceBlock.setMovable(true)\n\n            // update the value of the expand button field\n            updateCurrentValue(\"parametersVisible\", false)\n            setParametersVisible(false)\n        } else {\n            // add a removable field with the appropriate field type\n            appendParamInput(sourceBlock)\n\n            // update the value of the expand button field\n            updateCurrentValue(\"parametersVisible\", true)\n            setParametersVisible(true)\n        }\n    }\n\n    return (\n        <Grid container spacing={1}>\n            <Grid item>\n                <IconButtonWithTooltip\n                    style={{ backgroundColor: \"transparent\" }}\n                    onClick={handleExpandBlock}\n                    title=\"Expand dataset block to see all dataset info\"\n                >\n                    {parametersVisible ? (\n                        <RemoveCircleIcon />\n                    ) : (\n                        <AddCircleIcon />\n                    )}\n                </IconButtonWithTooltip>\n            </Grid>\n        </Grid>\n    )\n}\n\nexport default class ExpandModelBlockField extends ReactInlineField {\n    static KEY = \"model_field_key\"\n\n    constructor(value: string) {\n        super(value)\n    }\n\n    get defaultValue() {\n        return {\n            parametersVisible: false,\n        }\n    }\n\n    protected createContainer(): HTMLDivElement {\n        const c = document.createElement(\"div\")\n        c.style.display = \"inline-block\"\n        c.style.minWidth = \"2rem\"\n        return c\n    }\n\n    static fromJson(options: ReactFieldJSON) {\n        return new ExpandModelBlockField(options?.value)\n    }\n\n    fromXml(fieldElement: Element) {\n        this.setValue(fieldElement.textContent)\n        this.updateBlockName()\n    }\n\n    updateBlockName() {\n        const sourceBlock = this.getSourceBlock()\n\n        const nameField = sourceBlock.inputList[0].fieldRow[0]\n        const name: string = nameField.getValue()\n        const blockName = name.substr(0, name.indexOf(\"(\") - 1)\n\n        if (sourceBlock.type.indexOf(\"conv\") > 0) {\n            // display filters, kernel size, and stride size for convolutional blocks\n            nameField.setValue(\n                `${blockName} (${this.value.numFilters}, ${this.value.kernelSize}, ${this.value.strideSize})`\n            )\n        } else if (sourceBlock.type.indexOf(\"pool\") > 0) {\n            // display kernel size and stride for pooling blocks\n            // update the name of the block\n            nameField.setValue(\n                `${blockName} (${this.value.poolSize}, ${this.value.strideSize})`\n            )\n        } else if (sourceBlock.type.indexOf(\"dense\") > 0) {\n            // display number of units and activation functions for dense blocks\n            nameField.setValue(\n                `${blockName} (${this.value.numUnits}, ${this.value.activation})`\n            )\n        } else if (sourceBlock.type.indexOf(\"drop\") > 0) {\n            // display the dropout rate for dropout layers\n            nameField.setValue(`${blockName} (${this.value.rate})`)\n        }\n        // don't list parameters of other blocks\n    }\n\n    getText_() {\n        return \",\"\n    }\n\n    renderInlineField() {\n        return <ExpandIconWidget />\n    }\n\n    updateFieldValue(msg: any) {\n        this.value = {\n            ...this.value,\n            ...msg,\n        }\n        this.updateBlockName()\n    }\n}\n","import React, { ReactNode, useContext } from \"react\"\nimport { Box, Grid, makeStyles, Theme, createStyles } from \"@material-ui/core\"\n\nimport { ReactFieldJSON } from \"../ReactField\"\nimport ReactInlineField from \"../ReactInlineField\"\nimport { PointerBoundary } from \"../PointerBoundary\"\n\nimport WorkspaceContext, { resolveBlockServices } from \"../../WorkspaceContext\"\n\nexport interface FlattenLayerFieldValue {\n    percentParams: number\n    percentSize: number\n    runTimeInMs: number\n    outputShape: number[]\n}\n\nconst useStyles = makeStyles((theme: Theme) =>\n    createStyles({\n        fieldContainer: {\n            lineHeight: \"2.5rem\",\n            width: \"15rem\",\n        },\n        field: {\n            width: theme.spacing(10),\n        },\n    })\n)\n\nfunction LayerParameterWidget(props: {\n    initFieldValue: FlattenLayerFieldValue\n}) {\n    const { initFieldValue } = props\n\n    const { percentSize, percentParams, outputShape, runTimeInMs } =\n        initFieldValue\n\n    return (\n        <PointerBoundary>\n            <Grid container spacing={1} direction={\"column\"}>\n                <Grid item>\n                    <Box color=\"text.secondary\">\n                        Output shape: [{outputShape.join(\", \")}]<br />\n                        Percent of total size: {percentSize.toPrecision(2)}%\n                        <br />\n                        Percent of total params: {percentParams.toPrecision(2)}%\n                        <br />\n                        Run time: {runTimeInMs.toPrecision(2)} ms <br />\n                    </Box>\n                </Grid>\n            </Grid>\n        </PointerBoundary>\n    )\n}\n\nexport default class FlattenLayerBlockField extends ReactInlineField {\n    static KEY = \"flatten_layer_block_field_key\"\n\n    constructor(value: string, previousValue?: any) {\n        super(value)\n        if (previousValue)\n            this.value = { ...this.defaultValue, ...previousValue }\n    }\n\n    static fromJson(options: ReactFieldJSON) {\n        return new FlattenLayerBlockField(options?.value)\n    }\n\n    /* This default value is specified here and in modelblockdsl.ts */\n    get defaultValue() {\n        return {\n            runTimeInMs: 0,\n            outputShape: [0],\n            percentParams: 0,\n            percentSize: 0,\n            numUnits: 4,\n            activation: \"relu\",\n        }\n    }\n\n    getText_() {\n        return ``\n    }\n\n    renderInlineField(): ReactNode {\n        return <LayerParameterWidget initFieldValue={this.value} />\n    }\n}\n","import React, { ReactNode, useContext } from \"react\"\nimport { Button, createStyles, Grid, Tooltip } from \"@material-ui/core\"\nimport { makeStyles, Theme } from \"@material-ui/core/styles\"\nimport AutorenewIcon from \"@material-ui/icons/Autorenew\"\n// tslint:disable-next-line: no-submodule-imports match-default-export-name\nimport DownloadIcon from \"@material-ui/icons/GetApp\"\n// tslint:disable-next-line: no-submodule-imports match-default-export-name\n\nimport { ReactFieldJSON } from \"../ReactField\"\nimport ReactInlineField from \"../ReactInlineField\"\nimport WorkspaceContext from \"../../WorkspaceContext\"\n\nconst useStyles = makeStyles((theme: Theme) =>\n    createStyles({\n        numberField: {\n            marginBottom: theme.spacing(1),\n        },\n        buttonContainer: {\n            display: \"inline-flex\",\n            width: 300,\n        },\n    })\n)\n\nfunction NeuralNetworkButtonWidget() {\n    const classes = useStyles()\n\n    const { workspace, sourceBlock } = useContext(WorkspaceContext)\n\n    const handleTrainModel = () => {\n        console.log(\"Open NN classifier modal\")\n        sourceBlock.data = \"click.train\"\n    }\n\n    const handleDownloadModel = () => {\n        console.log(\"Download model\")\n        sourceBlock.data = \"click.download\"\n    }\n\n    return (\n        <Grid container spacing={1} direction={\"row\"}>\n            <Grid item className={classes.buttonContainer}>\n                <Tooltip title=\"Open modal to view and run classifier\">\n                    <Button\n                        onClick={handleTrainModel}\n                        startIcon={<AutorenewIcon />}\n                        variant=\"outlined\"\n                        size=\"small\"\n                    >\n                        Train\n                    </Button>\n                </Tooltip>\n                &ensp;\n                <Tooltip title=\"Download model JSON and weights file\">\n                    <Button\n                        onClick={handleDownloadModel}\n                        startIcon={<DownloadIcon />}\n                        variant=\"outlined\"\n                        size=\"small\"\n                    >\n                        Download\n                    </Button>\n                </Tooltip>\n            </Grid>\n        </Grid>\n    )\n}\n\nexport default class NeuralNetworkBlockButtons extends ReactInlineField {\n    static KEY = \"nn_block_buttons_key\"\n\n    constructor(value: string) {\n        super(value)\n    }\n\n    static fromJson(options: ReactFieldJSON) {\n        return new NeuralNetworkBlockButtons(options?.value)\n    }\n\n    getText_() {\n        return `nn`\n    }\n\n    renderInlineField(): ReactNode {\n        return <NeuralNetworkButtonWidget />\n    }\n}\n","import React, { ReactNode, useContext, useEffect, useState } from \"react\"\nimport {\n    Box,\n    Grid,\n    MenuItem,\n    Select,\n    TextField,\n    Tooltip,\n    makeStyles,\n    Theme,\n    createStyles,\n} from \"@material-ui/core\"\n\nimport { ReactFieldJSON } from \"../ReactField\"\nimport ReactInlineField from \"../ReactInlineField\"\nimport { PointerBoundary } from \"../PointerBoundary\"\n\nimport WorkspaceContext, { resolveBlockServices } from \"../../WorkspaceContext\"\n\nimport { useId } from \"react-use-id-hook\"\nimport ExpandModelBlockField from \"./ExpandModelBlockField\"\n\nexport interface NeuralNetworkBlockFieldValue {\n    totalLayers: number\n    totalParams: number\n    totalSize: number\n    runTimeInMs: number\n    inputShape: number[]\n    optimizer: string\n    numEpochs: number\n    lossFn: string\n    metrics: string\n}\n\nconst useStyles = makeStyles((theme: Theme) =>\n    createStyles({\n        fieldContainer: {\n            lineHeight: \"2.5rem\",\n            width: \"15rem\",\n        },\n        field: {\n            width: theme.spacing(10),\n        },\n    })\n)\n\nfunction NNParameterWidget(props: {\n    initFieldValue: NeuralNetworkBlockFieldValue\n}) {\n    const { initFieldValue } = props\n    const { sourceBlock } = useContext(WorkspaceContext)\n    const classes = useStyles()\n\n    const { totalLayers, totalSize, totalParams, runTimeInMs, inputShape } =\n        initFieldValue\n    const [optimizer, setOptimizer] = useState<string>(initFieldValue.optimizer)\n    const [numEpochs, setNumEpochs] = useState(initFieldValue.numEpochs)\n    const [lossFn, setLossFn] = useState(initFieldValue.lossFn)\n    const [metrics, setMetrics] = useState(initFieldValue.metrics)\n\n    useEffect(() => {\n        // push changes to source block after state values update\n        updateParameters()\n    }, [optimizer, numEpochs, lossFn, metrics])\n\n    const updateParameters = () => {\n        // push changes to field values to the parent\n        const updatedValue = {\n            optimizer: optimizer,\n            numEpochs: numEpochs,\n            lossFn: lossFn,\n            metrics: metrics,\n        }\n\n        // send new value to the parameter holder\n        const expandField = sourceBlock.getField(\n            \"EXPAND_BUTTON\"\n        ) as ExpandModelBlockField\n        expandField.updateFieldValue(updatedValue)\n    }\n\n    const handleChangedEpochs = (\n        event: React.ChangeEvent<HTMLInputElement>\n    ) => {\n        const newValue = event.target.valueAsNumber\n        if (newValue && !isNaN(newValue)) {\n            setNumEpochs(newValue)\n        }\n    }\n\n    const handleChangedOptimizer = event => {\n        const newValue = event.target.value\n        if (newValue) setOptimizer(newValue)\n    }\n\n    const handleChangedLossFn = event => {\n        const newValue = event.target.value\n        if (newValue) setLossFn(newValue)\n    }\n\n    return (\n        <PointerBoundary>\n            <Grid container spacing={1} direction={\"column\"}>\n                <Grid item className={classes.fieldContainer}>\n                    <Box color=\"text.secondary\">\n                        optimizer&ensp;\n                        <Tooltip title=\"Update the optimizer\">\n                            <Select\n                                id={useId() + \"optimizer\"}\n                                variant=\"outlined\"\n                                value={optimizer}\n                                onChange={handleChangedOptimizer}\n                            >\n                                <MenuItem value=\"adam\">adam</MenuItem>\n                                <MenuItem value=\"sgd\">SGD</MenuItem>\n                                <MenuItem value=\"adagrad\">adagrad</MenuItem>\n                                <MenuItem value=\"adadelta\">adadelta</MenuItem>\n                            </Select>\n                        </Tooltip>\n                    </Box>\n                    <Box color=\"text.secondary\">\n                        loss&ensp;\n                        <Tooltip title=\"Update the loss function\">\n                            <Select\n                                id={useId() + \"lossFn\"}\n                                variant=\"outlined\"\n                                value={lossFn}\n                                onChange={handleChangedLossFn}\n                            >\n                                <MenuItem value=\"categoricalCrossentropy\">\n                                    CCE\n                                </MenuItem>\n                                <MenuItem value=\"meanSquaredError\">\n                                    MSE\n                                </MenuItem>\n                                <MenuItem value=\"hinge\">hinge</MenuItem>\n                            </Select>\n                        </Tooltip>\n                    </Box>\n                    <Box color=\"text.secondary\">\n                        epochs&ensp;\n                        <Tooltip title=\"Update the batch size to train on\">\n                            <TextField\n                                id={useId() + \"epochs\"}\n                                type=\"number\"\n                                size=\"small\"\n                                variant=\"outlined\"\n                                value={numEpochs}\n                                onChange={handleChangedEpochs}\n                                className={classes.field}\n                            />\n                        </Tooltip>\n                    </Box>\n                </Grid>\n                <Grid item>\n                    <Box color=\"text.secondary\">\n                        Input shape: [{inputShape.join(\", \")}]<br />\n                        No. of layers: {totalLayers} <br />\n                        No. of parameters: {totalParams} <br />\n                        Total size: {(totalSize / 1000).toPrecision(2)} KB{\" \"}\n                        <br />\n                        Run time: {runTimeInMs.toPrecision(2)}ms @ 64MHz <br />\n                    </Box>\n                </Grid>\n            </Grid>\n        </PointerBoundary>\n    )\n}\n\nexport default class NeuralNetworkBlockField extends ReactInlineField {\n    static KEY = \"nn_block_field_key\"\n\n    constructor(value: string, previousValue?: any) {\n        super(value)\n        if (previousValue)\n            this.value = { ...this.defaultValue, ...previousValue }\n    }\n\n    static fromJson(options: ReactFieldJSON) {\n        return new NeuralNetworkBlockField(options?.value)\n    }\n\n    /* This default value is specified here and in modelblockdsl.ts */\n    get defaultValue() {\n        return {\n            totalLayers: 0,\n            totalParams: 0,\n            totalSize: 0,\n            runTimeInMs: 0,\n            inputShape: [0, 0],\n            optimizer: \"adam\",\n            numEpochs: 200,\n            lossFn: \"categoricalCrossentropy\",\n            metrics: \"acc\",\n        }\n    }\n\n    getText_() {\n        const { totalLayers } = this.value\n\n        return `${totalLayers} layer(s)`\n    }\n\n    renderInlineField(): ReactNode {\n        return <NNParameterWidget initFieldValue={this.value} />\n    }\n}\n","import React, { ReactNode, useContext } from \"react\"\nimport {\n    Box,\n    Grid,\n    TextField,\n    Tooltip,\n    makeStyles,\n    Theme,\n    createStyles,\n} from \"@material-ui/core\"\n\nimport { ReactFieldJSON } from \"../ReactField\"\nimport ReactInlineField from \"../ReactInlineField\"\nimport { PointerBoundary } from \"../PointerBoundary\"\n\nimport WorkspaceContext from \"../../WorkspaceContext\"\n\nimport { useId } from \"react-use-id-hook\"\nimport ExpandModelBlockField from \"./ExpandModelBlockField\"\n\nexport interface PoolingLayerFieldValue {\n    percentParams: number\n    percentSize: number\n    runTimeInMs: number\n    outputShape: number[]\n    poolSize: number\n    strideSize: number\n}\n\nconst useStyles = makeStyles((theme: Theme) =>\n    createStyles({\n        fieldContainer: {\n            lineHeight: \"2.5rem\",\n            width: \"15rem\",\n        },\n        field: {\n            width: theme.spacing(10),\n        },\n    })\n)\n\nfunction LayerParameterWidget(props: {\n    initFieldValue: PoolingLayerFieldValue\n}) {\n    const { initFieldValue } = props\n    const { sourceBlock } = useContext(WorkspaceContext)\n    const classes = useStyles()\n\n    const { percentSize, percentParams, outputShape, runTimeInMs } =\n        initFieldValue\n    let { poolSize, strideSize } = initFieldValue\n\n    const updateParameters = () => {\n        // push changes to field values to the parent\n        const updatedValue = {\n            poolSize: poolSize,\n            strideSize: strideSize,\n        }\n\n        // send new value to the parameter holder\n        const expandField = sourceBlock.getField(\n            \"EXPAND_BUTTON\"\n        ) as ExpandModelBlockField\n        expandField.updateFieldValue(updatedValue)\n    }\n\n    const handleChangedPoolSize = (\n        event: React.ChangeEvent<HTMLInputElement>\n    ) => {\n        const newValue = event.target.valueAsNumber\n        if (newValue && !isNaN(newValue)) {\n            poolSize = newValue\n            updateParameters()\n        }\n    }\n\n    const handleChangedStrides = (\n        event: React.ChangeEvent<HTMLInputElement>\n    ) => {\n        const newValue = event.target.valueAsNumber\n        if (newValue && !isNaN(newValue)) {\n            strideSize = newValue\n            updateParameters()\n        }\n    }\n\n    return (\n        <PointerBoundary>\n            <Grid container spacing={1} direction={\"column\"}>\n                <Grid item className={classes.fieldContainer}>\n                    <Box color=\"text.secondary\">\n                        pool size&emsp;\n                        <Tooltip title=\"Update the pool size\">\n                            <TextField\n                                id={useId() + \"poolSize\"}\n                                type=\"number\"\n                                size=\"small\"\n                                variant=\"outlined\"\n                                defaultValue={poolSize}\n                                onChange={handleChangedPoolSize}\n                                className={classes.field}\n                            />\n                        </Tooltip>\n                    </Box>\n                    <Box color=\"text.secondary\">\n                        stride&emsp;\n                        <Tooltip title=\"Update the stride\">\n                            <TextField\n                                id={useId() + \"stride\"}\n                                type=\"number\"\n                                size=\"small\"\n                                variant=\"outlined\"\n                                defaultValue={strideSize}\n                                onChange={handleChangedStrides}\n                                className={classes.field}\n                            />\n                        </Tooltip>\n                    </Box>\n                </Grid>\n                <Grid item>\n                    <Box color=\"text.secondary\">\n                        Output shape: [{outputShape.join(\", \")}]<br />\n                        Percent of total size: {percentSize.toPrecision(2)}%\n                        <br />\n                        Percent of total params: {percentParams.toPrecision(2)}%\n                        <br />\n                        Run time: {runTimeInMs.toPrecision(2)} ms <br />\n                    </Box>\n                </Grid>\n            </Grid>\n        </PointerBoundary>\n    )\n}\n\nexport default class PoolingLayerBlockField extends ReactInlineField {\n    static KEY = \"pooling_layer_block_field_key\"\n\n    constructor(value: string, previousValue?: any) {\n        super(value)\n        if (previousValue)\n            this.value = { ...this.defaultValue, ...previousValue }\n    }\n\n    static fromJson(options: ReactFieldJSON) {\n        return new PoolingLayerBlockField(options?.value)\n    }\n\n    /* This default value is specified here and in modelblockdsl.ts */\n    get defaultValue() {\n        return {\n            percentParams: 0,\n            percentSize: 0,\n            runTimeInMs: 0,\n            outputShape: [0, 0],\n            poolSize: 2,\n            strideSize: 1,\n        }\n    }\n\n    getText_() {\n        return ``\n    }\n\n    renderInlineField(): ReactNode {\n        return <LayerParameterWidget initFieldValue={this.value} />\n    }\n}\n","import React, { ReactNode, useContext, useEffect, useState } from \"react\"\nimport {\n    Box,\n    Grid,\n    Tooltip,\n    makeStyles,\n    Theme,\n    createStyles,\n    Button,\n} from \"@material-ui/core\"\nimport DownloadIcon from \"@material-ui/icons/GetApp\"\n// tslint:disable-next-line: no-submodule-imports match-default-export-name\n\nimport { ReactFieldJSON } from \"../ReactField\"\nimport ReactInlineField from \"../ReactInlineField\"\nimport { PointerBoundary } from \"../PointerBoundary\"\n\nimport WorkspaceContext, { resolveBlockServices } from \"../../WorkspaceContext\"\nimport ServiceManagerContext from \"../../../ServiceManagerContext\"\nimport FieldDataSet from \"../../../FieldDataSet\"\n\nexport interface RecordingBlockFieldValue {\n    numSamples: number\n    timestamp: number\n    inputTypes: string[]\n}\n\nfunction RecordingParameterWidget(props: {\n    initFieldValue: RecordingBlockFieldValue\n}) {\n    const { initFieldValue } = props\n    const { sourceBlock } = useContext(WorkspaceContext)\n\n    const { numSamples, inputTypes } = initFieldValue\n\n    const handleDownloadDataSet = () => {\n        console.log(\"Download recording\")\n        sourceBlock.data = \"click.download\"\n    }\n\n    return (\n        <PointerBoundary>\n            <Grid container spacing={1} direction={\"column\"}>\n                <Grid item>\n                    <Box color=\"text.secondary\">\n                        Total samples: {numSamples} <br />\n                        Input type(s):{\" \"}\n                        {inputTypes.length ? inputTypes.join(\", \") : \"none\"}\n                    </Box>\n                </Grid>\n                <Grid item style={{ display: \"inline-flex\" }}>\n                    <Tooltip title=\"Download recording as csv file\">\n                        <Button\n                            onClick={handleDownloadDataSet}\n                            startIcon={<DownloadIcon />}\n                            variant=\"outlined\"\n                            size=\"small\"\n                        >\n                            Download\n                        </Button>\n                    </Tooltip>\n                </Grid>\n            </Grid>\n        </PointerBoundary>\n    )\n}\n\nexport default class RecordingBlockField extends ReactInlineField {\n    static KEY = \"recording_block_field_key\"\n\n    constructor(value: string, previousValue?: any) {\n        super(value)\n        if (previousValue)\n            this.value = { ...this.defaultValue, ...previousValue }\n    }\n\n    static fromJson(options: ReactFieldJSON) {\n        return new RecordingBlockField(options?.value)\n    }\n\n    /* This default value is specified here and in modelblockdsl.ts */\n    get defaultValue() {\n        return {\n            numSamples: 0,\n            timestamp: 0,\n            inputTypes: [],\n        }\n    }\n\n    getText_() {\n        const { numSamples } = this.value\n\n        return `${numSamples} sample(s)`\n    }\n\n    renderInlineField(): ReactNode {\n        return <RecordingParameterWidget initFieldValue={this.value} />\n    }\n}\n","import React, { lazy, ReactNode, useContext, useEffect, useState } from \"react\"\nimport {\n    Box,\n    Button,\n    Grid,\n    Tooltip,\n    makeStyles,\n    Theme,\n    createStyles,\n} from \"@material-ui/core\"\nimport Suspense from \"../../../ui/Suspense\"\n\nimport { ReactFieldJSON } from \"../ReactField\"\nimport ReactInlineField from \"../ReactInlineField\"\nimport { PointerBoundary } from \"../PointerBoundary\"\n\nimport ViewIcon from \"@material-ui/icons/Visibility\"\n// tslint:disable-next-line: no-submodule-imports match-default-export-name\nimport DownloadIcon from \"@material-ui/icons/GetApp\"\n// tslint:disable-next-line: no-submodule-imports match-default-export-name\n\nimport { predictRequest } from \"../../dsl/workers/tf.proxy\"\nimport type { TFModelPredictRequest } from \"../../../../workers/tf/dist/node_modules/tf.worker\"\n\nimport WorkspaceContext, { resolveBlockServices } from \"../../WorkspaceContext\"\nimport { CHANGE } from \"../../../../../jacdac-ts/src/jdom/constants\"\n\nimport MBDataSet, { arraysEqual } from \"../../../model-editor/MBDataSet\"\nimport MBModel from \"../../../model-editor/MBModel\"\n\nconst ConfusionMatrixHeatMap = lazy(\n    () => import(\"../../../model-editor/components/ConfusionMatrixHeatMap\")\n)\nconst DataSetPlot = lazy(\n    () => import(\"../../../model-editor/components/DataSetPlot\")\n)\n\nconst useStyles = makeStyles((theme: Theme) =>\n    createStyles({\n        fieldContainer: {\n            lineHeight: \"2.5rem\",\n            width: \"15rem\",\n        },\n        field: {\n            width: theme.spacing(10),\n        },\n        inlineItem: {\n            height: theme.spacing(30),\n            overflowY: \"scroll\",\n        },\n    })\n)\n\nfunction TrainedModelDisplayWidget() {\n    const classes = useStyles()\n    const chartProps = {\n        CHART_WIDTH: 150,\n        CHART_HEIGHT: 150,\n        MARK_SIZE: 75,\n        TOOLTIP_NUM_FORMAT: \"0.2f\",\n        PALETTE: [\n            \"#003f5c\",\n            \"#ffa600\",\n            \"#665191\",\n            \"#a05195\",\n            \"#ff7c43\",\n            \"#d45087\",\n            \"#f95d6a\",\n            \"#2f4b7c\",\n        ],\n    }\n\n    const [chartType, setChartType] = useState<\n        \"confusion matrix\" | \"dataset plot\"\n    >(\"confusion matrix\")\n\n    const { sourceBlock } = useContext(WorkspaceContext)\n    const services = resolveBlockServices(sourceBlock)\n\n    const [dataSet, setDataSet] = useState(undefined)\n    const [model, setModel] = useState(undefined)\n    const [trainingPredictionResult, setTrainingPredictionResult] =\n        useState(undefined)\n    const [trainTimestamp, setTrainTimestamp] = useState(Date.now())\n    const [errorMsg, setErrorMsg] = useState(\"\")\n\n    // track workspace changes and re-render\n    useEffect(\n        () =>\n            services?.subscribe(CHANGE, () => {\n                sourceBlock.data = \"click.refreshdisplay\"\n\n                if (!services.data) {\n                    setErrorMsg(\"Please select a valid dataset\")\n                    return\n                }\n                setErrorMsg(\"\")\n\n                // grab the model and dataset to test with\n                const updatedDataSet = services.data[0] as MBDataSet\n                const updatedModel = services.data[1] as MBModel\n\n                if (!updatedModel || !updatedDataSet) return\n\n                // make sure dataset and model are compatible (same input data)\n                if (\n                    !arraysEqual(\n                        updatedDataSet.inputTypes,\n                        updatedModel.inputTypes\n                    ) ||\n                    updatedDataSet.length != updatedModel.inputShape[0] ||\n                    updatedDataSet.width != updatedModel.inputShape[1]\n                ) {\n                    setErrorMsg(\n                        \"The selected dataset does not have the same input/output type as the trained model\"\n                    )\n                    setDataSet(updatedDataSet)\n                    setModel(updatedModel)\n                    return\n                }\n                setErrorMsg(\"\")\n\n                // get selected chart\n                const selectedChart = sourceBlock\n                    .getField(\"SELECTED_CHART\")\n                    .getText()\n\n                // for confusion matrix and dataset plot predict on dataset\n                if (\n                    selectedChart == \"confusion matrix\" ||\n                    selectedChart == \"dataset plot\"\n                ) {\n                    const predictMsg = {\n                        worker: \"tf\",\n                        type: \"predict\",\n                        data: {\n                            zData: updatedDataSet.xs,\n                            model: updatedModel.toJSON(),\n                        },\n                    } as TFModelPredictRequest\n                    predictRequest(predictMsg).then(result => {\n                        if (result && result.data) {\n                            // convert prediction result to string\n                            const predictions = []\n                            result.data.predictTop.forEach(prediction => {\n                                predictions.push(\n                                    updatedModel.labels[prediction]\n                                )\n                            })\n                            setTrainingPredictionResult(predictions)\n                            setTrainTimestamp(Date.now())\n                        }\n                    })\n                }\n\n                setDataSet(updatedDataSet)\n                setModel(updatedModel)\n                setChartType(selectedChart)\n            }),\n        [services]\n    )\n\n    const handleViewTrainedModel = () => {\n        // open modal to view model\n        sourceBlock.data = \"click.view\"\n    }\n    const handleDownloadModel = () => {\n        // set the model name to what the user typed into the box\n        const trainedModelName = sourceBlock\n            .getField(\"TRAINED_MODEL_NAME\")\n            .getText()\n        if (model) model.name = trainedModelName\n\n        sourceBlock.data = \"click.download\"\n    }\n\n    if (errorMsg.length)\n        return (\n            <Grid container spacing={1} direction={\"column\"}>\n                <Grid item>\n                    <Box color=\"text.secondary\">\n                        Error: {errorMsg}\n                        <br />\n                    </Box>\n                    <br />\n                    {!!model && (\n                        <Box color=\"text.secondary\">\n                            Model input types: {model.inputTypes.join(\", \")}\n                            <br />\n                            Input shape: [{model.inputShape.join(\", \")}]\n                        </Box>\n                    )}\n                    <br />\n                    {!!dataSet && (\n                        <Box color=\"text.secondary\">\n                            Data set input types:{\" \"}\n                            {dataSet.inputTypes.join(\", \")}\n                            <br />\n                            Input shape: [{dataSet.length}, {dataSet.width}]\n                        </Box>\n                    )}\n                </Grid>\n                <Grid item style={{ display: \"inline-flex\" }}>\n                    <Tooltip title=\"View this model and perform actions like testing with live data\">\n                        <Button\n                            onClick={handleViewTrainedModel}\n                            startIcon={<ViewIcon />}\n                            variant=\"outlined\"\n                            size=\"small\"\n                        >\n                            View\n                        </Button>\n                    </Tooltip>\n                    &ensp;\n                    <Tooltip title=\"Download trained model file\">\n                        <Button\n                            onClick={handleDownloadModel}\n                            startIcon={<DownloadIcon />}\n                            variant=\"outlined\"\n                            size=\"small\"\n                        >\n                            Download\n                        </Button>\n                    </Tooltip>\n                </Grid>\n            </Grid>\n        )\n    else if (chartType == \"confusion matrix\")\n        return (\n            <Grid container spacing={1} direction={\"column\"}>\n                {!!model && !!dataSet && (\n                    <Grid item>\n                        <PointerBoundary>\n                            <Suspense>\n                                <ConfusionMatrixHeatMap\n                                    chartProps={chartProps}\n                                    yActual={dataSet.ys.map(\n                                        val => dataSet.labels[val]\n                                    )}\n                                    yPredicted={trainingPredictionResult}\n                                    labels={model.labels}\n                                    timestamp={trainTimestamp}\n                                />\n                            </Suspense>\n                        </PointerBoundary>\n                    </Grid>\n                )}\n                <Grid item style={{ display: \"inline-flex\" }}>\n                    <Tooltip title=\"View this model and perform actions like testing with live data\">\n                        <Button\n                            onClick={handleViewTrainedModel}\n                            startIcon={<ViewIcon />}\n                            variant=\"outlined\"\n                            size=\"small\"\n                        >\n                            View\n                        </Button>\n                    </Tooltip>\n                    &ensp;\n                    <Tooltip title=\"Download trained model file\">\n                        <Button\n                            onClick={handleDownloadModel}\n                            startIcon={<DownloadIcon />}\n                            variant=\"outlined\"\n                            size=\"small\"\n                        >\n                            Download\n                        </Button>\n                    </Tooltip>\n                </Grid>\n            </Grid>\n        )\n    else if (chartType == \"dataset plot\")\n        return (\n            <Grid container spacing={1} direction={\"column\"}>\n                {!!model && !!dataSet && (\n                    <Grid item>\n                        <PointerBoundary>\n                            <Suspense>\n                                <DataSetPlot\n                                    chartProps={chartProps}\n                                    reactStyle={classes}\n                                    dataset={dataSet}\n                                    predictedLabels={trainingPredictionResult}\n                                    timestamp={trainTimestamp}\n                                />\n                            </Suspense>\n                        </PointerBoundary>\n                    </Grid>\n                )}\n                <Grid item style={{ display: \"inline-flex\" }}>\n                    <Tooltip title=\"View this model and perform actions like testing with live data\">\n                        <Button\n                            onClick={handleViewTrainedModel}\n                            startIcon={<ViewIcon />}\n                            variant=\"outlined\"\n                            size=\"small\"\n                        >\n                            View\n                        </Button>\n                    </Tooltip>\n                    &ensp;\n                    <Tooltip title=\"Download trained model file\">\n                        <Button\n                            onClick={handleDownloadModel}\n                            startIcon={<DownloadIcon />}\n                            variant=\"outlined\"\n                            size=\"small\"\n                        >\n                            Download\n                        </Button>\n                    </Tooltip>\n                </Grid>\n            </Grid>\n        )\n}\n\nexport default class TrainedModelBlockField extends ReactInlineField {\n    static KEY = \"trained_model_block_field_key\"\n\n    constructor(value: string) {\n        super(value)\n    }\n\n    static fromJson(options: ReactFieldJSON) {\n        return new TrainedModelBlockField(options?.value)\n    }\n\n    getText_() {\n        return ``\n    }\n\n    renderInlineField(): ReactNode {\n        return <TrainedModelDisplayWidget />\n    }\n\n    updateFieldValue(msg: any) {\n        this.value = {\n            ...this.value,\n            ...msg,\n        }\n    }\n}\n","import Blockly, { Block } from \"blockly\"\nimport Flags from \"../../../jacdac-ts/src/jdom/flags\"\nimport { SMap, toMap } from \"../../../jacdac-ts/src/jdom/utils\"\nimport BlockDomainSpecificLanguage, { resolveDsl } from \"./dsl/dsl\"\nimport { ReactFieldBase } from \"./fields/ReactFieldBase\"\nimport {\n    VariableJSON,\n    WorkspaceJSON,\n    BlockJSON,\n    InputJSON,\n} from \"./dsl/workspacejson\"\n\nexport function workspaceToJSON(\n    workspace: Blockly.Workspace,\n    dsls: BlockDomainSpecificLanguage[],\n    top?: Block[]\n): WorkspaceJSON {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const clean = (o: any) =>\n        Object.keys(o)\n            .filter(k => o[k] === undefined || o[k] === null)\n            .forEach(k => delete o[k])\n    const builtins: SMap<(block: Blockly.Block) => string | number | boolean> =\n        {\n            logic_null: () => null,\n            text: block => block.getFieldValue(\"TEXT\"),\n            text_input: block => block.getFieldValue(\"TEXT\"),\n            math_number: block => Number(block.getFieldValue(\"NUM\") || \"0\"),\n            logic_boolean: block => block.getFieldValue(\"BOOL\") === \"TRUE\",\n        }\n\n    const variableToJSON = (variable: Blockly.VariableModel): VariableJSON => ({\n        name: variable.name,\n        type: variable.type,\n        id: variable.getId(),\n    })\n    const fieldsToJSON = (fields: Blockly.Field[]) =>\n        !fields.length\n            ? undefined\n            : toMap(\n                  fields,\n                  field => (field.name as string)?.toLowerCase(),\n                  fieldToJSON\n              )\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const xmlToJSON = (xml: Element): any => {\n        const j = {}\n        if (Flags.diagnostics) j[\"xml\"] = xml.outerHTML\n        // dump attributes\n        for (const name of xml\n            .getAttributeNames()\n            .filter(n => n !== \"preview\")) {\n            const v = xml.getAttribute(name)\n            j[name.toLowerCase()] = v\n        }\n        for (const child of xml.childNodes) {\n            if (child.nodeType === Node.TEXT_NODE) j[\"value\"] = xml.textContent\n            else if (child.nodeType === Node.ELEMENT_NODE) {\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                const children: any[] = j[\"children\"] || (j[\"children\"] = [])\n                children.push(xmlToJSON(child as Element))\n            }\n        }\n        return j\n    }\n    const fieldToJSON = (field: Blockly.Field) => {\n        if (field.isSerializable()) {\n            // custom field can just return the value\n            if (field instanceof ReactFieldBase) {\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                const value = (field as ReactFieldBase<any>).value\n                return { value }\n            } else {\n                const container = Blockly.utils.xml.createElement(\"field\")\n                const fieldXml = field.toXml(container)\n                return xmlToJSON(fieldXml)\n            }\n        }\n        return undefined\n    }\n    const flattenNext = (block: BlockJSON) => {\n        // flatten the linked list of next into an array\n        const children: BlockJSON[] = []\n        let current = block.next\n        while (current) {\n            children.push(current)\n            current = current.next\n        }\n        if (children.length) {\n            block.children = children\n            block.next = undefined\n        }\n    }\n    const blockToJSON = (block: Blockly.Block): BlockJSON => {\n        const blockToJSONHidden = (block: Blockly.Block): BlockJSON => {\n            // skip disabled blocks\n            if (!block?.isEnabled()) return undefined\n            // skip over insertion markers.\n            if (block.isInsertionMarker()) {\n                const child = block.getChildren(false)[0]\n                if (child) return blockToJSON(child)\n                else return undefined\n            }\n\n            const { type } = block\n            // allow DSL to handle conversion\n            let value = builtins[block.type]?.(block)\n            if (value === undefined) {\n                const dsl = resolveDsl(dsls, type)\n                value = dsl?.blockToValue?.(block)\n            }\n            const element: BlockJSON = {\n                type: block.type,\n                id: block.id,\n                value,\n                inputs:\n                    value === undefined\n                        ? block.inputList.map(input => {\n                              const container: InputJSON = {\n                                  type: input.type,\n                                  name: input.name,\n                                  fields: fieldsToJSON(input.fieldRow),\n                                  child: blockToJSON(\n                                      input.connection?.targetBlock()\n                                  ),\n                              }\n                              return container\n                          })\n                        : undefined,\n                next: blockToJSONHidden(block.getNextBlock()),\n            }\n            clean(element)\n            return element\n        }\n        const top = blockToJSONHidden(block)\n        if (top) {\n            flattenNext(top)\n            clean(top)\n        }\n        return top\n    }\n\n    try {\n        const variables = Blockly.Variables.allUsedVarModels(workspace).sort(\n            (l, r) => l.name.localeCompare(r.name)\n        ) // stable sort name\n        const todo = top || workspace.getTopBlocks(true)\n        const json: WorkspaceJSON = {\n            variables: variables.map(variableToJSON),\n            blocks: todo.map(blockToJSON).filter(b => !!b),\n        }\n        dsls.forEach(dsl => dsl.visitWorkspaceJSON?.(workspace, json))\n        dsls.forEach(dsl => dsl.onWorkspaceJSONChange?.(json))\n        return json\n    } catch (e) {\n        console.error(e)\n        return undefined\n    }\n}\n","import useDebouncedCallback from './useDebouncedCallback';\n/**\n * Creates a throttled function that only invokes `func` at most once per\n * every `wait` milliseconds (or once per browser frame). The throttled function\n * comes with a `cancel` method to cancel delayed `func` invocations and a\n * `flush` method to immediately invoke them. Provide `options` to indicate\n * whether `func` should be invoked on the leading and/or trailing edge of the\n * `wait` timeout. The `func` is invoked with the last arguments provided to the\n * throttled function. Subsequent calls to the throttled function return the\n * result of the last `func` invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the throttled function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * If `wait` is omitted in an environment with `requestAnimationFrame`, `func`\n * invocation will be deferred until the next frame is drawn (typically about\n * 16ms).\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `throttle` and `debounce`.\n *\n * @category Function\n * @param {Function} func The function to throttle.\n * @param {number} [wait=0]\n *  The number of milliseconds to throttle invocations to; if omitted,\n *  `requestAnimationFrame` is used (if available, otherwise it will be setTimeout(...,0)).\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=true]\n *  Specify invoking on the leading edge of the timeout.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new throttled function.\n * @example\n *\n * // Avoid excessively updating the position while scrolling.\n * const scrollHandler = useThrottledCallback(updatePosition, 100)\n * window.addEventListener('scroll', scrollHandler)\n *\n * // Invoke `renewToken` when the click event is fired, but not more than once every 5 minutes.\n * const { callback } = useThrottledCallback(renewToken, 300000, { 'trailing': false })\n * <button onClick={callback}>click</button>\n *\n * // Cancel the trailing throttled invocation.\n * window.addEventListener('popstate', throttled.cancel);\n */\n\nexport default function useThrottledCallback(func, wait, _a) {\n  var _b = _a === void 0 ? {} : _a,\n      _c = _b.leading,\n      leading = _c === void 0 ? true : _c,\n      _d = _b.trailing,\n      trailing = _d === void 0 ? true : _d;\n\n  return useDebouncedCallback(func, wait, {\n    maxWait: wait,\n    leading: leading,\n    trailing: trailing\n  });\n}","import { useState, useEffect } from \"react\"\nimport { CHANGE } from \"../../jacdac-ts/src/jdom/constants\"\nimport { IEventSource } from \"../../jacdac-ts/src/jdom/eventsource\"\nimport { useThrottledCallback } from \"use-debounce\"\n\nconst DEFAULT_THROTTLE = 200\nexport default function useChangeThrottled<TNode extends IEventSource, TValue>(\n    node: TNode,\n    query?: (n: TNode) => TValue,\n    time?: number,\n    deps?: React.DependencyList\n): TValue {\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    const [version, setVersion] = useState(node?.changeId || 0)\n    const value = query ? query(node) : undefined\n    const throttledSetVersion = useThrottledCallback(\n        setVersion,\n        time || DEFAULT_THROTTLE\n    )\n\n    useEffect(\n        () => node?.subscribe(CHANGE, () => throttledSetVersion(node.changeId)),\n        [node, ...(deps || [])]\n    )\n\n    return value\n}\n","import { useContext, useEffect, useState } from \"react\"\nimport { useDebounce } from \"use-debounce\"\nimport WorkspaceContext from \"./WorkspaceContext\"\n\nexport default function useDragDebounce<T>(value: T, delay?: number): T {\n    const { dragging } = useContext(WorkspaceContext)\n    const [debounced] = useDebounce(value, delay)\n    const [valueAtDragging, setValueAtDragging] = useState(debounced)\n\n    // record value when starting to drag\n    useEffect(() => {\n        if (dragging) setValueAtDragging(value)\n    }, [dragging])\n\n    // return value at dragging until drag is completed\n    return dragging ? valueAtDragging : debounced\n}\n","import { BlockServices, BlockWithServices } from \"./WorkspaceContext\"\nimport { Block } from \"blockly\"\nimport { useCallback, useEffect } from \"react\"\nimport useChangeThrottled from \"../../jacdac/useChangeThrottled\"\nimport useDragDebounce from \"./useDragDebounce\"\n\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport default function useBlockData<T extends object>(\n    block: Block,\n    initialValue?: T[]\n) {\n    const services = (block as unknown as BlockWithServices)?.jacdacServices\n    // data on the current node\n    const { data, transformedData } = useChangeThrottled<\n        BlockServices,\n        { data: T[]; transformedData: T[] }\n    >(services, _ => ({\n        data: _?.data as T[],\n        transformedData: _?.transformedData as T[],\n    }))\n    const setData = useCallback(\n        (value: T[]) => {\n            if (services) services.data = value\n        },\n        [services]\n    )\n\n    // set initial value\n    useEffect(() => {\n        if (\n            services &&\n            initialValue !== undefined &&\n            services.data === undefined\n        )\n            services.data = initialValue\n    }, [services])\n\n    // debounce with dragging\n    const debounced = useDragDebounce(data)\n    const debouncedTransformedData = useDragDebounce(transformedData)\n\n    return {\n        data: debounced,\n        transformedData: debouncedTransformedData,\n        setData,\n    }\n}\n","import { Chip } from \"@material-ui/core\"\nimport React, { useContext } from \"react\"\nimport OpenInBrowserIcon from \"@material-ui/icons/OpenInBrowser\"\nimport FileSystemContext from \"../FileSystemContext\"\nimport useChange from \"../../jacdac/useChange\"\n\nexport default function FileSystemChip() {\n    const { fileSystem, showDirectoryPicker } = useContext(FileSystemContext)\n    const root = useChange(fileSystem, _ => _?.root)\n    const handleOpenDirectory = showDirectoryPicker\n    const handleCloseDirectory = () => (fileSystem.root = undefined)\n\n    if (!fileSystem) return null\n\n    return (\n        <Chip\n            clickable\n            avatar={<OpenInBrowserIcon />}\n            label={root?.name || \"open directory\"}\n            onClick={handleOpenDirectory}\n            onDelete={root ? handleCloseDirectory : undefined}\n        />\n    )\n}\n","import {\n    Chip,\n    Dialog,\n    DialogContent,\n    DialogContentText,\n    TextField,\n    DialogActions,\n    Button,\n} from \"@material-ui/core\"\nimport React, { ChangeEvent, useContext, useState } from \"react\"\nimport AddIcon from \"@material-ui/icons/Add\"\nimport { useId } from \"react-use-id-hook\"\nimport FileSystemContext from \"../FileSystemContext\"\n\nexport default function FileNewFileChip(props: {\n    name?: string\n    content: string\n    label?: string\n    extension?: string\n}) {\n    const {\n        name: newFileName,\n        content: newFileContent,\n        label,\n        extension,\n    } = props\n    const { fileSystem } = useContext(FileSystemContext)\n    const [open, setOpen] = useState(false)\n    const [value, setValue] = useState(\"\")\n    const valueId = useId()\n\n    const handleOpen = () => {\n        setValue(\"\")\n        setOpen(true)\n    }\n    const handleOk = async () => {\n        setOpen(false)\n        let name = value.toLocaleLowerCase().replace(/\\s+/g, \"\")\n        if (newFileName)\n            await fileSystem.createWorkingDirectory(\n                name,\n                newFileName,\n                newFileContent\n            )\n        else {\n            if (extension) name += `.${extension}`\n            const d = fileSystem.workingDirectory || fileSystem.root\n            const f = await d.fileAsync(name, { create: true })\n            await f.write(newFileContent)\n            fileSystem.workingFile = f\n        }\n    }\n    const handleCancel = () => setOpen(false)\n    const handleValueChange = (event: ChangeEvent<HTMLInputElement>) => {\n        setValue(event.target.value)\n    }\n\n    return (\n        <>\n            <Chip\n                clickable\n                label={label || \"new...\"}\n                icon={<AddIcon />}\n                onClick={handleOpen}\n            />\n            <Dialog open={open} fullWidth={true}>\n                <DialogContent>\n                    <DialogContentText>Choose a project name</DialogContentText>\n                    <TextField\n                        id={valueId}\n                        value={value}\n                        label=\"Value\"\n                        fullWidth={true}\n                        onChange={handleValueChange}\n                    />\n                </DialogContent>\n                <DialogActions>\n                    <Button variant=\"contained\" onClick={handleCancel}>\n                        Cancel\n                    </Button>\n                    <Button\n                        variant=\"contained\"\n                        color=\"primary\"\n                        disabled={!value}\n                        onClick={handleOk}\n                    >\n                        Ok\n                    </Button>\n                </DialogActions>\n            </Dialog>\n        </>\n    )\n}\n","import { Chip } from \"@material-ui/core\"\nimport React from \"react\"\nimport { FileSystemNode } from \"./fsdom\"\n\nexport default function FileSystemNodeChip(props: {\n    node: FileSystemNode\n    selected?: boolean\n    onClick: () => void\n}) {\n    const { node, selected, onClick } = props\n    const { name } = node\n    return (\n        <Chip\n            clickable\n            label={name.replace(/\\.json$/i, \"\")}\n            color={selected ? \"primary\" : undefined}\n            onClick={onClick}\n        />\n    )\n}\n","import { Grid } from \"@material-ui/core\"\nimport React, { useContext, useRef } from \"react\"\nimport useKeyboardNavigationProps from \"../hooks/useKeyboardNavigationProps\"\nimport FileSystemContext from \"../FileSystemContext\"\nimport useChange from \"../../jacdac/useChange\"\nimport FileSystemChip from \"./FileSystemChip\"\nimport FileNewFileChip from \"./FileNewFileChip\"\nimport FileSystemNodeChip from \"./FileSystemNodeChip\"\n\nexport default function FileTabs(props: {\n    newFileName?: string\n    newFileExtension?: string\n    newFileContent?: string\n    newFileLabel?: string\n    hideDirectories?: boolean\n    hideFiles?: boolean\n    directoryFilter?: (directory: string) => boolean\n    fileFilter?: (file: string) => boolean\n}) {\n    const {\n        newFileName,\n        newFileContent,\n        hideDirectories,\n        hideFiles,\n        directoryFilter,\n        fileFilter,\n        newFileLabel,\n        newFileExtension\n    } = props\n    const { fileSystem } = useContext(FileSystemContext)\n    const root = useChange(fileSystem, _ => _?.root)\n    const workingDirectory = useChange(fileSystem, _ => _?.workingDirectory)\n    const workingFile = useChange(fileSystem, _ => _?.workingFile)\n    const directories = useChange(root, _ =>\n        _?.directories?.filter(d => !directoryFilter || directoryFilter(d.name))\n    )\n    const files = useChange(root, _ =>\n        _?.files?.filter(d => !fileFilter || fileFilter(d.name))\n    )\n    const gridRef = useRef()\n    const keyboardProps = useKeyboardNavigationProps(gridRef.current)\n    const handleDirectorySelected = handle => () =>\n        (fileSystem.workingDirectory = handle)\n    const handleFileSelected = handle => () => (fileSystem.workingFile = handle)\n\n    if (!fileSystem) return null\n\n    return (\n        <Grid ref={gridRef} container spacing={1} {...keyboardProps}>\n            <Grid item>\n                <FileSystemChip />\n            </Grid>\n            {!hideDirectories &&\n                directories?.map(node => (\n                    <Grid item key={node.name}>\n                        <FileSystemNodeChip\n                            node={node}\n                            selected={node === workingDirectory}\n                            onClick={handleDirectorySelected(node)}\n                        />\n                    </Grid>\n                ))}\n            {!hideFiles &&\n                files?.map(node => (\n                    <Grid item key={node.name}>\n                        <FileSystemNodeChip\n                            node={node}\n                            selected={node === workingFile}\n                            onClick={handleFileSelected(node)}\n                        />\n                    </Grid>\n                ))}\n            {root && newFileContent && (\n                <Grid item>\n                    <FileNewFileChip\n                        name={newFileName}\n                        content={newFileContent}\n                        label={newFileLabel}\n                        extension={newFileExtension}\n                    />\n                </Grid>\n            )}\n        </Grid>\n    )\n}\n","import React, { KeyboardEvent } from \"react\"\nimport { keyCodeFromEvent } from \"./useFireKey\";\n\nconst LEFT_KEY = 37;\nconst UP_KEY = 38;\nconst RIGHT_KEY = 39;\nconst DOWN_KEY = 40;\n\nexport default function useArrowKeys(options: {\n    onLeft?: () => void,\n    onRight?: () => void,\n    onUp?: () => void,\n    onDown?: () => void,\n    symmetric?: boolean;\n}) {\n    const { onLeft, onUp, onRight, onDown, symmetric } = options;\n\n    if (!onLeft && !onUp && !onRight && !onDown)\n        return undefined;\n\n    const handlers = {\n        [LEFT_KEY]: onLeft,\n        [RIGHT_KEY]: onRight,\n        [UP_KEY]: onUp || (symmetric && onRight),\n        [DOWN_KEY]: onDown || (symmetric && onLeft)\n    }\n\n    return (e: KeyboardEvent<Element>) => {\n        const charCode = keyCodeFromEvent(e);\n        const handler = handlers[charCode];\n        if (handler) {\n            e.preventDefault();\n            handler();\n        }\n    }\n}\n","import React from \"react\"\n\nexport default function useKeyboardNavigation(parentRef: Element) {\n    const query = '[tabindex=\"0\"]';\n    const onMove = (offset: number) => () => {\n        console.log('keyboard move', { offset })\n        const focusable = Array.from<SVGElement>(parentRef?.querySelectorAll(query) || []);\n        if (focusable.length) {\n            const me = focusable.findIndex(f => f === document.activeElement);\n            const next = ((me + offset) + focusable.length) % focusable.length;\n            focusable[next].focus();\n        }\n    }\n    return onMove;\n}","import useArrowKeys from \"./useArrowKeys\";\nimport useKeyboardNavigation from \"./useKeyboardNavigation\";\n\nexport default function useKeyboardNavigationProps(parentRef: Element, vertical?: boolean) {\n    const onMove = useKeyboardNavigation(parentRef);\n\n    const onKeyDown = useArrowKeys({\n        onLeft: !vertical && onMove(-1),\n        onRight: !vertical && onMove(1),\n        onDown: vertical && onMove(1),\n        onUp: vertical && onMove(-1),\n    });\n\n    return {\n        onKeyDown: parentRef && onKeyDown\n    }\n}","import { useContext } from \"react\"\nimport DeviceFilter from \"../../../jacdac-ts/src/jdom/filters/devicefilter\"\nimport ServiceFilter from \"../../../jacdac-ts/src/jdom/filters/servicefilter\"\nimport JacdacContext, { JacdacContextProps } from \"../../jacdac/Context\"\nimport useChange from \"../../jacdac/useChange\"\n\nexport default function useServices(options?: ServiceFilter & DeviceFilter) {\n    const { bus } = useContext<JacdacContextProps>(JacdacContext)\n    const services = useChange(bus, _ => _?.services(options) || [], [\n        JSON.stringify(options),\n    ])\n    return services\n}\n","import {\n    BlockDefinition,\n    CategoryDefinition,\n    MODEL_BLOCK_CLASS_STATEMENT_TYPE,\n    MODEL_BLOCK_LAYER_STATEMENT_TYPE,\n} from \"../blockly/toolbox\"\nimport BlockDomainSpecificLanguage from \"../blockly/dsl/dsl\"\n\nimport ExpandModelBlockField from \"../blockly/fields/mb/ExpandModelBlockField\"\nimport DataSetBlockButton from \"../blockly/fields/mb/DataSetBlockButton\"\nimport NeuralNetworkBlockButton from \"../blockly/fields/mb/NeuralNetworkBlockButtons\"\nimport TrainedModelBlockField from \"../blockly/fields/mb/TrainedModelBlockField\"\n\nexport const MODEL_BLOCKS = \"model_block_\"\nexport const MB_DATASET_VAR_TYPE = \"ModelBlockDataSet\"\nexport const MB_CLASS_VAR_TYPE = \"ModelBlockClass\"\nexport const MB_CLASSIFIER_VAR_TYPE = \"ModelBlockClassifier\"\n\nconst dataset_color = \"#123456\"\nconst class_color = \"#2466A8\"\nconst learning_color = \"#561234\"\nconst layer_color = \"#97207a\"\n\nexport class ModelBlockDomainSpecificLanguage\n    implements BlockDomainSpecificLanguage\n{\n    id = \"modelBlocks\"\n    createBlocks() {\n        const blocks: BlockDefinition[] = [\n            /* DataSet blocks */\n            {\n                kind: \"block\",\n                type: MODEL_BLOCKS + \"dataset\",\n                message0: \"dataset %1 %2\",\n                args0: [\n                    {\n                        type: \"field_variable\",\n                        name: \"DATASET_NAME\",\n                        variable: \"dataset1\",\n                        variableTypes: [MB_DATASET_VAR_TYPE],\n                        defaultType: MB_DATASET_VAR_TYPE,\n                    },\n                    {\n                        type: ExpandModelBlockField.KEY,\n                        name: \"EXPAND_BUTTON\",\n                    },\n                ],\n                message1: \"%1\",\n                args1: [\n                    {\n                        type: DataSetBlockButton.KEY,\n                        name: \"DATASET_BUTTONS\",\n                    },\n                ],\n                message2: \"%1\",\n                args2: [\n                    {\n                        type: \"input_statement\",\n                        name: \"LAYER_INPUTS\",\n                        check: [MODEL_BLOCK_CLASS_STATEMENT_TYPE],\n                    },\n                ],\n                inputsInline: false,\n                colour: dataset_color,\n                tooltip:\n                    \"Use this block to define a dataset; it only takes class blocks. Add more information to datasets by creating new classes and stacking them inside dataset blocks. Click on the inspector icon to view more details about this dataset or to generate a new dataset from this one\",\n                helpUrl: \"\",\n                hat: true,\n            } as BlockDefinition,\n            {\n                kind: \"block\",\n                type: MODEL_BLOCKS + \"recording\",\n                message0: \"recording %1 %2 %3\",\n                args0: [\n                    {\n                        type: \"field_input\",\n                        name: \"RECORDING_NAME\",\n                        text: \"recording0\",\n                    },\n                    {\n                        type: \"field_variable\",\n                        name: \"CLASS_NAME\",\n                        variable: \"class1\",\n                        variableTypes: [MB_CLASS_VAR_TYPE],\n                        defaultType: MB_CLASS_VAR_TYPE,\n                    },\n                    {\n                        type: ExpandModelBlockField.KEY,\n                        name: \"EXPAND_BUTTON\",\n                    },\n                ],\n                inputsInline: false,\n                previousStatement: MODEL_BLOCK_CLASS_STATEMENT_TYPE,\n                nextStatement: MODEL_BLOCK_CLASS_STATEMENT_TYPE,\n                colour: class_color,\n                tooltip:\n                    \"Use this recording block to define your classes. Click on the plus icon to download this recording\",\n                helpUrl: \"\",\n            } as BlockDefinition,\n            /* Classifier Blocks */\n            {\n                kind: \"block\",\n                type: MODEL_BLOCKS + \"nn\",\n                message0: \"neural network classifier %1\",\n                args0: [\n                    {\n                        type: \"field_variable\",\n                        name: \"CLASSIFIER_NAME\",\n                        variable: \"classifier1\",\n                        variableTypes: [MB_CLASSIFIER_VAR_TYPE],\n                        defaultType: MB_CLASSIFIER_VAR_TYPE,\n                    },\n                ],\n                message1: \" training data %1 %2\",\n                args1: [\n                    {\n                        type: \"field_variable\",\n                        name: \"NN_TRAINING\",\n                        variable: \"dataset1\",\n                        variableTypes: [MB_DATASET_VAR_TYPE],\n                        defaultType: MB_DATASET_VAR_TYPE,\n                    },\n                    {\n                        type: ExpandModelBlockField.KEY,\n                        name: \"EXPAND_BUTTON\",\n                    },\n                ],\n                message2: \"%1\",\n                args2: [\n                    {\n                        type: NeuralNetworkBlockButton.KEY,\n                        name: \"NN_BUTTONS\",\n                    },\n                ],\n                message3: \"%1\",\n                args3: [\n                    {\n                        type: \"input_statement\",\n                        name: \"LAYER_INPUTS\",\n                        check: [MODEL_BLOCK_LAYER_STATEMENT_TYPE],\n                    },\n                ],\n                inputsInline: false,\n                colour: learning_color,\n                tooltip:\n                    \"Use this block to define a neural network classifier; it only takes layer blocks.\",\n                helpUrl: \"\",\n            } as BlockDefinition,\n            {\n                kind: \"block\",\n                type: MODEL_BLOCKS + \"trained_nn\",\n                message0: \"trained model %1\",\n                args0: [\n                    {\n                        type: \"field_input\",\n                        name: \"TRAINED_MODEL_NAME\",\n                        text: \"classifier1.t\",\n                    },\n                ],\n                message1: \"testing data %1\",\n                args1: [\n                    {\n                        type: \"field_variable\",\n                        name: \"MODEL_TEST_SET\",\n                        variable: \"dataset1\",\n                        variableTypes: [MB_DATASET_VAR_TYPE],\n                        defaultType: MB_DATASET_VAR_TYPE,\n                    },\n                ],\n                message2: \"display %1\",\n                args2: [\n                    {\n                        type: \"field_dropdown\",\n                        options: [\"confusion matrix\", \"dataset plot\"].map(s => [\n                            s,\n                            s,\n                        ]),\n                        name: \"SELECTED_CHART\",\n                    },\n                ],\n                message3: \"%1\",\n                args3: [\n                    {\n                        type: TrainedModelBlockField.KEY,\n                        name: \"TRAINED_MODEL_DISPLAY\",\n                    },\n                ],\n                inputsInline: false,\n                colour: learning_color,\n                tooltip:\n                    \"Use this block to test a trained model with different datasets.\",\n                helpUrl: \"\",\n            } as BlockDefinition,\n            {\n                kind: \"block\",\n                type: MODEL_BLOCKS + \"conv1d_layer\",\n                message0: \"convolution1d (16, 2, 1) %1\",\n                args0: [\n                    {\n                        type: ExpandModelBlockField.KEY,\n                        name: \"EXPAND_BUTTON\",\n                    },\n                ],\n                inputsInline: false,\n                previousStatement: [MODEL_BLOCK_LAYER_STATEMENT_TYPE],\n                nextStatement: MODEL_BLOCK_LAYER_STATEMENT_TYPE,\n                colour: layer_color,\n                tooltip:\n                    \"Use this block to add a 1D convolutional layer to a neural network classifier. Convolutional layers are often used to summarize key features from input data.\",\n                helpUrl: \"\",\n            } as BlockDefinition,\n            {\n                kind: \"block\",\n                type: MODEL_BLOCKS + \"maxpool1d_layer\",\n                message0: \"max pool1d (2, 1) %1\",\n                args0: [\n                    {\n                        type: ExpandModelBlockField.KEY,\n                        name: \"EXPAND_BUTTON\",\n                    },\n                ],\n                inputsInline: false,\n                previousStatement: [MODEL_BLOCK_LAYER_STATEMENT_TYPE],\n                nextStatement: MODEL_BLOCK_LAYER_STATEMENT_TYPE,\n                colour: layer_color,\n                tooltip: \"\",\n                helpUrl: \"\",\n            } as BlockDefinition,\n            {\n                kind: \"block\",\n                type: MODEL_BLOCKS + \"avgpool1d_layer\",\n                message0: \"average pool1d (2, 1) %1\",\n                args0: [\n                    {\n                        type: ExpandModelBlockField.KEY,\n                        name: \"EXPAND_BUTTON\",\n                    },\n                ],\n                inputsInline: false,\n                previousStatement: [MODEL_BLOCK_LAYER_STATEMENT_TYPE],\n                nextStatement: MODEL_BLOCK_LAYER_STATEMENT_TYPE,\n                colour: layer_color,\n                tooltip: \"\",\n                helpUrl: \"\",\n            } as BlockDefinition,\n\n            {\n                kind: \"block\",\n                type: MODEL_BLOCKS + \"conv2d_layer\",\n                message0: \"convolution2d (16, 2, 1) %1\",\n                args0: [\n                    {\n                        type: ExpandModelBlockField.KEY,\n                        name: \"EXPAND_BUTTON\",\n                    },\n                ],\n                inputsInline: false,\n                previousStatement: [MODEL_BLOCK_LAYER_STATEMENT_TYPE],\n                nextStatement: MODEL_BLOCK_LAYER_STATEMENT_TYPE,\n                colour: layer_color,\n                tooltip:\n                    \"Use this block to add a 2D convolutional layer to a neural network classifier. Convolutional layers are often used to summarize key features from input data.\",\n                helpUrl: \"\",\n            } as BlockDefinition,\n            {\n                kind: \"block\",\n                type: MODEL_BLOCKS + \"maxpool2d_layer\",\n                message0: \"max pool2d (2, 1) %1\",\n                args0: [\n                    {\n                        type: ExpandModelBlockField.KEY,\n                        name: \"EXPAND_BUTTON\",\n                    },\n                ],\n                inputsInline: false,\n                previousStatement: [MODEL_BLOCK_LAYER_STATEMENT_TYPE],\n                nextStatement: MODEL_BLOCK_LAYER_STATEMENT_TYPE,\n                colour: layer_color,\n                tooltip: \"\",\n                helpUrl: \"\",\n            } as BlockDefinition,\n            {\n                kind: \"block\",\n                type: MODEL_BLOCKS + \"avgpool2d_layer\",\n                message0: \"average pool2d (2, 1) %1\",\n                args0: [\n                    {\n                        type: ExpandModelBlockField.KEY,\n                        name: \"EXPAND_BUTTON\",\n                    },\n                ],\n                inputsInline: false,\n                previousStatement: [MODEL_BLOCK_LAYER_STATEMENT_TYPE],\n                nextStatement: MODEL_BLOCK_LAYER_STATEMENT_TYPE,\n                colour: layer_color,\n                tooltip: \"\",\n                helpUrl: \"\",\n            } as BlockDefinition,\n            {\n                kind: \"block\",\n                type: MODEL_BLOCKS + \"dropout_layer\",\n                message0: \"dropout (0.1) %1\",\n                args0: [\n                    {\n                        type: ExpandModelBlockField.KEY,\n                        name: \"EXPAND_BUTTON\",\n                    },\n                ],\n                inputsInline: false,\n                previousStatement: [MODEL_BLOCK_LAYER_STATEMENT_TYPE],\n                nextStatement: MODEL_BLOCK_LAYER_STATEMENT_TYPE,\n                colour: layer_color,\n                tooltip: \"\",\n                helpUrl: \"\",\n            } as BlockDefinition,\n            {\n                kind: \"block\",\n                type: MODEL_BLOCKS + \"flatten_layer\",\n                message0: \"flatten %1\",\n                args0: [\n                    {\n                        type: ExpandModelBlockField.KEY,\n                        name: \"EXPAND_BUTTON\",\n                    },\n                ],\n                inputsInline: false,\n                previousStatement: [MODEL_BLOCK_LAYER_STATEMENT_TYPE],\n                nextStatement: MODEL_BLOCK_LAYER_STATEMENT_TYPE,\n                colour: layer_color,\n                tooltip: \"\",\n                helpUrl: \"\",\n            } as BlockDefinition,\n            {\n                kind: \"block\",\n                type: MODEL_BLOCKS + \"dense_layer\",\n                message0: \"dense (4, relu) %1\",\n                args0: [\n                    {\n                        type: ExpandModelBlockField.KEY,\n                        name: \"EXPAND_BUTTON\",\n                    },\n                ],\n                inputsInline: false,\n                previousStatement: [MODEL_BLOCK_LAYER_STATEMENT_TYPE],\n                nextStatement: MODEL_BLOCK_LAYER_STATEMENT_TYPE,\n                colour: layer_color,\n                tooltip: \"\",\n                helpUrl: \"\",\n            } as BlockDefinition,\n        ]\n        return blocks\n    }\n\n    createCategory() {\n        return [<CategoryDefinition>(<unknown>{\n                kind: \"category\",\n                name: \"Data sets\",\n                colour: dataset_color,\n                contents: [\n                    {\n                        kind: \"label\",\n                        text: \"Recordings\",\n                    },\n                    {\n                        kind: \"button\",\n                        text: \"Create new recording...\",\n                        callbackKey: \"createNewRecordingButton\",\n                    },\n                    {\n                        kind: \"label\",\n                        text: \"Datasets\",\n                    },\n                    {\n                        kind: \"button\",\n                        text: \"Create new dataset variable...\",\n                        callbackKey: \"createNewDataSetButton\",\n                    },\n                    {\n                        kind: \"block\",\n                        type: MODEL_BLOCKS + \"dataset\",\n                    },\n                ],\n            }), <CategoryDefinition>(<unknown>{\n                kind: \"category\",\n                name: \"Models\",\n                colour: learning_color,\n                contents: [\n                    {\n                        kind: \"label\",\n                        text: \"Classifiers\",\n                    },\n                    {\n                        kind: \"button\",\n                        text: \"Create new classifier variable...\",\n                        callbackKey: \"createNewClassifierButton\",\n                    },\n                    {\n                        kind: \"label\",\n                        text: \"Layers\",\n                    },\n                    {\n                        kind: \"block\",\n                        blockxml: `<block type=\"model_block_conv1d_layer\"><field name=\"EXPAND_BUTTON\">{\"parametersVisible\":false,\"percentSize\":0,\"percentParams\":0,\"runTimeInMs\":0,\"outputShape\":[0,0],\"numFilters\":16,\"kernelSize\":2,\"strideSize\":1,\"activation\":\"relu\"}</field></block>`,\n                    },\n                    {\n                        kind: \"block\",\n                        blockxml: `<block type=\"model_block_maxpool1d_layer\"><field name=\"EXPAND_BUTTON\">{\"parametersVisible\":false,\"percentSize\":0,\"percentParams\":0,\"runTimeInMs\":0,\"outputShape\":[0,0],\"poolSize\":2,\"strideSize\":1}</field></block>`,\n                    },\n                    /*{\n                        kind: \"block\",\n                        blockxml: `<block type=\"model_block_avgpool1d_layer\"><field name=\"EXPAND_BUTTON\">{\"parametersVisible\":false,\"percentSize\":0,\"percentParams\":0,\"runTimeInMs\":0,\"outputShape\":[0,0],\"poolSize\":2,\"strideSize\":1}</field></block>`,\n                    },*/\n                    {\n                        kind: \"block\",\n                        blockxml: `<block type=\"model_block_conv2d_layer\"><field name=\"EXPAND_BUTTON\">{\"parametersVisible\":false,\"percentSize\":0,\"percentParams\":0,\"runTimeInMs\":0,\"outputShape\":[0,0,0],\"numFilters\":16,\"kernelSize\":2,\"strideSize\":1,\"activation\":\"relu\"}</field></block>`,\n                    },\n                    {\n                        kind: \"block\",\n                        blockxml: `<block type=\"model_block_maxpool2d_layer\"><field name=\"EXPAND_BUTTON\">{\"parametersVisible\":false,\"percentSize\":0,\"percentParams\":0,\"runTimeInMs\":0,\"outputShape\":[0,0,0],\"poolSize\":2,\"strideSize\":1}</field></block>`,\n                    },\n                    /*{\n                        kind: \"block\",\n                        blockxml: `<block type=\"model_block_avgpool2d_layer\"><field name=\"EXPAND_BUTTON\">{\"parametersVisible\":false,\"percentSize\":0,\"percentParams\":0,\"runTimeInMs\":0,\"outputShape\":[0,0,0],\"poolSize\":2,\"strideSize\":1}</field></block>`,\n                    },*/\n                    {\n                        kind: \"block\",\n                        blockxml: `<block type=\"model_block_dropout_layer\"><field name=\"EXPAND_BUTTON\">{\"parametersVisible\":false,\"percentSize\":0,\"percentParams\":0,\"runTimeInMs\":0,\"outputShape\":[0,0],\"rate\":0.1}</field></block>`,\n                    },\n                    {\n                        kind: \"block\",\n                        blockxml: `<block type=\"model_block_flatten_layer\"><field name=\"EXPAND_BUTTON\">{\"parametersVisible\":false,\"percentSize\":0,\"percentParams\":0,\"runTimeInMs\":0,\"outputShape\":[0]}</field></block>`,\n                    },\n                    {\n                        kind: \"block\",\n                        blockxml: `<block type=\"model_block_dense_layer\"><field name=\"EXPAND_BUTTON\">{\"parametersVisible\":false,\"percentSize\":0,\"percentParams\":0,\"runTimeInMs\":0,\"outputShape\":[0],\"numUnits\":4,\"activation\":\"relu\"}</field></block>`,\n                    },\n                ],\n            })]\n    }\n}\n\nconst modelBlockDsl = new ModelBlockDomainSpecificLanguage()\nexport default modelBlockDsl\n","import {\n    createTheme,\n    responsiveFontSizes,\n    ThemeOptions,\n    ThemeProvider,\n} from \"@material-ui/core\"\nimport React, { useContext } from \"react\"\nimport DarkModeContext from \"./DarkModeContext\"\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport default function AppTheme(props: any) {\n    const { darkMode } = useContext(DarkModeContext)\n    const isDark = darkMode === \"dark\"\n    const themeDef: ThemeOptions = {\n        palette: {\n            primary: {\n                main: isDark ? \"#56d364\" : \"#2e7d32\",\n            },\n            secondary: {\n                main: \"#ffc400\",\n            },\n            contrastThreshold: isDark ? 5.1 : 3.1,\n            type: darkMode,\n        },\n    }\n    const rawTheme = createTheme(themeDef)\n    const theme = responsiveFontSizes(rawTheme)\n    return <ThemeProvider theme={theme} {...props} />\n}\n","import React, { useState } from \"react\"\nimport FileCopyIcon from \"@material-ui/icons/FileCopy\"\nimport DoneIcon from \"@material-ui/icons/Done\"\nimport ReportProblemIcon from \"@material-ui/icons/ReportProblem\"\nimport IconButtonWithTooltip from \"./IconButtonWithTooltip\"\nimport { Button } from \"@material-ui/core\"\nimport useMounted from \"../hooks/useMounted\"\nimport { delay } from \"../../../jacdac-ts/src/jdom/utils\"\n\ndeclare class ClipboardItem {\n    constructor(input: { [contentType: string]: Blob })\n}\ndeclare type AsyncClipboardWriteFunction = (\n    input: ClipboardItem\n) => Promise<void>\n\ndeclare global {\n    interface Window {\n        ClipboardItem: ClipboardItem | undefined\n    }\n\n    interface Clipboard {\n        write?: AsyncClipboardWriteFunction\n    }\n}\n\nexport default function CopyButton(props: {\n    label?: string\n    title?: string\n    onCopy: () => Promise<string | HTMLCanvasElement>\n    className?: string\n    size?: \"small\"\n}) {\n    const { label, title = \"copy data to clipboard\", onCopy, ...rest } = props\n    const [copied, setCopied] = useState<boolean>(undefined)\n    const mounted = useMounted()\n    const handleClick = async (ev: React.MouseEvent<HTMLButtonElement>) => {\n        ev.stopPropagation()\n        ev.preventDefault()\n\n        try {\n            setCopied(null)\n            const copied = await onCopy()\n            if (typeof copied === \"string\") {\n                const text = copied as string\n                await navigator.clipboard.writeText(text)\n            } else {\n                const canvas = copied as HTMLCanvasElement\n                const blob = await new Promise<Blob>(resolve =>\n                    canvas.toBlob(blob => resolve(blob))\n                )\n                const item = new ClipboardItem({ \"image/png\": blob })\n                navigator.clipboard.write([item])\n            }\n            if (mounted()) setCopied(true)\n        } catch (e) {\n            console.debug(e)\n            if (mounted()) setCopied(false)\n        } finally {\n            await delay(1000)\n            if (mounted()) setCopied(undefined)\n        }\n    }\n    const disabled = copied !== undefined\n    const text =\n        copied === true\n            ? \"Copied!\"\n            : copied === false\n            ? \"Copy failed\"\n            : label || \"copy to clipboard\"\n    return label ? (\n        <Button\n            title={title}\n            {...rest}\n            onClick={disabled ? undefined : handleClick}\n        >\n            {text}\n        </Button>\n    ) : (\n        <IconButtonWithTooltip\n            trackName=\"ui.copy\"\n            title={text}\n            {...rest}\n            onClick={disabled ? undefined : handleClick}\n        >\n            {copied === true ? (\n                <DoneIcon />\n            ) : copied === false ? (\n                <ReportProblemIcon />\n            ) : (\n                <FileCopyIcon />\n            )}\n        </IconButtonWithTooltip>\n    )\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\nfunction mkTitle(txt: string): SVGTitleElement {\n    const t = <SVGTitleElement>elt(\"title\")\n    t.textContent = txt\n    return t\n}\nexport function title(el: SVGElement, txt: string): SVGTitleElement {\n    const t = mkTitle(txt)\n    el.appendChild(t)\n    return t\n}\n\nexport function hydrate(el: SVGElement, props: any) {\n    for (const k in props) {\n        if (k == \"title\") {\n            title(el, props[k])\n        } else el.setAttributeNS(null, k, props[k])\n    }\n}\n\nexport function elt(name: string, props?: any): SVGElement {\n    const el = document.createElementNS(\"http://www.w3.org/2000/svg\", name)\n    if (props) hydrate(el, props)\n    return el\n}\n\nexport function child(parent: Element, name: string, props?: any): SVGElement {\n    const el = elt(name, props)\n    parent.appendChild(el)\n    return el\n}\n"],"names":["VM_WATCH_CHANGE","VM_BREAKPOINT","VM_COMMAND_FAILED","VM_ROLE_MISSING","VM_GLOBAL_CHANGE","VM_GLOBAL_TYPE_MISMATCH","VM_INTERNAL_ERROR","VM_LOG_ENTRY","BOUND","CHANGE","DEVICE_ANNOUNCE","DEVICE_DISCONNECT","ROLE_BOUND","ROLE_UNBOUND","UNBOUND","serviceSpecificationFromClassIdentifier","JDClient","RoleManager","bus","_roles","mount","subscribe","addServices","bind","removeServices","bindServices","roles","bound","undefined","filter","service","slice","updateRoles","newRoles","oldBound","isBound","changed","supportedNewRoles","serviceClass","i","role","find","r","splice","emit","length","newRole","existingRole","push","emitBoundEvents","updateRole","preferredDeviceId","binding","bindRole","ret","services","ignoreInfrastructure","s","theOne","newOne","device","deviceId","forEach","dev","selfDevice","toString","map","join","every","startRoles","bindings","onUpdate","options","incomplete","roleManager","Object","keys","key","srv","update","unsubscribe","useContext","useMemo","JacdacContext","useRoleManager","visitWorkspace","collectWarnings","workspace","warnings","visitBlock","b","warning","sourceId","id","message","identityTransformData","resolveBlockDefinition","resolveBlockServices","start","done","PROGRESS_DELAY","registerDataSolver","block","jacdacServices","transformData","type","applyTransform","isEnabled","isInFlyout","nextServices","nextConnection","targetBlock","setDataWarning","newData","data","progressid","setTimeout","clearTimeout","transformedData","def","passthroughData","e","console","debug","then","on","Blockly","useCallback","useWorkspaceEvent","useBlocklyEvents","handleChange","event","Events","BLOCK_CHANGE","change","getBlockById","blockId","twinInput","inputList","twinField","fieldRow","f","name","emitChange","ContextMenuRegistry","useEffect","DisableTopBlocks","useBlocklyPlugins","registry","getItem","unregister","addChangeListener","disableOrphans","disableTopBlocksPlugin","init","removeChangeListener","useState","useEffectAsync","useAsyncMemo","factory","deps","value","setValue","mounted","v","arrayConcatMany","useServices","Flags","useTheme","registerFields","visitToolbox","addDataPreviewField","BlockSvg","prototype","setHighlighted","highlighted","rendered","addSelect","removeSelect","loadBlocks","dsls","theme","blocks","dsl","dslBlocks","createBlocks","Blocks","jacdacDefinition","jsonInit","patchCategoryJSONtoXML","cat","contents","node","kind","exists","diagnostics","warn","values","blockxml","shadow","useToolbox","source","liveServices","specification","toolboxConfiguration","dslsCategories","createCategory","sort","l","order","shift","pop","useToolboxButtons","buttons","visitButton","btn","button","registerButtonCallback","callbackKey","callback","removeButtonCallback","Xml","React","createContext","toMap","useLocalStorage","workspaceToJSON","JSON_WARNINGS_CATEGORY","NEW_PROJET_XML","WORKSPACE_FILENAME","BlockServices","resolveWorkspaceServices","WorkspaceServices","AppContext","useChange","FileSystemContext","resolveBlockWarnings","useWindowEvent","AllOptions","BlockContext","editorId","setEditorId","workspaceXml","workspaceJSON","dragging","setWarnings","setWorkspace","setWorkspaceXml","displayName","DEFAULT_XML","BlockProvider","props","storageKey","children","onBeforeSaveWorkspaceFile","setError","fileSystem","workspaceDirectory","_","workingDirectory","workspaceFile","file","create","storedXml","setStoredXml","_setWorkspaceXml","setWorkspaceJSON","_setWarnings","setDragging","xml","category","entries","findIndex","w","loadWorkspaceFile","editor","Error","dom","textToDom","clear","domToWorkspace","initializeBlockServices","initialized","notifyServicesChanged","handleBlockChange","clearData","handleWorkspaceEvent","workspaceId","BLOCK_DRAG","dragEvent","isStart","FINISHED_LOADING","getAllBlocks","BLOCK_CREATE","bev","BLOCK_MOVE","cev","parentId","newParentId","unmounnts","u","wws","newWorkspaceJSON","newWarnings","text","textAsync","json","JSON","parse","onSave","fileContent","stringify","write","allErrors","setWarningText","handlers","createWorkspaceChangeListener","c","handler","backgroundRefreshRegisters","msg","action","error","Grid","Typography","CodeBlock","BlockDiagnostics","Dialog","DialogActions","DialogContent","DialogContentText","TextField","Button","useRef","useId","BlocklyModalDialogs","dialogType","setDialogType","setMessage","valueId","showDialog","previous","alert","confirm","prompt","cb","current","defaultValue","handleCloseConfirm","handleCancel","handleOk","handleValueChange","target","utils","TOOLBOX_AT_LEFT","Scrollbar","ComponentManager","ReactDOM","svgPointerPoint","MINI_RADIUS","MARGIN_VERTICAL_","MARGIN_HORIZONTAL_","MIN_SCALE","MAX_WIDTH","MAX_HEIGHT","MiniBlock","x","y","width","height","color","MiniViewport","view","top","left","palette","vx","vy","primary","grey","BlockMiniMap","onSizeUpdate","svgRef","metrics","setMetrics","setView","handleMetrics","metricsManager","getMetricsManager","getViewMetrics","getContentMetrics","scroll","getScrollMetrics","tops","getTopBlocks","childBlocks_","rect","getBoundingRectangle","getColour","handleView","BLOCK_DELETE","VIEWPORT_CHANGE","handleCenterView","preventDefault","stopPropagation","pos","halfViewWidth","halfViewHeight","scrollToCenterX","scrollToCenterY","cleft","ctop","cwidth","cheight","right","bottom","MinimapPlugin","workspace_","top_","left_","width_","height_","scale_","componentManager","getComponentManager","addComponent","component","weight","capabilities","Capability","POSITIONABLE","createDom_","resize","svgGroup_","createSvgElement","Svg","G","class","insertAfter","getBubbleCanvas","render","handleSizeUpdate","position","hasVerticalScrollbars","scrollbar","canScrollHorizontally","toolboxMetrics","horizontalLayout","RTL","absoluteMetrics","viewMetrics","scrollbarThickness","positionSvgGroup","setAttribute","Rect","Math","min","dw","useBlockMinimap","getParser","Alert","AlertTitle","BrowserCompatibilityAlert","label","compatible","window","browser","navigator","userAgent","satisfies","useBlocklyWorkspace","Theme","DarkTheme","DarkModeContext","createStyles","makeStyles","clsx","withPrefix","UIFlags","useStyles","hosted","fontFamily","typography","fontWeight","opacity","cursor","fill","SuspendedBlockEditor","className","classes","darkMode","blocklyRef","ref","workspaceConfiguration","collapse","disable","comments","css","trashcan","sounds","renderer","oneBasedIndex","move","scrollbars","vertical","horizontal","media","zoom","controls","wheel","startScale","maxScale","minScale","scaleSpeed","pinch","initialXml","onImportXmlError","ResizeObserver","observer","observe","disconnect","chrome","edge","firefox","BlockEditor","ScatterPlotField","DATA_SCIENCE_STATEMENT_TYPE","DataColumnChooserField","LinePlotField","BarChartField","HistogramField","DataTableField","paletteColorByIndex","BoxPlotField","VegaChartField","tidyHeaders","tidyResolveFieldColumn","JSONSettingsField","HeatMapPlotField","SCATTERPLOT_BLOCK","LINEPLOT_BLOCK","HEATMAP_BLOCK","BARCHART_BLOCK","HISTOGRAM_BLOCK","BOX_PLOT_BLOCK","CHART_SHOW_TABLE_BLOCK","VEGA_LAYER_BLOCK","VEGA_ENCODING_BLOCK","VEGA_STATEMENT_TYPE","chartSettingsSchema","properties","title","axisSchema","scaleSchema","domainMin","description","domainMax","encodingSettingsSchema","axis","encodingNumberSettingsSchema","scale","char2DSettingsSchema","encoding","charMapSettingsSchema","index","colour","chartDsl","tooltip","message0","args0","KEY","selectColumns","previousStatement","nextStatement","template","inputsInline","dataPreviewField","dataType","schema","check","parentData","blockToVisualizationSpec","sourceBlock","headers","types","mark","getFieldValue","spec","child","getInputTargetBlock","channel","field","fieldType","indexOf","getNextBlock","resolveDsl","dslName","fieldShadows","fieldsDsl","workerProxy","downloadCSV","url","worker","res","postMessage","saveCSV","fileHandle","unparseCSV","resp","parseCSV","visitor","inputs","input","visitInput","fields","k","visitField","FieldDropdown","builtins","cereal","penguins","BuiltinDataSetField","fromJson","updateData","getValue","getSourceBlock","marker","isInsertionMarker","cache","errors","setSourceBlock","doValueUpdate_","newValue","lazy","ReactField","Suspense","DataTablePreviewWidget","DataPreviewField","validator","compare","initCustomView","group","fieldGroup_","classList","add","getText_","renderField","preview","lastIndexOf","parseInt","substr","identity","ReactInlineField","DataTableWidget","SMALL_TABLE_HEIGHT","MAX_ITEMS","EDITABLE","transformed","small","createContainer","document","createElement","style","display","minWidth","maxWidth","maxHeight","renderInlineField","tableHeight","WorkspaceContext","useBlockData","TABLE_HEIGHT","TABLE_WIDTH","PointerBoundary","CopyButton","roundWithPrecision","tidyResolveHeader","humanify","empty","paddingLeft","paddingRight","background","borderRadius","root","marginTop","overflow","table","margin","fontSize","lineHeight","backgroundClip","borderColor","borderRightStyle","maxItems","raw","selectedColumns","n","columns","renderCell","handleCopy","FileOpenField","SERIALIZABLE","fromXml","fieldElement","textContent","getOptions","resolveFiles","doClassValidation_","parseSource","dispose","unmount","directory","files","test","filename","csv","_data","log","value_","blockServices","wsServices","_unmount","Field","FileSaveField","fileType","showEditor_","openFileHandle","accept","excludeAcceptAllOption","showSaveFilePicker","tidyFindLastValue","tidy","tidyMin","max","tidyMax","summarize","GaugeWidget","GaugeWidgetView","Number","isNaN","step","ceil","abs","precision","log10","GaugeWidgetField","IFrameDataChooserField","dataId","NoServiceAlert","JDomServiceTreeView","JDomTreeWidget","roleService","flyout","onPointerStopPropagation","JDomTreeField","UNMOUNT","assert","JSONSchemaForm","JSONSettingsWidget","events","editValue","setEditValue","minHeight","padding","renderKeyboardKey","KeyboardKeyInput","KeyboardKeyField","selector","modifiers","newSelector","newModifiers","toShadowDefinition","rgbToHtmlColor","ValueContext","LEDWidget","LEDColorFieldWidget","onValueChange","LEDColorField","size_","cx","cy","strokeWidth","stroke","updateView","circle","SHADOW","ReactImageField","setSize","Size","img","imgUri","renderValue","setAttributeNS","getText","alt","fromHex","toHex","VALUE_CHANGE","LEDMatrixWidget","LEDMatrixField","rows","leds","columnspadded","ledsBytes","cvs","pw","ph","h","ctx","getContext","fillStyle","fillRect","bitindex","byte","bit","dataUri","toDataURL","onChange","newLeds","Uint8Array","LogViewWidget","LogViewField","AddIcon","startServiceProviderFromServiceClass","roleServiceClass","handleStartSimulator","classIdentifier","createToneContext","PianoWidget","NoteField","handlePlayTone","newFrequency","toneContext","playTone","JacdacProvider","IdProvider","DarkModeProvider","AppTheme","Box","ValueProvider","JDEventSource","WorkspaceProvider","WebAudioProvider","ReactFieldBase","SOURCE_BLOCK_CHANGE","MOUNT","toXml","sourceBlock_","bs","initView","updateSize_","div_","DropDownDiv","getContentDiv","border","getColourTertiary","setColour","showPositionedByField","dropdownDispose_","hide","hideIfOwner","unmountComponentAtNode","output","size","fo","container","appendChild","resizeObserver","entry","contentRect","forceRerender","ev","get","fire","renderBlock","bindEvents_","Tooltip","bindMouseEvents","getClickTarget_","Slider","FieldWithSlider","nv","round","SliderField","renderWidget","ServoWidget","ServiceFieldWidget","ServoAngleField","TwinWidget","TwinField","UseModelField","_models","m","populateModels","model","status","getModel","selectedModel","initialValue","onFieldValueChange","VariablesWidget","runner","variables","setVariables","globals","VariablesField","SwitchWithLabel","HORIZON","WatchValueWidget","setData","lookupWatch","watchSourceId","time","timestamp","valueNumber","paper","spacing","WatchValueField","VegaLiteWidget","BAR_CORNER_RADIUS","BAR_MAX_ITEMS","BarWidget","sliceOptions","sliceMax","cornerRadius","BarField","BoxPlotWidget","zero","LINE_MAX_ITEMS","HeatMapWidget","sliceHead","HistogramWidget","bin","aggregate","LinePlotWidget","SCATTER_MAX_ITEMS","ScatterPlotWidget","linearRegression","sliceSample","filled","slope","intercept","layer","transform","regression","VegaChartWidget","WORKSPACE_CHANGE","NoSsr","CHART_HEIGHT","CHART_SVG_MAX_ITEMS","CHART_WIDTH","tidySlice","JSONTryParse","IconButtonWithTooltip","SaveAltIcon","VegaLite","clone","isKV","Array","isArray","jsonMergeFrom","trg","src","vegaData","setVegaData","viewRef","settings","handleNewView","fullSpec","some","clip","strokeDash","sliced","canvas","toCanvas","handleExport","parent","vega","dataset","vegaDataset","showToolbar","ExpandModelBlockField","DataSetBlockField","DataSetBlockButton","RecordingBlockField","NeuralNetworkBlockField","NeuralNetworkBlockButton","ConvLayerBlockField","PoolingLayerBlockField","DropoutLayerBlockField","FlattenLayerBlockField","DenseLayerBlockField","TrainedModelBlockField","reactFieldShadows","registerType","fieldRegistry","register","fieldTypes","MenuItem","Select","fieldContainer","LayerParameterWidget","initFieldValue","percentSize","percentParams","outputShape","runTimeInMs","numFilters","kernelSize","strideSize","activation","updateParameters","updatedValue","expandField","getField","updateFieldValue","handleChangedFilters","valueAsNumber","handleChangedKernelSize","handleChangedStrides","handleChangedActivation","toPrecision","previousValue","ViewIcon","DownloadIcon","DataSetButtonWidget","handleViewDataSet","handleDownloadDataSet","DataSetBlockButtons","DataSetParameterWidget","inputClasses","inputTypes","setBlockData","totalRecordings","numRecordings","numSamples","numUnits","handleChangedUnits","rate","rateAsNum","parseFloat","handleChangedRate","valueAsNum","AddCircleIcon","RemoveCircleIcon","MODEL_BLOCKS","REMOVABLE_INPUT","LAYER_INPUT","ExpandIconWidget","getCurrentValue","updateCurrentValue","paramName","paramValue","appendParamInput","appendDummyInput","appendField","getBlockFieldType","setMovable","getInput","moveInputBefore","blockType","currentValue","parametersVisible","setParametersVisible","fieldValue","paramsVisible","handleExpandBlock","parameterField","paramValues","getParentInput","removeInput","backgroundColor","updateBlockName","nameField","blockName","poolSize","AutorenewIcon","numberField","marginBottom","buttonContainer","NeuralNetworkButtonWidget","handleTrainModel","handleDownloadModel","NeuralNetworkBlockButtons","NNParameterWidget","totalLayers","totalSize","totalParams","inputShape","optimizer","setOptimizer","numEpochs","setNumEpochs","lossFn","setLossFn","handleChangedEpochs","handleChangedOptimizer","handleChangedLossFn","handleChangedPoolSize","RecordingParameterWidget","predictRequest","arraysEqual","ConfusionMatrixHeatMap","DataSetPlot","inlineItem","overflowY","TrainedModelDisplayWidget","chartProps","MARK_SIZE","TOOLTIP_NUM_FORMAT","PALETTE","chartType","setChartType","dataSet","setDataSet","setModel","trainingPredictionResult","setTrainingPredictionResult","trainTimestamp","setTrainTimestamp","Date","now","errorMsg","setErrorMsg","updatedDataSet","updatedModel","selectedChart","predictMsg","zData","xs","toJSON","result","predictions","predictTop","prediction","labels","handleViewTrainedModel","trainedModelName","ys","val","clean","o","logic_null","text_input","math_number","logic_boolean","variableToJSON","variable","getId","fieldsToJSON","toLowerCase","fieldToJSON","xmlToJSON","j","outerHTML","getAttributeNames","getAttribute","childNodes","nodeType","Node","TEXT_NODE","ELEMENT_NODE","isSerializable","fieldXml","flattenNext","next","blockToJSON","blockToJSONHidden","getChildren","blockToValue","element","connection","Variables","allUsedVarModels","localeCompare","todo","visitWorkspaceJSON","onWorkspaceJSONChange","useThrottledCallback","DEFAULT_THROTTLE","useChangeThrottled","query","version","setVersion","changeId","throttledSetVersion","useDebounce","useDragDebounce","delay","debounced","valueAtDragging","setValueAtDragging","debouncedTransformedData","Chip","OpenInBrowserIcon","FileSystemChip","showDirectoryPicker","handleOpenDirectory","handleCloseDirectory","FileNewFileChip","newFileName","content","newFileContent","extension","open","setOpen","handleOpen","toLocaleLowerCase","replace","createWorkingDirectory","d","fileAsync","workingFile","FileSystemNodeChip","selected","onClick","useKeyboardNavigationProps","FileTabs","hideDirectories","hideFiles","directoryFilter","fileFilter","newFileLabel","newFileExtension","directories","gridRef","keyboardProps","handleDirectorySelected","handle","handleFileSelected","keyCodeFromEvent","LEFT_KEY","UP_KEY","RIGHT_KEY","DOWN_KEY","useArrowKeys","onLeft","onUp","onRight","onDown","symmetric","charCode","useKeyboardNavigation","parentRef","onMove","offset","focusable","from","querySelectorAll","me","activeElement","focus","onKeyDown","MODEL_BLOCK_CLASS_STATEMENT_TYPE","MODEL_BLOCK_LAYER_STATEMENT_TYPE","MB_DATASET_VAR_TYPE","MB_CLASS_VAR_TYPE","MB_CLASSIFIER_VAR_TYPE","dataset_color","class_color","learning_color","layer_color","ModelBlockDomainSpecificLanguage","variableTypes","defaultType","message1","args1","message2","args2","helpUrl","hat","message3","args3","modelBlockDsl","createTheme","responsiveFontSizes","ThemeProvider","isDark","themeDef","main","secondary","contrastThreshold","rawTheme","FileCopyIcon","DoneIcon","ReportProblemIcon","useMounted","onCopy","rest","copied","setCopied","handleClick","clipboard","writeText","blob","Promise","resolve","toBlob","item","ClipboardItem","disabled","mkTitle","txt","t","elt","el","hydrate","createElementNS"],"sourceRoot":""}