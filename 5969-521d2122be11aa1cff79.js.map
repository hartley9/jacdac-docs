{"version":3,"file":"5969-521d2122be11aa1cff79.js","mappings":"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","sources":["webpack://jacdac-docs/./node_modules/@mui/icons-material/Keyboard.js","webpack://jacdac-docs/./src/components/dashboard/DashboardHIDKeyboard.tsx","webpack://jacdac-docs/./src/components/ui/KeyboardKeyInput.tsx"],"sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _jsxRuntime = require(\"react/jsx-runtime\");\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M20 5H4c-1.1 0-1.99.9-1.99 2L2 17c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm-9 3h2v2h-2V8zm0 3h2v2h-2v-2zM8 8h2v2H8V8zm0 3h2v2H8v-2zm-1 2H5v-2h2v2zm0-3H5V8h2v2zm9 7H8v-2h8v2zm0-4h-2v-2h2v2zm0-3h-2V8h2v2zm3 3h-2v-2h2v2zm0-3h-2V8h2v2z\"\n}), 'Keyboard');\n\nexports.default = _default;","import React, { useCallback, useState } from \"react\"\nimport { Grid } from \"@mui/material\"\nimport {\n    HidKeyboardAction,\n    HidKeyboardCmd,\n    HidKeyboardModifiers,\n} from \"../../../jacdac-ts/jacdac-spec/dist/specconstants\"\nimport { DashboardServiceProps } from \"./DashboardServiceWidget\"\nimport { jdpack } from \"../../../jacdac-ts/src/jdom/pack\"\nimport CmdButton from \"../CmdButton\"\nimport KeyboardKeyInput from \"../ui/KeyboardKeyInput\"\nimport KeyboardIcon from \"@mui/icons-material/Keyboard\"\n\nexport default function DashboardHIDKeyboard(props: DashboardServiceProps) {\n    const { service } = props\n    const [selector, setSelector] = useState(0)\n    const [modifiers, setModifiers] = useState(HidKeyboardModifiers.None)\n\n    const handleKeyChange = (\n        newSelector: number,\n        newModifiers: HidKeyboardModifiers\n    ) => {\n        setSelector(newSelector)\n        setModifiers(newModifiers)\n    }\n\n    const handleClick = useCallback(async () => {\n        const unpacked: [[number, HidKeyboardModifiers, HidKeyboardAction][]] =\n            [[[selector, modifiers, HidKeyboardAction.Press]]]\n        const data = jdpack(\"r: u16 u8 u8\", unpacked)\n        await service.sendCmdAsync(HidKeyboardCmd.Key, data)\n    }, [selector, modifiers, service])\n\n    const disabled = !selector && !modifiers\n\n    return (\n        <Grid container direction=\"column\" spacing={1}>\n            <Grid item xs={12}>\n                <KeyboardKeyInput\n                    selector={selector}\n                    modifiers={modifiers}\n                    onChange={handleKeyChange}\n                />\n            </Grid>\n            <Grid item xs={12}>\n                <CmdButton\n                    variant=\"outlined\"\n                    title=\"send keys\"\n                    disabled={disabled}\n                    onClick={handleClick}\n                    icon={<KeyboardIcon />}\n                >\n                    Send keys\n                </CmdButton>\n            </Grid>\n        </Grid>\n    )\n}\n","import React, { useContext, useEffect, useMemo, useRef, useState } from \"react\"\nimport { styled } from \"@mui/material/styles\"\nimport { HidKeyboardModifiers } from \"../../../jacdac-ts/jacdac-spec/dist/specconstants\"\nimport Keyboard from \"react-simple-keyboard\"\nimport \"react-simple-keyboard/build/css/index.css\"\nimport DarkModeContext from \"./DarkModeContext\"\nimport { useId } from \"react-use-id-hook\"\nimport {\n    modifierCodes,\n    renderKeyboardKey,\n    selectors,\n} from \"../../../jacdac-ts/src/servers/hidkeyboardserver\"\nimport useMediaQueries from \"../hooks/useMediaQueries\"\n\nconst PREFIX = \"KeyboardKeyInput\"\n\nconst classes = {\n    capture: `${PREFIX}-capture`,\n    darkKeyboard: `${PREFIX}-darkKeyboard`,\n    keyboard: `${PREFIX}-keyboard`,\n}\n\nconst Root = styled(\"div\")(({ theme }) => ({\n    [`& .${classes.capture}`]: {\n        cursor: \"pointer\",\n        \"&:hover\": {\n            borderColor: theme.palette.primary.main,\n        },\n        \"&:focus\": {\n            borderColor: theme.palette.action.active,\n        },\n    },\n\n    [`& .${classes.darkKeyboard}`]: {\n        backgroundColor: \"#333 !important\",\n        borderColor: \"#777 !important\",\n        color: \"white !important\",\n        \"& .hg-button\": {\n            background: \"rgba(0, 0, 0, 0.5) !important\",\n            color: \"white\",\n        },\n        \"& .hg-button.buttonSelected\": {\n            background: `${theme.palette.primary.dark} !important`,\n            color: \"white !important\",\n        },\n    },\n\n    [`& .${classes.keyboard}`]: {\n        \"& .buttonSelected\": {\n            background: `${theme.palette.primary.dark} !important`,\n            color: \"white !important\",\n        },\n    },\n}))\n\nexport default function KeyboardKeyInput(props: {\n    initialSelector?: number\n    initialModifiers?: HidKeyboardModifiers\n    selector?: number\n    modifiers?: HidKeyboardModifiers\n    onChange: (newSelector: number, newModifiers: HidKeyboardModifiers) => void\n}) {\n    const { initialSelector, initialModifiers, selector, modifiers, onChange } =\n        props\n    const uncontrolled = useMemo(\n        () => selector === undefined || modifiers === undefined,\n        []\n    )\n    const [selector_, setSelector_] = useState<number>(initialSelector || 0)\n    const [modifiers_, setModifiters_] = useState<HidKeyboardModifiers>(\n        initialModifiers || HidKeyboardModifiers.None\n    )\n    const { darkMode } = useContext(DarkModeContext)\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const keyboardRef = useRef<any>()\n\n    const theme = `hg-theme-default hg-layout-default ${\n        darkMode === \"dark\" ? classes.darkKeyboard : classes.keyboard\n    }`\n    const { mobile } = useMediaQueries()\n    const layoutName = mobile ? \"mobile\" : \"default\"\n    const keyboardId = useId()\n\n    const layout = {\n        default: [\n            \"{escape} {f1} {f2} {f3} {f4} {f5} {f6} {f7} {f8} {f9} {f10} {f11} {f12}\",\n            \"` 1 2 3 4 5 6 7 8 9 0 - = {backspace}\",\n            \"{tab} q w e r t y u i o p [ ] \\\\\",\n            \"{capslock} a s d f g h j k l ; ' {enter}\",\n            \"{shiftleft} z x c v b n m , . / {shiftright}\",\n            \"{controlleft} {altleft} {metaleft} {space} {metaright} {altright}\",\n        ],\n        mobile: [\n            \"{escape} {f1} {f2} {f3} {f4} {f5}\",\n            \"{f6} {f7} {f8} {f9} {f10} {f11} {f12}\",\n            \"` 1 2 3 4 5 6\",\n            \"7 8 9 0 - = {backspace}\",\n            \"{tab} q w e r t\",\n            \"y u i o p [ ] \\\\\",\n            \"{capslock} a s d f g\",\n            \"h j k l ; ' {enter}\",\n            \"{shiftleft} z x c v b\",\n            \"n m , . / {shiftright}\",\n            \"{controlleft} {altleft} {metaleft} {space}\",\n            \"{metaright} {altright}\",\n        ],\n    }\n    const display = {\n        \"{escape}\": \"esc ⎋\",\n        \"{tab}\": \"tab ⇥\",\n        \"{backspace}\": \"backspace ⌫\",\n        \"{enter}\": \"enter ↵\",\n        \"{capslock}\": \"caps lock ⇪\",\n        \"{shiftleft}\": \"shift ⇧\",\n        \"{shiftright}\": \"shift ⇧\",\n        \"{controlleft}\": \"ctrl ⌃\",\n        \"{controlright}\": \"ctrl ⌃\",\n        \"{altleft}\": \"alt ⌥\",\n        \"{altright}\": \"alt ⌥\",\n        \"{metaleft}\": \"cmd ⌘\",\n        \"{metaright}\": \"cmd ⌘\",\n        \"{space}\": \"⎵\",\n    }\n    const handleKeyboardKeyPress = (code: string) => {\n        code = code.toLowerCase().replace(/[{}]/g, \"\")\n        let newSelector = selector_\n        let newModifiers = modifiers_\n        const msel = selectors[code]\n        const mcode = modifierCodes[code]\n        if (msel) {\n            if (msel === selector) newSelector = undefined\n            else newSelector = msel\n        } else {\n            if (mcode) {\n                if (newModifiers & mcode) newModifiers &= ~mcode\n                else newModifiers |= mcode\n            }\n        }\n        setSelector_(newSelector)\n        setModifiters_(newModifiers)\n        onChange(newSelector, newModifiers)\n    }\n\n    // update external values\n    useEffect(() => {\n        if (selector !== undefined) {\n            if (uncontrolled)\n                console.warn(`trying to set an uncontrolled selector`)\n            setSelector_(selector)\n        }\n    }, [selector])\n    useEffect(() => {\n        if (modifiers !== undefined) {\n            if (uncontrolled)\n                console.warn(`trying to set an uncontrolled modifier`)\n            setModifiters_(modifiers)\n        }\n    }, [modifiers])\n\n    const value = renderKeyboardKey(selector_, modifiers_, false)\n    useEffect(() => {\n        keyboardRef.current?.addButtonTheme(value, \"buttonSelected\")\n        return () =>\n            keyboardRef.current?.removeButtonTheme(value, \"buttonSelected\")\n    }, [value])\n\n    return (\n        <Root>\n            <Keyboard\n                baseClass={keyboardId}\n                keyboardRef={r => (keyboardRef.current = r)}\n                onKeyPress={handleKeyboardKeyPress}\n                layout={layout}\n                layoutName={layoutName}\n                theme={theme}\n                display={display}\n                mergeDisplay={true}\n            />\n        </Root>\n    )\n}\n"],"names":["React","useCallback","useState","Grid","HidKeyboardAction","HidKeyboardCmd","HidKeyboardModifiers","jdpack","CmdButton","KeyboardKeyInput","KeyboardIcon","DashboardHIDKeyboard","props","service","selector","setSelector","modifiers","setModifiers","None","handleKeyChange","newSelector","newModifiers","handleClick","unpacked","Press","data","sendCmdAsync","Key","disabled","useContext","useEffect","useMemo","useRef","styled","Keyboard","DarkModeContext","useId","modifierCodes","renderKeyboardKey","selectors","useMediaQueries","PREFIX","classes","capture","darkKeyboard","keyboard","Root","theme","cursor","borderColor","palette","primary","main","action","active","backgroundColor","color","background","dark","initialSelector","initialModifiers","onChange","uncontrolled","undefined","selector_","setSelector_","modifiers_","setModifiters_","darkMode","keyboardRef","mobile","layoutName","keyboardId","layout","default","display","handleKeyboardKeyPress","code","toLowerCase","replace","msel","mcode","console","warn","value","current","addButtonTheme","removeButtonTheme","r"],"sourceRoot":""}