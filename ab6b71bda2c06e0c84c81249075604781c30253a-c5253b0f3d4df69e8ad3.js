(self["webpackChunkjacdac_docs"] = self["webpackChunkjacdac_docs"] || []).push([[9484],{

/***/ 94325:
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";
var __webpack_unused_export__;


var _interopRequireDefault = __webpack_require__(95318);

__webpack_unused_export__ = ({
  value: true
});
exports.Z = void 0;

var _createSvgIcon = _interopRequireDefault(__webpack_require__(32174));

var _jsxRuntime = __webpack_require__(85893);

var _default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)("path", {
  d: "M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4V7zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"
}), 'AddCircleOutline');

exports.Z = _default;

/***/ }),

/***/ 47450:
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";
var __webpack_unused_export__;


var _interopRequireDefault = __webpack_require__(95318);

__webpack_unused_export__ = ({
  value: true
});
exports.Z = void 0;

var _createSvgIcon = _interopRequireDefault(__webpack_require__(32174));

var _jsxRuntime = __webpack_require__(85893);

var _default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)("path", {
  d: "M12 6v3l4-4-4-4v3c-4.42 0-8 3.58-8 8 0 1.57.46 3.03 1.24 4.26L6.7 14.8c-.45-.83-.7-1.79-.7-2.8 0-3.31 2.69-6 6-6zm6.76 1.74L17.3 9.2c.44.84.7 1.79.7 2.8 0 3.31-2.69 6-6 6v-3l-4 4 4 4v-3c4.42 0 8-3.58 8-8 0-1.57-.46-3.03-1.24-4.26z"
}), 'Autorenew');

exports.Z = _default;

/***/ }),

/***/ 42971:
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";
var __webpack_unused_export__;


var _interopRequireDefault = __webpack_require__(95318);

__webpack_unused_export__ = ({
  value: true
});
exports.Z = void 0;

var _createSvgIcon = _interopRequireDefault(__webpack_require__(32174));

var _jsxRuntime = __webpack_require__(85893);

var _default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)("path", {
  d: "M9 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"
}), 'Done');

exports.Z = _default;

/***/ }),

/***/ 74639:
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";
var __webpack_unused_export__;


var _interopRequireDefault = __webpack_require__(95318);

__webpack_unused_export__ = ({
  value: true
});
exports.Z = void 0;

var _createSvgIcon = _interopRequireDefault(__webpack_require__(32174));

var _jsxRuntime = __webpack_require__(85893);

var _default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)("path", {
  d: "M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4 6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"
}), 'FileCopy');

exports.Z = _default;

/***/ }),

/***/ 96009:
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";
var __webpack_unused_export__;


var _interopRequireDefault = __webpack_require__(95318);

__webpack_unused_export__ = ({
  value: true
});
exports.Z = void 0;

var _createSvgIcon = _interopRequireDefault(__webpack_require__(32174));

var _jsxRuntime = __webpack_require__(85893);

var _default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)("path", {
  d: "M19 4H5c-1.11 0-2 .9-2 2v12c0 1.1.89 2 2 2h4v-2H5V8h14v10h-4v2h4c1.1 0 2-.9 2-2V6c0-1.1-.89-2-2-2zm-7 6-4 4h3v6h2v-6h3l-4-4z"
}), 'OpenInBrowser');

exports.Z = _default;

/***/ }),

/***/ 35880:
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";
var __webpack_unused_export__;


var _interopRequireDefault = __webpack_require__(95318);

__webpack_unused_export__ = ({
  value: true
});
exports.Z = void 0;

var _createSvgIcon = _interopRequireDefault(__webpack_require__(32174));

var _jsxRuntime = __webpack_require__(85893);

var _default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)("path", {
  d: "M7 11v2h10v-2H7zm5-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"
}), 'RemoveCircleOutline');

exports.Z = _default;

/***/ }),

/***/ 93083:
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";
var __webpack_unused_export__;


var _interopRequireDefault = __webpack_require__(95318);

__webpack_unused_export__ = ({
  value: true
});
exports.Z = void 0;

var _createSvgIcon = _interopRequireDefault(__webpack_require__(32174));

var _jsxRuntime = __webpack_require__(85893);

var _default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)("path", {
  d: "M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"
}), 'ReportProblem');

exports.Z = _default;

/***/ }),

/***/ 10132:
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";
var __webpack_unused_export__;


var _interopRequireDefault = __webpack_require__(95318);

__webpack_unused_export__ = ({
  value: true
});
exports.Z = void 0;

var _createSvgIcon = _interopRequireDefault(__webpack_require__(32174));

var _jsxRuntime = __webpack_require__(85893);

var _default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)("path", {
  d: "M19 12v7H5v-7H3v7c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zm-6 .67 2.59-2.58L17 11.5l-5 5-5-5 1.41-1.41L11 12.67V3h2z"
}), 'SaveAlt');

exports.Z = _default;

/***/ }),

/***/ 94093:
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";
var __webpack_unused_export__;


var _interopRequireDefault = __webpack_require__(95318);

__webpack_unused_export__ = ({
  value: true
});
exports.Z = void 0;

var _createSvgIcon = _interopRequireDefault(__webpack_require__(32174));

var _jsxRuntime = __webpack_require__(85893);

var _default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)("path", {
  d: "M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"
}), 'Visibility');

exports.Z = _default;

/***/ }),

/***/ 18599:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";

// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  "Z": function() { return /* binding */ DialogActions_DialogActions; }
});

// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js
var objectWithoutPropertiesLoose = __webpack_require__(63366);
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/extends.js
var esm_extends = __webpack_require__(87462);
// EXTERNAL MODULE: ./node_modules/react/index.js
var react = __webpack_require__(67294);
// EXTERNAL MODULE: ./node_modules/clsx/dist/clsx.m.js
var clsx_m = __webpack_require__(85505);
// EXTERNAL MODULE: ./node_modules/@mui/base/composeClasses/composeClasses.js
var composeClasses = __webpack_require__(49408);
// EXTERNAL MODULE: ./node_modules/@mui/material/styles/styled.js + 2 modules
var styled = __webpack_require__(98348);
// EXTERNAL MODULE: ./node_modules/@mui/material/styles/useThemeProps.js + 1 modules
var useThemeProps = __webpack_require__(47761);
// EXTERNAL MODULE: ./node_modules/@mui/base/generateUtilityClass/generateUtilityClass.js
var generateUtilityClass = __webpack_require__(48416);
// EXTERNAL MODULE: ./node_modules/@mui/base/generateUtilityClasses/generateUtilityClasses.js
var generateUtilityClasses = __webpack_require__(62194);
;// CONCATENATED MODULE: ./node_modules/@mui/material/DialogActions/dialogActionsClasses.js

function getDialogActionsUtilityClass(slot) {
  return (0,generateUtilityClass/* default */.Z)('MuiDialogActions', slot);
}
var dialogActionsClasses = (0,generateUtilityClasses/* default */.Z)('MuiDialogActions', ['root', 'spacing']);
/* harmony default export */ var DialogActions_dialogActionsClasses = ((/* unused pure expression or super */ null && (dialogActionsClasses)));
// EXTERNAL MODULE: ./node_modules/react/jsx-runtime.js
var jsx_runtime = __webpack_require__(85893);
;// CONCATENATED MODULE: ./node_modules/@mui/material/DialogActions/DialogActions.js


var _excluded = ["className", "disableSpacing"];








var useUtilityClasses = ownerState => {
  var {
    classes,
    disableSpacing
  } = ownerState;
  var slots = {
    root: ['root', !disableSpacing && 'spacing']
  };
  return (0,composeClasses/* default */.Z)(slots, getDialogActionsUtilityClass, classes);
};

var DialogActionsRoot = (0,styled/* default */.ZP)('div', {
  name: 'MuiDialogActions',
  slot: 'Root',
  overridesResolver: (props, styles) => {
    var {
      ownerState
    } = props;
    return [styles.root, !ownerState.disableSpacing && styles.spacing];
  }
})(_ref => {
  var {
    ownerState
  } = _ref;
  return (0,esm_extends/* default */.Z)({
    display: 'flex',
    alignItems: 'center',
    padding: 8,
    justifyContent: 'flex-end',
    flex: '0 0 auto'
  }, !ownerState.disableSpacing && {
    '& > :not(:first-of-type)': {
      marginLeft: 8
    }
  });
});
var DialogActions = /*#__PURE__*/react.forwardRef(function DialogActions(inProps, ref) {
  var props = (0,useThemeProps/* default */.Z)({
    props: inProps,
    name: 'MuiDialogActions'
  });

  var {
    className,
    disableSpacing = false
  } = props,
      other = (0,objectWithoutPropertiesLoose/* default */.Z)(props, _excluded);

  var ownerState = (0,esm_extends/* default */.Z)({}, props, {
    disableSpacing
  });

  var classes = useUtilityClasses(ownerState);
  return /*#__PURE__*/(0,jsx_runtime.jsx)(DialogActionsRoot, (0,esm_extends/* default */.Z)({
    className: (0,clsx_m["default"])(classes.root, className),
    ownerState: ownerState,
    ref: ref
  }, other));
});
 false ? 0 : void 0;
/* harmony default export */ var DialogActions_DialogActions = (DialogActions);

/***/ }),

/***/ 90460:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";

// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  "Z": function() { return /* binding */ DialogContentText_DialogContentText; }
});

// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js
var objectWithoutPropertiesLoose = __webpack_require__(63366);
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/extends.js
var esm_extends = __webpack_require__(87462);
// EXTERNAL MODULE: ./node_modules/react/index.js
var react = __webpack_require__(67294);
// EXTERNAL MODULE: ./node_modules/@mui/base/composeClasses/composeClasses.js
var composeClasses = __webpack_require__(49408);
// EXTERNAL MODULE: ./node_modules/@mui/material/styles/styled.js + 2 modules
var styled = __webpack_require__(98348);
// EXTERNAL MODULE: ./node_modules/@mui/material/styles/useThemeProps.js + 1 modules
var useThemeProps = __webpack_require__(47761);
// EXTERNAL MODULE: ./node_modules/@mui/material/Typography/Typography.js + 1 modules
var Typography = __webpack_require__(49308);
// EXTERNAL MODULE: ./node_modules/@mui/base/generateUtilityClass/generateUtilityClass.js
var generateUtilityClass = __webpack_require__(48416);
// EXTERNAL MODULE: ./node_modules/@mui/base/generateUtilityClasses/generateUtilityClasses.js
var generateUtilityClasses = __webpack_require__(62194);
;// CONCATENATED MODULE: ./node_modules/@mui/material/DialogContentText/dialogContentTextClasses.js

function getDialogContentTextUtilityClass(slot) {
  return (0,generateUtilityClass/* default */.Z)('MuiDialogContentText', slot);
}
var dialogContentTextClasses = (0,generateUtilityClasses/* default */.Z)('MuiDialogContentText', ['root']);
/* harmony default export */ var DialogContentText_dialogContentTextClasses = ((/* unused pure expression or super */ null && (dialogContentTextClasses)));
// EXTERNAL MODULE: ./node_modules/react/jsx-runtime.js
var jsx_runtime = __webpack_require__(85893);
;// CONCATENATED MODULE: ./node_modules/@mui/material/DialogContentText/DialogContentText.js


var _excluded = ["children"];








var useUtilityClasses = ownerState => {
  var {
    classes
  } = ownerState;
  var slots = {
    root: ['root']
  };
  var composedClasses = (0,composeClasses/* default */.Z)(slots, getDialogContentTextUtilityClass, classes);
  return (0,esm_extends/* default */.Z)({}, classes, composedClasses);
};

var DialogContentTextRoot = (0,styled/* default */.ZP)(Typography/* default */.Z, {
  shouldForwardProp: prop => (0,styled/* rootShouldForwardProp */.FO)(prop) || prop === 'classes',
  name: 'MuiDialogContentText',
  slot: 'Root',
  overridesResolver: (props, styles) => styles.root
})({});
var DialogContentText = /*#__PURE__*/react.forwardRef(function DialogContentText(inProps, ref) {
  var props = (0,useThemeProps/* default */.Z)({
    props: inProps,
    name: 'MuiDialogContentText'
  });

  var ownerState = (0,objectWithoutPropertiesLoose/* default */.Z)(props, _excluded);

  var classes = useUtilityClasses(ownerState);
  return /*#__PURE__*/(0,jsx_runtime.jsx)(DialogContentTextRoot, (0,esm_extends/* default */.Z)({
    component: "p",
    variant: "body1",
    color: "text.secondary",
    ref: ref,
    ownerState: ownerState
  }, props, {
    classes: classes
  }));
});
 false ? 0 : void 0;
/* harmony default export */ var DialogContentText_DialogContentText = (DialogContentText);

/***/ }),

/***/ 30672:
/***/ (function(module) {

!function (e, t) {
   true ? module.exports = t() : 0;
}(this, function () {
  return function (e) {
    var t = {};

    function r(n) {
      if (t[n]) return t[n].exports;
      var i = t[n] = {
        i: n,
        l: !1,
        exports: {}
      };
      return e[n].call(i.exports, i, i.exports, r), i.l = !0, i.exports;
    }

    return r.m = e, r.c = t, r.d = function (e, t, n) {
      r.o(e, t) || Object.defineProperty(e, t, {
        enumerable: !0,
        get: n
      });
    }, r.r = function (e) {
      "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, {
        value: "Module"
      }), Object.defineProperty(e, "__esModule", {
        value: !0
      });
    }, r.t = function (e, t) {
      if (1 & t && (e = r(e)), 8 & t) return e;
      if (4 & t && "object" == typeof e && e && e.__esModule) return e;
      var n = Object.create(null);
      if (r.r(n), Object.defineProperty(n, "default", {
        enumerable: !0,
        value: e
      }), 2 & t && "string" != typeof e) for (var i in e) {
        r.d(n, i, function (t) {
          return e[t];
        }.bind(null, i));
      }
      return n;
    }, r.n = function (e) {
      var t = e && e.__esModule ? function () {
        return e.default;
      } : function () {
        return e;
      };
      return r.d(t, "a", t), t;
    }, r.o = function (e, t) {
      return Object.prototype.hasOwnProperty.call(e, t);
    }, r.p = "", r(r.s = 90);
  }({
    17: function _(e, t, r) {
      "use strict";

      t.__esModule = !0, t.default = void 0;

      var n = r(18),
          i = function () {
        function e() {}

        return e.getFirstMatch = function (e, t) {
          var r = t.match(e);
          return r && r.length > 0 && r[1] || "";
        }, e.getSecondMatch = function (e, t) {
          var r = t.match(e);
          return r && r.length > 1 && r[2] || "";
        }, e.matchAndReturnConst = function (e, t, r) {
          if (e.test(t)) return r;
        }, e.getWindowsVersionName = function (e) {
          switch (e) {
            case "NT":
              return "NT";

            case "XP":
              return "XP";

            case "NT 5.0":
              return "2000";

            case "NT 5.1":
              return "XP";

            case "NT 5.2":
              return "2003";

            case "NT 6.0":
              return "Vista";

            case "NT 6.1":
              return "7";

            case "NT 6.2":
              return "8";

            case "NT 6.3":
              return "8.1";

            case "NT 10.0":
              return "10";

            default:
              return;
          }
        }, e.getMacOSVersionName = function (e) {
          var t = e.split(".").splice(0, 2).map(function (e) {
            return parseInt(e, 10) || 0;
          });
          if (t.push(0), 10 === t[0]) switch (t[1]) {
            case 5:
              return "Leopard";

            case 6:
              return "Snow Leopard";

            case 7:
              return "Lion";

            case 8:
              return "Mountain Lion";

            case 9:
              return "Mavericks";

            case 10:
              return "Yosemite";

            case 11:
              return "El Capitan";

            case 12:
              return "Sierra";

            case 13:
              return "High Sierra";

            case 14:
              return "Mojave";

            case 15:
              return "Catalina";

            default:
              return;
          }
        }, e.getAndroidVersionName = function (e) {
          var t = e.split(".").splice(0, 2).map(function (e) {
            return parseInt(e, 10) || 0;
          });
          if (t.push(0), !(1 === t[0] && t[1] < 5)) return 1 === t[0] && t[1] < 6 ? "Cupcake" : 1 === t[0] && t[1] >= 6 ? "Donut" : 2 === t[0] && t[1] < 2 ? "Eclair" : 2 === t[0] && 2 === t[1] ? "Froyo" : 2 === t[0] && t[1] > 2 ? "Gingerbread" : 3 === t[0] ? "Honeycomb" : 4 === t[0] && t[1] < 1 ? "Ice Cream Sandwich" : 4 === t[0] && t[1] < 4 ? "Jelly Bean" : 4 === t[0] && t[1] >= 4 ? "KitKat" : 5 === t[0] ? "Lollipop" : 6 === t[0] ? "Marshmallow" : 7 === t[0] ? "Nougat" : 8 === t[0] ? "Oreo" : 9 === t[0] ? "Pie" : void 0;
        }, e.getVersionPrecision = function (e) {
          return e.split(".").length;
        }, e.compareVersions = function (t, r, n) {
          void 0 === n && (n = !1);
          var i = e.getVersionPrecision(t),
              s = e.getVersionPrecision(r),
              a = Math.max(i, s),
              o = 0,
              u = e.map([t, r], function (t) {
            var r = a - e.getVersionPrecision(t),
                n = t + new Array(r + 1).join(".0");
            return e.map(n.split("."), function (e) {
              return new Array(20 - e.length).join("0") + e;
            }).reverse();
          });

          for (n && (o = a - Math.min(i, s)), a -= 1; a >= o;) {
            if (u[0][a] > u[1][a]) return 1;

            if (u[0][a] === u[1][a]) {
              if (a === o) return 0;
              a -= 1;
            } else if (u[0][a] < u[1][a]) return -1;
          }
        }, e.map = function (e, t) {
          var r,
              n = [];
          if (Array.prototype.map) return Array.prototype.map.call(e, t);

          for (r = 0; r < e.length; r += 1) {
            n.push(t(e[r]));
          }

          return n;
        }, e.find = function (e, t) {
          var r, n;
          if (Array.prototype.find) return Array.prototype.find.call(e, t);

          for (r = 0, n = e.length; r < n; r += 1) {
            var i = e[r];
            if (t(i, r)) return i;
          }
        }, e.assign = function (e) {
          for (var t, r, n = e, i = arguments.length, s = new Array(i > 1 ? i - 1 : 0), a = 1; a < i; a++) {
            s[a - 1] = arguments[a];
          }

          if (Object.assign) return Object.assign.apply(Object, [e].concat(s));

          var o = function o() {
            var e = s[t];
            "object" == typeof e && null !== e && Object.keys(e).forEach(function (t) {
              n[t] = e[t];
            });
          };

          for (t = 0, r = s.length; t < r; t += 1) {
            o();
          }

          return e;
        }, e.getBrowserAlias = function (e) {
          return n.BROWSER_ALIASES_MAP[e];
        }, e.getBrowserTypeByAlias = function (e) {
          return n.BROWSER_MAP[e] || "";
        }, e;
      }();

      t.default = i, e.exports = t.default;
    },
    18: function _(e, t, r) {
      "use strict";

      t.__esModule = !0, t.ENGINE_MAP = t.OS_MAP = t.PLATFORMS_MAP = t.BROWSER_MAP = t.BROWSER_ALIASES_MAP = void 0;
      t.BROWSER_ALIASES_MAP = {
        "Amazon Silk": "amazon_silk",
        "Android Browser": "android",
        Bada: "bada",
        BlackBerry: "blackberry",
        Chrome: "chrome",
        Chromium: "chromium",
        Electron: "electron",
        Epiphany: "epiphany",
        Firefox: "firefox",
        Focus: "focus",
        Generic: "generic",
        "Google Search": "google_search",
        Googlebot: "googlebot",
        "Internet Explorer": "ie",
        "K-Meleon": "k_meleon",
        Maxthon: "maxthon",
        "Microsoft Edge": "edge",
        "MZ Browser": "mz",
        "NAVER Whale Browser": "naver",
        Opera: "opera",
        "Opera Coast": "opera_coast",
        PhantomJS: "phantomjs",
        Puffin: "puffin",
        QupZilla: "qupzilla",
        QQ: "qq",
        QQLite: "qqlite",
        Safari: "safari",
        Sailfish: "sailfish",
        "Samsung Internet for Android": "samsung_internet",
        SeaMonkey: "seamonkey",
        Sleipnir: "sleipnir",
        Swing: "swing",
        Tizen: "tizen",
        "UC Browser": "uc",
        Vivaldi: "vivaldi",
        "WebOS Browser": "webos",
        WeChat: "wechat",
        "Yandex Browser": "yandex",
        Roku: "roku"
      };
      t.BROWSER_MAP = {
        amazon_silk: "Amazon Silk",
        android: "Android Browser",
        bada: "Bada",
        blackberry: "BlackBerry",
        chrome: "Chrome",
        chromium: "Chromium",
        electron: "Electron",
        epiphany: "Epiphany",
        firefox: "Firefox",
        focus: "Focus",
        generic: "Generic",
        googlebot: "Googlebot",
        google_search: "Google Search",
        ie: "Internet Explorer",
        k_meleon: "K-Meleon",
        maxthon: "Maxthon",
        edge: "Microsoft Edge",
        mz: "MZ Browser",
        naver: "NAVER Whale Browser",
        opera: "Opera",
        opera_coast: "Opera Coast",
        phantomjs: "PhantomJS",
        puffin: "Puffin",
        qupzilla: "QupZilla",
        qq: "QQ Browser",
        qqlite: "QQ Browser Lite",
        safari: "Safari",
        sailfish: "Sailfish",
        samsung_internet: "Samsung Internet for Android",
        seamonkey: "SeaMonkey",
        sleipnir: "Sleipnir",
        swing: "Swing",
        tizen: "Tizen",
        uc: "UC Browser",
        vivaldi: "Vivaldi",
        webos: "WebOS Browser",
        wechat: "WeChat",
        yandex: "Yandex Browser"
      };
      t.PLATFORMS_MAP = {
        tablet: "tablet",
        mobile: "mobile",
        desktop: "desktop",
        tv: "tv"
      };
      t.OS_MAP = {
        WindowsPhone: "Windows Phone",
        Windows: "Windows",
        MacOS: "macOS",
        iOS: "iOS",
        Android: "Android",
        WebOS: "WebOS",
        BlackBerry: "BlackBerry",
        Bada: "Bada",
        Tizen: "Tizen",
        Linux: "Linux",
        ChromeOS: "Chrome OS",
        PlayStation4: "PlayStation 4",
        Roku: "Roku"
      };
      t.ENGINE_MAP = {
        EdgeHTML: "EdgeHTML",
        Blink: "Blink",
        Trident: "Trident",
        Presto: "Presto",
        Gecko: "Gecko",
        WebKit: "WebKit"
      };
    },
    90: function _(e, t, r) {
      "use strict";

      t.__esModule = !0, t.default = void 0;
      var n,
          i = (n = r(91)) && n.__esModule ? n : {
        default: n
      },
          s = r(18);

      function a(e, t) {
        for (var r = 0; r < t.length; r++) {
          var n = t[r];
          n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n);
        }
      }

      var o = function () {
        function e() {}

        var t, r, n;
        return e.getParser = function (e, t) {
          if (void 0 === t && (t = !1), "string" != typeof e) throw new Error("UserAgent should be a string");
          return new i.default(e, t);
        }, e.parse = function (e) {
          return new i.default(e).getResult();
        }, t = e, n = [{
          key: "BROWSER_MAP",
          get: function get() {
            return s.BROWSER_MAP;
          }
        }, {
          key: "ENGINE_MAP",
          get: function get() {
            return s.ENGINE_MAP;
          }
        }, {
          key: "OS_MAP",
          get: function get() {
            return s.OS_MAP;
          }
        }, {
          key: "PLATFORMS_MAP",
          get: function get() {
            return s.PLATFORMS_MAP;
          }
        }], (r = null) && a(t.prototype, r), n && a(t, n), e;
      }();

      t.default = o, e.exports = t.default;
    },
    91: function _(e, t, r) {
      "use strict";

      t.__esModule = !0, t.default = void 0;
      var n = u(r(92)),
          i = u(r(93)),
          s = u(r(94)),
          a = u(r(95)),
          o = u(r(17));

      function u(e) {
        return e && e.__esModule ? e : {
          default: e
        };
      }

      var d = function () {
        function e(e, t) {
          if (void 0 === t && (t = !1), null == e || "" === e) throw new Error("UserAgent parameter can't be empty");
          this._ua = e, this.parsedResult = {}, !0 !== t && this.parse();
        }

        var t = e.prototype;
        return t.getUA = function () {
          return this._ua;
        }, t.test = function (e) {
          return e.test(this._ua);
        }, t.parseBrowser = function () {
          var e = this;
          this.parsedResult.browser = {};
          var t = o.default.find(n.default, function (t) {
            if ("function" == typeof t.test) return t.test(e);
            if (t.test instanceof Array) return t.test.some(function (t) {
              return e.test(t);
            });
            throw new Error("Browser's test function is not valid");
          });
          return t && (this.parsedResult.browser = t.describe(this.getUA())), this.parsedResult.browser;
        }, t.getBrowser = function () {
          return this.parsedResult.browser ? this.parsedResult.browser : this.parseBrowser();
        }, t.getBrowserName = function (e) {
          return e ? String(this.getBrowser().name).toLowerCase() || "" : this.getBrowser().name || "";
        }, t.getBrowserVersion = function () {
          return this.getBrowser().version;
        }, t.getOS = function () {
          return this.parsedResult.os ? this.parsedResult.os : this.parseOS();
        }, t.parseOS = function () {
          var e = this;
          this.parsedResult.os = {};
          var t = o.default.find(i.default, function (t) {
            if ("function" == typeof t.test) return t.test(e);
            if (t.test instanceof Array) return t.test.some(function (t) {
              return e.test(t);
            });
            throw new Error("Browser's test function is not valid");
          });
          return t && (this.parsedResult.os = t.describe(this.getUA())), this.parsedResult.os;
        }, t.getOSName = function (e) {
          var t = this.getOS().name;
          return e ? String(t).toLowerCase() || "" : t || "";
        }, t.getOSVersion = function () {
          return this.getOS().version;
        }, t.getPlatform = function () {
          return this.parsedResult.platform ? this.parsedResult.platform : this.parsePlatform();
        }, t.getPlatformType = function (e) {
          void 0 === e && (e = !1);
          var t = this.getPlatform().type;
          return e ? String(t).toLowerCase() || "" : t || "";
        }, t.parsePlatform = function () {
          var e = this;
          this.parsedResult.platform = {};
          var t = o.default.find(s.default, function (t) {
            if ("function" == typeof t.test) return t.test(e);
            if (t.test instanceof Array) return t.test.some(function (t) {
              return e.test(t);
            });
            throw new Error("Browser's test function is not valid");
          });
          return t && (this.parsedResult.platform = t.describe(this.getUA())), this.parsedResult.platform;
        }, t.getEngine = function () {
          return this.parsedResult.engine ? this.parsedResult.engine : this.parseEngine();
        }, t.getEngineName = function (e) {
          return e ? String(this.getEngine().name).toLowerCase() || "" : this.getEngine().name || "";
        }, t.parseEngine = function () {
          var e = this;
          this.parsedResult.engine = {};
          var t = o.default.find(a.default, function (t) {
            if ("function" == typeof t.test) return t.test(e);
            if (t.test instanceof Array) return t.test.some(function (t) {
              return e.test(t);
            });
            throw new Error("Browser's test function is not valid");
          });
          return t && (this.parsedResult.engine = t.describe(this.getUA())), this.parsedResult.engine;
        }, t.parse = function () {
          return this.parseBrowser(), this.parseOS(), this.parsePlatform(), this.parseEngine(), this;
        }, t.getResult = function () {
          return o.default.assign({}, this.parsedResult);
        }, t.satisfies = function (e) {
          var t = this,
              r = {},
              n = 0,
              i = {},
              s = 0;

          if (Object.keys(e).forEach(function (t) {
            var a = e[t];
            "string" == typeof a ? (i[t] = a, s += 1) : "object" == typeof a && (r[t] = a, n += 1);
          }), n > 0) {
            var a = Object.keys(r),
                u = o.default.find(a, function (e) {
              return t.isOS(e);
            });

            if (u) {
              var d = this.satisfies(r[u]);
              if (void 0 !== d) return d;
            }

            var c = o.default.find(a, function (e) {
              return t.isPlatform(e);
            });

            if (c) {
              var f = this.satisfies(r[c]);
              if (void 0 !== f) return f;
            }
          }

          if (s > 0) {
            var l = Object.keys(i),
                h = o.default.find(l, function (e) {
              return t.isBrowser(e, !0);
            });
            if (void 0 !== h) return this.compareVersion(i[h]);
          }
        }, t.isBrowser = function (e, t) {
          void 0 === t && (t = !1);
          var r = this.getBrowserName().toLowerCase(),
              n = e.toLowerCase(),
              i = o.default.getBrowserTypeByAlias(n);
          return t && i && (n = i.toLowerCase()), n === r;
        }, t.compareVersion = function (e) {
          var t = [0],
              r = e,
              n = !1,
              i = this.getBrowserVersion();
          if ("string" == typeof i) return ">" === e[0] || "<" === e[0] ? (r = e.substr(1), "=" === e[1] ? (n = !0, r = e.substr(2)) : t = [], ">" === e[0] ? t.push(1) : t.push(-1)) : "=" === e[0] ? r = e.substr(1) : "~" === e[0] && (n = !0, r = e.substr(1)), t.indexOf(o.default.compareVersions(i, r, n)) > -1;
        }, t.isOS = function (e) {
          return this.getOSName(!0) === String(e).toLowerCase();
        }, t.isPlatform = function (e) {
          return this.getPlatformType(!0) === String(e).toLowerCase();
        }, t.isEngine = function (e) {
          return this.getEngineName(!0) === String(e).toLowerCase();
        }, t.is = function (e, t) {
          return void 0 === t && (t = !1), this.isBrowser(e, t) || this.isOS(e) || this.isPlatform(e);
        }, t.some = function (e) {
          var t = this;
          return void 0 === e && (e = []), e.some(function (e) {
            return t.is(e);
          });
        }, e;
      }();

      t.default = d, e.exports = t.default;
    },
    92: function _(e, t, r) {
      "use strict";

      t.__esModule = !0, t.default = void 0;
      var n,
          i = (n = r(17)) && n.__esModule ? n : {
        default: n
      };
      var s = /version\/(\d+(\.?_?\d+)+)/i,
          a = [{
        test: [/googlebot/i],
        describe: function describe(e) {
          var t = {
            name: "Googlebot"
          },
              r = i.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i, e) || i.default.getFirstMatch(s, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/opera/i],
        describe: function describe(e) {
          var t = {
            name: "Opera"
          },
              r = i.default.getFirstMatch(s, e) || i.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/opr\/|opios/i],
        describe: function describe(e) {
          var t = {
            name: "Opera"
          },
              r = i.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i, e) || i.default.getFirstMatch(s, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/SamsungBrowser/i],
        describe: function describe(e) {
          var t = {
            name: "Samsung Internet for Android"
          },
              r = i.default.getFirstMatch(s, e) || i.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/Whale/i],
        describe: function describe(e) {
          var t = {
            name: "NAVER Whale Browser"
          },
              r = i.default.getFirstMatch(s, e) || i.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/MZBrowser/i],
        describe: function describe(e) {
          var t = {
            name: "MZ Browser"
          },
              r = i.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i, e) || i.default.getFirstMatch(s, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/focus/i],
        describe: function describe(e) {
          var t = {
            name: "Focus"
          },
              r = i.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i, e) || i.default.getFirstMatch(s, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/swing/i],
        describe: function describe(e) {
          var t = {
            name: "Swing"
          },
              r = i.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i, e) || i.default.getFirstMatch(s, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/coast/i],
        describe: function describe(e) {
          var t = {
            name: "Opera Coast"
          },
              r = i.default.getFirstMatch(s, e) || i.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/opt\/\d+(?:.?_?\d+)+/i],
        describe: function describe(e) {
          var t = {
            name: "Opera Touch"
          },
              r = i.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i, e) || i.default.getFirstMatch(s, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/yabrowser/i],
        describe: function describe(e) {
          var t = {
            name: "Yandex Browser"
          },
              r = i.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i, e) || i.default.getFirstMatch(s, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/ucbrowser/i],
        describe: function describe(e) {
          var t = {
            name: "UC Browser"
          },
              r = i.default.getFirstMatch(s, e) || i.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/Maxthon|mxios/i],
        describe: function describe(e) {
          var t = {
            name: "Maxthon"
          },
              r = i.default.getFirstMatch(s, e) || i.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/epiphany/i],
        describe: function describe(e) {
          var t = {
            name: "Epiphany"
          },
              r = i.default.getFirstMatch(s, e) || i.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/puffin/i],
        describe: function describe(e) {
          var t = {
            name: "Puffin"
          },
              r = i.default.getFirstMatch(s, e) || i.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/sleipnir/i],
        describe: function describe(e) {
          var t = {
            name: "Sleipnir"
          },
              r = i.default.getFirstMatch(s, e) || i.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/k-meleon/i],
        describe: function describe(e) {
          var t = {
            name: "K-Meleon"
          },
              r = i.default.getFirstMatch(s, e) || i.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/micromessenger/i],
        describe: function describe(e) {
          var t = {
            name: "WeChat"
          },
              r = i.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i, e) || i.default.getFirstMatch(s, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/qqbrowser/i],
        describe: function describe(e) {
          var t = {
            name: /qqbrowserlite/i.test(e) ? "QQ Browser Lite" : "QQ Browser"
          },
              r = i.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i, e) || i.default.getFirstMatch(s, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/msie|trident/i],
        describe: function describe(e) {
          var t = {
            name: "Internet Explorer"
          },
              r = i.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/\sedg\//i],
        describe: function describe(e) {
          var t = {
            name: "Microsoft Edge"
          },
              r = i.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/edg([ea]|ios)/i],
        describe: function describe(e) {
          var t = {
            name: "Microsoft Edge"
          },
              r = i.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/vivaldi/i],
        describe: function describe(e) {
          var t = {
            name: "Vivaldi"
          },
              r = i.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/seamonkey/i],
        describe: function describe(e) {
          var t = {
            name: "SeaMonkey"
          },
              r = i.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/sailfish/i],
        describe: function describe(e) {
          var t = {
            name: "Sailfish"
          },
              r = i.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/silk/i],
        describe: function describe(e) {
          var t = {
            name: "Amazon Silk"
          },
              r = i.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/phantom/i],
        describe: function describe(e) {
          var t = {
            name: "PhantomJS"
          },
              r = i.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/slimerjs/i],
        describe: function describe(e) {
          var t = {
            name: "SlimerJS"
          },
              r = i.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/blackberry|\bbb\d+/i, /rim\stablet/i],
        describe: function describe(e) {
          var t = {
            name: "BlackBerry"
          },
              r = i.default.getFirstMatch(s, e) || i.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/(web|hpw)[o0]s/i],
        describe: function describe(e) {
          var t = {
            name: "WebOS Browser"
          },
              r = i.default.getFirstMatch(s, e) || i.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/bada/i],
        describe: function describe(e) {
          var t = {
            name: "Bada"
          },
              r = i.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/tizen/i],
        describe: function describe(e) {
          var t = {
            name: "Tizen"
          },
              r = i.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i, e) || i.default.getFirstMatch(s, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/qupzilla/i],
        describe: function describe(e) {
          var t = {
            name: "QupZilla"
          },
              r = i.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i, e) || i.default.getFirstMatch(s, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/firefox|iceweasel|fxios/i],
        describe: function describe(e) {
          var t = {
            name: "Firefox"
          },
              r = i.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/electron/i],
        describe: function describe(e) {
          var t = {
            name: "Electron"
          },
              r = i.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/MiuiBrowser/i],
        describe: function describe(e) {
          var t = {
            name: "Miui"
          },
              r = i.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/chromium/i],
        describe: function describe(e) {
          var t = {
            name: "Chromium"
          },
              r = i.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i, e) || i.default.getFirstMatch(s, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/chrome|crios|crmo/i],
        describe: function describe(e) {
          var t = {
            name: "Chrome"
          },
              r = i.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/GSA/i],
        describe: function describe(e) {
          var t = {
            name: "Google Search"
          },
              r = i.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i, e);
          return r && (t.version = r), t;
        }
      }, {
        test: function test(e) {
          var t = !e.test(/like android/i),
              r = e.test(/android/i);
          return t && r;
        },
        describe: function describe(e) {
          var t = {
            name: "Android Browser"
          },
              r = i.default.getFirstMatch(s, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/playstation 4/i],
        describe: function describe(e) {
          var t = {
            name: "PlayStation 4"
          },
              r = i.default.getFirstMatch(s, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/safari|applewebkit/i],
        describe: function describe(e) {
          var t = {
            name: "Safari"
          },
              r = i.default.getFirstMatch(s, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/.*/i],
        describe: function describe(e) {
          var t = -1 !== e.search("\\(") ? /^(.*)\/(.*)[ \t]\((.*)/ : /^(.*)\/(.*) /;
          return {
            name: i.default.getFirstMatch(t, e),
            version: i.default.getSecondMatch(t, e)
          };
        }
      }];
      t.default = a, e.exports = t.default;
    },
    93: function _(e, t, r) {
      "use strict";

      t.__esModule = !0, t.default = void 0;
      var n,
          i = (n = r(17)) && n.__esModule ? n : {
        default: n
      },
          s = r(18);
      var a = [{
        test: [/Roku\/DVP/],
        describe: function describe(e) {
          var t = i.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i, e);
          return {
            name: s.OS_MAP.Roku,
            version: t
          };
        }
      }, {
        test: [/windows phone/i],
        describe: function describe(e) {
          var t = i.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i, e);
          return {
            name: s.OS_MAP.WindowsPhone,
            version: t
          };
        }
      }, {
        test: [/windows /i],
        describe: function describe(e) {
          var t = i.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i, e),
              r = i.default.getWindowsVersionName(t);
          return {
            name: s.OS_MAP.Windows,
            version: t,
            versionName: r
          };
        }
      }, {
        test: [/Macintosh(.*?) FxiOS(.*?)\//],
        describe: function describe(e) {
          var t = {
            name: s.OS_MAP.iOS
          },
              r = i.default.getSecondMatch(/(Version\/)(\d[\d.]+)/, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/macintosh/i],
        describe: function describe(e) {
          var t = i.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i, e).replace(/[_\s]/g, "."),
              r = i.default.getMacOSVersionName(t),
              n = {
            name: s.OS_MAP.MacOS,
            version: t
          };
          return r && (n.versionName = r), n;
        }
      }, {
        test: [/(ipod|iphone|ipad)/i],
        describe: function describe(e) {
          var t = i.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i, e).replace(/[_\s]/g, ".");
          return {
            name: s.OS_MAP.iOS,
            version: t
          };
        }
      }, {
        test: function test(e) {
          var t = !e.test(/like android/i),
              r = e.test(/android/i);
          return t && r;
        },
        describe: function describe(e) {
          var t = i.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i, e),
              r = i.default.getAndroidVersionName(t),
              n = {
            name: s.OS_MAP.Android,
            version: t
          };
          return r && (n.versionName = r), n;
        }
      }, {
        test: [/(web|hpw)[o0]s/i],
        describe: function describe(e) {
          var t = i.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i, e),
              r = {
            name: s.OS_MAP.WebOS
          };
          return t && t.length && (r.version = t), r;
        }
      }, {
        test: [/blackberry|\bbb\d+/i, /rim\stablet/i],
        describe: function describe(e) {
          var t = i.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i, e) || i.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i, e) || i.default.getFirstMatch(/\bbb(\d+)/i, e);
          return {
            name: s.OS_MAP.BlackBerry,
            version: t
          };
        }
      }, {
        test: [/bada/i],
        describe: function describe(e) {
          var t = i.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i, e);
          return {
            name: s.OS_MAP.Bada,
            version: t
          };
        }
      }, {
        test: [/tizen/i],
        describe: function describe(e) {
          var t = i.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i, e);
          return {
            name: s.OS_MAP.Tizen,
            version: t
          };
        }
      }, {
        test: [/linux/i],
        describe: function describe() {
          return {
            name: s.OS_MAP.Linux
          };
        }
      }, {
        test: [/CrOS/],
        describe: function describe() {
          return {
            name: s.OS_MAP.ChromeOS
          };
        }
      }, {
        test: [/PlayStation 4/],
        describe: function describe(e) {
          var t = i.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i, e);
          return {
            name: s.OS_MAP.PlayStation4,
            version: t
          };
        }
      }];
      t.default = a, e.exports = t.default;
    },
    94: function _(e, t, r) {
      "use strict";

      t.__esModule = !0, t.default = void 0;
      var n,
          i = (n = r(17)) && n.__esModule ? n : {
        default: n
      },
          s = r(18);
      var a = [{
        test: [/googlebot/i],
        describe: function describe() {
          return {
            type: "bot",
            vendor: "Google"
          };
        }
      }, {
        test: [/huawei/i],
        describe: function describe(e) {
          var t = i.default.getFirstMatch(/(can-l01)/i, e) && "Nova",
              r = {
            type: s.PLATFORMS_MAP.mobile,
            vendor: "Huawei"
          };
          return t && (r.model = t), r;
        }
      }, {
        test: [/nexus\s*(?:7|8|9|10).*/i],
        describe: function describe() {
          return {
            type: s.PLATFORMS_MAP.tablet,
            vendor: "Nexus"
          };
        }
      }, {
        test: [/ipad/i],
        describe: function describe() {
          return {
            type: s.PLATFORMS_MAP.tablet,
            vendor: "Apple",
            model: "iPad"
          };
        }
      }, {
        test: [/Macintosh(.*?) FxiOS(.*?)\//],
        describe: function describe() {
          return {
            type: s.PLATFORMS_MAP.tablet,
            vendor: "Apple",
            model: "iPad"
          };
        }
      }, {
        test: [/kftt build/i],
        describe: function describe() {
          return {
            type: s.PLATFORMS_MAP.tablet,
            vendor: "Amazon",
            model: "Kindle Fire HD 7"
          };
        }
      }, {
        test: [/silk/i],
        describe: function describe() {
          return {
            type: s.PLATFORMS_MAP.tablet,
            vendor: "Amazon"
          };
        }
      }, {
        test: [/tablet(?! pc)/i],
        describe: function describe() {
          return {
            type: s.PLATFORMS_MAP.tablet
          };
        }
      }, {
        test: function test(e) {
          var t = e.test(/ipod|iphone/i),
              r = e.test(/like (ipod|iphone)/i);
          return t && !r;
        },
        describe: function describe(e) {
          var t = i.default.getFirstMatch(/(ipod|iphone)/i, e);
          return {
            type: s.PLATFORMS_MAP.mobile,
            vendor: "Apple",
            model: t
          };
        }
      }, {
        test: [/nexus\s*[0-6].*/i, /galaxy nexus/i],
        describe: function describe() {
          return {
            type: s.PLATFORMS_MAP.mobile,
            vendor: "Nexus"
          };
        }
      }, {
        test: [/[^-]mobi/i],
        describe: function describe() {
          return {
            type: s.PLATFORMS_MAP.mobile
          };
        }
      }, {
        test: function test(e) {
          return "blackberry" === e.getBrowserName(!0);
        },
        describe: function describe() {
          return {
            type: s.PLATFORMS_MAP.mobile,
            vendor: "BlackBerry"
          };
        }
      }, {
        test: function test(e) {
          return "bada" === e.getBrowserName(!0);
        },
        describe: function describe() {
          return {
            type: s.PLATFORMS_MAP.mobile
          };
        }
      }, {
        test: function test(e) {
          return "windows phone" === e.getBrowserName();
        },
        describe: function describe() {
          return {
            type: s.PLATFORMS_MAP.mobile,
            vendor: "Microsoft"
          };
        }
      }, {
        test: function test(e) {
          var t = Number(String(e.getOSVersion()).split(".")[0]);
          return "android" === e.getOSName(!0) && t >= 3;
        },
        describe: function describe() {
          return {
            type: s.PLATFORMS_MAP.tablet
          };
        }
      }, {
        test: function test(e) {
          return "android" === e.getOSName(!0);
        },
        describe: function describe() {
          return {
            type: s.PLATFORMS_MAP.mobile
          };
        }
      }, {
        test: function test(e) {
          return "macos" === e.getOSName(!0);
        },
        describe: function describe() {
          return {
            type: s.PLATFORMS_MAP.desktop,
            vendor: "Apple"
          };
        }
      }, {
        test: function test(e) {
          return "windows" === e.getOSName(!0);
        },
        describe: function describe() {
          return {
            type: s.PLATFORMS_MAP.desktop
          };
        }
      }, {
        test: function test(e) {
          return "linux" === e.getOSName(!0);
        },
        describe: function describe() {
          return {
            type: s.PLATFORMS_MAP.desktop
          };
        }
      }, {
        test: function test(e) {
          return "playstation 4" === e.getOSName(!0);
        },
        describe: function describe() {
          return {
            type: s.PLATFORMS_MAP.tv
          };
        }
      }, {
        test: function test(e) {
          return "roku" === e.getOSName(!0);
        },
        describe: function describe() {
          return {
            type: s.PLATFORMS_MAP.tv
          };
        }
      }];
      t.default = a, e.exports = t.default;
    },
    95: function _(e, t, r) {
      "use strict";

      t.__esModule = !0, t.default = void 0;
      var n,
          i = (n = r(17)) && n.__esModule ? n : {
        default: n
      },
          s = r(18);
      var a = [{
        test: function test(e) {
          return "microsoft edge" === e.getBrowserName(!0);
        },
        describe: function describe(e) {
          if (/\sedg\//i.test(e)) return {
            name: s.ENGINE_MAP.Blink
          };
          var t = i.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i, e);
          return {
            name: s.ENGINE_MAP.EdgeHTML,
            version: t
          };
        }
      }, {
        test: [/trident/i],
        describe: function describe(e) {
          var t = {
            name: s.ENGINE_MAP.Trident
          },
              r = i.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i, e);
          return r && (t.version = r), t;
        }
      }, {
        test: function test(e) {
          return e.test(/presto/i);
        },
        describe: function describe(e) {
          var t = {
            name: s.ENGINE_MAP.Presto
          },
              r = i.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i, e);
          return r && (t.version = r), t;
        }
      }, {
        test: function test(e) {
          var t = e.test(/gecko/i),
              r = e.test(/like gecko/i);
          return t && !r;
        },
        describe: function describe(e) {
          var t = {
            name: s.ENGINE_MAP.Gecko
          },
              r = i.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i, e);
          return r && (t.version = r), t;
        }
      }, {
        test: [/(apple)?webkit\/537\.36/i],
        describe: function describe() {
          return {
            name: s.ENGINE_MAP.Blink
          };
        }
      }, {
        test: [/(apple)?webkit/i],
        describe: function describe(e) {
          var t = {
            name: s.ENGINE_MAP.WebKit
          },
              r = i.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i, e);
          return r && (t.version = r), t;
        }
      }];
      t.default = a, e.exports = t.default;
    }
  });
});

/***/ }),

/***/ 5495:
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports["default"] = void 0;

var _react = _interopRequireDefault(__webpack_require__(67294));

var _propTypes = _interopRequireDefault(__webpack_require__(45697));

var _useBlocklyWorkspace2 = _interopRequireDefault(__webpack_require__(48877));

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : {
    default: obj
  };
}

var propTypes = {
  initialXml: _propTypes.default.string,
  toolboxConfiguration: _propTypes.default.object,
  // eslint-disable-line react/forbid-prop-types
  workspaceConfiguration: _propTypes.default.object,
  // eslint-disable-line react/forbid-prop-types
  className: _propTypes.default.string,
  onWorkspaceChange: _propTypes.default.func,
  onImportXmlError: _propTypes.default.func,
  onXmlChange: _propTypes.default.func,
  onInject: _propTypes.default.func,
  onDispose: _propTypes.default.func
};
var defaultProps = {
  initialXml: null,
  toolboxConfiguration: null,
  workspaceConfiguration: null,
  className: null,
  onWorkspaceChange: null,
  onImportXmlError: null,
  onXmlChange: null,
  onInject: null,
  onDispose: null
};

function BlocklyWorkspace(_ref) {
  var initialXml = _ref.initialXml,
      toolboxConfiguration = _ref.toolboxConfiguration,
      workspaceConfiguration = _ref.workspaceConfiguration,
      className = _ref.className,
      onWorkspaceChange = _ref.onWorkspaceChange,
      onXmlChange = _ref.onXmlChange,
      onImportXmlError = _ref.onImportXmlError,
      onInject = _ref.onInject,
      onDispose = _ref.onDispose;

  var editorDiv = _react.default.useRef(null);

  var _useBlocklyWorkspace = (0, _useBlocklyWorkspace2.default)({
    ref: editorDiv,
    initialXml: initialXml,
    toolboxConfiguration: toolboxConfiguration,
    workspaceConfiguration: workspaceConfiguration,
    onWorkspaceChange: onWorkspaceChange,
    onImportXmlError: onImportXmlError,
    onInject: onInject,
    onDispose: onDispose
  }),
      xml = _useBlocklyWorkspace.xml;

  var onXmlChangeRef = _react.default.useRef(onXmlChange);

  _react.default.useEffect(function () {
    onXmlChangeRef.current = onXmlChange;
  }, [onXmlChange]);

  _react.default.useEffect(function () {
    if (onXmlChangeRef.current && xml) {
      onXmlChangeRef.current(xml);
    }
  }, [xml]);

  return /*#__PURE__*/_react.default.createElement("div", {
    className: className,
    ref: editorDiv
  });
}

BlocklyWorkspace.propTypes = propTypes;
BlocklyWorkspace.defaultProps = defaultProps;
var _default = BlocklyWorkspace;
exports["default"] = _default;

/***/ }),

/***/ 16995:
/***/ (function(__unused_webpack_module, exports) {

"use strict";


Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports["default"] = debounce;

function debounce(func, wait) {
  var timeout = null;
  var later = null;

  var debouncedFunction = function debouncedFunction() {
    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    later = function later() {
      timeout = null;
      func.apply(void 0, args);
    };

    clearTimeout(timeout);
    timeout = setTimeout(later, wait);
  };

  var cancel = function cancel() {
    if (timeout !== null) {
      clearTimeout(timeout);
      later();
    }
  };

  return [debouncedFunction, cancel];
}

/***/ }),

/***/ 691:
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";
var __webpack_unused_export__;


__webpack_unused_export__ = ({
  value: true
});
Object.defineProperty(exports, "JP", ({
  enumerable: true,
  get: function get() {
    return _useBlocklyWorkspace.default;
  }
}));
__webpack_unused_export__ = ({
  enumerable: true,
  get: function get() {
    return _BlocklyWorkspace.default;
  }
});

var _useBlocklyWorkspace = _interopRequireDefault(__webpack_require__(48877));

var _BlocklyWorkspace = _interopRequireDefault(__webpack_require__(5495));

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : {
    default: obj
  };
}

/***/ }),

/***/ 48877:
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports["default"] = void 0;

var _react = _interopRequireDefault(__webpack_require__(67294));

var _blockly = _interopRequireDefault(__webpack_require__(74640));

var _debounce3 = _interopRequireDefault(__webpack_require__(16995));

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : {
    default: obj
  };
}

function ownKeys(object, enumerableOnly) {
  var keys = Object.keys(object);

  if (Object.getOwnPropertySymbols) {
    var symbols = Object.getOwnPropertySymbols(object);
    if (enumerableOnly) symbols = symbols.filter(function (sym) {
      return Object.getOwnPropertyDescriptor(object, sym).enumerable;
    });
    keys.push.apply(keys, symbols);
  }

  return keys;
}

function _objectSpread(target) {
  for (var i = 1; i < arguments.length; i++) {
    var source = arguments[i] != null ? arguments[i] : {};

    if (i % 2) {
      ownKeys(Object(source), true).forEach(function (key) {
        _defineProperty(target, key, source[key]);
      });
    } else if (Object.getOwnPropertyDescriptors) {
      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));
    } else {
      ownKeys(Object(source)).forEach(function (key) {
        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));
      });
    }
  }

  return target;
}

function _defineProperty(obj, key, value) {
  if (key in obj) {
    Object.defineProperty(obj, key, {
      value: value,
      enumerable: true,
      configurable: true,
      writable: true
    });
  } else {
    obj[key] = value;
  }

  return obj;
}

function _slicedToArray(arr, i) {
  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();
}

function _nonIterableRest() {
  throw new TypeError("Invalid attempt to destructure non-iterable instance");
}

function _iterableToArrayLimit(arr, i) {
  if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === "[object Arguments]")) {
    return;
  }

  var _arr = [];
  var _n = true;
  var _d = false;
  var _e = undefined;

  try {
    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {
      _arr.push(_s.value);

      if (i && _arr.length === i) break;
    }
  } catch (err) {
    _d = true;
    _e = err;
  } finally {
    try {
      if (!_n && _i["return"] != null) _i["return"]();
    } finally {
      if (_d) throw _e;
    }
  }

  return _arr;
}

function _arrayWithHoles(arr) {
  if (Array.isArray(arr)) return arr;
}

function importFromXml(xml, workspace, onImportXmlError) {
  try {
    _blockly.default.Xml.domToWorkspace(_blockly.default.Xml.textToDom(xml), workspace);

    return true;
  } catch (e) {
    if (onImportXmlError) {
      onImportXmlError(e);
    }

    return false;
  }
}

var useBlocklyWorkspace = function useBlocklyWorkspace(_ref) {
  var ref = _ref.ref,
      initialXml = _ref.initialXml,
      toolboxConfiguration = _ref.toolboxConfiguration,
      workspaceConfiguration = _ref.workspaceConfiguration,
      onWorkspaceChange = _ref.onWorkspaceChange,
      onImportXmlError = _ref.onImportXmlError,
      onInject = _ref.onInject,
      onDispose = _ref.onDispose;

  var _React$useState = _react.default.useState(null),
      _React$useState2 = _slicedToArray(_React$useState, 2),
      workspace = _React$useState2[0],
      setWorkspace = _React$useState2[1];

  var _React$useState3 = _react.default.useState(initialXml),
      _React$useState4 = _slicedToArray(_React$useState3, 2),
      xml = _React$useState4[0],
      setXml = _React$useState4[1];

  var _React$useState5 = _react.default.useState(false),
      _React$useState6 = _slicedToArray(_React$useState5, 2),
      didInitialImport = _React$useState6[0],
      setDidInitialImport = _React$useState6[1];

  var _React$useState7 = _react.default.useState(false),
      _React$useState8 = _slicedToArray(_React$useState7, 2),
      didHandleNewWorkspace = _React$useState8[0],
      setDidHandleNewWorkspace = _React$useState8[1]; // we explicitly don't want to recreate the workspace when the configuration changes
  // so, we'll keep it in a ref and update as necessary in an effect hook


  var workspaceConfigurationRef = _react.default.useRef(workspaceConfiguration);

  _react.default.useEffect(function () {
    workspaceConfigurationRef.current = workspaceConfiguration;
  }, [workspaceConfiguration]);

  var toolboxConfigurationRef = _react.default.useRef(toolboxConfiguration);

  _react.default.useEffect(function () {
    toolboxConfigurationRef.current = toolboxConfiguration;

    if (toolboxConfiguration && workspace) {
      workspace.updateToolbox(toolboxConfiguration);
    }
  }, [toolboxConfiguration, workspace]);

  var onInjectRef = _react.default.useRef(onInject);

  var onDisposeRef = _react.default.useRef(onDispose);

  _react.default.useEffect(function () {
    onInjectRef.current = onInject;
  }, [onInject]);

  _react.default.useEffect(function () {
    onDisposeRef.current = onDispose;
  }, [onDispose]);

  var handleWorkspaceChanged = _react.default.useCallback(function (newWorkspace) {
    if (onWorkspaceChange) {
      onWorkspaceChange(newWorkspace);
    }
  }, [onWorkspaceChange]); // Workspace creation


  _react.default.useEffect(function () {
    var newWorkspace = _blockly.default.inject(ref.current, _objectSpread(_objectSpread({}, workspaceConfigurationRef.current), {}, {
      toolbox: toolboxConfigurationRef.current
    }));

    setWorkspace(newWorkspace);
    setDidInitialImport(false); // force a re-import if we recreate the workspace

    setDidHandleNewWorkspace(false); // Singal that a workspace change event needs to be sent.

    if (onInjectRef.current) {
      onInjectRef.current(newWorkspace);
    }

    var onDisposeFunction = onDisposeRef.current; // Dispose of the workspace when our div ref goes away (Equivalent to didComponentUnmount)

    return function () {
      newWorkspace.dispose();

      if (onDisposeFunction) {
        onDisposeFunction(newWorkspace);
      }
    };
  }, [ref]); // Send a workspace change event when the workspace is created


  _react.default.useEffect(function () {
    if (workspace && !didHandleNewWorkspace) {
      handleWorkspaceChanged(workspace);
    }
  }, [handleWorkspaceChanged, didHandleNewWorkspace, workspace]); // Workspace change listener


  _react.default.useEffect(function () {
    if (workspace == null) {
      return undefined;
    }

    var listener = function listener() {
      handleWorkspaceChanged(workspace);
    };

    workspace.addChangeListener(listener);
    return function () {
      workspace.removeChangeListener(listener);
    };
  }, [workspace, handleWorkspaceChanged]); // xmlDidChange callback


  _react.default.useEffect(function () {
    if (workspace == null) {
      return undefined;
    }

    var _debounce = (0, _debounce3.default)(function () {
      var newXml = _blockly.default.Xml.domToText(_blockly.default.Xml.workspaceToDom(workspace));

      if (newXml === xml) {
        return;
      }

      setXml(newXml);
    }, 200),
        _debounce2 = _slicedToArray(_debounce, 2),
        callback = _debounce2[0],
        cancel = _debounce2[1];

    workspace.addChangeListener(callback);
    return function () {
      workspace.removeChangeListener(callback);
      cancel();
    };
  }, [workspace, xml]); // Initial Xml Changes


  _react.default.useEffect(function () {
    if (xml && workspace && !didInitialImport) {
      var success = importFromXml(xml, workspace, onImportXmlError);

      if (!success) {
        setXml(null);
      }

      setDidInitialImport(true);
    }
  }, [xml, workspace, didInitialImport, onImportXmlError]);

  return {
    workspace: workspace,
    xml: xml
  };
};

var _default = useBlocklyWorkspace;
exports["default"] = _default;

/***/ }),

/***/ 87709:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ useDebouncedCallback; }
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(67294);

/**
 * Creates a debounced function that delays invoking `func` until after `wait`
 * milliseconds have elapsed since the last time the debounced function was
 * invoked, or until the next browser frame is drawn. The debounced function
 * comes with a `cancel` method to cancel delayed `func` invocations and a
 * `flush` method to immediately invoke them. Provide `options` to indicate
 * whether `func` should be invoked on the leading and/or trailing edge of the
 * `wait` timeout. The `func` is invoked with the last arguments provided to the
 * debounced function. Subsequent calls to the debounced function return the
 * result of the last `func` invocation.
 *
 * **Note:** If `leading` and `trailing` options are `true`, `func` is
 * invoked on the trailing edge of the timeout only if the debounced function
 * is invoked more than once during the `wait` timeout.
 *
 * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred
 * until the next tick, similar to `setTimeout` with a timeout of `0`.
 *
 * If `wait` is omitted in an environment with `requestAnimationFrame`, `func`
 * invocation will be deferred until the next frame is drawn (typically about
 * 16ms).
 *
 * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)
 * for details over the differences between `debounce` and `throttle`.
 *
 * @category Function
 * @param {Function} func The function to debounce.
 * @param {number} [wait=0]
 *  The number of milliseconds to delay; if omitted, `requestAnimationFrame` is
 *  used (if available, otherwise it will be setTimeout(...,0)).
 * @param {Object} [options={}] The options object.
 *  Specify invoking on the leading edge of the timeout.
 * @param {boolean} [options.leading=false]
 *  The maximum time `func` is allowed to be delayed before it's invoked.
 * @param {number} [options.maxWait]
 *  Specify invoking on the trailing edge of the timeout.
 * @param {boolean} [options.trailing=true]
 * @returns {Function} Returns the new debounced function.
 * @example
 *
 * // Avoid costly calculations while the window size is in flux.
 * const resizeHandler = useDebouncedCallback(calculateLayout, 150);
 * window.addEventListener('resize', resizeHandler)
 *
 * // Invoke `sendMail` when clicked, debouncing subsequent calls.
 * const clickHandler = useDebouncedCallback(sendMail, 300, {
 *   leading: true,
 *   trailing: false,
 * })
 * <button onClick={clickHandler}>click me</button>
 *
 * // Ensure `batchLog` is invoked once after 1 second of debounced calls.
 * const debounced = useDebouncedCallback(batchLog, 250, { 'maxWait': 1000 })
 * const source = new EventSource('/stream')
 * source.addEventListener('message', debounced)
 *
 * // Cancel the trailing debounced invocation.
 * window.addEventListener('popstate', debounced.cancel)
 *
 * // Check for pending invocations.
 * const status = debounced.pending() ? "Pending..." : "Ready"
 */

function useDebouncedCallback(func, wait, options) {
  var _this = this;

  var lastCallTime = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  var lastInvokeTime = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(0);
  var timerId = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null);
  var lastArgs = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)([]);
  var lastThis = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)();
  var result = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)();
  var funcRef = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(func);
  var mounted = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(true);
  funcRef.current = func; // Bypass `requestAnimationFrame` by explicitly setting `wait=0`.

  var useRAF = !wait && wait !== 0 && typeof window !== 'undefined';

  if (typeof func !== 'function') {
    throw new TypeError('Expected a function');
  }

  wait = +wait || 0;
  options = options || {};
  var leading = !!options.leading;
  var trailing = 'trailing' in options ? !!options.trailing : true; // `true` by default

  var maxing = ('maxWait' in options);
  var maxWait = maxing ? Math.max(+options.maxWait || 0, wait) : null;
  (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(function () {
    mounted.current = true;
    return function () {
      mounted.current = false;
    };
  }, []); // You may have a question, why we have so many code under the useMemo definition.
  //
  // This was made as we want to escape from useCallback hell and
  // not to initialize a number of functions each time useDebouncedCallback is called.
  //
  // It means that we have less garbage for our GC calls which improves performance.
  // Also, it makes this library smaller.
  //
  // And the last reason, that the code without lots of useCallback with deps is easier to read.
  // You have only one place for that.

  var debounced = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(function () {
    var invokeFunc = function invokeFunc(time) {
      var args = lastArgs.current;
      var thisArg = lastThis.current;
      lastArgs.current = lastThis.current = null;
      lastInvokeTime.current = time;
      return result.current = funcRef.current.apply(thisArg, args);
    };

    var startTimer = function startTimer(pendingFunc, wait) {
      if (useRAF) cancelAnimationFrame(timerId.current);
      timerId.current = useRAF ? requestAnimationFrame(pendingFunc) : setTimeout(pendingFunc, wait);
    };

    var shouldInvoke = function shouldInvoke(time) {
      if (!mounted.current) return false;
      var timeSinceLastCall = time - lastCallTime.current;
      var timeSinceLastInvoke = time - lastInvokeTime.current; // Either this is the first call, activity has stopped and we're at the
      // trailing edge, the system time has gone backwards and we're treating
      // it as the trailing edge, or we've hit the `maxWait` limit.

      return !lastCallTime.current || timeSinceLastCall >= wait || timeSinceLastCall < 0 || maxing && timeSinceLastInvoke >= maxWait;
    };

    var trailingEdge = function trailingEdge(time) {
      timerId.current = null; // Only invoke if we have `lastArgs` which means `func` has been
      // debounced at least once.

      if (trailing && lastArgs.current) {
        return invokeFunc(time);
      }

      lastArgs.current = lastThis.current = null;
      return result.current;
    };

    var timerExpired = function timerExpired() {
      var time = Date.now();

      if (shouldInvoke(time)) {
        return trailingEdge(time);
      } // https://github.com/xnimorz/use-debounce/issues/97


      if (!mounted.current) {
        return;
      } // Remaining wait calculation


      var timeSinceLastCall = time - lastCallTime.current;
      var timeSinceLastInvoke = time - lastInvokeTime.current;
      var timeWaiting = wait - timeSinceLastCall;
      var remainingWait = maxing ? Math.min(timeWaiting, maxWait - timeSinceLastInvoke) : timeWaiting; // Restart the timer

      startTimer(timerExpired, remainingWait);
    };

    var func = function func() {
      var args = [];

      for (var _i = 0; _i < arguments.length; _i++) {
        args[_i] = arguments[_i];
      }

      var time = Date.now();
      var isInvoking = shouldInvoke(time);
      lastArgs.current = args;
      lastThis.current = _this;
      lastCallTime.current = time;

      if (isInvoking) {
        if (!timerId.current && mounted.current) {
          // Reset any `maxWait` timer.
          lastInvokeTime.current = lastCallTime.current; // Start the timer for the trailing edge.

          startTimer(timerExpired, wait); // Invoke the leading edge.

          return leading ? invokeFunc(lastCallTime.current) : result.current;
        }

        if (maxing) {
          // Handle invocations in a tight loop.
          startTimer(timerExpired, wait);
          return invokeFunc(lastCallTime.current);
        }
      }

      if (!timerId.current) {
        startTimer(timerExpired, wait);
      }

      return result.current;
    };

    func.cancel = function () {
      if (timerId.current) {
        useRAF ? cancelAnimationFrame(timerId.current) : clearTimeout(timerId.current);
      }

      lastInvokeTime.current = 0;
      lastArgs.current = lastCallTime.current = lastThis.current = timerId.current = null;
    };

    func.isPending = function () {
      return !!timerId.current;
    };

    func.flush = function () {
      return !timerId.current ? result.current : trailingEdge(Date.now());
    };

    return func;
  }, [leading, maxing, wait, maxWait, trailing, useRAF]);
  return debounced;
}

/***/ }),

/***/ 73390:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";

// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  "i_": function() { return /* binding */ checkProgram; },
  "IJ": function() { return /* binding */ compileProgram; },
  "EB": function() { return /* binding */ toIdentifier; },
  "vf": function() { return /* binding */ toMemberExpression; }
});

// UNUSED EXPORTS: getServiceFromRole

// EXTERNAL MODULE: ./jacdac-ts/src/jdom/spec.ts + 1 modules
var jdom_spec = __webpack_require__(26799);
;// CONCATENATED MODULE: ./jacdac-ts/src/vm/ir.ts
var VMFunctions = [{
  id: "start",
  args: [],
  prompt: "start block",
  context: "command"
}, {
  id: "halt",
  args: [],
  prompt: "terminates the current handler",
  context: "command"
}, {
  id: "nop",
  args: [],
  prompt: "no operation",
  context: "command"
}, {
  id: "label",
  args: ["Identifier"],
  prompt: "label target {1}",
  context: "command"
}, {
  id: "jump",
  args: ["Identifier"],
  prompt: "jump to label {1}",
  context: "command"
}, {
  id: "branchOnCondition",
  args: ["boolean", "Identifier"],
  prompt: "if {1} then jump to label {2}",
  context: "command"
}, {
  id: "wait",
  args: ["number"],
  prompt: "wait for {1} milliseconds",
  context: "command"
}, {
  id: "awaitRegister",
  args: ["register"],
  prompt: "wait on register {1} to change value",
  context: "command"
}, {
  id: "awaitChange",
  args: ["register", "number"],
  prompt: "wait for register {1} to change by {2}",
  context: "command"
}, {
  id: "awaitEvent",
  args: ["event", ["boolean", true]],
  prompt: "wait for event {1} and then check {2} (other events ignored)",
  context: "command"
}, {
  id: "awaitCondition",
  args: ["boolean"],
  prompt: "wait for condition {1}",
  context: "command"
}, {
  id: "writeRegister",
  args: ["register", "number"],
  prompt: "write value {2:val} to {1}",
  context: "command"
}, {
  id: "writeLocal",
  args: ["register", "number"],
  prompt: "write value {2:val} to {1}",
  context: "command"
}, {
  id: "watch",
  args: ["number"],
  prompt: "watch expression {1}",
  context: "command"
}, {
  id: "log",
  args: ["number"],
  prompt: "not used",
  context: "command"
}, {
  id: "roleBound",
  args: ["Identifier", "Identifier"],
  prompt: "role {1} {2}",
  context: "command"
}, {
  id: "roleBoundExpression",
  args: ["Identifier"],
  prompt: "is role {1} bound?",
  context: "expression"
}, {
  id: "onRoleConnected",
  args: ["Identifier"],
  prompt: "fires when a role is connected",
  context: "command"
}, {
  id: "onRoleDisconnected",
  args: ["Identifier"],
  prompt: "fires when a role is disconnected",
  context: "command"
}];
// EXTERNAL MODULE: ./jacdac-ts/jacdac-spec/spectool/jdutils.ts
var jdutils = __webpack_require__(30055);
;// CONCATENATED MODULE: ./jacdac-ts/src/vm/symutils.ts
 // eslint-disable-next-line @typescript-eslint/no-explicit-any

function exprVisitor(parent, current, structVisit) {
  if (Array.isArray(current)) {
    ;
    current.forEach(c => exprVisitor(current, c, structVisit));
  } else if (typeof current === "object") {
    if (parent && current) structVisit(parent, current);
    Object.keys(current).forEach(key => {
      exprVisitor(current, current[key], structVisit);
    });
  }
}
var SpecSymbolResolver = /*#__PURE__*/function () {
  function SpecSymbolResolver(spec, role2spec, error) {
    this.spec = spec;
    this.role2spec = role2spec;
    this.error = error;
    this.reset();
  }

  var _proto = SpecSymbolResolver.prototype;

  _proto.reset = function reset() {
    this.registers = [];
    this.events = [];
    this.roles = [];
  };

  _proto.check = function check(e, type) {
    if (!e) {
      this.error("expression is undefined");
      return false;
    } else if (e.type !== type) {
      this.error("expected " + type + "; got " + e.type);
      return false;
    }

    return true;
  };

  _proto.specResolve = function specResolve(e) {
    var ret = undefined;

    if (this.spec) {
      ret = {
        role: this.spec.shortName,
        spec: this.spec,
        client: true,
        rest: e
      };
    } else if (e.type === "Identifier") {
      return undefined;
    } else if (this.check(e, "MemberExpression") && this.check(e.object, "Identifier") && this.role2spec) {
      var obj = e.object;
      if (obj.name.startsWith("$")) return undefined;

      if (!this.role2spec(obj.name)) {
        this.error("no specification found for " + obj.name);
      }

      var {
        spec: _spec,
        client
      } = this.role2spec(obj.name);
      ret = {
        role: obj.name,
        spec: _spec,
        client,
        rest: e.property
      };
    }

    if (ret && this.roles.indexOf(ret.role) < 0) this.roles.push(ret.role);
    return ret;
  };

  _proto.destructAccessPath = function destructAccessPath(e, expectIdentifier) {
    if (expectIdentifier === void 0) {
      expectIdentifier = false;
    }

    if (e.type === "Identifier") {
      return [e.name, ""];
    } else if (!expectIdentifier && e.type === "MemberExpression") {
      var object = e.object;
      var property = e.property;
      if (this.check(object, "Identifier") && this.check(property, "Identifier")) return [object.name, property.name];
      return undefined;
    } else {
      if (!expectIdentifier) this.error("expected Identifier or MemberExpression; got " + e.type);else this.error("expected Identifier; got " + e.type);
      return undefined;
    }
  };

  _proto.lookupEvent = function lookupEvent(e) {
    var _spec$packets;

    var resolve = this.specResolve(e);
    if (!resolve) return;
    var {
      role,
      spec,
      rest
    } = resolve;
    var [id, _] = this.destructAccessPath(rest, true);
    var events = (_spec$packets = spec.packets) === null || _spec$packets === void 0 ? void 0 : _spec$packets.filter(pkt => pkt.kind === "event");
    var pkt = events.find(p => p.name === id);

    if (!pkt) {
      this.error("no event " + id + " in specification");
      return undefined;
    } else {
      var ev = role + "." + id;
      if (this.events.indexOf(ev) < 0) this.events.push(ev);
      return pkt;
    }
  };

  _proto.lookupRegister = function lookupRegister(e) {
    var resolve = this.specResolve(e);
    if (!resolve) return;
    var {
      role,
      spec,
      rest
    } = resolve;
    var [root, fld] = this.destructAccessPath(rest);
    this.lookupRegisterRaw(spec, root, fld);
    var reg = role + "." + root;
    if (this.registers.indexOf(reg) < 0) this.registers.push(reg);
  };

  _proto.lookupRegisterRaw = function lookupRegisterRaw(spec, root, fld) {
    var reg = getRegister(spec, root, fld);
    if (reg.pkt && (!reg.fld && !isBoolOrNumericFormat(reg.pkt.packFormat) || reg.fld && reg.fld.type && !isBoolOrNumericFormat(reg.fld.type))) this.error("only bool/numeric registers allowed"); // if (!fld && regField.pkt.fields.length > 0)
    //    error(`register ${root} has fields, but no field specified`)
  };

  _proto.lookupReplace = function lookupReplace(events, parent, child) {
    if (Array.isArray(parent)) {
      var replace = this.lookup(events, parent, child);
      parent.forEach(i => {
        if (parent[i] === child) parent[i] = replace;
      });
    } else {
      // don't process identifiers that are callees of CallExpression
      if ((parent === null || parent === void 0 ? void 0 : parent.type) === "CallExpression" && child === parent.callee) return;

      var _replace = this.lookup(events, parent, child);

      if (_replace) {
        Object.keys(parent).forEach(k => {
          if (parent[k] === child) parent[k] = _replace;
        });
      }
    }
  };

  _proto.lookup = function lookup(events, parent, child) {
    var resolve = this.specResolve(child);
    if (!resolve) return;
    var {
      role,
      spec,
      rest
    } = resolve;
    var [root, fld] = this.destructAccessPath(rest);

    try {
      try {
        var val = (0,jdutils/* parseIntFloat */.Qv)(spec, fld ? root + "." + fld : root);
        var lit = {
          type: "Literal",
          value: val,
          raw: val.toString()
        };
        return lit;
      } catch (e) {
        this.lookupRegisterRaw(spec, root, fld);
        var reg = role + "." + root;
        if (this.registers.indexOf(reg) < 0) this.registers.push(reg);
      }
    } catch (e) {
      var pkt = undefined;
      if (events.length) pkt = events.find(pkt => pkt.name === root);else {
        var _spec$packets2;

        // we need a fully qualified name
        pkt = (_spec$packets2 = spec.packets) === null || _spec$packets2 === void 0 ? void 0 : _spec$packets2.find(p => p.kind === "event" && p.name === root);
      }
      if (!pkt) this.error("event " + root + " not bound correctly");else if (!fld && pkt.fields.length > 0) this.error("event " + root + " has fields, but no field specified");else if (fld && !pkt.fields.find(f => f.name === fld)) this.error("Field " + fld + " of event " + root + " not found in specification");
    }
  };

  return SpecSymbolResolver;
}();
var VMChecker = /*#__PURE__*/function () {
  function VMChecker(resolver, supportedExpression, error) {
    this.resolver = resolver;
    this.supportedExpression = supportedExpression;
    this.error = error;
  }

  var _proto2 = VMChecker.prototype;

  _proto2.checkCommand = function checkCommand(root, funs) {
    var _root$callee;

    if (!root || !root.type || root.type != "CallExpression") {
      this.error("a command must be a call expression in JavaScript syntax");
      return;
    } // check for unsupported expression types


    exprVisitor(null, root, (p, c) => {
      if (!this.supportedExpression(c.type)) this.error("Expression of type " + c.type + " not currently supported");
    }); // first lookup in known functions

    var callee = (_root$callee = root.callee) === null || _root$callee === void 0 ? void 0 : _root$callee.name;
    var cmdIndex = funs.findIndex(r => callee === r.id);
    var theCommand = undefined;

    if (cmdIndex < 0) {
      if (root.callee.type === "MemberExpression") {
        var {
          role: _role,
          spec: _spec2,
          rest,
          client
        } = this.resolver.specResolve(root.callee);
        var [command, _] = this.resolver.destructAccessPath(rest);

        if (!_role) {
          this.error("command does not conform to expected call expression");
          return undefined;
        } else {
          var _spec2$packets;

          // we have a spec, now look for command
          var commands = (_spec2$packets = _spec2.packets) === null || _spec2$packets === void 0 ? void 0 : _spec2$packets.filter(pkt => client && pkt.kind === "command" || !client && pkt.kind === "event");
          theCommand = commands.find(c => (c === null || c === void 0 ? void 0 : c.name) === command);

          if (!theCommand) {
            this.error("cannot find command named " + command + " in spec " + _spec2.shortName);
          } else return this.processSpecCommandFunction(root, theCommand);
        }
      } else {
        if (callee) this.error(callee + " is not a registered function.");else this.error("command does not conform to expected call expression");
        return undefined;
      }
    } else return this.processTestFunction(funs, root, cmdIndex);

    return undefined;
  };

  _proto2.processSpecCommandFunction = function processSpecCommandFunction(root, command) {
    var _command$fields;

    if (root.arguments.length !== (command === null || command === void 0 ? void 0 : (_command$fields = command.fields) === null || _command$fields === void 0 ? void 0 : _command$fields.length)) {
      this.error("Command " + command.name + " expects " + command.fields.length + " arguments: got " + root.arguments.length);
    } else {
      var args = root.arguments;
      args.forEach(arg => {
        this.visitReplace(root, arg, []);
      });
    }

    return [undefined, root];
  };

  _proto2.processTestFunction = function processTestFunction(funs, root, cmdIndex) {
    var _root$callee2;

    var callee = (_root$callee2 = root.callee) === null || _root$callee2 === void 0 ? void 0 : _root$callee2.name; // check arguments

    var command = funs[cmdIndex];
    var minArgs = argsRequiredOptional(command.args).length;
    var maxArgs = command.args.length;

    if (root.arguments.length < minArgs) {
      this.error(callee + " expects at least " + minArgs + " arguments; got " + root.arguments.length);
      return undefined;
    } else if (root.arguments.length > maxArgs) {
      this.error(callee + " expects at most " + maxArgs + " arguments; got " + root.arguments.length);
      return undefined;
    } // deal with optional arguments


    var newExpressions = [];

    for (var i = root.arguments.length; i < command.args.length; i++) {
      var [name, def] = command.args[i];
      var lit = {
        type: "Literal",
        value: def,
        raw: def.toString()
      };
      newExpressions.push(lit);
    }

    root.arguments = root.arguments.concat(newExpressions); // type checking of arguments.

    this.processTestArguments(command, root);
    return [command, root];

    function argsRequiredOptional(args, optional) {
      if (optional === void 0) {
        optional = false;
      }

      return args.filter(a => !optional && typeof a === "string" || optional && typeof a === "object");
    }
  };

  _proto2.processTestArguments = function processTestArguments(command, root) {
    var args = root.arguments;
    var eventSymTable = [];
    args.forEach((arg, a) => {
      var argType = command.args[a];
      if (typeof argType === "object") argType = command.args[a][0];

      if (argType === "register" || argType === "event" || argType === "Identifier") {
        if (argType === "Identifier") {
          this.resolver.check(arg, "Identifier");
        } else if (argType === "event" && a === 0) {
          var pkt = this.resolver.lookupEvent(arg);
          if (pkt && eventSymTable.indexOf(pkt) === -1) eventSymTable.push(pkt);
        } else if (argType === "register") {
          try {
            this.resolver.lookupRegister(arg);
          } catch (e) {
            this.error(e.message);
          }
        }
      } else if (argType === "events") {
        if (arg.type != "ArrayExpression") this.error("events function expects a list of service events");else {
          ;
          arg.elements.forEach(e => this.resolver.lookupEvent(e));
        }
      } else if (argType === "number" || argType === "boolean") {
        this.visitReplace(root, arg, eventSymTable);
      } else {
        this.error("unexpected argument type (" + argType + ")");
      }
    });
  };

  _proto2.visitReplace = function visitReplace(root, arg, eventSymTable) {
    if (eventSymTable === void 0) {
      eventSymTable = [];
    }

    exprVisitor(root, arg, (p, c) => {
      if (p.type !== "MemberExpression" && c.type === "Identifier") {
        this.resolver.lookupReplace(eventSymTable, p, c);
      } else if (c.type === "ArrayExpression") {
        this.error("array expression not allowed in this context");
      } else if (p.type !== "MemberExpression" && c.type === "MemberExpression") {
        var member = c; // A member expression must be of form <Identifier>.<memberExpression|Identifier>

        if (member.object.type !== "Identifier" || member.computed) {
          this.error("property access must be of form id.property");
        } else {
          this.resolver.lookupReplace(eventSymTable, p, c);
        }
      }
    });
  };

  return VMChecker;
}(); // private stuff

function isBoolOrNumericFormat(fmt) {
  return fmt === "bool" || /^[ui]\d+/i.test(fmt);
}

function isRegister(pkt) {
  return pkt && (pkt.kind === "const" || pkt.kind === "ro" || pkt.kind === "rw");
}

function lookupRegister(spec, id) {
  return spec.packets.find(pkt => isRegister(pkt) && pkt.name === id);
}

function lookupField(pkt, field) {
  return pkt.fields.find(member => member.name === field);
}

function getRegister(spec, root, fld) {
  if (fld === void 0) {
    fld = "";
  }

  var ret = {
    pkt: undefined,
    fld: undefined
  };
  ret.pkt = lookupRegister(spec, root);

  if (!ret.pkt) {
    throw new Error("no register " + root + " found in service " + spec.shortName);
  } else if (fld) {
    ret.fld = lookupField(ret.pkt, fld);
    if (!ret.fld) throw new Error("no field " + fld + " found in register " + root + " of service " + spec.shortName);
  }

  return ret;
}
// EXTERNAL MODULE: ./jacdac-ts/src/jdom/utils.ts
var utils = __webpack_require__(81794);
;// CONCATENATED MODULE: ./jacdac-ts/src/vm/compile.ts




function toIdentifier(id) {
  return {
    type: "Identifier",
    name: id
  };
}
function toMemberExpression(root, field) {
  return {
    type: "MemberExpression",
    object: toIdentifier(root),
    property: typeof field === "string" ? toIdentifier(field) : field,
    computed: false
  };
}

function handlerVisitor(handler, visitITE, visitCommand) {
  handler.commands.forEach(visitBase);

  function visitBase(base) {
    switch (base.type) {
      case "cmd":
        {
          if (visitCommand) visitCommand(base);
          break;
        }

      case "ite":
        {
          var _ite$else, _ite$then;

          var _ite = base;
          if (visitITE) visitITE(_ite, 0);
          _ite === null || _ite === void 0 ? void 0 : (_ite$else = _ite.else) === null || _ite$else === void 0 ? void 0 : _ite$else.forEach(visitBase);
          if (visitITE) visitITE(_ite, 1);
          _ite === null || _ite === void 0 ? void 0 : (_ite$then = _ite.then) === null || _ite$then === void 0 ? void 0 : _ite$then.forEach(visitBase);
          if (visitITE) visitITE(_ite, 2);
        }
    }
  }
}

function compileProgram(_ref) {
  var {
    roles,
    serverRoles,
    handlers
  } = _ref;
  var newProgram = {
    roles,
    serverRoles,
    handlers: []
  }; // process start blocks

  handlers.forEach(startBlock); // remove if-then-else

  newProgram.handlers = handlers.map(h => {
    return {
      commands: removeIfThenElse(h),
      errors: h === null || h === void 0 ? void 0 : h.errors
    };
  });
  return newProgram;
}

function checkCall(cmd, id) {
  if (cmd.type === "cmd") {
    var callee = cmd.command.callee;

    if (callee.type === "Identifier") {
      var cid = callee.name;
      return id === cid;
    }
  }

  return undefined;
}

function startBlock(handler) {
  if (handler.commands.length && checkCall(handler.commands[0], "start")) {
    handler.commands.shift();
    handler.commands.push({
      type: "cmd",
      command: {
        type: "CallExpression",
        callee: toIdentifier("halt"),
        arguments: []
      }
    });
  }
}

function removeIfThenElse(handler) {
  var newSequence = [];
  var labels = [];
  var labelId = 1;
  handlerVisitor(handler, (ite, time) => {
    switch (time) {
      case 0:
        {
          // create the labels and branch instruction
          var then = "then_" + labelId;
          var end = "end_" + labelId;
          labels.push({
            then,
            end
          });
          labelId++;
          newSequence.push({
            type: "cmd",
            command: {
              type: "CallExpression",
              callee: toIdentifier("branchOnCondition"),
              arguments: [ite.expr, toIdentifier(then)]
            }
          });
          break;
        }

      case 1:
        {
          // insert the jump and then label
          var {
            then: _then,
            end: _end
          } = labels[labels.length - 1];
          newSequence.push({
            type: "cmd",
            command: {
              type: "CallExpression",
              callee: toIdentifier("jump"),
              arguments: [toIdentifier(_end)]
            }
          });
          newSequence.push({
            type: "cmd",
            command: {
              type: "CallExpression",
              callee: toIdentifier("label"),
              arguments: [toIdentifier(_then)]
            }
          });
          break;
        }

      case 2:
        {
          (0,utils/* assert */.hu)(labels.length > 0);
          var {
            end: _end2
          } = labels[labels.length - 1];
          newSequence.push({
            type: "cmd",
            command: {
              type: "CallExpression",
              callee: toIdentifier("label"),
              arguments: [toIdentifier(_end2)]
            }
          });
          labels.pop();
        }
    }
  }, cmd => {
    newSequence.push(cmd);
  });
  return newSequence;
}

var getServiceFromRole = info => role => {
  // lookup in roles first
  var roleFound = info.roles.find(pair => pair.role === role);
  var client = true;

  if (!roleFound) {
    roleFound = info.serverRoles.find(pair => pair.role === role);
    client = false;
  }

  if (roleFound) {
    // must succeed
    var spec = (0,jdom_spec/* serviceSpecificationFromClassIdentifier */.d5)(roleFound.serviceClass);
    (0,utils/* assert */.hu)(!!spec, "service class " + roleFound.serviceClass + " not resolved");
    return {
      spec,
      client
    };
  } else {
    var _spec = (0,jdom_spec/* serviceSpecificationFromName */.kB)(role);

    return {
      spec: _spec,
      client: true
    };
  }
};
function checkProgram(prog) {
  var allErrors = [];
  var goodHandlers = [];

  var errorFun = e => {
    allErrors.push({
      sourceId: undefined,
      message: e
    });
  };

  var symbolResolver = new SpecSymbolResolver(undefined, getServiceFromRole(prog), errorFun);
  var checker = new VMChecker(symbolResolver, _ => true, errorFun);
  prog.handlers.forEach(h => {
    if (h !== null && h !== void 0 && h.errors.length) {
      h === null || h === void 0 ? void 0 : h.errors.forEach(e => allErrors.push(e));
      return;
    }

    var errorCount = allErrors.length;
    symbolResolver.roles = [];
    handlerVisitor(h, undefined, c => checker.checkCommand(c.command, VMFunctions));

    if ((h === null || h === void 0 ? void 0 : h.errors.length) === 0 && allErrors.length === errorCount) {
      h.roles = symbolResolver.roles;
      goodHandlers.push(h);
    } else {
      h === null || h === void 0 ? void 0 : h.errors.forEach(e => allErrors.push(e));
    }
  });
  prog.handlers = goodHandlers;
  return {
    registers: symbolResolver.registers.map(s => {
      var [root, fld] = s.split(".");
      return {
        role: root,
        register: fld
      };
    }),
    events: symbolResolver.events.map(e => {
      var [root, fld] = e.split(".");
      return {
        role: root,
        event: fld
      };
    }),
    errors: allErrors
  };
}

/***/ }),

/***/ 59448:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "UM": function() { return /* binding */ VM_WATCH_CHANGE; },
/* harmony export */   "Di": function() { return /* binding */ VM_BREAKPOINT; },
/* harmony export */   "ai": function() { return /* binding */ VM_COMMAND_FAILED; },
/* harmony export */   "XD": function() { return /* binding */ VM_ROLE_MISSING; },
/* harmony export */   "b4": function() { return /* binding */ VM_GLOBAL_CHANGE; },
/* harmony export */   "c2": function() { return /* binding */ VM_INTERNAL_ERROR; },
/* harmony export */   "aG": function() { return /* binding */ VM_LOG_ENTRY; }
/* harmony export */ });
/* unused harmony export VM_GLOBAL_TYPE_MISMATCH */
var VM_WATCH_CHANGE = "vmWatchChange";
var VM_BREAKPOINT = "vmBreakpoint";
var VM_COMMAND_FAILED = "vmCommandFailed";
var VM_ROLE_MISSING = "vmRoleMissing";
var VM_GLOBAL_CHANGE = "vmVariableChange";
var VM_GLOBAL_TYPE_MISMATCH = "vmDynamicTypeError";
var VM_INTERNAL_ERROR = "vmInternalError";
var VM_LOG_ENTRY = "vmLogEntry";

/***/ }),

/***/ 26212:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";

// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  "Z": function() { return /* binding */ BlockProvider; },
  "C": function() { return /* binding */ blockly_BlockContext; }
});

// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js
var asyncToGenerator = __webpack_require__(15861);
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js + 5 modules
var toConsumableArray = __webpack_require__(15785);
// EXTERNAL MODULE: ./node_modules/blockly/index.js
var blockly = __webpack_require__(74640);
var blockly_default = /*#__PURE__*/__webpack_require__.n(blockly);
// EXTERNAL MODULE: ./node_modules/react/index.js
var react = __webpack_require__(67294);
// EXTERNAL MODULE: ./jacdac-ts/src/jdom/constants.ts
var constants = __webpack_require__(71815);
// EXTERNAL MODULE: ./jacdac-ts/src/jdom/utils.ts
var utils = __webpack_require__(81794);
// EXTERNAL MODULE: ./src/jacdac/providerbus.ts + 19 modules
var providerbus = __webpack_require__(24725);
// EXTERNAL MODULE: ./src/jacdac/Context.tsx
var Context = __webpack_require__(20392);
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/defineProperty.js
var defineProperty = __webpack_require__(4942);
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js
var objectWithoutProperties = __webpack_require__(45987);
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/createClass.js
var createClass = __webpack_require__(43144);
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js
var assertThisInitialized = __webpack_require__(97326);
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js
var inheritsLoose = __webpack_require__(94578);
// EXTERNAL MODULE: ./jacdac-ts/src/jdom/spec.ts + 1 modules
var spec = __webpack_require__(26799);
// EXTERNAL MODULE: ./jacdac-ts/src/jdom/client.ts
var client = __webpack_require__(47235);
;// CONCATENATED MODULE: ./jacdac-ts/src/jdom/rolemanager.ts






var _excluded = ["service"];

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0,defineProperty/* default */.Z)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }




/**
 * A binding from a name to a service
 * @category Roles
 */

/**
 * A role manager
 * @category Roles
 */
var RoleManager = /*#__PURE__*/function (_JDClient) {
  (0,inheritsLoose/* default */.Z)(RoleManager, _JDClient);

  function RoleManager(bus) {
    var _this;

    _this = _JDClient.call(this) || this;
    _this._roles = [];
    _this.bus = bus;

    _this.mount(_this.bus.subscribe(constants/* DEVICE_ANNOUNCE */.Hob, _this.addServices.bind((0,assertThisInitialized/* default */.Z)(_this))));

    _this.mount(_this.bus.subscribe(constants/* DEVICE_DISCONNECT */.O55, _this.removeServices.bind((0,assertThisInitialized/* default */.Z)(_this))));

    _this.bindServices();

    return _this;
  }
  /**
   * Indicates if all roles are bound.
   */


  var _proto = RoleManager.prototype;

  /**
   * Gets the list of roles tracked by the manager
   */
  _proto.roles = function roles(bound) {
    if (bound === void 0) {
      bound = undefined;
    }

    if (bound !== undefined) return this._roles.filter(_ref => {
      var {
        service
      } = _ref;
      return !!service === bound;
    });else return this._roles.slice(0);
  }
  /**
   * Saves roles status
   * @returns
   */
  ;

  _proto.saveRoles = function saveRoles() {
    return this._roles.map(_ref2 => {
      var {
        service
      } = _ref2,
          rest = (0,objectWithoutProperties/* default */.Z)(_ref2, _excluded);

      return _objectSpread(_objectSpread({}, rest), {}, {
        serviceId: service === null || service === void 0 ? void 0 : service.id
      });
    });
  };

  /**
   * Updates the list of roles
   * @param newRoles
   */
  _proto.updateRoles = function updateRoles(newRoles) {
    var _this2 = this;

    var oldBound = this.isBound;
    var oldHash = this.hash; // remove unknown roles

    var supportedNewRoles = newRoles.filter(_ref3 => {
      var {
        serviceClass
      } = _ref3;
      return (0,spec/* serviceSpecificationFromClassIdentifier */.d5)(serviceClass);
    }); // ensure that preferred deviceid/service index is unique

    var preferreds = new Set();

    for (var role of supportedNewRoles.filter(r => !!r.preferredDeviceId)) {
      var key = role.preferredDeviceId + (role.preferredServiceIndex || -1);

      if (preferreds.has(key)) {
        role.preferredDeviceId = undefined;
        role.preferredServiceIndex = undefined;
      } else preferreds.add(key);
    } // unbind removed roles


    var i = 0;

    var _loop = function _loop() {
      var role = _this2._roles[i];

      if (!supportedNewRoles.find(r => r.role === role.role)) {
        _this2._roles.splice(i, 1);

        _this2.emit(constants/* ROLE_UNBOUND */.CCp, role.role);
      } else {
        i++;
      }
    };

    while (i < this._roles.length) {
      _loop();
    } // update or add roles


    var _loop2 = function _loop2(newRole) {
      var existingRole = _this2._roles.find(r => r.role === newRole.role);

      if (!existingRole) {
        // added role
        _this2._roles.push(_objectSpread({}, newRole));
      } else {
        var bindingChanged = existingRole.serviceClass !== newRole.serviceClass || existingRole.preferredDeviceId != newRole.preferredDeviceId || existingRole.preferredServiceIndex != newRole.preferredServiceIndex;
        existingRole.serviceClass = newRole.serviceClass;
        existingRole.preferredDeviceId = newRole.preferredDeviceId;
        existingRole.preferredServiceIndex = newRole.preferredServiceIndex; // unbinding existing service

        if (existingRole.service && bindingChanged) {
          existingRole.service = undefined;

          _this2.emit(constants/* ROLE_UNBOUND */.CCp, existingRole.role);
        }
      }

      if (newRole.preferredDeviceId) {
        // make sure that the preferred device id is free
        var otherBinding = _this2._roles.find(r => r.service && r.service.device.deviceId === newRole.preferredDeviceId && (isNaN(newRole.preferredServiceIndex) || r.service.serviceIndex === newRole.preferredServiceIndex));

        if (otherBinding) {
          otherBinding.service = undefined;

          _this2.emit(constants/* ROLE_UNBOUND */.CCp, otherBinding.role);
        }
      } // role unmodified

    };

    for (var newRole of supportedNewRoles) {
      _loop2(newRole);
    } // bound services


    var changed = oldHash !== this.hash;
    this.bindServices(changed);
    this.emitBoundEvents(oldBound);
  }
  /**
   * Resolves the service bound to a given role.
   * @param role
   * @returns
   */
  ;

  _proto.service = function service(role) {
    var _this$_roles$find;

    return (_this$_roles$find = this._roles.find(r => r.role === role)) === null || _this$_roles$find === void 0 ? void 0 : _this$_roles$find.service;
  }
  /**
   * Updates or creates a new role
   * @param role name of the role
   * @param serviceClass desired service class
   * @param preferredDeviceId optional preferred device id
   * @returns
   */
  ;

  _proto.updateRole = function updateRole(role, serviceClass, preferredDeviceId, preferredServiceIndex) {
    var newRoles = this._roles.slice(0).map(r => _objectSpread({}, r));

    var binding = newRoles.find(r => r.role === role);

    if (binding) {
      binding.service = undefined;
      binding.preferredDeviceId = preferredDeviceId;
      binding.preferredServiceIndex = preferredServiceIndex;
    } else {
      binding = {
        role,
        serviceClass,
        preferredDeviceId,
        preferredServiceIndex
      };
      newRoles.push(binding);
    } // find any other binding with the same preferences and clear it


    if (preferredDeviceId) {
      var other = this._roles.find(r => r !== binding && r.preferredDeviceId === preferredDeviceId && r.preferredServiceIndex === preferredServiceIndex);

      if (other) {
        other.preferredDeviceId = undefined;
        other.preferredServiceIndex = undefined;
      }
    }

    this.updateRoles(newRoles);
  };

  _proto.emitBoundEvents = function emitBoundEvents(oldBound) {
    var bound = this.isBound;
    if (oldBound !== bound) this.emit(bound ? constants/* BOUND */.E5I : constants/* UNBOUND */.BKI);
  } // TODO: need to respect other (unbound) role's preferredDeviceId
  ;

  _proto.bindRole = function bindRole(role) {
    // find a service that is not yet allocated
    var bound = this.roles(true);
    var unboundServices = this.bus.services({
      ignoreInfrastructure: true,
      serviceClass: role.serviceClass
    }).filter(s => !bound.find(r => r.service === s));
    var boundServices = bound.map(r => r.service).filter(srv => !!srv); // pick the first unbound service

    var theOne = unboundServices[0]; // if there are constraint, try a better fit

    if (role.preferredDeviceId) {
      var newOne = [].concat((0,toConsumableArray/* default */.Z)(unboundServices), (0,toConsumableArray/* default */.Z)(boundServices)).find(s => s.device.deviceId === role.preferredDeviceId && (isNaN(role.preferredServiceIndex) || role.preferredServiceIndex === s.serviceIndex));

      if (newOne) {
        theOne = newOne;
      }
    }

    if (theOne) {
      role.service = theOne;
      this.emit(constants/* ROLE_BOUND */.l9m, role.role);
      return true;
    } else return false;
  };

  _proto.bindServices = function bindServices(changed) {
    var r = this.roles().sort((l, r) => {
      var c = 0;
      if (r.preferredDeviceId || l.preferredDeviceId) c = -(l.preferredDeviceId || "").localeCompare(r.preferredDeviceId || "");
      if (c != 0) return c;
      if (!isNaN(l.preferredServiceIndex) || !isNaN(r.preferredServiceIndex)) c = -(l.preferredServiceIndex || 0) + (r.preferredServiceIndex || 0);
      return c;
    });
    r.forEach(binding => {
      if (this.bindRole(binding)) changed = true;
    });
    if (changed) this.emit(constants/* CHANGE */.Ver);
  };

  _proto.addServices = function addServices(dev) {
    if (dev === this.bus.selfDevice) return;
    this.bindServices();
  };

  _proto.removeServices = function removeServices(dev) {
    var changed = false;

    this._roles.filter(r => {
      var _r$service;

      return ((_r$service = r.service) === null || _r$service === void 0 ? void 0 : _r$service.device) === dev;
    }).forEach(r => {
      r.service = undefined;
      this.emit(constants/* ROLE_UNBOUND */.CCp, r.role);
      changed = true;
    });

    this.bindServices(changed);
  };

  _proto.toString = function toString() {
    return this._roles.map(_ref4 => {
      var {
        role,
        service
      } = _ref4;
      return role + "->" + (service || "?");
    }).join(",");
  };

  (0,createClass/* default */.Z)(RoleManager, [{
    key: "isBound",
    get: function get() {
      return this._roles.every(_ref5 => {
        var {
          service
        } = _ref5;
        return !!service;
      });
    }
  }, {
    key: "hash",
    get: function get() {
      return JSON.stringify(this.saveRoles());
    }
  }]);

  return RoleManager;
}(client/* JDClient */.z);
/* harmony default export */ var rolemanager = (RoleManager);
/**
 * Tracks a set of roles
 * @param bus bus hosting the devices
 * @param bindings map of role names to device service pairs
 * @param onUpdate callback to run whenver role assignments change
 * @param options Additional options
 * @returns A unsubscribe callback to cleanup handlers
 * @category Roles
 */

function startRoles(bus, bindings, onUpdate, options) {
  var {
    incomplete
  } = options || {};
  var roleManager = new RoleManager(bus);
  roleManager.updateRoles(Object.keys(bindings).map(role => ({
    role,
    serviceClass: bindings[role].serviceClass,
    preferredDeviceId: bindings[role].preferredDeviceId,
    preferredServiceIndex: bindings[role].preferredServiceIndex
  })));

  var roles = () => {
    // eslint-disable-next-line @typescript-eslint/no-explicit-any
    var r = {};

    for (var key in bindings) {
      var srv = roleManager.service(key);
      if (srv) r[key] = srv;
    }

    return r;
  };

  var update = () => {
    if (!incomplete && !roleManager.isBound) return;
    onUpdate(roles());
  };

  var unsubscribe = roleManager.subscribe(CHANGE, update);
  update();
  return unsubscribe;
}
/*
function test(bus: JDBus) {
    const bindings = {
        thermo1: { serviceClass: SRV_BUTTON },
        thermo2: { serviceClass: SRV_BUTTON },
    }
    trackRoles(
        bus,
        bindings,
        ({ thermo1, thermo2 }) => {
            console.log({ thermo1, thermo2 })
        },
        { incomplete: true }
    )
}
*/
;// CONCATENATED MODULE: ./src/components/hooks/useRoleManager.ts



function useRoleManager() {
  var {
    bus
  } = (0,react.useContext)(Context/* default */.Z);
  var roleManager = (0,react.useMemo)(() => bus && new rolemanager(bus), [bus]);
  return roleManager;
}
// EXTERNAL MODULE: ./src/components/hooks/useLocalStorage.ts
var useLocalStorage = __webpack_require__(34093);
// EXTERNAL MODULE: ./src/components/blockly/dsl/workspacevisitor.ts
var workspacevisitor = __webpack_require__(52429);
;// CONCATENATED MODULE: ./src/components/blockly/blockwarning.ts

function collectWarnings(workspace) {
  var warnings = [];
  (0,workspacevisitor/* visitWorkspace */.R1)(workspace, {
    visitBlock: b => {
      if (b.warning) warnings.push({
        sourceId: b.id,
        message: b.warning
      });
    }
  });
  return warnings;
}
// EXTERNAL MODULE: ./src/components/blockly/toolbox.ts
var toolbox = __webpack_require__(16582);
// EXTERNAL MODULE: ./src/components/blockly/WorkspaceContext.tsx
var WorkspaceContext = __webpack_require__(89801);
;// CONCATENATED MODULE: ./src/components/blockly/dsl/datasolver.ts



 //import nprogress from "accessible-nprogress"

var PROGRESS_DELAY = 200;
function registerDataSolver(block) {
  var {
    jacdacServices: services
  } = block; // register data transforms

  var {
    transformData
  } = (0,toolbox/* resolveBlockDefinition */.Pq)(block.type) || {};
  if (!transformData) return;

  var applyTransform = /*#__PURE__*/function () {
    var _ref = (0,asyncToGenerator/* default */.Z)(function* () {
      var _block$nextConnection;

      if (!block.isEnabled() || block.isInFlyout) return; // transfer data to the next block

      var nextServices = (0,WorkspaceContext/* resolveBlockServices */.Ys)((_block$nextConnection = block.nextConnection) === null || _block$nextConnection === void 0 ? void 0 : _block$nextConnection.targetBlock());

      try {
        services.setDataWarning(undefined); // eslint-disable-next-line @typescript-eslint/ban-types

        var newData;
        if (transformData === toolbox/* identityTransformData */.FW) newData = services.data;else {
          var progressid = setTimeout(() => {
            progressid = undefined; // nprogress.start()
          }, PROGRESS_DELAY);

          try {
            //const start = performance.now()
            newData = yield transformData(block, services.data, nextServices === null || nextServices === void 0 ? void 0 : nextServices.data); //const end = performance.now()
            //console.debug(
            //    `data ${block.type}: ${roundWithPrecision(
            //        (end - start) / 1000,
            //        3
            //    )}s`
            //)
          } finally {
            if (progressid) clearTimeout(progressid);else {//nprogress.done()
            }
          }
        } // propagate

        services.transformedData = newData; // check if pass through

        var def = (0,toolbox/* resolveBlockDefinition */.Pq)(block.type);
        if (def !== null && def !== void 0 && def.passthroughData) newData = services.data;
        if (nextServices) nextServices.data = newData;
      } catch (e) {
        console.debug(e);
      }
    });

    return function applyTransform() {
      return _ref.apply(this, arguments);
    };
  }(); // apply transform, then register for change


  applyTransform().then(() => services.on(constants/* CHANGE */.Ver, applyTransform));
}
// EXTERNAL MODULE: ./src/components/blockly/jsongenerator.ts
var jsongenerator = __webpack_require__(97428);
// EXTERNAL MODULE: ./src/components/blockly/useWorkspaceEvent.ts
var useWorkspaceEvent = __webpack_require__(34148);
;// CONCATENATED MODULE: ./src/components/blockly/useBlocklyEvents.ts


 // do not use block context

function useBlocklyEvents(workspace) {
  var handleChange = (0,react.useCallback)(event => {
    var {
      type
    } = event;

    switch (type) {
      case (blockly_default()).Events.BLOCK_CHANGE:
        {
          var _twinField$emitChange;

          var change = event;
          var block = workspace.getBlockById(change.blockId); // notify twin that the value changed

          var twinInput = block.inputList[1];
          var twinField = twinInput === null || twinInput === void 0 ? void 0 : twinInput.fieldRow.find(f => f.name === "twin");
          twinField === null || twinField === void 0 ? void 0 : (_twinField$emitChange = twinField.emitChange) === null || _twinField$emitChange === void 0 ? void 0 : _twinField$emitChange.call(twinField);
          break;
        }
    }
  }, [workspace]);
  (0,useWorkspaceEvent/* default */.Z)(workspace, handleChange);
}
// EXTERNAL MODULE: ./node_modules/blockly/core-browser.js
var core_browser = __webpack_require__(90888);
;// CONCATENATED MODULE: ./node_modules/@blockly/field-slider/src/field_slider.js
/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */

/**
 * @fileoverview Number slider input field.
 * @author kozbial@google.com (Monica Kozbial)
 */

/**
 * Slider field.
 */

class FieldSlider extends core_browser.FieldNumber {
  /**
   * Class for an number slider field.
   * @param {string|number=} value The initial value of the field. Should
   *    cast to a number. Defaults to 0.
   * @param {?(string|number)=} min Minimum value.
   * @param {?(string|number)=} max Maximum value.
   * @param {?(string|number)=} precision Precision for value.
   * @param {?Function=} validator A function that is called to validate
   *    changes to the field's value. Takes in a number & returns a validated
   *    number, or null to abort the change.
   * @param {Object=} config A map of options used to configure the field.
   *    See the [field creation documentation]{@link
   * https://developers.google.com/blockly/guides/create-custom-blocks/fields/built-in-fields/number#creation}
   *    for a list of properties this parameter supports.
   * @extends {Blockly.FieldNumber}
   * @constructor
   */
  constructor() {
    var value = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : undefined;
    var min = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : undefined;
    var max = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : undefined;
    var precision = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : undefined;
    var validator = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : undefined;
    var config = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : undefined;
    super(value, min, max, precision, validator, config);
    /**
     * Array holding info needed to unbind events.
     * Used for disposing.
     * Ex: [[node, name, func], [node, name, func]].
     * @type {!Array.<Array<?>>}
     * @private
     */

    this.boundEvents_ = [];
    /**
     * The HTML range input element.
     * @type {?HTMLInputElement}
     * @private
     */

    this.sliderInput_ = null;
  }
  /**
   * Constructs a FieldSlider from a JSON arg object.
   * @param {!Object} options A JSON object with options (value, min, max, and
   *                          precision).
   * @return {!FieldSlider} The new field instance.
   * @package
   * @nocollapse
   */


  static fromJson(options) {
    return new FieldSlider(options['value'], undefined, undefined, undefined, undefined, options);
  }
  /**
   * Show the inline free-text editor on top of the text along with the slider
   *    editor.
   * @param {Event=} e Optional mouse event that triggered the field to
   *     open, or undefined if triggered programmatically.
   * @param {boolean=} _quietInput Quiet input.
   * @protected
   * @override
   */


  showEditor_() {
    var e = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : undefined;

    var _quietInput = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : undefined;

    // Mobile browsers have issues with in-line textareas (focus & keyboards).
    var noFocus = core_browser.utils.userAgent.MOBILE || core_browser.utils.userAgent.ANDROID || core_browser.utils.userAgent.IPAD;
    super.showEditor_(e, noFocus); // Build the DOM.

    var editor = this.dropdownCreate_();
    core_browser.DropDownDiv.getContentDiv().appendChild(editor);
    core_browser.DropDownDiv.setColour(this.sourceBlock_.style.colourPrimary, this.sourceBlock_.style.colourTertiary);
    core_browser.DropDownDiv.showPositionedByField(this, this.dropdownDispose_.bind(this));
  }
  /**
   * Updates the slider when the field rerenders.
   * @protected
   * @override
   */


  render_() {
    super.render_();
    this.updateSlider_();
  }
  /**
   * Creates the slider editor and add event listeners.
   * @return {!Element} The newly created slider.
   * @private
   */


  dropdownCreate_() {
    var wrapper = document.createElement('div');
    wrapper.className = 'fieldSliderContainer';
    var sliderInput = document.createElement('input');
    sliderInput.setAttribute('type', 'range');
    sliderInput.setAttribute('min', this.min_);
    sliderInput.setAttribute('max', this.max_);
    sliderInput.setAttribute('step', this.precision_);
    sliderInput.setAttribute('value', this.getValue());
    sliderInput.className = 'fieldSlider';
    wrapper.appendChild(sliderInput);
    this.sliderInput_ = sliderInput;
    this.boundEvents_.push(core_browser.bindEventWithChecks_(sliderInput, 'input', this, this.onSliderChange_));
    return wrapper;
  }
  /**
   * Disposes of events belonging to the slider editor.
   * @private
   */


  dropdownDispose_() {
    for (var event of this.boundEvents_) {
      core_browser.unbindEvent_(event);
    }

    this.sliderInput_ = null;
  }
  /**
   * Sets the text to match the slider's position.
   * @private
   */


  onSliderChange_() {
    this.setEditorValue_(this.sliderInput_.value);
  }
  /**
   * Updates the slider when the field rerenders.
   * @private
   */


  updateSlider_() {
    if (!this.sliderInput_) {
      return;
    }

    this.sliderInput_.setAttribute('value', this.getValue());
  }

}
core_browser.fieldRegistry.register('field_slider', FieldSlider);
/**
 * CSS for slider field.
 */

core_browser.Css.register([
/* eslint-disable indent */
".fieldSliderContainer {\n      align-items: center;\n      display: flex;\n      height: 32px;\n      justify-content: center;\n      width: 150px;\n    }\n    .fieldSlider {\n      -webkit-appearance: none;\n      background: transparent; /* override white in chrome */\n      margin: 4px;\n      padding: 0;\n      width: 100%;\n    }\n    .fieldSlider:focus {\n      outline: none;\n    }\n    /* Webkit */\n    .fieldSlider::-webkit-slider-runnable-track {\n      background: #ddd;\n      border-radius: 5px;\n      height: 10px;\n    }\n    .fieldSlider::-webkit-slider-thumb {\n      -webkit-appearance: none;\n      background: #fff;\n      border-radius: 50%;\n      box-shadow: 0 0 0 4px rgba(255,255,255,.15);\n      cursor: pointer;\n      height: 24px;\n      margin-top: -7px;\n      width: 24px;\n    }\n    /* Firefox */\n    .fieldSlider::-moz-range-track {\n      background: #ddd;\n      border-radius: 5px;\n      height: 10px;\n    }\n    .fieldSlider::-moz-range-thumb {\n      background: #fff;\n      border: none;\n      border-radius: 50%;\n      box-shadow: 0 0 0 4px rgba(255,255,255,.15);\n      cursor: pointer;\n      height: 24px;\n      width: 24px;\n    }\n    .fieldSlider::-moz-focus-outer {\n      /* override the focus border style */\n      border: 0;\n    }\n    /* IE */\n    .fieldSlider::-ms-track {\n      /* IE wont let the thumb overflow the track, so fake it */\n      background: transparent;\n      border-color: transparent;\n      border-width: 15px 0;\n      /* remove default tick marks */\n      color: transparent;\n      height: 10px;\n      width: 100%;\n      margin: -4px 0;\n    }\n    .fieldSlider::-ms-fill-lower  {\n      background: #ddd;\n      border-radius: 5px;\n    }\n    .fieldSlider::-ms-fill-upper  {\n      background: #ddd;\n      border-radius: 5px;\n    }\n    .fieldSlider::-ms-thumb {\n      background: #fff;\n      border: none;\n      border-radius: 50%;\n      box-shadow: 0 0 0 4px rgba(255,255,255,.15);\n      cursor: pointer;\n      height: 24px;\n      width: 24px;\n    }"
/* eslint-enable indent */
]);
;// CONCATENATED MODULE: ./node_modules/@blockly/field-slider/src/index.js
/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */

;// CONCATENATED MODULE: ./node_modules/@blockly/block-dynamic-connection/src/insertion_marker_manager_monkey_patch.js
/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */

/**
 * @fileoverview Overrides methods on Blockly.InsertionMarkerManager to
 * allow blocks to hook in dynamic functionality when they have pending
 * connections.
 * @author anjali@code.org (Anjali Pal)
 */


core_browser.InsertionMarkerManager.prototype.update = function (dxy, deleteArea) {
  var candidate = this.getCandidate_(dxy);
  this.wouldDeleteBlock_ = this.shouldDelete_(candidate, deleteArea);
  var shouldUpdate = this.wouldDeleteBlock_ || this.shouldUpdatePreviews_(candidate, dxy);

  if (shouldUpdate) {
    // Begin monkey patch
    if (candidate.closest && candidate.closest.sourceBlock_.onPendingConnection) {
      candidate.closest.sourceBlock_.onPendingConnection(candidate.closest);

      if (!this.pendingBlocks) {
        this.pendingBlocks = new Set();
      }

      this.pendingBlocks.add(candidate.closest.sourceBlock_);
    } // End monkey patch
    // Don't fire events for insertion marker creation or movement.


    core_browser.Events.disable();
    this.maybeHidePreview_(candidate);
    this.maybeShowPreview_(candidate);
    core_browser.Events.enable();
  }
};

var oldDispose = core_browser.InsertionMarkerManager.prototype.dispose;

core_browser.InsertionMarkerManager.prototype.dispose = function () {
  if (this.pendingBlocks) {
    this.pendingBlocks.forEach(block => {
      if (block.finalizeConnections) {
        block.finalizeConnections();
      }
    });
  }

  oldDispose.call(this);
};
;// CONCATENATED MODULE: ./node_modules/@blockly/block-dynamic-connection/src/dynamic_if.js
/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */

/**
 * @fileoverview Defines a version of the if block with dyanmic
 *     inputs that appear when a block is dragged over inputs on the block.
 */

core_browser.Blocks.dynamic_if = {
  /**
   * Counter for the next input to add to this block.
   * @type {number}
   */
  inputCounter: 1,

  /**
   * Minimum number of inputs for this block.
   * @type {number}
   */
  minInputs: 1,

  /**
   * Block for if/elseif/else statements. Must have one if input.
   * Can have any number of elseif inputs and optionally one else input.
   * @this {Blockly.Block}
   */
  init: function init() {
    this.setHelpUrl(core_browser.Msg.CONTROLS_IF_HELPURL);
    this.setStyle('logic_blocks');
    this.appendValueInput('IF0').setCheck('Boolean').appendField(core_browser.Msg.CONTROLS_IF_MSG_IF, 'if');
    this.appendStatementInput('DO0').appendField(core_browser.Msg.CONTROLS_IF_MSG_THEN);
    this.setNextStatement(true);
    this.setPreviousStatement(true);
    this.setTooltip(core_browser.Msg.LISTS_CREATE_WITH_TOOLTIP);
  },

  /**
   * Create XML to represent if/elseif/else inputs.
   * @return {!Element} XML storage element.
   * @this {Blockly.Block}
   */
  mutationToDom: function mutationToDom() {
    var container = core_browser.utils.xml.createElement('mutation');
    var inputNames = this.inputList.filter(input => input.name.includes('IF')).map(input => input.name.replace('IF', '')).join(',');
    container.setAttribute('inputs', inputNames);
    var hasElse = !!this.getInput('ELSE');
    container.setAttribute('else', hasElse);
    container.setAttribute('next', this.inputCounter);
    return container;
  },

  /**
   * Parse XML to restore the inputs.
   * @param {!Element} xmlElement XML storage element.
   * @this {Blockly.Block}
   */
  domToMutation: function domToMutation(xmlElement) {
    var inputs = xmlElement.getAttribute('inputs');

    if (inputs) {
      var inputNumbers = inputs.split(',');

      if (this.getInput('IF0')) {
        this.removeInput('IF0');
      }

      if (this.getInput('DO0')) {
        this.removeInput('DO0');
      }

      var first = inputNumbers[0];
      this.appendValueInput('IF' + first).setCheck('Boolean').appendField(core_browser.Msg.CONTROLS_IF_MSG_IF, 'if');
      this.appendStatementInput('DO' + first).appendField(core_browser.Msg.CONTROLS_IF_MSG_THEN);

      for (var i = 1; i < inputNumbers.length; i++) {
        this.appendValueInput('IF' + inputNumbers[i]).setCheck('Boolean').appendField(core_browser.Msg.CONTROLS_IF_MSG_ELSEIF, 'elseif');
        this.appendStatementInput('DO' + inputNumbers[i]).appendField(core_browser.Msg.CONTROLS_IF_MSG_THEN);
      }
    }

    var hasElse = xmlElement.getAttribute('else');

    if (hasElse == 'true') {
      this.appendStatementInput('ELSE').appendField(core_browser.Msg.CONTROLS_IF_MSG_ELSE, 'else');
    }

    var next = parseInt(xmlElement.getAttribute('next'));
    this.inputCounter = next;
  },

  /**
   * Finds the index of a connection. Used to determine where in the block to
   * insert new inputs.
   * @param {!Blockly.Connection} connection A connection on this block.
   * @return {?number} The index of the connection in the this.inputList.
   */
  findInputIndexForConnection: function findInputIndexForConnection(connection) {
    for (var i = 0; i < this.inputList.length; i++) {
      var input = this.inputList[i];

      if (input.connection == connection) {
        return i;
      }
    }

    return null;
  },

  /**
   * Inserts a boolean value input and statement input at the specified index.
   * @param {number} index Index of the input before which to add new inputs.
   */
  insertElseIf: function insertElseIf(index) {
    var caseNumber = this.inputCounter;
    this.appendValueInput('IF' + caseNumber).setCheck('Boolean').appendField(core_browser.Msg.CONTROLS_IF_MSG_ELSEIF, 'elseif');
    this.appendStatementInput('DO' + caseNumber).appendField(core_browser.Msg.CONTROLS_IF_MSG_THEN);
    this.moveInputBefore('IF' + caseNumber, this.inputList[index].name);
    this.moveInputBefore('DO' + caseNumber, this.inputList[index + 1].name);
    this.inputCounter++;
  },

  /**
   * Called when a block is dragged over one of the connections on this block.
   * @param {!Blockly.Connection} connection The connection on this block that
   * has a pending connection.
   */
  onPendingConnection: function onPendingConnection(connection) {
    if (connection.type === core_browser.NEXT_STATEMENT && !this.getInput('ELSE')) {
      this.appendStatementInput('ELSE').appendField(core_browser.Msg.CONTROLS_IF_MSG_ELSE, 'else');
    }

    var inputIndex = this.findInputIndexForConnection(connection);

    if (inputIndex === null) {
      return;
    }

    var input = this.inputList[inputIndex];

    if (connection.targetConnection && input.name.includes('IF')) {
      var nextIfInput = this.inputList[inputIndex + 2];

      if (!nextIfInput || nextIfInput.name == 'ELSE') {
        this.insertElseIf(inputIndex + 2);
      } else {
        var nextIfConnection = nextIfInput && nextIfInput.connection.targetConnection;

        if (nextIfConnection && !nextIfConnection.sourceBlock_.isInsertionMarker()) {
          this.insertElseIf(inputIndex + 2);
        }
      }
    }
  },

  /**
   * Called when a block drag ends if the dragged block had a pending connection
   * with this block.
   */
  finalizeConnections: function finalizeConnections() {
    var toRemove = []; // Remove Else If inputs if neither the if nor the do has a connected block.

    for (var i = 2; i < this.inputList.length - 1; i += 2) {
      var ifConnection = this.inputList[i];
      var doConnection = this.inputList[i + 1];

      if (!ifConnection.connection.targetConnection && !doConnection.connection.targetConnection) {
        toRemove.push(ifConnection.name);
        toRemove.push(doConnection.name);
      }
    }

    toRemove.forEach(input => this.removeInput(input)); // Remove Else input if it doesn't have a connected block.

    var elseInput = this.getInput('ELSE');

    if (elseInput && !elseInput.connection.targetConnection) {
      this.removeInput(elseInput.name);
    } // Remove the If input if it is empty and there is at least one Else If


    if (this.inputList.length > 2) {
      var ifInput = this.inputList[0];
      var doInput = this.inputList[1];
      var nextInput = this.inputList[2];

      if (nextInput.name.includes('IF') && !ifInput.connection.targetConnection && !doInput.connection.targetConnection) {
        this.removeInput(ifInput.name);
        this.removeInput(doInput.name);
        nextInput.removeField('elseif');
        nextInput.appendField(core_browser.Msg.CONTROLS_IF_MSG_IF, 'if');
      }
    }
  }
};
;// CONCATENATED MODULE: ./node_modules/@blockly/block-dynamic-connection/src/dynamic_text_join.js
/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */

/**
 * @fileoverview Defines a version of the text_join block with dyanmic
 *    inputs that appear when a block is dragged over inputs on the block.
 */

core_browser.Blocks.dynamic_text_join = {
  /**
   * Counter for the next input to add to this block.
   * @type {number}
   */
  inputCounter: 2,

  /**
   * Minimum number of inputs for this block.
   * @type {number}
   */
  minInputs: 2,

  /**
   * Block for concatenating any number of strings.
   * @this {Blockly.Block}
   */
  init: function init() {
    this.setHelpUrl(core_browser.Msg.TEXT_JOIN_HELPURL);
    this.setStyle('text_blocks');
    this.appendValueInput('ADD0').appendField(core_browser.Msg.TEXT_JOIN_TITLE_CREATEWITH);
    this.appendValueInput('ADD1');
    this.setOutput(true, 'String');
    this.setTooltip(core_browser.Msg.TEXT_JOIN_TOOLTIP);
  },

  /**
   * Create XML to represent number of text inputs.
   * @return {!Element} XML storage element.
   * @this {Blockly.Block}
   */
  mutationToDom: function mutationToDom() {
    var container = core_browser.utils.xml.createElement('mutation');
    var inputNames = this.inputList.map(input => input.name).join(',');
    container.setAttribute('inputs', inputNames);
    container.setAttribute('next', this.inputCounter);
    return container;
  },

  /**
   * Parse XML to restore the text inputs.
   * @param {!Element} xmlElement XML storage element.
   * @this {Blockly.Block}
   */
  domToMutation: function domToMutation(xmlElement) {
    var items = xmlElement.getAttribute('inputs');

    if (items) {
      var inputNames = items.split(',');
      this.inputList = [];
      inputNames.forEach(name => this.appendValueInput(name));
      this.inputList[0].appendField(core_browser.Msg.TEXT_JOIN_TITLE_CREATEWITH);
    }

    var next = parseInt(xmlElement.getAttribute('next'));
    this.inputCounter = next;
  },

  /**
   * Check whether a new input should be added and determine where it should go.
   * @param {!Blockly.Connection} connection The connection that has a
   *     pending connection.
   * @return {number} The index before which to insert a new input,
   *     or null if no input should be added.
   */
  getIndexForNewInput: function getIndexForNewInput(connection) {
    if (!connection.targetConnection) {
      // this connection is available
      return null;
    }

    var connectionIndex;

    for (var i = 0; i < this.inputList.length; i++) {
      if (this.inputList[i].connection == connection) {
        connectionIndex = i;
      }
    }

    if (connectionIndex == this.inputList.length - 1) {
      // this connection is the last one and already has a block in it, so
      // we should add a new connection at the end.
      return this.inputList.length + 1;
    }

    var nextInput = this.inputList[connectionIndex + 1];
    var nextConnection = nextInput && nextInput.connection.targetConnection;

    if (nextConnection && !nextConnection.sourceBlock_.isInsertionMarker()) {
      return connectionIndex + 1;
    } // Don't add new connection


    return null;
  },

  /**
   * Called when a block is dragged over one of the connections on this block.
   * @param {!Blockly.Connection} connection The connection on this block that
   *     has a pending connection.
   */
  onPendingConnection: function onPendingConnection(connection) {
    var insertIndex = this.getIndexForNewInput(connection);

    if (insertIndex == null) {
      return;
    }

    this.appendValueInput('ADD' + this.inputCounter++);
    this.moveNumberedInputBefore(this.inputList.length - 1, insertIndex);
  },

  /**
   * Called when a block drag ends if the dragged block had a pending connection
   * with this block.
   */
  finalizeConnections: function finalizeConnections() {
    if (this.inputList.length > this.minInputs) {
      var toRemove = [];
      this.inputList.forEach(input => {
        var targetConnection = input.connection.targetConnection;

        if (!targetConnection) {
          toRemove.push(input.name);
        }
      });

      if (this.inputList.length - toRemove.length < this.minInputs) {
        // Always show at least two inputs
        toRemove = toRemove.slice(this.minInputs);
      }

      toRemove.forEach(inputName => this.removeInput(inputName)); // The first input should have the block text. If we removed the
      // first input, add the block text to the new first input.

      if (this.inputList[0].fieldRow.length == 0) {
        this.inputList[0].appendField(core_browser.Msg.TEXT_JOIN_TITLE_CREATEWITH);
      }
    }
  }
};
;// CONCATENATED MODULE: ./node_modules/@blockly/block-dynamic-connection/src/dynamic_list_create.js
/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */

/**
 * @fileoverview Defines a version of the list_create block with dyanmic
 *     inputs that appear when a block is dragged over inputs on the block.
 */

core_browser.Blocks.dynamic_list_create = {
  /**
   * Counter for the next input to add to this block.
   * @type {number}
   */
  inputCounter: 2,

  /**
   * Minimum number of inputs for this block.
   * @type {number}
   */
  minInputs: 2,

  /**
   * Block for concatenating any number of strings.
   * @this {Blockly.Block}
   */
  init: function init() {
    this.setHelpUrl(core_browser.Msg.LISTS_CREATE_WITH_HELPURL);
    this.setStyle('list_blocks');
    this.appendValueInput('ADD0').appendField(core_browser.Msg.LISTS_CREATE_WITH_INPUT_WITH);
    this.appendValueInput('ADD1');
    this.setOutput(true, 'Array');
    this.setTooltip(core_browser.Msg.LISTS_CREATE_WITH_TOOLTIP);
  },

  /**
   * Create XML to represent number of text inputs.
   * @return {!Element} XML storage element.
   * @this {Blockly.Block}
   */
  mutationToDom: function mutationToDom() {
    var container = core_browser.utils.xml.createElement('mutation');
    var inputNames = this.inputList.map(input => input.name).join(',');
    container.setAttribute('inputs', inputNames);
    container.setAttribute('next', this.inputCounter);
    return container;
  },

  /**
   * Parse XML to restore the text inputs.
   * @param {!Element} xmlElement XML storage element.
   * @this {Blockly.Block}
   */
  domToMutation: function domToMutation(xmlElement) {
    var items = xmlElement.getAttribute('inputs');

    if (items) {
      var inputNames = items.split(',');
      this.inputList = [];
      inputNames.forEach(name => this.appendValueInput(name));
      this.inputList[0].appendField(core_browser.Msg.LISTS_CREATE_WITH_INPUT_WITH);
    }

    var next = parseInt(xmlElement.getAttribute('next'));
    this.inputCounter = next;
  },

  /**
   * Check whether a new input should be added and determine where it should go.
   * @param {!Blockly.Connection} connection The connection that has a
   *     pending connection.
   * @return {number} The index before which to insert a new input,
   *     or null if no input should be added.
   */
  getIndexForNewInput: function getIndexForNewInput(connection) {
    if (!connection.targetConnection) {
      // this connection is available
      return null;
    }

    var connectionIndex;

    for (var i = 0; i < this.inputList.length; i++) {
      if (this.inputList[i].connection == connection) {
        connectionIndex = i;
      }
    }

    if (connectionIndex == this.inputList.length - 1) {
      // this connection is the last one and already has a block in it, so
      // we should add a new connection at the end.
      return this.inputList.length + 1;
    }

    var nextInput = this.inputList[connectionIndex + 1];
    var nextConnection = nextInput && nextInput.connection.targetConnection;

    if (nextConnection && !nextConnection.sourceBlock_.isInsertionMarker()) {
      return connectionIndex + 1;
    } // Don't add new connection


    return null;
  },

  /**
   * Called when a block is dragged over one of the connections on this block.
   * @param {!Blockly.Connection} connection The connection on this block that
   * has a pending connection.
   */
  onPendingConnection: function onPendingConnection(connection) {
    var insertIndex = this.getIndexForNewInput(connection);

    if (insertIndex == null) {
      return;
    }

    this.appendValueInput('ADD' + this.inputCounter++);
    this.moveNumberedInputBefore(this.inputList.length - 1, insertIndex);
  },

  /**
   * Called when a block drag ends if the dragged block had a pending connection
   * with this block.
   */
  finalizeConnections: function finalizeConnections() {
    if (this.inputList.length > this.minInputs) {
      var toRemove = [];
      this.inputList.forEach(input => {
        var targetConnection = input.connection.targetConnection;

        if (!targetConnection) {
          toRemove.push(input.name);
        }
      });

      if (this.inputList.length - toRemove.length < this.minInputs) {
        // Always show at least two inputs
        toRemove = toRemove.slice(this.minInputs);
      }

      toRemove.forEach(inputName => this.removeInput(inputName)); // The first input should have the block text. If we removed the
      // first input, add the block text to the new first input.

      if (this.inputList[0].fieldRow.length == 0) {
        this.inputList[0].appendField(core_browser.Msg.LISTS_CREATE_WITH_INPUT_WITH);
      }
    }
  }
};
;// CONCATENATED MODULE: ./node_modules/@blockly/block-dynamic-connection/src/index.js
/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */

/**
 * @fileoverview Adds blocks that replace the built-in mutator UI with dynamic
 *     connections that appear when a block is dragged over inputs on the block.
 */





var overrideOldBlockDefinitions = function overrideOldBlockDefinitions() {
  Blockly.Blocks['list_create'] = Blockly.Blocks['dynamic_list_create'];
  Blockly.Blocks['text_join'] = Blockly.Blocks['dynamic_text_join'];
  Blockly.Blocks['controls_if'] = Blockly.Blocks['dynamic_if'];
};
;// CONCATENATED MODULE: ./node_modules/@blockly/disable-top-blocks/src/index.js
/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */

/**
 * @fileoverview Plugin for changing the context menu to match the
 * `disableOrphans` event handler.
 */

/**
 * This plugin changes the logic of the enable/disable context menu item. It is
 * enabled for all blocks except top-level blocks that have output or
 * previous connections. In other words, the option is disabled for orphan
 * blocks. Using this plugin allows users to disable valid non-orphan blocks,
 * but not re-enable blocks that have been automatically disabled by
 * `disableOrphans`.
 */

class DisableTopBlocks {
  /**
   * Modifies the context menu 'disable' option as described above.
   */
  init() {
    var disableMenuItem = core_browser.ContextMenuRegistry.registry.getItem('blockDisable');
    this.oldPreconditionFn = disableMenuItem.preconditionFn;

    disableMenuItem.preconditionFn = function (
    /** @type {!Blockly.ContextMenuRegistry.Scope} */
    scope) {
      var block = scope.block;

      if (!block.isInFlyout && block.workspace.options.disable && block.isEditable()) {
        if (block.getInheritedDisabled() || isOrphan(block)) {
          return 'disabled';
        }

        return 'enabled';
      }

      return 'hidden';
    };
  }
  /**
   * Turn off the effects of this plugin and restore the initial behavior.
   * This is never required to be called. It is optional in case you need to
   * disable the plugin.
   */


  dispose() {
    var disableMenuItem = core_browser.ContextMenuRegistry.registry.getItem('blockDisable');
    disableMenuItem.preconditionFn = this.oldPreconditionFn;
  }

}
/**
 * A block is an orphan if its parent is an orphan, or if it doesn't have a
 * parent but it does have a previous or output connection (so it expects to be
 * attached to something). This means all children of orphan blocks are also
 * orphans and cannot be manually re-enabled.
 * @param {!Blockly.BlockSvg} block Block to check.
 * @return {boolean} Whether the block is an orphan.
 */

function isOrphan(block) {
  // If the parent is an orphan block, this block should also be considered
  // an orphan so it cannot be manually re-enabled.
  var parent =
  /** @type {Blockly.BlockSvg} */
  block.getParent();

  if (parent && isOrphan(parent)) {
    return true;
  }

  return !parent && !!(block.outputConnection || block.previousConnection);
}
;// CONCATENATED MODULE: ./src/components/blockly/useBlocklyPlugins.ts




 // do not use block context

function useBlocklyPlugins(workspace) {
  //plugins
  (0,react.useEffect)(() => {
    if (!workspace) return; // context menu stuff

    if (blockly.ContextMenuRegistry.registry.getItem("blockInline")) blockly.ContextMenuRegistry.registry.unregister("blockInline");
    if (blockly.ContextMenuRegistry.registry.getItem("cleanWorkspace")) blockly.ContextMenuRegistry.registry.unregister("cleanWorkspace"); // Add the disableOrphans event handler. This is not done automatically by
    // the plugin and should be handled by your application.

    workspace.addChangeListener((blockly_default()).Events.disableOrphans); // The plugin must be initialized before it has any effect.

    var disableTopBlocksPlugin = new DisableTopBlocks();
    disableTopBlocksPlugin.init();
    return () => workspace.removeChangeListener((blockly_default()).Events.disableOrphans);
  }, [workspace]);
}
// EXTERNAL MODULE: ./src/components/hooks/useServices.ts
var useServices = __webpack_require__(2928);
// EXTERNAL MODULE: ./jacdac-ts/src/jdom/flags.ts
var flags = __webpack_require__(21258);
// EXTERNAL MODULE: ./node_modules/@mui/material/styles/useTheme.js
var useTheme = __webpack_require__(66449);
// EXTERNAL MODULE: ./src/components/blockly/fields/fields.ts
var fields = __webpack_require__(29434);
// EXTERNAL MODULE: ./src/components/blockly/fields/DataPreviewField.tsx
var DataPreviewField = __webpack_require__(16229);
// EXTERNAL MODULE: ./src/components/useEffectAsync.ts
var useEffectAsync = __webpack_require__(7751);
;// CONCATENATED MODULE: ./src/components/hooks/useAsyncMemo.ts



function useAsyncMemo(factory, deps) {
  var {
    0: value,
    1: setValue
  } = (0,react.useState)();
  (0,useEffectAsync/* default */.Z)( /*#__PURE__*/function () {
    var _ref = (0,asyncToGenerator/* default */.Z)(function* (mounted) {
      var v = yield factory();
      if (mounted()) setValue(v);
    });

    return function (_x) {
      return _ref.apply(this, arguments);
    };
  }(), deps || []);
  return value;
}
;// CONCATENATED MODULE: ./src/components/blockly/useToolbox.ts










 // overrides blockly emboss filter for svg elements

(blockly_default()).BlockSvg.prototype.setHighlighted = function (highlighted) {
  if (!this.rendered) {
    return;
  }

  if (highlighted) {
    this.addSelect();
  } else {
    this.removeSelect();
  }
};

function loadBlocks(_x, _x2) {
  return _loadBlocks.apply(this, arguments);
}

function _loadBlocks() {
  _loadBlocks = (0,asyncToGenerator/* default */.Z)(function* (dsls, theme) {
    var blocks = [];

    for (var dsl of dsls) {
      var _dsl$createBlocks;

      var dslBlocks = yield dsl === null || dsl === void 0 ? void 0 : (_dsl$createBlocks = dsl.createBlocks) === null || _dsl$createBlocks === void 0 ? void 0 : _dsl$createBlocks.call(dsl, {
        theme
      });
      if (dslBlocks) for (var b of dslBlocks) {
        (0,DataPreviewField/* addDataPreviewField */.q)(b);
        b.dsl = dsl.id; // ensure DSL is set

        blocks.push(b);
      }
    } // register field editors


    (0,fields/* registerFields */.k)(); // re-register blocks with blocklys

    blocks.forEach(block => (blockly_default()).Blocks[block.type] = {
      jacdacDefinition: block,
      init: function init() {
        this.jsonInit(block);
      }
    });
    return {
      blocks
    };
  });
  return _loadBlocks.apply(this, arguments);
}

function patchCategoryJSONtoXML(cat) {
  var _cat$contents;

  (_cat$contents = cat.contents) === null || _cat$contents === void 0 ? void 0 : _cat$contents.filter(node => node.kind === "block").map(node => node).filter(block => {
    var exists = (blockly_default()).Blocks[block.type];
    if (!exists && flags/* default.diagnostics */.Z.diagnostics) console.warn("block type '" + block.type + "' not found, consider refreshing page...");
    return !!block.values && exists;
  }) // avoid broken blocks
  .forEach(block => {
    // yup, this suck but we have to go through it
    block.blockxml = "<block type=\"" + block.type + "\">" + Object.keys(block.values).map(name => {
      var {
        type
      } = block.values[name];
      var shadow = type !== "variables_get";
      return "<value name=\"" + name + "\"><" + (shadow ? "shadow" : "field") + " type=\"" + type + "\" /></value>";
    }).join("\n") + "</block>";
    delete block.type;
  });
  return cat;
}

function useToolbox(dsls, source) {
  var liveServices = (0,useServices/* default */.Z)({
    specification: true
  });
  var theme = (0,useTheme/* default */.Z)();
  var blocks = useAsyncMemo( /*#__PURE__*/(0,asyncToGenerator/* default */.Z)(function* () {
    var r = yield loadBlocks(dsls, theme);
    if (flags/* default.diagnostics */.Z.diagnostics) console.debug("blocks", r);
    return r;
  }), [theme, dsls]);
  var toolboxConfiguration = (0,react.useMemo)(() => {
    if (!blocks) return undefined;
    var dslsCategories = (0,utils/* arrayConcatMany */.ue)(dsls.map(dsl => {
      var _dsl$createCategory;

      return dsl === null || dsl === void 0 ? void 0 : (_dsl$createCategory = dsl.createCategory) === null || _dsl$createCategory === void 0 ? void 0 : _dsl$createCategory.call(dsl, {
        theme,
        source,
        liveServices
      });
    })).filter(cat => !!cat).sort((l, r) => -((l.order || 0) - (r.order || 0)));
    var contents = dslsCategories.map(node => node.kind === "category" ? patchCategoryJSONtoXML(node) : node); // remove trailing separators

    while (((_contents$ = contents[0]) === null || _contents$ === void 0 ? void 0 : _contents$.kind) === "sep") {
      var _contents$;

      contents.shift();
    }

    while (((_contents = contents[contents.length - 1]) === null || _contents === void 0 ? void 0 : _contents.kind) === "sep") {
      var _contents;

      contents.pop();
    } //


    return {
      kind: "categoryToolbox",
      contents
    };
  }, [blocks, theme, dsls, source, (liveServices || []).map(srv => srv.id).join(",")]);
  return toolboxConfiguration;
} // do not use block context

function useToolboxButtons(workspace, toolboxConfiguration) {
  // track workspace changes and update callbacks
  (0,react.useEffect)(() => {
    if (!workspace) return; // collect buttons

    var buttons = [];
    (0,toolbox/* visitToolbox */.j2)(toolboxConfiguration, {
      visitButton: btn => buttons.push(btn)
    }); // register buttons

    buttons.forEach(button => workspace.registerButtonCallback(button.callbackKey, () => button.callback(workspace))); // cleanup

    return () => buttons.forEach(button => workspace.removeButtonCallback(button.callbackKey));
  }, [workspace, toolboxConfiguration]);
}
// EXTERNAL MODULE: ./src/components/AppContext.tsx
var AppContext = __webpack_require__(84377);
// EXTERNAL MODULE: ./src/jacdac/useChange.ts
var useChange = __webpack_require__(54774);
// EXTERNAL MODULE: ./src/components/FileSystemContext.tsx + 1 modules
var FileSystemContext = __webpack_require__(37258);
// EXTERNAL MODULE: ./src/components/hooks/useWindowEvent.ts
var useWindowEvent = __webpack_require__(72144);
// EXTERNAL MODULE: ./src/components/blockly/fields/IFrameDataChooserField.ts
var IFrameDataChooserField = __webpack_require__(84152);
// EXTERNAL MODULE: ./src/components/blockly/dsl/servicesbase.ts
var servicesbase = __webpack_require__(21910);
;// CONCATENATED MODULE: ./src/components/blockly/BlockContext.tsx

























var BlockContext = /*#__PURE__*/(0,react.createContext)({
  editorId: "",
  setEditorId: () => {},
  dsls: [],
  workspace: undefined,
  workspaceXml: undefined,
  workspaceJSON: undefined,
  toolboxConfiguration: undefined,
  roleManager: undefined,
  dragging: false,
  setWarnings: () => {},
  setWorkspace: () => {},
  setWorkspaceXml: () => {}
});
BlockContext.displayName = "Block";
var DEFAULT_XML = '<xml xmlns="http://www.w3.org/1999/xhtml"></xml>';
/* harmony default export */ var blockly_BlockContext = (BlockContext); // eslint-disable-next-line react/prop-types

function BlockProvider(props) {
  var {
    storageKey,
    dsls,
    children,
    onBeforeSaveWorkspaceFile
  } = props;
  var {
    setError
  } = (0,react.useContext)(AppContext/* default */.ZP);
  var {
    fileSystem
  } = (0,react.useContext)(FileSystemContext/* default */.Z);
  var workspaceDirectory = (0,useChange/* default */.Z)(fileSystem, _ => _ === null || _ === void 0 ? void 0 : _.workingDirectory);
  var workspaceFile = (0,useChange/* default */.Z)(workspaceDirectory, _ => _ === null || _ === void 0 ? void 0 : _.file(toolbox/* WORKSPACE_FILENAME */.cR, {
    create: true
  }));
  var [storedXml, setStoredXml] = (0,useLocalStorage/* default */.Z)(storageKey, toolbox/* NEW_PROJET_XML */.Uz);
  var roleManager = useRoleManager();
  var {
    0: workspace,
    1: setWorkspace
  } = (0,react.useState)(undefined);
  var {
    0: workspaceXml,
    1: _setWorkspaceXml
  } = (0,react.useState)(storedXml);
  var {
    0: workspaceJSON,
    1: setWorkspaceJSON
  } = (0,react.useState)(undefined);
  var {
    0: warnings,
    1: _setWarnings
  } = (0,react.useState)([]);
  var {
    0: dragging,
    1: setDragging
  } = (0,react.useState)(false);
  var {
    0: editorId,
    1: setEditorId
  } = (0,react.useState)("");

  var setWorkspaceXml = xml => {
    _setWorkspaceXml(xml);

    setStoredXml(xml);
  };

  var setWarnings = (category, entries) => {
    var i = warnings.findIndex(w => w.category === category);

    _setWarnings([].concat((0,toConsumableArray/* default */.Z)(warnings.slice(0, i)), [{
      category,
      entries
    }], (0,toConsumableArray/* default */.Z)(warnings.slice(i + 1))));
  };

  var loadWorkspaceFile = file => {
    var {
      editor,
      xml
    } = file || {};
    if (editor !== editorId) throw new Error("wrong block editor (" + editor + " != " + editorId); // try loading xml into a dummy blockly workspace

    var dom = blockly.Xml.textToDom(xml || DEFAULT_XML); // all good, load in workspace

    workspace.clear();
    blockly.Xml.domToWorkspace(dom, workspace);
  };

  var toolboxConfiguration = useToolbox(dsls, workspaceJSON);

  var initializeBlockServices = block => {
    var _block$jacdacServices;

    if (block !== null && block !== void 0 && (_block$jacdacServices = block.jacdacServices) !== null && _block$jacdacServices !== void 0 && _block$jacdacServices.initialized) return;
    var services = block.jacdacServices;

    if (!services) {
      var _block$inputList;

      services = block.jacdacServices = new WorkspaceContext/* BlockServices */.LL();
      (_block$inputList = block.inputList) === null || _block$inputList === void 0 ? void 0 : _block$inputList.forEach(i => {
        var _i$fieldRow;

        return (_i$fieldRow = i.fieldRow) === null || _i$fieldRow === void 0 ? void 0 : _i$fieldRow.forEach(f => {
          var _notifyServicesChange, _ref;

          return (_notifyServicesChange = (_ref = f).notifyServicesChanged) === null || _notifyServicesChange === void 0 ? void 0 : _notifyServicesChange.call(_ref);
        });
      });
    }

    services.initialized = true;
    registerDataSolver(block);
  };

  var handleBlockChange = blockId => {
    var block = workspace.getBlockById(blockId);
    var services = block === null || block === void 0 ? void 0 : block.jacdacServices;

    if (block && !block.isEnabled()) {
      services === null || services === void 0 ? void 0 : services.clearData();
    } else services === null || services === void 0 ? void 0 : services.emit(constants/* CHANGE */.Ver);
  };

  var handleWorkspaceEvent = event => {
    var {
      type,
      workspaceId
    } = event;
    if (workspaceId !== workspace.id) return; //console.log(`blockly: ${type}`, event)

    if (type === blockly.Events.BLOCK_DRAG) {
      var dragEvent = event;
      setDragging(!!dragEvent.isStart);
    } else if (type === blockly.Events.FINISHED_LOADING) {
      workspace.getAllBlocks(false).forEach(b => initializeBlockServices(b));
    } else if (type === blockly.Events.BLOCK_CREATE) {
      var bev = event;
      var block = workspace.getBlockById(bev.blockId);
      initializeBlockServices(block);
    } else if (type === blockly.Events.BLOCK_MOVE) {
      var cev = event; // eslint-disable-next-line @typescript-eslint/no-explicit-any

      var parentId = cev.newParentId;
      if (parentId) handleBlockChange(parentId);
    } else if (type === blockly.Events.BLOCK_CHANGE) {
      var _cev = event;
      handleBlockChange(_cev.blockId);
    }
  }; // mounting dsts


  (0,react.useEffect)(() => {
    var unmounnts = dsls.map(dsl => {
      var _dsl$mount;

      return (_dsl$mount = dsl.mount) === null || _dsl$mount === void 0 ? void 0 : _dsl$mount.call(dsl, workspace);
    }).filter(u => !!u);
    return () => {
      unmounnts.forEach(u => u());
    };
  }, [workspace]); // plugins

  useBlocklyPlugins(workspace);
  useBlocklyEvents(workspace);
  useToolboxButtons(workspace, toolboxConfiguration); // role manager

  (0,react.useEffect)(() => {
    var services = (0,WorkspaceContext/* resolveWorkspaceServices */.O7)(workspace);
    if (services) services.roleManager = roleManager;
  }, [workspace, roleManager]);
  (0,react.useEffect)(() => {
    // eslint-disable-next-line @typescript-eslint/no-explicit-any
    var wws = workspace;

    if (wws && !wws.jacdacServices) {
      wws.jacdacServices = new WorkspaceContext/* WorkspaceServices */.yq();
      wws.jacdacServices.roleManager = roleManager;
    }
  }, [workspace]);
  (0,react.useEffect)(() => {
    var services = (0,WorkspaceContext/* resolveWorkspaceServices */.O7)(workspace);
    if (services) services.workingDirectory = workspaceDirectory;
  }, [workspace, workspaceDirectory]);
  (0,react.useEffect)(() => {
    if (!workspace || dragging) return;
    var newWorkspaceJSON = (0,jsongenerator/* workspaceToJSON */.v)(workspace, dsls);
    setWorkspaceJSON(newWorkspaceJSON);
    var newWarnings = collectWarnings(newWorkspaceJSON);
    setWarnings(toolbox/* JSON_WARNINGS_CATEGORY */.FD, newWarnings);
  }, [dsls, workspace, dragging, workspaceXml]);
  (0,useEffectAsync/* default */.Z)( /*#__PURE__*/function () {
    var _ref2 = (0,asyncToGenerator/* default */.Z)(function* (mounted) {
      if (!workspaceFile) return;

      try {
        var text = yield workspaceFile.textAsync();
        if (!mounted()) return;
        var json = JSON.parse(text);
        loadWorkspaceFile(json);
      } catch (e) {
        if (mounted()) setError(e);
        if (fileSystem) fileSystem.workingDirectory = undefined;
      }
    });

    return function (_x) {
      return _ref2.apply(this, arguments);
    };
  }(), [workspaceFile]);
  (0,useEffectAsync/* default */.Z)( /*#__PURE__*/(0,asyncToGenerator/* default */.Z)(function* () {
    var file = {
      editor: editorId,
      xml: workspaceXml,
      json: workspaceJSON
    };
    dsls.forEach(dsl => {
      var _dsl$onBeforeSaveWork;

      return (_dsl$onBeforeSaveWork = dsl.onBeforeSaveWorkspaceFile) === null || _dsl$onBeforeSaveWork === void 0 ? void 0 : _dsl$onBeforeSaveWork.call(dsl, file);
    });
    onBeforeSaveWorkspaceFile === null || onBeforeSaveWorkspaceFile === void 0 ? void 0 : onBeforeSaveWorkspaceFile(file);
    dsls.forEach(dsl => {
      var _dsl$onSave;

      return (_dsl$onSave = dsl.onSave) === null || _dsl$onSave === void 0 ? void 0 : _dsl$onSave.call(dsl, file);
    });

    if (workspaceFile) {
      var fileContent = JSON.stringify(file);
      workspaceFile === null || workspaceFile === void 0 ? void 0 : workspaceFile.write(fileContent);
    }
  }), [editorId, workspaceFile, workspaceXml, workspaceJSON]);
  (0,react.useEffect)(() => {
    var services = (0,WorkspaceContext/* resolveWorkspaceServices */.O7)(workspace);
    if (services) services.workspaceJSON = workspaceJSON;
  }, [workspace, workspaceJSON]); // apply errors

  (0,react.useEffect)(() => {
    if (!workspace) return;
    var allErrors = (0,utils/* toMap */.qL)((0,utils/* arrayConcatMany */.ue)(warnings.map(w => w.entries).filter(entries => !!(entries !== null && entries !== void 0 && entries.length))), e => e.sourceId || "", e => e.message);
    workspace.getAllBlocks(false).forEach(b => b.setWarningText(allErrors[b.id] || (0,WorkspaceContext/* resolveBlockWarnings */.$$)(b)));
  }, [workspace, warnings]); // register block creation

  (0,react.useEffect)(() => {
    var handlers = [handleWorkspaceEvent].concat((0,toConsumableArray/* default */.Z)(dsls.map(dsl => {
      var _dsl$createWorkspaceC;

      return (_dsl$createWorkspaceC = dsl.createWorkspaceChangeListener) === null || _dsl$createWorkspaceC === void 0 ? void 0 : _dsl$createWorkspaceC.call(dsl, workspace);
    }))).filter(c => !!c);
    handlers.forEach(handler => workspace === null || workspace === void 0 ? void 0 : workspace.addChangeListener(handler));
    return () => handlers === null || handlers === void 0 ? void 0 : handlers.forEach(handler => workspace === null || workspace === void 0 ? void 0 : workspace.removeChangeListener(handler));
  }, [workspace, dsls]); // don't refresh registers while dragging

  (0,react.useEffect)(() => {
    providerbus/* default.backgroundRefreshRegisters */.Z.backgroundRefreshRegisters = !dragging;
  }, [dragging]); // handle services

  (0,react.useEffect)(() => providerbus/* default.subscribe */.Z.subscribe([constants/* DEVICE_ANNOUNCE */.Hob, constants/* DEVICE_DISCONNECT */.O55], () => {
    if (!workspace) return;
    var services = providerbus/* default.services */.Z.services({
      ignoreInfrastructure: true
    });
    services.forEach(service => {
      var name = (0,servicesbase/* toServiceName */.ZS)(service);
      var type = (0,servicesbase/* toServiceType */.Fd)(service);
      workspace.createVariable(name, type, service.id); // TODO: remove unused variables?
    });
  }), [providerbus/* default */.Z, workspace]); // load message from parent

  (0,useWindowEvent/* default */.Z)("message", msg => {
    var {
      data
    } = msg;
    var {
      type,
      action
    } = data;

    if (type === "dsl") {
      switch (action) {
        case "load":
          console.debug("dsl load", data);

          try {
            loadWorkspaceFile(data);
          } catch (e) {
            console.error(e);
          }

          break;

        case "options":
          {
            var options = data.options;
            console.debug("dsl: received options", options);
            Object.entries(options || {}).forEach(_ref4 => {
              var [key, value] = _ref4;
              return IFrameDataChooserField/* AllOptions */.e[key] = value;
            });
          }
      }
    }
  }, false, []);
  return /*#__PURE__*/react.createElement(BlockContext.Provider, {
    value: {
      editorId,
      setEditorId,
      dsls,
      workspace,
      workspaceXml,
      workspaceJSON,
      toolboxConfiguration,
      roleManager,
      dragging,
      setWarnings,
      setWorkspace,
      setWorkspaceXml
    }
  }, children);
}

/***/ }),

/***/ 9370:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ BlockDiagnostics; }
/* harmony export */ });
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(4320);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(49308);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(67294);
/* harmony import */ var _CodeBlock__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(9433);
/* harmony import */ var _BlockContext__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(26212);




function BlockDiagnostics() {
  var {
    workspaceXml,
    workspaceJSON
  } = (0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(_BlockContext__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .C);
  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .ZP, {
    item: true,
    xs: 12
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z, {
    variant: "subtitle1"
  }, "Blockly JSON"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_CodeBlock__WEBPACK_IMPORTED_MODULE_1__["default"], {
    className: "json",
    downloadName: "test.json",
    downloadText: JSON.stringify(workspaceJSON, null, 2)
  }, JSON.stringify(workspaceJSON, null, 2))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .ZP, {
    item: true,
    xs: 12
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z, {
    variant: "subtitle1"
  }, "Blockly XML"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_CodeBlock__WEBPACK_IMPORTED_MODULE_1__["default"], {
    className: "xml"
  }, workspaceXml)));
}

/***/ }),

/***/ 39067:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";

// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  "Z": function() { return /* binding */ BlockEditor; }
});

// EXTERNAL MODULE: ./node_modules/react/index.js
var react = __webpack_require__(67294);
// EXTERNAL MODULE: ./node_modules/@mui/material/styles/styled.js + 2 modules
var styled = __webpack_require__(98348);
// EXTERNAL MODULE: ./node_modules/react-blockly/dist/index.js
var dist = __webpack_require__(691);
// EXTERNAL MODULE: ./node_modules/blockly/core-browser.js
var core_browser = __webpack_require__(90888);
var core_browser_default = /*#__PURE__*/__webpack_require__.n(core_browser);
;// CONCATENATED MODULE: ./node_modules/@blockly/theme-modern/src/index.js
/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */

/**
 * @fileoverview Modern theme.
 */

/* harmony default export */ var src = (core_browser_default().Theme.defineTheme('modern', {
  'base': (core_browser_default()).Themes.Classic,
  'blockStyles': {
    'colour_blocks': {
      'colourPrimary': '#a5745b',
      'colourSecondary': '#dbc7bd',
      'colourTertiary': '#845d49'
    },
    'list_blocks': {
      'colourPrimary': '#745ba5',
      'colourSecondary': '#c7bddb',
      'colourTertiary': '#5d4984'
    },
    'logic_blocks': {
      'colourPrimary': '#5b80a5',
      'colourSecondary': '#bdccdb',
      'colourTertiary': '#496684'
    },
    'loop_blocks': {
      'colourPrimary': '#5ba55b',
      'colourSecondary': '#bddbbd',
      'colourTertiary': '#498449'
    },
    'math_blocks': {
      'colourPrimary': '#5b67a5',
      'colourSecondary': '#bdc2db',
      'colourTertiary': '#495284'
    },
    'procedure_blocks': {
      'colourPrimary': '#995ba5',
      'colourSecondary': '#d6bddb',
      'colourTertiary': '#7a4984'
    },
    'text_blocks': {
      'colourPrimary': '#5ba58c',
      'colourSecondary': '#bddbd1',
      'colourTertiary': '#498470'
    },
    'variable_blocks': {
      'colourPrimary': '#a55b99',
      'colourSecondary': '#dbbdd6',
      'colourTertiary': '#84497a'
    },
    'variable_dynamic_blocks': {
      'colourPrimary': '#a55b99',
      'colourSecondary': '#dbbdd6',
      'colourTertiary': '#84497a'
    },
    'hat_blocks': {
      'colourPrimary': '#a55b99',
      'colourSecondary': '#dbbdd6',
      'colourTertiary': '#84497a',
      'hat': 'cap'
    }
  },
  'categoryStyles': {
    'colour_category': {
      'colour': '#a5745b'
    },
    'list_category': {
      'colour': '#745ba5'
    },
    'logic_category': {
      'colour': '#5b80a5'
    },
    'loop_category': {
      'colour': '#5ba55b'
    },
    'math_category': {
      'colour': '#5b67a5'
    },
    'procedure_category': {
      'colour': '#995ba5'
    },
    'text_category': {
      'colour': '#5ba58c'
    },
    'variable_category': {
      'colour': '#a55b99'
    },
    'variable_dynamic_category': {
      'colour': '#a55b99'
    }
  },
  'componentStyles': {},
  'fontStyle': {},
  'startHats': null
}));
;// CONCATENATED MODULE: ./node_modules/@blockly/theme-dark/src/index.js
/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */

/**
 * @fileoverview Dark theme.
 */
 // Temporarily required to ensure there's no conflict with
// Blockly.Themes.Dark

core_browser_default().registry.unregister('theme', 'dark');
/**
 * Dark theme.
 */

/* harmony default export */ var theme_dark_src = (core_browser_default().Theme.defineTheme('dark', {
  'base': (core_browser_default()).Themes.Classic,
  'componentStyles': {
    'workspaceBackgroundColour': '#1e1e1e',
    'toolboxBackgroundColour': 'blackBackground',
    'toolboxForegroundColour': '#fff',
    'flyoutBackgroundColour': '#252526',
    'flyoutForegroundColour': '#ccc',
    'flyoutOpacity': 1,
    'scrollbarColour': '#797979',
    'insertionMarkerColour': '#fff',
    'insertionMarkerOpacity': 0.3,
    'scrollbarOpacity': 0.4,
    'cursorColour': '#d0d0d0',
    'blackBackground': '#333'
  }
}));
// EXTERNAL MODULE: ./node_modules/@mui/material/Dialog/Dialog.js + 1 modules
var Dialog = __webpack_require__(61359);
// EXTERNAL MODULE: ./node_modules/@mui/material/DialogContent/DialogContent.js + 1 modules
var DialogContent = __webpack_require__(86763);
// EXTERNAL MODULE: ./node_modules/@mui/material/DialogContentText/DialogContentText.js + 1 modules
var DialogContentText = __webpack_require__(90460);
// EXTERNAL MODULE: ./node_modules/@mui/material/TextField/TextField.js + 1 modules
var TextField = __webpack_require__(65970);
// EXTERNAL MODULE: ./node_modules/@mui/material/DialogActions/DialogActions.js + 1 modules
var DialogActions = __webpack_require__(18599);
// EXTERNAL MODULE: ./node_modules/blockly/index.js
var blockly = __webpack_require__(74640);
var blockly_default = /*#__PURE__*/__webpack_require__.n(blockly);
// EXTERNAL MODULE: ./node_modules/gatsby-theme-material-ui/index.js
var gatsby_theme_material_ui = __webpack_require__(36176);
// EXTERNAL MODULE: ./node_modules/react-use-id-hook/dist/react-use-id-hook.esm.js
var react_use_id_hook_esm = __webpack_require__(19640);
;// CONCATENATED MODULE: ./src/components/blockly/BlocklyModalDialogs.tsx





function BlocklyModalDialogs() {
  var {
    0: dialogType,
    1: setDialogType
  } = (0,react.useState)();
  var {
    0: message,
    1: setMessage
  } = (0,react.useState)("");
  var {
    0: value,
    1: setValue
  } = (0,react.useState)("");
  var valueId = (0,react_use_id_hook_esm/* useId */.Me)(); // eslint-disable-next-line @typescript-eslint/no-explicit-any

  var callback = (0,react.useRef)();
  var showDialog = !!dialogType;
  (0,react.useEffect)(() => {
    // store older
    var previous = {
      alert: (blockly_default()).alert,
      confirm: (blockly_default()).confirm,
      prompt: (blockly_default()).prompt
    }; // replace

    (blockly_default()).alert = (message, cb) => {
      setMessage(message);
      callback.current = cb;
      setDialogType("alert");
    };

    (blockly_default()).confirm = (message, cb) => {
      setMessage(message);
      callback.current = cb;
      setDialogType("confirm");
    };

    (blockly_default()).prompt = (message, defaultValue, cb) => {
      setMessage(message);
      setValue(defaultValue);
      callback.current = cb;
      setDialogType("prompt");
    }; // cleanup


    return () => {
      (blockly_default()).alert = previous.alert;
      (blockly_default()).confirm = previous.confirm;
      (blockly_default()).prompt = previous.prompt;
    };
  }, []);

  var handleCloseConfirm = () => setDialogType(undefined);

  var handleCancel = () => {
    var _callback$current;

    (_callback$current = callback.current) === null || _callback$current === void 0 ? void 0 : _callback$current.call(callback, undefined);
    setDialogType(undefined);
  };

  var handleOk = () => {
    var _callback$current2;

    switch (dialogType) {
      case "alert":
        (_callback$current2 = callback.current) === null || _callback$current2 === void 0 ? void 0 : _callback$current2.call(callback);
        break;

      case "confirm":
        callback.current(true);
        break;

      case "prompt":
        callback.current(value);
        break;
    }

    setDialogType(undefined);
  };

  var handleValueChange = event => {
    setValue(event.target.value);
  };

  return /*#__PURE__*/react.createElement(Dialog/* default */.Z, {
    open: showDialog,
    onClose: handleCloseConfirm
  }, /*#__PURE__*/react.createElement(DialogContent/* default */.Z, null, /*#__PURE__*/react.createElement(DialogContentText/* default */.Z, null, message), dialogType === "prompt" && /*#__PURE__*/react.createElement(TextField/* default */.Z, {
    id: valueId,
    value: value,
    label: "Value",
    fullWidth: true,
    onChange: handleValueChange
  })), /*#__PURE__*/react.createElement(DialogActions/* default */.Z, null, dialogType !== "alert" && /*#__PURE__*/react.createElement(gatsby_theme_material_ui/* Button */.zx, {
    variant: "contained",
    onClick: handleCancel
  }, "Cancel"), /*#__PURE__*/react.createElement(gatsby_theme_material_ui/* Button */.zx, {
    variant: "contained",
    color: "primary",
    onClick: handleOk
  }, "Ok")));
}
// EXTERNAL MODULE: ./src/components/ui/DarkModeContext.tsx
var DarkModeContext = __webpack_require__(91350);
// EXTERNAL MODULE: ./src/components/AppContext.tsx
var AppContext = __webpack_require__(84377);
// EXTERNAL MODULE: ./node_modules/clsx/dist/clsx.m.js
var clsx_m = __webpack_require__(85505);
// EXTERNAL MODULE: ./.cache/gatsby-browser-entry.js
var gatsby_browser_entry = __webpack_require__(35313);
// EXTERNAL MODULE: ./jacdac-ts/src/jdom/flags.ts
var flags = __webpack_require__(21258);
// EXTERNAL MODULE: ./src/components/blockly/BlockContext.tsx + 16 modules
var BlockContext = __webpack_require__(26212);
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js + 5 modules
var toConsumableArray = __webpack_require__(15785);
// EXTERNAL MODULE: ./node_modules/@mui/material/styles/useTheme.js
var useTheme = __webpack_require__(66449);
// EXTERNAL MODULE: ./node_modules/react-dom/index.js
var react_dom = __webpack_require__(73935);
// EXTERNAL MODULE: ./jacdac-ts/src/jdom/utils.ts
var utils = __webpack_require__(81794);
// EXTERNAL MODULE: ./src/components/widgets/svgutils.ts
var svgutils = __webpack_require__(92526);
// EXTERNAL MODULE: ./src/components/blockly/useWorkspaceEvent.ts
var useWorkspaceEvent = __webpack_require__(34148);
;// CONCATENATED MODULE: ./src/components/blockly/BlockMinimap.tsx








var MINI_RADIUS = 16;
var MARGIN_VERTICAL_ = 20;
var MARGIN_HORIZONTAL_ = 20;
var MIN_SCALE = 0.05;
var MAX_WIDTH = 200;
var MAX_HEIGHT = 96;

function MiniBlock(props) {
  var {
    x,
    y,
    width,
    height,
    color
  } = props;
  return /*#__PURE__*/react.createElement("rect", {
    x: x,
    y: y,
    width: width,
    height: height,
    fill: color,
    rx: MINI_RADIUS,
    ry: MINI_RADIUS
  });
}

function MiniViewport(props) {
  var {
    view
  } = props;
  var {
    top,
    left,
    width,
    height
  } = view;
  var {
    palette
  } = (0,useTheme/* default */.Z)();
  var vx = left;
  var vy = top;
  return /*#__PURE__*/react.createElement("rect", {
    x: vx,
    y: vy,
    width: width,
    height: height,
    strokeWidth: MINI_RADIUS >> 1,
    stroke: palette.text.primary,
    fill: palette.grey[400],
    opacity: 0.2,
    rx: MINI_RADIUS,
    ry: MINI_RADIUS
  });
}

function BlockMiniMap(props) {
  var {
    workspace,
    onSizeUpdate
  } = props;
  var svgRef = (0,react.useRef)();
  var {
    0: metrics,
    1: setMetrics
  } = (0,react.useState)();
  var {
    0: view,
    1: setView
  } = (0,react.useState)();

  var handleMetrics = () => {
    var metricsManager = workspace.getMetricsManager();
    var view = metricsManager.getViewMetrics(true);
    var contents = metricsManager.getContentMetrics(true);
    var scroll = metricsManager.getScrollMetrics(true, view, contents);
    var tops = (0,utils/* arrayConcatMany */.ue)(workspace.getTopBlocks(false).map(top => [top].concat((0,toConsumableArray/* default */.Z)(top.childBlocks_))));
    var blocks = tops.map(b => ({
      blockId: b.id,
      rect: b.getBoundingRectangle(),
      color: b.getColour()
    }));
    setMetrics({
      scroll,
      contents,
      blocks
    });
    setView(view);
    onSizeUpdate(scroll.width, scroll.height);
  };

  var handleView = () => {
    var metricsManager = workspace.getMetricsManager();
    var view = metricsManager.getViewMetrics(true);
    setView(view);
  };

  var handleChange = (0,react.useCallback)(event => {
    var {
      type
    } = event;

    switch (type) {
      case blockly.Events.BLOCK_CREATE:
      case blockly.Events.BLOCK_DELETE:
      case blockly.Events.BLOCK_MOVE:
      case blockly.Events.BLOCK_CHANGE:
      case blockly.Events.FINISHED_LOADING:
        handleMetrics();
        break;

      case blockly.Events.VIEWPORT_CHANGE:
        handleView();
        break;
    }
  }, [workspace]);
  (0,useWorkspaceEvent/* default */.Z)(workspace, handleChange);

  var handleCenterView = event => {
    event.preventDefault();
    event.stopPropagation();
    if (event.buttons < 1) return;
    var pos = (0,svgutils/* svgPointerPoint */.PW)(svgRef.current, event); // viewHeight and viewWidth are in pixels.

    var halfViewWidth = view.width / 2;
    var halfViewHeight = view.height / 2; // Put the block in the center of the visible workspace instead.

    var scrollToCenterX = pos.x - halfViewWidth + scroll.left;
    var scrollToCenterY = pos.y - halfViewHeight + scroll.top; // Convert from workspace directions to canvas directions.
    // move to center of view

    var x = -scrollToCenterX;
    var y = -scrollToCenterY;
    workspace.scroll(x, y);
  }; // nothing to see


  if (!metrics || !view) return null;
  var {
    scroll,
    blocks
  } = metrics;
  var cleft = scroll.left;
  var ctop = scroll.top;
  var cwidth = scroll.width;
  var cheight = scroll.height;
  return /*#__PURE__*/react.createElement("svg", {
    ref: svgRef,
    viewBox: "0 0 " + cwidth + " " + cheight,
    width: cwidth,
    height: cheight
  }, /*#__PURE__*/react.createElement("g", {
    transform: "translate(" + -cleft + "," + -ctop + ")"
  }, blocks === null || blocks === void 0 ? void 0 : blocks.map(_ref => {
    var {
      blockId,
      rect,
      color
    } = _ref;
    return /*#__PURE__*/react.createElement(MiniBlock, {
      key: blockId,
      x: rect.left,
      y: rect.top,
      width: rect.right - rect.left,
      height: rect.bottom - rect.top,
      color: color
    });
  }), view && /*#__PURE__*/react.createElement(MiniViewport, {
    scroll: scroll,
    view: view
  })), /*#__PURE__*/react.createElement("rect", {
    x: 0,
    y: 0,
    width: cwidth,
    height: cheight,
    fill: "transparent",
    stroke: "#aaa",
    strokeWidth: 24,
    onPointerDown: handleCenterView,
    onPointerMove: handleCenterView
  }));
}

var MinimapPlugin = /*#__PURE__*/function () {
  function MinimapPlugin(workspace_) {
    this.id = "minimap";
    this.top_ = 0;
    this.left_ = 0;
    this.width_ = MAX_WIDTH;
    this.height_ = MAX_HEIGHT;
    this.scale_ = MIN_SCALE;
    this.workspace_ = workspace_;
    this.init();
  }

  var _proto = MinimapPlugin.prototype;

  _proto.init = function init() {
    var componentManager = this.workspace_.getComponentManager();
    componentManager.addComponent({
      component: this,
      weight: 2,
      capabilities: [blockly.ComponentManager.Capability.POSITIONABLE]
    });
    this.createDom_();
    this.workspace_.resize();
  };

  _proto.createDom_ = function createDom_() {
    this.svgGroup_ = blockly.utils.dom.createSvgElement(blockly.utils.Svg.G, {
      class: "minimap"
    });
    blockly.utils.dom.insertAfter(this.svgGroup_, this.workspace_.getBubbleCanvas());
    react_dom.render(this.render(), this.svgGroup_);
  };

  _proto.render = function render() {
    return /*#__PURE__*/react.createElement(BlockMiniMap, {
      workspace: this.workspace_,
      onSizeUpdate: this.handleSizeUpdate.bind(this)
    });
  };

  _proto.position = function position(metrics) {
    var hasVerticalScrollbars = this.workspace_.scrollbar && this.workspace_.scrollbar.canScrollHorizontally();

    if (metrics.toolboxMetrics.position === blockly.TOOLBOX_AT_LEFT || this.workspace_.horizontalLayout && !this.workspace_.RTL) {
      // Right corner placement.
      this.left_ = metrics.absoluteMetrics.left + metrics.viewMetrics.width - this.width_ - MARGIN_HORIZONTAL_;

      if (hasVerticalScrollbars && !this.workspace_.RTL) {
        this.left_ -= blockly.Scrollbar.scrollbarThickness;
      }
    } else {
      // Left corner placement.
      this.left_ = MARGIN_HORIZONTAL_;

      if (hasVerticalScrollbars && this.workspace_.RTL) {
        this.left_ += blockly.Scrollbar.scrollbarThickness;
      }
    } // Upper corner placement


    this.top_ = metrics.absoluteMetrics.top + MARGIN_VERTICAL_;
    this.positionSvgGroup();
  };

  _proto.positionSvgGroup = function positionSvgGroup() {
    this.svgGroup_.setAttribute("transform", "translate(" + this.left_ + "," + this.top_ + ") scale(" + this.scale_ + ")");
  };

  _proto.getBoundingRectangle = function getBoundingRectangle() {
    return new blockly.utils.Rect(this.top_, this.top_ + this.height_, this.left_, this.left_ + this.width_);
  };

  _proto.handleSizeUpdate = function handleSizeUpdate(width, height) {
    if (width !== this.width_ || height !== this.height_) {
      this.scale_ = Math.min(MIN_SCALE, Math.min(MAX_HEIGHT / height, MAX_WIDTH / width));
      var dw = width * this.scale_ - this.width_;
      this.width_ = width * this.scale_;
      this.height_ = height * this.scale_;
      this.left_ -= dw;
      this.positionSvgGroup();
    }
  };

  return MinimapPlugin;
}();

function useBlockMinimap(workspace) {
  (0,react.useEffect)(() => {
    if (workspace) {
      new MinimapPlugin(workspace);
    }
  }, [workspace]);
}
// EXTERNAL MODULE: ./node_modules/bowser/es5.js
var es5 = __webpack_require__(30672);
// EXTERNAL MODULE: ./src/components/ui/Alert.tsx
var Alert = __webpack_require__(95453);
// EXTERNAL MODULE: ./node_modules/@mui/material/AlertTitle/AlertTitle.js + 1 modules
var AlertTitle = __webpack_require__(89132);
;// CONCATENATED MODULE: ./src/components/ui/BrowserCompatibilityAlert.tsx




function BrowserCompatibilityAlert(props) {
  var {
    filter,
    label
  } = props;
  var compatible = (0,react.useMemo)(() => {
    if (typeof window !== undefined) {
      var browser = (0,es5.getParser)(window.navigator.userAgent);
      return browser.satisfies(filter);
    }

    return true; // SSR
  }, [JSON.stringify(filter)]);
  if (compatible) return null;
  return /*#__PURE__*/react.createElement(Alert/* default */.Z, {
    severity: "warning"
  }, /*#__PURE__*/react.createElement(AlertTitle/* default */.Z, null, "Browser not compatible."), label);
}
// EXTERNAL MODULE: ./src/jacdac/providerbus.ts + 19 modules
var providerbus = __webpack_require__(24725);
;// CONCATENATED MODULE: ./src/components/blockly/BlockEditor.tsx















var PREFIX = "BlockEditor";
var classes = {
  editor: PREFIX + "-editor"
};
var Root = (0,styled/* default */.ZP)("div")(_ref => {
  var {
    theme
  } = _ref;
  return {
    ["& ." + classes.editor]: {
      height: "calc(100vh - " + (providerbus/* UIFlags.hosted */.A.hosted ? 3.5 : flags/* default.diagnostics */.Z.diagnostics ? 15 : 10) + "rem)",
      "& .blocklyTreeLabel": {
        fontFamily: theme.typography.fontFamily
      },
      "& .blocklyText": {
        fontWeight: "normal !important",
        fontFamily: theme.typography.fontFamily + " !important"
      },
      "& .blocklyTreeIconOpen, & .blocklyTreeIconClosed": {
        opacity: 0.5
      },
      "& .blocklyFieldButton.blocklyEditableText": {
        cursor: "pointer"
      },
      "& .blocklyFieldButton.blocklyEditableText > text": {
        fill: "#ffffff"
      },
      "& .blocklyFieldButton.blocklyEditableText > .blocklyFieldRect": {
        fill: "transparent !important"
      }
    }
  };
});

function SuspendedBlockEditor(props) {
  var {
    editorId,
    className
  } = props;
  var {
    toolboxConfiguration,
    workspaceXml,
    setWorkspace,
    setWorkspaceXml,
    setEditorId
  } = (0,react.useContext)(BlockContext/* default */.C);
  var {
    darkMode
  } = (0,react.useContext)(DarkModeContext/* default */.Z);
  var {
    setError
  } = (0,react.useContext)(AppContext/* default */.ZP);
  var theme = darkMode === "dark" ? theme_dark_src : src; // setup editor id in context

  (0,react.useEffect)(() => {
    setEditorId(editorId);
    return () => setEditorId("");
  }, [editorId]); // ReactBlockly
  // eslint-disable-next-line @typescript-eslint/no-explicit-any

  var blocklyRef = (0,react.useRef)(null);
  var {
    workspace,
    xml
  } = (0,dist/* useBlocklyWorkspace */.JP)({
    ref: blocklyRef,
    toolboxConfiguration,
    workspaceConfiguration: {
      collapse: false,
      disable: false,
      comments: true,
      css: true,
      trashcan: false,
      sounds: false,
      renderer: "zelos",
      theme,
      oneBasedIndex: false,
      move: {
        scrollbars: {
          vertical: true,
          horizontal: true
        }
      },
      media: (0,gatsby_browser_entry.withPrefix)("blockly/media/"),
      zoom: {
        controls: true,
        wheel: false,
        startScale: 1.0,
        maxScale: 3,
        minScale: 0.08,
        scaleSpeed: 1.1,
        pinch: true
      }
    },
    initialXml: workspaceXml,
    onImportXmlError: () => {
      console.error("error loading blocks");
      setError("Error loading blocks...");
    }
  }); // store ref

  (0,react.useEffect)(() => setWorkspace(workspace), [workspace]);
  (0,react.useEffect)(() => setWorkspaceXml(xml), [xml]); // resize blockly

  (0,react.useEffect)(() => {
    if (typeof ResizeObserver !== "undefined") {
      var observer = new ResizeObserver(() => workspace === null || workspace === void 0 ? void 0 : workspace.resize());
      observer.observe(blocklyRef.current);
      return () => observer.disconnect();
    }
  }, [workspace, blocklyRef.current]);
  useBlockMinimap(workspace);
  return /*#__PURE__*/react.createElement(Root, null, /*#__PURE__*/react.createElement(BrowserCompatibilityAlert, {
    filter: {
      chrome: "> 90",
      edge: "> 90",
      firefox: "> 90"
    },
    label: "Please use Microsoft Edge 90+ or Google Chrome 90+ for this page."
  }), /*#__PURE__*/react.createElement("div", {
    className: (0,clsx_m["default"])(classes.editor, className),
    ref: blocklyRef
  }), /*#__PURE__*/react.createElement(BlocklyModalDialogs, null));
}

function BlockEditor(props) {
  var {
    toolboxConfiguration
  } = (0,react.useContext)(BlockContext/* default */.C);
  if (!toolboxConfiguration) return null;
  return /*#__PURE__*/react.createElement(SuspendedBlockEditor, props);
}

/***/ }),

/***/ 57611:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "w": function() { return /* binding */ blockToVisualizationSpec; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(4942);
/* harmony import */ var _fields_chart_ScatterPlotField__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(88533);
/* harmony import */ var _toolbox__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(16582);
/* harmony import */ var _fields_DataColumnChooserField__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(44393);
/* harmony import */ var _fields_chart_LinePlotField__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(23030);
/* harmony import */ var _fields_chart_BarField__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(95702);
/* harmony import */ var _fields_chart_HistogramField__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(76295);
/* harmony import */ var _fields_DataTableField__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(54741);
/* harmony import */ var _palette__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(74602);
/* harmony import */ var _fields_chart_BoxPlotField__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(62953);
/* harmony import */ var _fields_chart_VegaChartField__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(61562);
/* harmony import */ var _fields_tidy__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(47554);
/* harmony import */ var _fields_JSONSettingsField__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(68494);
/* harmony import */ var _fields_chart_HeatMapField__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(49211);


function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }














var SCATTERPLOT_BLOCK = "chart_scatterplot";
var LINEPLOT_BLOCK = "chart_lineplot";
var HEATMAP_BLOCK = "chart_heatmap";
var BARCHART_BLOCK = "chart_bar";
var HISTOGRAM_BLOCK = "chart_histogram";
var BOX_PLOT_BLOCK = "chart_box_plot";
var CHART_SHOW_TABLE_BLOCK = "chart_show_table";
var VEGA_LAYER_BLOCK = "vega_layer";
var VEGA_ENCODING_BLOCK = "vega_encoding";
var VEGA_STATEMENT_TYPE = "vegaStatementType";
var chartSettingsSchema = {
  type: "object",
  properties: {
    title: {
      type: "string",
      title: "Chart title"
    }
  }
};
var axisSchema = {
  type: "object",
  properties: {
    title: {
      type: "string",
      title: "Title"
    }
  }
};
var scaleSchema = {
  type: "object",
  properties: {
    domainMin: {
      type: "number",
      title: "minimum",
      description: "Sets the minimum value in the scale domain"
    },
    domainMax: {
      type: "number",
      title: "maximum",
      description: "Sets the maximum value in the scale domain"
    }
  }
};
var encodingSettingsSchema = {
  type: "object",
  properties: {
    axis: axisSchema
  }
};
var encodingNumberSettingsSchema = {
  type: "object",
  properties: {
    scale: scaleSchema,
    axis: axisSchema
  }
};
var char2DSettingsSchema = {
  type: "object",
  properties: {
    title: {
      type: "string",
      title: "Chart title"
    },
    encoding: {
      type: "object",
      properties: {
        x: _objectSpread({
          title: "X"
        }, encodingNumberSettingsSchema),
        y: _objectSpread({
          title: "Y"
        }, encodingNumberSettingsSchema)
      }
    }
  }
};
var charMapSettingsSchema = {
  type: "object",
  properties: {
    title: {
      type: "string",
      title: "Chart title"
    },
    encoding: {
      index: _objectSpread({
        title: "Index"
      }, encodingSettingsSchema),
      value: _objectSpread({
        title: "Value"
      }, encodingNumberSettingsSchema)
    }
  }
};
var colour = (0,_palette__WEBPACK_IMPORTED_MODULE_13__/* .paletteColorByIndex */ .W)(4);
var chartDsl = {
  id: "chart",
  createBlocks: () => [{
    kind: "block",
    type: CHART_SHOW_TABLE_BLOCK,
    tooltip: "Displays the block data as a table",
    message0: "show table %1 %2 %3 %4 %5 %6",
    args0: [{
      type: _fields_DataColumnChooserField__WEBPACK_IMPORTED_MODULE_3__/* ["default"].KEY */ .Z.KEY,
      name: "column0"
    }, {
      type: _fields_DataColumnChooserField__WEBPACK_IMPORTED_MODULE_3__/* ["default"].KEY */ .Z.KEY,
      name: "column1"
    }, {
      type: _fields_DataColumnChooserField__WEBPACK_IMPORTED_MODULE_3__/* ["default"].KEY */ .Z.KEY,
      name: "column2"
    }, {
      type: _fields_DataColumnChooserField__WEBPACK_IMPORTED_MODULE_3__/* ["default"].KEY */ .Z.KEY,
      name: "column3"
    }, {
      type: "input_dummy"
    }, {
      type: _fields_DataTableField__WEBPACK_IMPORTED_MODULE_7__/* ["default"].KEY */ .Z.KEY,
      name: "table",
      selectColumns: true
    }],
    previousStatement: _toolbox__WEBPACK_IMPORTED_MODULE_2__/* .DATA_SCIENCE_STATEMENT_TYPE */ .zN,
    nextStatement: _toolbox__WEBPACK_IMPORTED_MODULE_2__/* .DATA_SCIENCE_STATEMENT_TYPE */ .zN,
    colour,
    template: "meta",
    inputsInline: false,
    dataPreviewField: false,
    transformData: _toolbox__WEBPACK_IMPORTED_MODULE_2__/* .identityTransformData */ .FW
  }, {
    kind: "block",
    type: SCATTERPLOT_BLOCK,
    tooltip: "Renders the block data in a scatter plot",
    message0: "scatterplot of x %1 y %2 size %3 group %4 %5 %6 %7",
    args0: [{
      type: _fields_DataColumnChooserField__WEBPACK_IMPORTED_MODULE_3__/* ["default"].KEY */ .Z.KEY,
      name: "x",
      dataType: "number"
    }, {
      type: _fields_DataColumnChooserField__WEBPACK_IMPORTED_MODULE_3__/* ["default"].KEY */ .Z.KEY,
      name: "y",
      dataType: "number"
    }, {
      type: _fields_DataColumnChooserField__WEBPACK_IMPORTED_MODULE_3__/* ["default"].KEY */ .Z.KEY,
      name: "size",
      dataType: "number"
    }, {
      type: _fields_DataColumnChooserField__WEBPACK_IMPORTED_MODULE_3__/* ["default"].KEY */ .Z.KEY,
      name: "group"
    }, {
      type: _fields_JSONSettingsField__WEBPACK_IMPORTED_MODULE_11__/* ["default"].KEY */ .Z.KEY,
      name: "settings",
      schema: char2DSettingsSchema
    }, {
      type: "input_dummy"
    }, {
      type: _fields_chart_ScatterPlotField__WEBPACK_IMPORTED_MODULE_1__/* ["default"].KEY */ .Z.KEY,
      name: "plot"
    }],
    previousStatement: _toolbox__WEBPACK_IMPORTED_MODULE_2__/* .DATA_SCIENCE_STATEMENT_TYPE */ .zN,
    nextStatement: _toolbox__WEBPACK_IMPORTED_MODULE_2__/* .DATA_SCIENCE_STATEMENT_TYPE */ .zN,
    colour,
    template: "meta",
    inputsInline: false,
    dataPreviewField: false,
    transformData: _toolbox__WEBPACK_IMPORTED_MODULE_2__/* .identityTransformData */ .FW
  }, {
    kind: "block",
    type: BARCHART_BLOCK,
    tooltip: "Renders the block data in a bar chart",
    message0: "bar chart of index %1 value %2 %3 %4 %5",
    args0: [{
      type: _fields_DataColumnChooserField__WEBPACK_IMPORTED_MODULE_3__/* ["default"].KEY */ .Z.KEY,
      name: "index"
    }, {
      type: _fields_DataColumnChooserField__WEBPACK_IMPORTED_MODULE_3__/* ["default"].KEY */ .Z.KEY,
      name: "value",
      dataType: "number"
    }, {
      type: _fields_JSONSettingsField__WEBPACK_IMPORTED_MODULE_11__/* ["default"].KEY */ .Z.KEY,
      name: "settings",
      schema: charMapSettingsSchema
    }, {
      type: "input_dummy"
    }, {
      type: _fields_chart_BarField__WEBPACK_IMPORTED_MODULE_5__/* ["default"].KEY */ .Z.KEY,
      name: "plot"
    }],
    previousStatement: _toolbox__WEBPACK_IMPORTED_MODULE_2__/* .DATA_SCIENCE_STATEMENT_TYPE */ .zN,
    nextStatement: _toolbox__WEBPACK_IMPORTED_MODULE_2__/* .DATA_SCIENCE_STATEMENT_TYPE */ .zN,
    colour,
    template: "meta",
    inputsInline: false,
    dataPreviewField: false,
    transformData: _toolbox__WEBPACK_IMPORTED_MODULE_2__/* .identityTransformData */ .FW
  }, {
    kind: "block",
    type: LINEPLOT_BLOCK,
    tooltip: "Renders the block data in a line chart",
    message0: "line chart of x %1 y %2 %3 %4 group %5 %6 %7 %8",
    args0: [{
      type: _fields_DataColumnChooserField__WEBPACK_IMPORTED_MODULE_3__/* ["default"].KEY */ .Z.KEY,
      name: "x",
      dataType: "number"
    }, {
      type: _fields_DataColumnChooserField__WEBPACK_IMPORTED_MODULE_3__/* ["default"].KEY */ .Z.KEY,
      name: "y",
      dataType: "number"
    }, {
      type: _fields_DataColumnChooserField__WEBPACK_IMPORTED_MODULE_3__/* ["default"].KEY */ .Z.KEY,
      name: "y2",
      dataType: "number"
    }, {
      type: _fields_DataColumnChooserField__WEBPACK_IMPORTED_MODULE_3__/* ["default"].KEY */ .Z.KEY,
      name: "y3",
      dataType: "number"
    }, {
      type: _fields_DataColumnChooserField__WEBPACK_IMPORTED_MODULE_3__/* ["default"].KEY */ .Z.KEY,
      name: "group"
    }, {
      type: _fields_JSONSettingsField__WEBPACK_IMPORTED_MODULE_11__/* ["default"].KEY */ .Z.KEY,
      name: "settings",
      schema: char2DSettingsSchema
    }, {
      type: "input_dummy"
    }, {
      type: _fields_chart_LinePlotField__WEBPACK_IMPORTED_MODULE_4__/* ["default"].KEY */ .Z.KEY,
      name: "plot"
    }],
    previousStatement: _toolbox__WEBPACK_IMPORTED_MODULE_2__/* .DATA_SCIENCE_STATEMENT_TYPE */ .zN,
    nextStatement: _toolbox__WEBPACK_IMPORTED_MODULE_2__/* .DATA_SCIENCE_STATEMENT_TYPE */ .zN,
    colour,
    template: "meta",
    inputsInline: false,
    dataPreviewField: false,
    transformData: _toolbox__WEBPACK_IMPORTED_MODULE_2__/* .identityTransformData */ .FW
  }, {
    kind: "block",
    type: HEATMAP_BLOCK,
    tooltip: "Renders the block data in a 2D heatmap",
    message0: "heatmap of x %1 y %2 color %3 %4 %5 %6",
    args0: [{
      type: _fields_DataColumnChooserField__WEBPACK_IMPORTED_MODULE_3__/* ["default"].KEY */ .Z.KEY,
      name: "x",
      dataType: "number"
    }, {
      type: _fields_DataColumnChooserField__WEBPACK_IMPORTED_MODULE_3__/* ["default"].KEY */ .Z.KEY,
      name: "y",
      dataType: "number"
    }, {
      type: _fields_DataColumnChooserField__WEBPACK_IMPORTED_MODULE_3__/* ["default"].KEY */ .Z.KEY,
      name: "color"
    }, {
      type: _fields_JSONSettingsField__WEBPACK_IMPORTED_MODULE_11__/* ["default"].KEY */ .Z.KEY,
      name: "settings",
      schema: char2DSettingsSchema
    }, {
      type: "input_dummy"
    }, {
      type: _fields_chart_HeatMapField__WEBPACK_IMPORTED_MODULE_12__/* ["default"].KEY */ .Z.KEY,
      name: "plot"
    }],
    previousStatement: _toolbox__WEBPACK_IMPORTED_MODULE_2__/* .DATA_SCIENCE_STATEMENT_TYPE */ .zN,
    nextStatement: _toolbox__WEBPACK_IMPORTED_MODULE_2__/* .DATA_SCIENCE_STATEMENT_TYPE */ .zN,
    colour,
    template: "meta",
    inputsInline: false,
    dataPreviewField: false,
    transformData: _toolbox__WEBPACK_IMPORTED_MODULE_2__/* .identityTransformData */ .FW
  }, {
    kind: "block",
    type: HISTOGRAM_BLOCK,
    tooltip: "Renders the block data as a histogram",
    message0: "histogram of %1 group %2 %3 %4 %5",
    args0: [{
      type: _fields_DataColumnChooserField__WEBPACK_IMPORTED_MODULE_3__/* ["default"].KEY */ .Z.KEY,
      name: "index",
      dataType: "number"
    }, {
      type: _fields_DataColumnChooserField__WEBPACK_IMPORTED_MODULE_3__/* ["default"].KEY */ .Z.KEY,
      name: "group"
    }, {
      type: _fields_JSONSettingsField__WEBPACK_IMPORTED_MODULE_11__/* ["default"].KEY */ .Z.KEY,
      name: "settings",
      schema: chartSettingsSchema
    }, {
      type: "input_dummy"
    }, {
      type: _fields_chart_HistogramField__WEBPACK_IMPORTED_MODULE_6__/* ["default"].KEY */ .Z.KEY,
      name: "plot"
    }],
    previousStatement: _toolbox__WEBPACK_IMPORTED_MODULE_2__/* .DATA_SCIENCE_STATEMENT_TYPE */ .zN,
    nextStatement: _toolbox__WEBPACK_IMPORTED_MODULE_2__/* .DATA_SCIENCE_STATEMENT_TYPE */ .zN,
    colour,
    template: "meta",
    inputsInline: false,
    dataPreviewField: false,
    transformData: _toolbox__WEBPACK_IMPORTED_MODULE_2__/* .identityTransformData */ .FW
  }, {
    kind: "block",
    type: BOX_PLOT_BLOCK,
    message0: "boxplot of index %1 value %2 group %3 %4 %5 %6",
    args0: [{
      type: _fields_DataColumnChooserField__WEBPACK_IMPORTED_MODULE_3__/* ["default"].KEY */ .Z.KEY,
      name: "index"
    }, {
      type: _fields_DataColumnChooserField__WEBPACK_IMPORTED_MODULE_3__/* ["default"].KEY */ .Z.KEY,
      name: "value",
      dataType: "number"
    }, {
      type: _fields_DataColumnChooserField__WEBPACK_IMPORTED_MODULE_3__/* ["default"].KEY */ .Z.KEY,
      name: "group"
    }, {
      type: _fields_JSONSettingsField__WEBPACK_IMPORTED_MODULE_11__/* ["default"].KEY */ .Z.KEY,
      name: "settings",
      schema: charMapSettingsSchema
    }, {
      type: "input_dummy"
    }, {
      type: _fields_chart_BoxPlotField__WEBPACK_IMPORTED_MODULE_8__/* ["default"].KEY */ .Z.KEY,
      name: "plot"
    }],
    previousStatement: _toolbox__WEBPACK_IMPORTED_MODULE_2__/* .DATA_SCIENCE_STATEMENT_TYPE */ .zN,
    nextStatement: _toolbox__WEBPACK_IMPORTED_MODULE_2__/* .DATA_SCIENCE_STATEMENT_TYPE */ .zN,
    colour,
    template: "meta",
    inputsInline: false,
    dataPreviewField: false,
    transformData: _toolbox__WEBPACK_IMPORTED_MODULE_2__/* .identityTransformData */ .FW
  }, {
    kind: "block",
    type: VEGA_LAYER_BLOCK,
    message0: "chart %1 %2 %3 %4 %5 %6",
    args0: [{
      type: "field_dropdown",
      options: ["arc", "area", "bar", "boxplot", "circle", "errorband", "errorbar", "line", "point", "rect", "rule", "square", "text", "tick", "trail"].map(s => [s, s]),
      name: "mark"
    }, {
      type: _fields_JSONSettingsField__WEBPACK_IMPORTED_MODULE_11__/* ["default"].KEY */ .Z.KEY,
      name: "settings",
      schema: chartSettingsSchema
    }, {
      type: "input_dummy"
    }, {
      type: "input_statement",
      name: "fields",
      check: VEGA_STATEMENT_TYPE
    }, {
      type: "input_dummy"
    }, {
      type: _fields_chart_VegaChartField__WEBPACK_IMPORTED_MODULE_9__/* ["default"].KEY */ .Z.KEY,
      name: "chart"
    }],
    previousStatement: _toolbox__WEBPACK_IMPORTED_MODULE_2__/* .DATA_SCIENCE_STATEMENT_TYPE */ .zN,
    nextStatement: _toolbox__WEBPACK_IMPORTED_MODULE_2__/* .DATA_SCIENCE_STATEMENT_TYPE */ .zN,
    colour,
    template: "meta",
    inputsInline: false,
    dataPreviewField: false,
    transformData: _toolbox__WEBPACK_IMPORTED_MODULE_2__/* .identityTransformData */ .FW
  }, {
    kind: "block",
    type: VEGA_ENCODING_BLOCK,
    message0: "encoding %1 as %2 type %3",
    args0: [{
      type: "field_dropdown",
      options: ["x", "y", "x2", "y2", "xError", "yError", "xError2", "yError2", "theta", "theta2", "radius", "radius2", "color", "angle", "opacity", "fillOpacity", "strokeOpacity", "shape", "size", "strokeDash", "strokeWidth", "text"].map(s => [s, s]),
      name: "channel"
    }, {
      type: _fields_DataColumnChooserField__WEBPACK_IMPORTED_MODULE_3__/* ["default"].KEY */ .Z.KEY,
      name: "field",
      parentData: true
    }, {
      type: "field_dropdown",
      options: ["quantitative", "ordinal", "nominal", "temporal"].map(s => [s, s]),
      name: "type"
    }],
    previousStatement: VEGA_STATEMENT_TYPE,
    nextStatement: VEGA_STATEMENT_TYPE,
    colour,
    template: "meta",
    inputsInline: false,
    dataPreviewField: false,
    transformData: _toolbox__WEBPACK_IMPORTED_MODULE_2__/* .identityTransformData */ .FW
  }],
  createCategory: () => [{
    kind: "category",
    name: "Charts",
    contents: [{
      kind: "block",
      type: SCATTERPLOT_BLOCK
    }, {
      kind: "block",
      type: LINEPLOT_BLOCK
    }, {
      kind: "block",
      type: BARCHART_BLOCK
    }, {
      kind: "block",
      type: HISTOGRAM_BLOCK
    }, {
      kind: "block",
      type: BOX_PLOT_BLOCK
    }, {
      kind: "block",
      type: HEATMAP_BLOCK
    }, {
      kind: "block",
      type: CHART_SHOW_TABLE_BLOCK
    }, {
      kind: "sep"
    }, {
      kind: "label",
      text: "Advanced"
    }, {
      kind: "block",
      type: VEGA_LAYER_BLOCK
    }, {
      kind: "block",
      type: VEGA_ENCODING_BLOCK
    }],
    colour
  }]
};
/* harmony default export */ __webpack_exports__["Z"] = (chartDsl);
function blockToVisualizationSpec(sourceBlock, // eslint-disable-next-line @typescript-eslint/ban-types
data) {
  var {
    headers,
    types
  } = (0,_fields_tidy__WEBPACK_IMPORTED_MODULE_10__/* .tidyHeaders */ .P2)(data);
  var mark = sourceBlock.getFieldValue("mark");
  var title = sourceBlock.getFieldValue("title");
  var spec = {
    title,
    mark: {
      type: mark,
      tooltip: true
    },
    encoding: {},
    data: {
      name: "values"
    }
  };
  var child = sourceBlock.getInputTargetBlock("fields");

  while (child) {
    switch (child.type) {
      case VEGA_ENCODING_BLOCK:
        {
          var channel = child.getFieldValue("channel");
          var field = (0,_fields_tidy__WEBPACK_IMPORTED_MODULE_10__/* .tidyResolveFieldColumn */ .Fy)(data, child, "field");
          var type = child.getFieldValue("type");

          if (channel && field) {
            var fieldType = types[headers.indexOf(field)]; // eslint-disable-next-line @typescript-eslint/no-explicit-any

            spec.encoding[channel] = {
              field,
              type: type || (fieldType === "number" ? "quantitative" : "nominal")
            };
          }

          break;
        }
    }

    child = child.getNextBlock();
  }

  return spec;
}

/***/ }),

/***/ 94113:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "u": function() { return /* binding */ resolveDsl; }
/* harmony export */ });
/* harmony import */ var _toolbox__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(16582);

function resolveDsl(dsls, type) {
  var dsl = dsls === null || dsls === void 0 ? void 0 : dsls.find(dsl => {
    var _dsl$types;

    return ((_dsl$types = dsl.types) === null || _dsl$types === void 0 ? void 0 : _dsl$types.indexOf(type)) > -1;
  });
  if (dsl) return dsl;
  var {
    dsl: dslName
  } = (0,_toolbox__WEBPACK_IMPORTED_MODULE_0__/* .resolveBlockDefinition */ .Pq)(type) || {};

  if (!dslName) {
    console.warn("unknown dsl for " + type);
    return undefined;
  }

  return dsls === null || dsls === void 0 ? void 0 : dsls.find(dsl => dsl.id === dslName);
}

/***/ }),

/***/ 76658:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var _fields_fields__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(29434);

var fieldsDsl = {
  id: "fields",
  createBlocks: () => (0,_fields_fields__WEBPACK_IMPORTED_MODULE_0__/* .fieldShadows */ .w)()
};
/* harmony default export */ __webpack_exports__["Z"] = (fieldsDsl);

/***/ }),

/***/ 21910:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ZS": function() { return /* binding */ toServiceName; },
/* harmony export */   "Fd": function() { return /* binding */ toServiceType; },
/* harmony export */   "tT": function() { return /* binding */ toRoleType; },
/* harmony export */   "eS": function() { return /* binding */ parseRoleType; },
/* harmony export */   "GB": function() { return /* binding */ fieldsToFieldInputs; },
/* harmony export */   "ki": function() { return /* binding */ fieldsToValues; },
/* harmony export */   "Bo": function() { return /* binding */ fieldsToMessage; },
/* harmony export */   "me": function() { return /* binding */ serviceHelp; },
/* harmony export */   "JO": function() { return /* binding */ createServiceColor; },
/* harmony export */   "xH": function() { return /* binding */ roleVariable; },
/* harmony export */   "wi": function() { return /* binding */ getServiceInfo; },
/* harmony export */   "Hy": function() { return /* binding */ ServicesBaseDSL; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(15785);
/* harmony import */ var core_js_modules_es_array_flat_map_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(86535);
/* harmony import */ var core_js_modules_es_array_flat_map_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_array_flat_map_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var core_js_modules_es_array_unscopables_flat_map_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(99244);
/* harmony import */ var core_js_modules_es_array_unscopables_flat_map_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_array_unscopables_flat_map_js__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var gatsby__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(35313);
/* harmony import */ var _jacdac_ts_jacdac_spec_spectool_jdspec__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(13996);
/* harmony import */ var _jacdac_ts_src_jdom_constants__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(71815);
/* harmony import */ var _jacdac_ts_src_jdom_flags__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(21258);
/* harmony import */ var _jacdac_ts_src_jdom_spec__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(26799);
/* harmony import */ var _jacdac_ts_src_jdom_utils__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(81794);
/* harmony import */ var _jacdac_ts_src_vm_compile__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(73390);
/* harmony import */ var _fields_NoteField__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(50585);
/* harmony import */ var _fields_ServoAngleField__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(891);
/* harmony import */ var _toolbox__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(16582);
/* harmony import */ var _vm_VMgenerator__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(15056);
/* harmony import */ var blockly__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(74640);
/* harmony import */ var blockly__WEBPACK_IMPORTED_MODULE_13___default = /*#__PURE__*/__webpack_require__.n(blockly__WEBPACK_IMPORTED_MODULE_13__);
/* harmony import */ var _palette__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(74602);
















var SET_STATUS_LIGHT_BLOCK = "jacdac_set_status_light";
var ROLE_BOUND_EVENT_BLOCK = "jacdac_role_bound_event";
var ROLE_BOUND_BLOCK = "jacdac_role_bound";

function isBooleanField(field) {
  return field.type === "bool";
}

function isStringField(field) {
  return field.type === "string";
}

function toBlocklyType(field) {
  return field.encoding === "JSON" ? _toolbox__WEBPACK_IMPORTED_MODULE_11__/* .JSON_TYPE */ .oj : isBooleanField(field) ? _toolbox__WEBPACK_IMPORTED_MODULE_11__/* .BOOLEAN_TYPE */ .lu : isStringField(field) ? _toolbox__WEBPACK_IMPORTED_MODULE_11__/* .STRING_TYPE */ .jt : (0,_jacdac_ts_jacdac_spec_spectool_jdspec__WEBPACK_IMPORTED_MODULE_3__/* .isNumericType */ .FV)(field) ? _toolbox__WEBPACK_IMPORTED_MODULE_11__/* .NUMBER_TYPE */ .sS : undefined;
}

function enumInfo(srv, field) {
  var _srv$enums;

  var e = (_srv$enums = srv.enums) === null || _srv$enums === void 0 ? void 0 : _srv$enums[field.type];
  return e;
}

var ignoredServices = [_jacdac_ts_src_jdom_constants__WEBPACK_IMPORTED_MODULE_4__/* .SRV_CONTROL */ .gm9, _jacdac_ts_src_jdom_constants__WEBPACK_IMPORTED_MODULE_4__/* .SRV_LOGGER */ .w9j, _jacdac_ts_src_jdom_constants__WEBPACK_IMPORTED_MODULE_4__/* .SRV_ROLE_MANAGER */ .igi, _jacdac_ts_src_jdom_constants__WEBPACK_IMPORTED_MODULE_4__/* .SRV_PROTO_TEST */ .$Bn, _jacdac_ts_src_jdom_constants__WEBPACK_IMPORTED_MODULE_4__/* .SRV_BOOTLOADER */ .PWm];
var customMessages = [{
  service: _jacdac_ts_src_jdom_constants__WEBPACK_IMPORTED_MODULE_4__/* .SRV_JOYSTICK */ .vRO,
  register: _jacdac_ts_src_jdom_constants__WEBPACK_IMPORTED_MODULE_4__/* .JoystickReg.Direction */ .ztd.Direction,
  field: "buttons",
  get: "is %1 %2 pressed"
}]; // internal helper functions

var customShadows = [{
  serviceClass: _jacdac_ts_src_jdom_constants__WEBPACK_IMPORTED_MODULE_4__/* .SRV_SERVO */ .$X_,
  kind: "rw",
  identifier: _jacdac_ts_src_jdom_constants__WEBPACK_IMPORTED_MODULE_4__/* .ServoReg.Angle */ .pmu.Angle,
  field: "_",
  shadow: {
    kind: "block",
    type: _fields_ServoAngleField__WEBPACK_IMPORTED_MODULE_10__/* ["default"].SHADOW.type */ .Z.SHADOW.type
  }
}, {
  serviceClass: _jacdac_ts_src_jdom_constants__WEBPACK_IMPORTED_MODULE_4__/* .SRV_BUZZER */ .J1$,
  kind: "command",
  identifier: _jacdac_ts_src_jdom_constants__WEBPACK_IMPORTED_MODULE_4__/* .BuzzerCmd.PlayNote */ .Rv2.PlayNote,
  field: "frequency",
  shadow: {
    kind: "block",
    type: _fields_NoteField__WEBPACK_IMPORTED_MODULE_9__/* ["default"].SHADOW.type */ .Z.SHADOW.type
  }
}];

var lookupCustomShadow = (service, info, field) => {
  var _customShadows$find;

  return (_customShadows$find = customShadows.find(cs => cs.serviceClass === service.classIdentifier && cs.kind == info.kind && cs.identifier === info.identifier && cs.field == field.name)) === null || _customShadows$find === void 0 ? void 0 : _customShadows$find.shadow;
};

var fieldsSupported = pkt => pkt.fields.every(toBlocklyType);

var fieldName = (reg, field) => field.name === "_" ? reg.name : field.name;

var fieldToShadow = (service, info, field) => lookupCustomShadow(service, info, field) || (isBooleanField(field) ? {
  kind: "block",
  type: "jacdac_on_off"
} : isStringField(field) ? {
  kind: "block",
  type: "text"
} : field.unit === "°" ? {
  kind: "block",
  type: "jacdac_angle"
} : field.unit === "/" ? {
  kind: "block",
  type: "jacdac_ratio"
} : /^%/.test(field.unit) ? {
  kind: "block",
  type: "jacdac_percent"
} : field.type === "u8" ? {
  kind: "block",
  type: "jacdac_byte"
} : {
  kind: "block",
  type: "math_number",
  value: field.defaultValue || 0,
  min: field.typicalMin || field.absoluteMin,
  max: field.typicalMax || field.absoluteMax
});

var variableName = (srv, client) => "" + (0,_jacdac_ts_jacdac_spec_spectool_jdspec__WEBPACK_IMPORTED_MODULE_3__/* .humanify */ .lW)(srv.camelName).toLowerCase() + (client ? "" : " server") + " 1";

var isEnabledRegister = info => info.fields.length === 1 && info.fields[0].type === "bool" && info.name === "enabled";

var customMessage = (srv, reg, field) => customMessages.find(m => m.service === srv.classIdentifier && m.register === reg.identifier && m.field === field.name);

var eventFieldGroups = [{
  output: _toolbox__WEBPACK_IMPORTED_MODULE_11__/* .NUMBER_TYPE */ .sS,
  filter: _jacdac_ts_jacdac_spec_spectool_jdspec__WEBPACK_IMPORTED_MODULE_3__/* .isNumericType */ .FV
}, {
  output: _toolbox__WEBPACK_IMPORTED_MODULE_11__/* .BOOLEAN_TYPE */ .lu,
  filter: isBooleanField
}, {
  output: _toolbox__WEBPACK_IMPORTED_MODULE_11__/* .STRING_TYPE */ .jt,
  filter: f => isStringField(f) && f.encoding !== "JSON"
}, {
  output: _toolbox__WEBPACK_IMPORTED_MODULE_11__/* .JSON_TYPE */ .oj,
  filter: f => isStringField(f) && f.encoding === "JSON"
}];
// exports
function toServiceName(service) {
  var name = "";
  var instanceName = service.instanceName;
  if (instanceName) name += (0,_jacdac_ts_jacdac_spec_spectool_jdspec__WEBPACK_IMPORTED_MODULE_3__/* .humanify */ .lW)((0,_jacdac_ts_jacdac_spec_spectool_jdspec__WEBPACK_IMPORTED_MODULE_3__/* .dashify */ .P1)(instanceName));else {
    name += (0,_jacdac_ts_jacdac_spec_spectool_jdspec__WEBPACK_IMPORTED_MODULE_3__/* .humanify */ .lW)((0,_jacdac_ts_jacdac_spec_spectool_jdspec__WEBPACK_IMPORTED_MODULE_3__/* .dashify */ .P1)(service.specification.shortName));
    if (service.device.services({
      serviceClass: service.serviceClass
    }).length > 1) name += "[" + service.serviceIndex.toString(16) + "]";
  }
  name += " (" + service.device.shortId + ")";
  return name;
}
function toServiceType(service) {
  return (0,_jacdac_ts_src_jdom_spec__WEBPACK_IMPORTED_MODULE_6__/* .isSensor */ .rq)(service.specification) ? "sensor" : "service";
}
function toRoleType(service, client) {
  if (client === void 0) {
    client = true;
  }

  return service.classIdentifier + ":" + (client ? "client" : "server");
}
function parseRoleType(v) {
  var split = v.type.split(":");
  return {
    role: v.name,
    serviceClass: parseInt(split[0]),
    client: split.length === 2 ? split[1] === "client" : true
  };
}
var fieldsToFieldInputs = info => info.fields.map(field => ({
  type: "input_value",
  name: fieldName(info, field),
  check: toBlocklyType(field)
}));
var fieldsToValues = (service, info) => (0,_jacdac_ts_src_jdom_utils__WEBPACK_IMPORTED_MODULE_7__/* .toMap */ .qL)(info.fields, field => fieldName(info, field), field => fieldToShadow(service, info, field));
var fieldsToMessage = info => info.fields.map((field, i) => (0,_jacdac_ts_jacdac_spec_spectool_jdspec__WEBPACK_IMPORTED_MODULE_3__/* .humanify */ .lW)(field.name) + " %" + (2 + i)).join(" ");
var serviceHelp = service => {
  return (0,gatsby__WEBPACK_IMPORTED_MODULE_2__.withPrefix)("/services/" + service.shortId);
};
var sensorColor = (0,_palette__WEBPACK_IMPORTED_MODULE_14__/* .paletteColorByIndex */ .W)(1);
var otherColor = (0,_palette__WEBPACK_IMPORTED_MODULE_14__/* .paletteColorByIndex */ .W)(3); // eslint-disable-next-line @typescript-eslint/no-unused-vars

var createServiceColor = theme => {
  var serviceColor = srv => (0,_jacdac_ts_src_jdom_spec__WEBPACK_IMPORTED_MODULE_6__/* .isSensor */ .rq)(srv) ? sensorColor : otherColor;

  return serviceColor;
};
var roleVariable = function roleVariable(service, client) {
  if (client === void 0) {
    client = true;
  }

  return {
    type: "field_variable",
    name: "role",
    variable: variableName(service, client),
    variableTypes: [toRoleType(service, client)],
    defaultType: toRoleType(service, client)
  };
};
var getServiceInfo = () => {
  var allServices = (0,_jacdac_ts_src_jdom_spec__WEBPACK_IMPORTED_MODULE_6__/* .serviceSpecifications */ .Le)();
  var supportedServices = allServices.filter(service => !/^_/.test(service.shortId) && service.status !== "deprecated").filter(service => ignoredServices.indexOf(service.classIdentifier) < 0);
  var registers = (0,_jacdac_ts_src_jdom_utils__WEBPACK_IMPORTED_MODULE_7__/* .arrayConcatMany */ .ue)(supportedServices.map(service => service.packets.filter(_jacdac_ts_src_jdom_spec__WEBPACK_IMPORTED_MODULE_6__/* .isHighLevelRegister */ .vr).map(register => ({
    service,
    register
  }))));
  var [registerSimples, registerComposites] = (0,_jacdac_ts_src_jdom_utils__WEBPACK_IMPORTED_MODULE_7__/* .splitFilter */ .ap)(registers, reg => reg.register.fields.length == 1);
  var [registerSimpleTypes, registerSimpleOthers] = (0,_jacdac_ts_src_jdom_utils__WEBPACK_IMPORTED_MODULE_7__/* .splitFilter */ .ap)(registerSimples, _ref => {
    var {
      register
    } = _ref;
    return !!toBlocklyType(register.fields[0]);
  });
  var registerSimpleEnumTypes = registerSimpleOthers.filter(_ref2 => {
    var {
      service,
      register
    } = _ref2;
    return !!enumInfo(service, register.fields[0]);
  }).map(_ref3 => {
    var {
      service,
      register
    } = _ref3;
    return {
      service,
      register,
      field: register.fields[0],
      einfo: enumInfo(service, register.fields[0])
    };
  });
  var registerCompositeEnumTypes = (0,_jacdac_ts_src_jdom_utils__WEBPACK_IMPORTED_MODULE_7__/* .arrayConcatMany */ .ue)(registerComposites.map(_ref4 => {
    var {
      service,
      register
    } = _ref4;
    return register.fields.map(field => ({
      service,
      register,
      field,
      einfo: enumInfo(service, field)
    })).filter(_ref5 => {
      var {
        einfo
      } = _ref5;
      return !!einfo;
    });
  }));
  return {
    allServices,
    supportedServices,
    registers,
    registerSimpleTypes,
    registerComposites,
    registerSimpleEnumTypes,
    registerCompositeEnumTypes,
    events: supportedServices.map(service => ({
      service,
      events: service.packets.filter(_jacdac_ts_src_jdom_spec__WEBPACK_IMPORTED_MODULE_6__/* .isHighLevelEvent */ .jl)
    })).filter(kv => !!kv.events.length),
    commands: (0,_jacdac_ts_src_jdom_utils__WEBPACK_IMPORTED_MODULE_7__/* .arrayConcatMany */ .ue)(supportedServices.map(service => service.packets.filter(pkt => (0,_jacdac_ts_src_jdom_spec__WEBPACK_IMPORTED_MODULE_6__/* .isCommand */ .ao)(pkt) && !pkt.lowLevel && fieldsSupported(pkt)).map(pkt => ({
      service,
      command: pkt
    }))))
  };
};
var ServicesBaseDSL = /*#__PURE__*/function () {
  function ServicesBaseDSL() {
    this._serviceBlocks = [];
    this._eventFieldBlocks = [];
  }

  var _proto = ServicesBaseDSL.prototype;

  _proto.makeRegisterSimpleGetBlocks = function makeRegisterSimpleGetBlocks(registers, client) {
    if (client === void 0) {
      client = true;
    }

    return registers.map(_ref6 => {
      var _customMessage;

      var {
        service,
        register
      } = _ref6;
      return {
        kind: "block",
        type: "jacdac_get_simple_" + service.shortId + "_" + register.name + (client ? "" : "_server"),
        message0: ((_customMessage = customMessage(service, register, register.fields[0])) === null || _customMessage === void 0 ? void 0 : _customMessage.get) || "%1 " + (0,_jacdac_ts_jacdac_spec_spectool_jdspec__WEBPACK_IMPORTED_MODULE_3__/* .humanify */ .lW)(register.name),
        args0: [roleVariable(service, client)],
        inputsInline: true,
        output: toBlocklyType(register.fields[0]),
        colour: this.serviceColor(service),
        tooltip: register.description,
        helpUrl: serviceHelp(service),
        service,
        register,
        field: register.fields[0],
        template: "register_get"
      };
    });
  };

  _proto.makeRegisterSetBlocks = function makeRegisterSetBlocks(registers, client) {
    if (client === void 0) {
      client = true;
    }

    return registers.filter(_ref7 => {
      var {
        register
      } = _ref7;
      return !client || register.kind === "rw";
    }).filter(_ref8 => {
      var {
        register
      } = _ref8;
      return fieldsSupported(register);
    }).map(_ref9 => {
      var {
        service,
        register
      } = _ref9;
      return {
        kind: "block",
        type: "jacdac_set_" + service.shortId + "_" + register.name + (client ? "" : "_server"),
        message0: isEnabledRegister(register) ? "set %1 %2" : "set %1 " + register.name + " to " + (register.fields.length === 1 ? "%2" : fieldsToMessage(register)),
        args0: [roleVariable(service, client)].concat((0,_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z)(fieldsToFieldInputs(register))),
        values: fieldsToValues(service, register),
        inputsInline: true,
        colour: this.serviceColor(service),
        tooltip: register.description,
        helpUrl: serviceHelp(service),
        service,
        register,
        previousStatement: _toolbox__WEBPACK_IMPORTED_MODULE_11__/* .CODE_STATEMENT_TYPE */ .lL,
        nextStatement: _toolbox__WEBPACK_IMPORTED_MODULE_11__/* .CODE_STATEMENT_TYPE */ .lL,
        template: "register_set"
      };
    });
  };

  _proto.makeRegisterChangeByEventBlocks = function makeRegisterChangeByEventBlocks(registers, client) {
    if (client === void 0) {
      client = true;
    }

    return registers.filter(_ref10 => {
      var {
        service
      } = _ref10;
      return !service.packets.some(_jacdac_ts_src_jdom_spec__WEBPACK_IMPORTED_MODULE_6__/* .isHighLevelEvent */ .jl);
    }).filter(_ref11 => {
      var {
        register
      } = _ref11;
      return register.fields.length === 1 && (0,_jacdac_ts_jacdac_spec_spectool_jdspec__WEBPACK_IMPORTED_MODULE_3__/* .isNumericType */ .FV)(register.fields[0]) && register.identifier !== _jacdac_ts_src_jdom_constants__WEBPACK_IMPORTED_MODULE_4__/* .SystemReg.Intensity */ .ZJq.Intensity;
    }).map(_ref12 => {
      var {
        service,
        register
      } = _ref12;
      return {
        kind: "block",
        type: "jacdac_change_by_events_" + service.shortId + "_" + register.name + (client ? "" : "_server"),
        message0: "on %1 " + (0,_jacdac_ts_jacdac_spec_spectool_jdspec__WEBPACK_IMPORTED_MODULE_3__/* .humanify */ .lW)(register.name) + " change by %2",
        args0: [roleVariable(service, client)].concat((0,_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z)(fieldsToFieldInputs(register))).filter(v => !!v),
        values: fieldsToValues(service, register),
        inputsInline: true,
        nextStatement: _toolbox__WEBPACK_IMPORTED_MODULE_11__/* .CODE_STATEMENT_TYPE */ .lL,
        colour: this.serviceColor(service),
        tooltip: "Event raised when " + register.name + " changes",
        helpUrl: serviceHelp(service),
        service,
        register,
        template: "register_change_event"
      };
    });
  };

  _proto.makeRegisterNumericsGetBlocks = function makeRegisterNumericsGetBlocks(registers, client) {
    if (client === void 0) {
      client = true;
    }

    return registers.filter(re => re.register.fields.some(_jacdac_ts_jacdac_spec_spectool_jdspec__WEBPACK_IMPORTED_MODULE_3__/* .isNumericType */ .FV)).map(_ref13 => {
      var {
        service,
        register
      } = _ref13;
      return {
        kind: "block",
        type: "jacdac_get_numerics_" + service.shortId + "_" + register.name + (client ? "" : "_server"),
        message0: "%1 " + (0,_jacdac_ts_jacdac_spec_spectool_jdspec__WEBPACK_IMPORTED_MODULE_3__/* .humanify */ .lW)(register.name) + (register.fields.length > 1 ? " %2" : ""),
        args0: [roleVariable(service, client), register.fields.length > 1 ? {
          type: "field_dropdown",
          name: "field",
          options: register.fields.filter(f => (0,_jacdac_ts_jacdac_spec_spectool_jdspec__WEBPACK_IMPORTED_MODULE_3__/* .isNumericType */ .FV)(f)).map(field => [(0,_jacdac_ts_jacdac_spec_spectool_jdspec__WEBPACK_IMPORTED_MODULE_3__/* .humanify */ .lW)(field.name), fieldName(register, field)])
        } : undefined].filter(v => !!v),
        inputsInline: true,
        output: "Number",
        colour: this.serviceColor(service),
        tooltip: register.description,
        helpUrl: serviceHelp(service),
        service,
        register,
        template: "register_get"
      };
    });
  };

  _proto.makeRegisterEnumGetBlocks = function makeRegisterEnumGetBlocks(registers, client) {
    if (client === void 0) {
      client = true;
    }

    return registers.map(_ref14 => {
      var _customMessage2;

      var {
        service,
        register,
        field,
        einfo
      } = _ref14;
      return {
        kind: "block",
        type: "jacdac_get_enum_" + service.shortId + "_" + register.name + "_" + field.name + (client ? "" : "_server"),
        message0: ((_customMessage2 = customMessage(service, register, field)) === null || _customMessage2 === void 0 ? void 0 : _customMessage2.get) || "%1 " + (0,_jacdac_ts_jacdac_spec_spectool_jdspec__WEBPACK_IMPORTED_MODULE_3__/* .humanify */ .lW)(register.name) + (field.name === "_" ? "" : " " + field.name) + " %2",
        args0: [roleVariable(service, client), {
          type: "field_dropdown",
          name: field.name,
          options: Object.keys(einfo.members).map(member => [(0,_jacdac_ts_jacdac_spec_spectool_jdspec__WEBPACK_IMPORTED_MODULE_3__/* .humanify */ .lW)(member), member])
        }],
        inputsInline: true,
        output: "Boolean",
        colour: this.serviceColor(service),
        tooltip: register.description,
        helpUrl: serviceHelp(service),
        service,
        register,
        field,
        template: "register_get"
      };
    });
  } // generate accessor blocks for event/command data with numbers
  ;

  _proto.makeFieldBlocks = function makeFieldBlocks(sps, client) {
    if (client === void 0) {
      client = true;
    }

    var worker = (sp, output, filter) => {
      var {
        service,
        packets
      } = sp;
      return packets.filter(pkt => pkt.fields.filter(filter).length > 0).map(pkt => ({
        service,
        pkt
      })).map(_ref15 => {
        var {
          service,
          pkt
        } = _ref15;
        return {
          kind: "block",
          type: "jacdac_event_field_" + output.toLowerCase() + "_" + service.shortId + "_" + pkt.name + (client ? "" : "_server"),
          message0: pkt.name + " %1",
          args0: [{
            type: "field_dropdown",
            name: "field",
            options: pkt.fields.map(field => [(0,_jacdac_ts_jacdac_spec_spectool_jdspec__WEBPACK_IMPORTED_MODULE_3__/* .humanify */ .lW)(field.name), field.name])
          }],
          colour: this.serviceColor(service),
          inputsInline: true,
          tooltip: "Data fields of the " + pkt.name + " " + (client ? "event" : "command"),
          helpUrl: serviceHelp(service),
          service,
          event: pkt,
          output,
          template: "event_field"
        };
      });
    };

    return (0,_jacdac_ts_src_jdom_utils__WEBPACK_IMPORTED_MODULE_7__/* .arrayConcatMany */ .ue)((0,_jacdac_ts_src_jdom_utils__WEBPACK_IMPORTED_MODULE_7__/* .arrayConcatMany */ .ue)(eventFieldGroups.map(_ref16 => {
      var {
        output,
        filter
      } = _ref16;
      return sps.map(sp => worker(sp, output, filter));
    })));
  };

  _proto.createCategoryHelper = function createCategoryHelper(options) {
    var _source$blocks;

    var {
      theme,
      source,
      liveServices
    } = options;
    this.serviceColor = createServiceColor(theme);
    var blockServices = (source === null || source === void 0 ? void 0 : source.variables.map(parseRoleType).filter(vt => !!(0,_jacdac_ts_src_jdom_spec__WEBPACK_IMPORTED_MODULE_6__/* .serviceSpecificationFromClassIdentifier */ .d5)(vt.serviceClass))) || [];
    var usedEvents = new Set(source === null || source === void 0 ? void 0 : (_source$blocks = source.blocks) === null || _source$blocks === void 0 ? void 0 : _source$blocks.map(block => ({
      block,
      definition: (0,_toolbox__WEBPACK_IMPORTED_MODULE_11__/* .resolveBlockDefinition */ .Pq)(block.type)
    })).filter(_ref17 => {
      var {
        definition
      } = _ref17;
      return (definition === null || definition === void 0 ? void 0 : definition.template) === "event";
    }).map(_ref18 => {
      var {
        block,
        definition
      } = _ref18;
      var {
        events
      } = definition;
      if (events.length === 1) return events[0];else {
        var eventName = block.inputs[0].fields["event"].value;
        return events.find(ev => ev.name === eventName);
      }
    }).filter(ev => !!ev));

    var jdBlocks = this._serviceBlocks.filter(block => !!block.service);

    var services = (0,_jacdac_ts_src_jdom_utils__WEBPACK_IMPORTED_MODULE_7__/* .uniqueMap */ .EM)(jdBlocks, block => block.service.shortId, block => block.service);
    var toolboxServices = (0,_jacdac_ts_src_jdom_utils__WEBPACK_IMPORTED_MODULE_7__/* .uniqueMap */ .EM)(_jacdac_ts_src_jdom_flags__WEBPACK_IMPORTED_MODULE_5__/* ["default"].diagnostics */ .Z.diagnostics ? services : [].concat((0,_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z)(blockServices.map(pair => services.find(service => service.classIdentifier === pair.serviceClass)).filter(srv => !!srv)), (0,_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z)(liveServices.map(s => s.specification))), srv => srv.shortId, srv => srv).filter(srv => srv && ignoredServices.indexOf(srv.classIdentifier) < 0).sort((l, r) => l.name.localeCompare(r.name));

    var getFieldBlocks = (service, fieldBlocks) => fieldBlocks.filter(ev => ev.service === service && usedEvents.has(ev.event)).map(block => ({
      kind: "block",
      type: block.type,
      values: block.values
    }));

    var makeCategory = (service, isClient, serviceBlocks, eventFieldBLocks) => {
      return {
        kind: "category",
        name: service.name + (isClient ? "" : " Server"),
        colour: this.serviceColor(service),
        contents: [{
          kind: "button",
          text: "Add " + service.name + " " + (isClient ? "role" : "server"),
          callbackKey: "jacdac_add_role_callback_" + toRoleType(service, isClient),
          callback: workspace => blockly__WEBPACK_IMPORTED_MODULE_13__.Variables.createVariableButtonHandler(workspace, null, toRoleType(service, isClient))
        }].concat((0,_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z)(serviceBlocks.map(block => ({
          kind: "block",
          type: block.type,
          values: block.values
        }))), (0,_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z)(getFieldBlocks(service, eventFieldBLocks)))
      };
    };

    return function (serviceBlocks, eventFieldBlocks, client) {
      if (client === void 0) {
        client = true;
      }

      return toolboxServices.map(serviceClient => ({
        serviceClient,
        serviceBlocks: serviceBlocks.filter(block => block.service === serviceClient)
      })).map(sc => makeCategory(sc.serviceClient, client, sc.serviceBlocks, eventFieldBlocks));
    };
  };

  _proto.compileEventToVM = function compileEventToVM(options) {
    var makeAwaitEvent = (cmd, role, eventName) => {
      return {
        expression: {
          type: "CallExpression",
          arguments: cmd == "awaitEvent" ? [(0,_jacdac_ts_src_vm_compile__WEBPACK_IMPORTED_MODULE_8__/* .toMemberExpression */ .vf)(role.toString(), eventName.toString())] : [(0,_jacdac_ts_src_vm_compile__WEBPACK_IMPORTED_MODULE_8__/* .toIdentifier */ .EB)(role.toString()), (0,_jacdac_ts_src_vm_compile__WEBPACK_IMPORTED_MODULE_8__/* .toIdentifier */ .EB)(eventName.toString())],
          callee: (0,_jacdac_ts_src_vm_compile__WEBPACK_IMPORTED_MODULE_8__/* .toIdentifier */ .EB)(cmd)
        },
        event: {
          role: role.toString(),
          event: eventName.toString()
        }
      };
    };

    var {
      block,
      definition,
      blockToExpression
    } = options;
    var {
      inputs
    } = block;
    var {
      template
    } = definition;

    switch (template) {
      case "event":
        {
          var {
            value: role
          } = inputs[0].fields["role"];
          var {
            value: eventName
          } = inputs[0].fields["event"];
          return makeAwaitEvent("awaitEvent", role.toString(), eventName.toString());
        }

      case "register_change_event":
        {
          var {
            value: _role
          } = inputs[0].fields["role"];
          var {
            register
          } = definition;
          var {
            expr,
            errors
          } = blockToExpression(undefined, inputs[0].child);
          return {
            expression: {
              type: "CallExpression",
              arguments: [(0,_jacdac_ts_src_vm_compile__WEBPACK_IMPORTED_MODULE_8__/* .toMemberExpression */ .vf)(_role.toString(), register.name), expr],
              callee: (0,_jacdac_ts_src_vm_compile__WEBPACK_IMPORTED_MODULE_8__/* .toIdentifier */ .EB)("awaitChange")
            },
            errors
          };
        }

      default:
        {
          var {
            type
          } = block;

          switch (type) {
            case ROLE_BOUND_EVENT_BLOCK:
              {
                var {
                  value: _role2
                } = inputs[0].fields["role"];
                var {
                  value: _eventName
                } = inputs[0].fields["event"];
                return makeAwaitEvent("roleBound", _role2.toString(), _eventName.toString());
              }
          }
        }
    }

    return undefined;
  };

  _proto.compileExpressionToVM = function compileExpressionToVM(options) {
    var {
      event,
      definition,
      block
    } = options;
    var {
      inputs,
      id
    } = block;
    var {
      template
    } = definition;

    switch (template) {
      case "register_get":
        {
          var {
            register
          } = definition;
          var {
            value: role
          } = inputs[0].fields["role"];
          var _field = inputs[0].fields["field"];
          return {
            expr: (0,_jacdac_ts_src_vm_compile__WEBPACK_IMPORTED_MODULE_8__/* .toMemberExpression */ .vf)(role, _field ? (0,_jacdac_ts_src_vm_compile__WEBPACK_IMPORTED_MODULE_8__/* .toMemberExpression */ .vf)(register.name, _field.value) : register.name),
            errors: []
          };
        }

      case "event_field":
        {
          var {
            event: eventInfo
          } = definition;
          var errors = [];

          if (event.event !== eventInfo.name) {
            errors.push({
              sourceId: id,
              message: "Event " + eventInfo.name + " is not available in this handler."
            });
          }

          var _field2 = inputs[0].fields["field"];
          return {
            expr: (0,_jacdac_ts_src_vm_compile__WEBPACK_IMPORTED_MODULE_8__/* .toMemberExpression */ .vf)(event.role, (0,_jacdac_ts_src_vm_compile__WEBPACK_IMPORTED_MODULE_8__/* .toMemberExpression */ .vf)(event.event, _field2.value)),
            errors
          };
        }

      default:
        {
          var {
            type
          } = block;
          var _errors = [];

          switch (type) {
            case ROLE_BOUND_BLOCK:
              {
                var {
                  value: _role3
                } = inputs[0].fields["role"];
                return {
                  expr: {
                    type: "CallExpression",
                    arguments: [(0,_jacdac_ts_src_vm_compile__WEBPACK_IMPORTED_MODULE_8__/* .toIdentifier */ .EB)(_role3.toString())],
                    callee: (0,_jacdac_ts_src_vm_compile__WEBPACK_IMPORTED_MODULE_8__/* .toMemberExpression */ .vf)("$fun", "roleBoundExpression")
                  },
                  errors: _errors
                };
              }
          }
        }
    }

    return undefined;
  };

  _proto.compileCommandToVM = function compileCommandToVM(options) {
    var {
      event,
      block,
      definition,
      blockToExpression
    } = options;
    var {
      template
    } = definition;
    var {
      inputs
    } = block;

    switch (template) {
      case "register_set":
        {
          // TODO: need to handle the case of writing a register with fields
          var {
            register
          } = definition;
          var exprsErrors = inputs.map(a => {
            return blockToExpression(event, a.child);
          });
          var {
            value: role
          } = inputs[0].fields.role;
          return {
            cmd: (0,_vm_VMgenerator__WEBPACK_IMPORTED_MODULE_12__/* .makeVMBase */ .IZ)(block, {
              type: "CallExpression",
              arguments: [(0,_jacdac_ts_src_vm_compile__WEBPACK_IMPORTED_MODULE_8__/* .toMemberExpression */ .vf)(role, register.name)].concat((0,_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z)(exprsErrors.map(p => p.expr))),
              callee: (0,_jacdac_ts_src_vm_compile__WEBPACK_IMPORTED_MODULE_8__/* .toIdentifier */ .EB)("writeRegister")
            }),
            errors: exprsErrors.flatMap(p => p.errors)
          };
        }

      case "raiseNo":
      case "raiseArgs":
      case "command":
        {
          var {
            command: serviceCommand
          } = definition;
          var {
            value: _role4
          } = inputs[0].fields.role;
          var eventName = template === "raiseNo" ? inputs[0].fields["event"].value.toString() : "";

          var _exprsErrors = template === "raiseNo" ? [] : inputs.map(a => {
            return blockToExpression(event, a.child);
          });

          return {
            cmd: (0,_vm_VMgenerator__WEBPACK_IMPORTED_MODULE_12__/* .makeVMBase */ .IZ)(block, {
              type: "CallExpression",
              arguments: _exprsErrors.map(p => p.expr),
              callee: (0,_jacdac_ts_src_vm_compile__WEBPACK_IMPORTED_MODULE_8__/* .toMemberExpression */ .vf)(_role4, eventName ? eventName : serviceCommand.name)
            }),
            errors: _exprsErrors.flatMap(p => p.errors)
          };
        }

      case "server":
        {
          return {
            cmd: (0,_vm_VMgenerator__WEBPACK_IMPORTED_MODULE_12__/* .makeVMBase */ .IZ)(block, {
              type: "CallExpression",
              arguments: [],
              callee: (0,_jacdac_ts_src_vm_compile__WEBPACK_IMPORTED_MODULE_8__/* .toIdentifier */ .EB)("nop")
            }),
            errors: []
          };
        }

      default:
        {
          var {
            type
          } = block;

          switch (type) {
            case SET_STATUS_LIGHT_BLOCK:
              {
                console.log("SET_STATUS");
              }
          }
        }
    }

    return undefined;
  };

  return ServicesBaseDSL;
}();

/***/ }),

/***/ 53480:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "EZ": function() { return /* binding */ downloadCSV; },
/* harmony export */   "Eg": function() { return /* binding */ saveCSV; },
/* harmony export */   "sh": function() { return /* binding */ unparseCSV; },
/* harmony export */   "bW": function() { return /* binding */ parseCSV; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(15861);
/* harmony import */ var _proxy__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(60669);


/* eslint-disable @typescript-eslint/ban-types */

function downloadCSV(_x) {
  return _downloadCSV.apply(this, arguments);
}

function _downloadCSV() {
  _downloadCSV = (0,_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z)(function* (url) {
    var worker = (0,_proxy__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)("csv");
    var res = yield worker.postMessage({
      worker: "csv",
      type: "download",
      url
    });
    return res === null || res === void 0 ? void 0 : res.file;
  });
  return _downloadCSV.apply(this, arguments);
}

function saveCSV(_x2, _x3) {
  return _saveCSV.apply(this, arguments);
}

function _saveCSV() {
  _saveCSV = (0,_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z)(function* (fileHandle, data) {
    var worker = (0,_proxy__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)("csv");
    yield worker.postMessage({
      worker: "csv",
      type: "save",
      fileHandle,
      data
    });
  });
  return _saveCSV.apply(this, arguments);
}

function unparseCSV(_x4) {
  return _unparseCSV.apply(this, arguments);
}

function _unparseCSV() {
  _unparseCSV = (0,_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z)(function* (data) {
    var worker = (0,_proxy__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)("csv");
    var resp = yield worker.postMessage({
      worker: "csv",
      type: "unparse",
      data
    });
    return resp === null || resp === void 0 ? void 0 : resp.text;
  });
  return _unparseCSV.apply(this, arguments);
}

function parseCSV(_x5) {
  return _parseCSV.apply(this, arguments);
}

function _parseCSV() {
  _parseCSV = (0,_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z)(function* (source) {
    var worker = (0,_proxy__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)("csv");
    var resp = yield worker.postMessage({
      worker: "csv",
      type: "parse",
      source
    });
    return resp === null || resp === void 0 ? void 0 : resp.file;
  });
  return _parseCSV.apply(this, arguments);
}

/***/ }),

/***/ 52429:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "R1": function() { return /* binding */ visitWorkspace; }
/* harmony export */ });
/* unused harmony exports visitBlock, visitInput, visitField */
function visitBlock(block, visitor) {
  var _visitor$visitBlock;

  if (!block) return;
  (_visitor$visitBlock = visitor.visitBlock) === null || _visitor$visitBlock === void 0 ? void 0 : _visitor$visitBlock.call(visitor, block);
  var {
    inputs,
    children
  } = block;
  inputs === null || inputs === void 0 ? void 0 : inputs.forEach(input => visitInput(input, visitor));
  children === null || children === void 0 ? void 0 : children.forEach(child => visitBlock(child, visitor));
}
function visitInput(input, visitor) {
  var _visitor$visitInput;

  if (!input) return;
  (_visitor$visitInput = visitor.visitInput) === null || _visitor$visitInput === void 0 ? void 0 : _visitor$visitInput.call(visitor, input);
  var {
    fields,
    child
  } = input;
  if (fields) Object.keys(fields).map(k => visitField(k, fields[k], visitor));
  visitBlock(child, visitor);
}
function visitField(name, field, visitor) {
  var _visitor$visitField;

  if (!field) return;
  (_visitor$visitField = visitor.visitField) === null || _visitor$visitField === void 0 ? void 0 : _visitor$visitField.call(visitor, name, field);
}
function visitWorkspace(workspace, visitor) {
  var _workspace$blocks;

  workspace === null || workspace === void 0 ? void 0 : (_workspace$blocks = workspace.blocks) === null || _workspace$blocks === void 0 ? void 0 : _workspace$blocks.forEach(block => visitBlock(block, visitor));
}

/***/ }),

/***/ 69223:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ BuiltinDataSetField; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(15861);
/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(94578);
/* harmony import */ var blockly__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(74640);
/* harmony import */ var blockly__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(blockly__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gatsby__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(35313);
/* harmony import */ var _dsl_workers_csv_proxy__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(53480);





var builtins = {
  cereal: (0,gatsby__WEBPACK_IMPORTED_MODULE_1__.withPrefix)("/datasets/cereal.csv"),
  penguins: (0,gatsby__WEBPACK_IMPORTED_MODULE_1__.withPrefix)("/datasets/penguins.csv")
};

var BuiltinDataSetField = /*#__PURE__*/function (_FieldDropdown) {
  (0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)(BuiltinDataSetField, _FieldDropdown);

  // eslint-disable-next-line @typescript-eslint/ban-types
  BuiltinDataSetField.fromJson = function fromJson(options) {
    return new BuiltinDataSetField(options);
  } // eslint-disable-next-line @typescript-eslint/ban-types
  ;

  function BuiltinDataSetField(options) {
    var _this;

    _this = _FieldDropdown.call(this, () => Object.keys(builtins).map(k => [k, k]), undefined, options) || this;
    _this.initialized = false;
    return _this;
  }

  var _proto = BuiltinDataSetField.prototype;

  _proto.init = function init() {
    _FieldDropdown.prototype.init.call(this);

    this.initialized = true;
    this.updateData();
  };

  _proto.updateData = /*#__PURE__*/function () {
    var _updateData = (0,_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(function* () {
      if (!this.initialized) return;
      var url = builtins[this.getValue()];
      if (!url) return; // load dataset as needed

      var sourceBlock = this.getSourceBlock();
      var marker = !!(sourceBlock !== null && sourceBlock !== void 0 && sourceBlock.isInsertionMarker());
      if (!sourceBlock || marker) return;
      var services = sourceBlock.jacdacServices;
      if (!services || services.cache[BuiltinDataSetField.KEY] === url) return; // already downloaded
      // avoid races

      services.cache[BuiltinDataSetField.KEY] = url;
      var {
        data,
        errors
      } = yield (0,_dsl_workers_csv_proxy__WEBPACK_IMPORTED_MODULE_2__/* .downloadCSV */ .EZ)(url);
      if (errors !== null && errors !== void 0 && errors.length) console.debug("csv parse errors", {
        id: sourceBlock.id,
        marker,
        data,
        errors,
        services,
        url
      });
      services.data = data;
    });

    function updateData() {
      return _updateData.apply(this, arguments);
    }

    return updateData;
  }();

  _proto.setSourceBlock = function setSourceBlock(block) {
    _FieldDropdown.prototype.setSourceBlock.call(this, block);

    this.updateData();
  };

  _proto.doValueUpdate_ = function doValueUpdate_(newValue) {
    _FieldDropdown.prototype.doValueUpdate_.call(this, newValue);

    this.updateData();
  };

  _proto.notifyServicesChanged = function notifyServicesChanged() {
    this.updateData();
  };

  return BuiltinDataSetField;
}(blockly__WEBPACK_IMPORTED_MODULE_0__.FieldDropdown);

BuiltinDataSetField.KEY = "jacdac_field_data_builtin_dataset";


/***/ }),

/***/ 16229:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ DataPreviewField; },
/* harmony export */   "q": function() { return /* binding */ addDataPreviewField; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(94578);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(67294);
/* harmony import */ var _ReactField__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(77576);
/* harmony import */ var _toolbox__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(16582);
/* harmony import */ var _ui_Suspense__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(6890);





var DataTablePreviewWidget = /*#__PURE__*/(0,react__WEBPACK_IMPORTED_MODULE_0__.lazy)(() => __webpack_require__.e(/* import() */ 6241).then(__webpack_require__.bind(__webpack_require__, 26241)));

// eslint-disable-next-line @typescript-eslint/no-explicit-any
var DataPreviewField = /*#__PURE__*/function (_ReactField) {
  (0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(DataPreviewField, _ReactField);

  DataPreviewField.fromJson = function fromJson(options) {
    return new DataPreviewField(options === null || options === void 0 ? void 0 : options.value, undefined, options);
  } // the first argument is a dummy and never used
  // eslint-disable-next-line @typescript-eslint/no-explicit-any
  ;

  function DataPreviewField(value, validator, options) {
    var _this;

    _this = _ReactField.call(this, value, validator, options) || this;
    _this.compare = !!(options !== null && options !== void 0 && options.compare);
    return _this;
  }

  var _proto = DataPreviewField.prototype;

  _proto.initCustomView = function initCustomView() {
    var group = this.fieldGroup_;
    group.classList.add("blocklyFieldButton");
    return undefined;
  };

  _proto.getText_ = function getText_() {
    return "👀";
  };

  _proto.renderField = function renderField() {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ui_Suspense__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(DataTablePreviewWidget, {
      compare: this.compare
    }));
  };

  return DataPreviewField;
}(_ReactField__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .ZP);

DataPreviewField.KEY = "jacdac_field_data_preview";

function addDataPreviewField(block) {
  var preview = block === null || block === void 0 ? void 0 : block.dataPreviewField;

  if (preview) {
    // don't add twice
    block.dataPreviewField = false; // parse args and add one more arg

    var {
      message0
    } = block;
    var i = message0.lastIndexOf("%");
    var index = parseInt(message0.substr(i + 1)) || 0;
    block.message0 += " %" + (index + 1); // does this mutate the data?

    var identity = preview === "after" || block.transformData === _toolbox__WEBPACK_IMPORTED_MODULE_2__/* .identityTransformData */ .FW; // add field

    block.args0.push({
      type: DataPreviewField.KEY,
      name: "preview",
      compare: !identity
    });
  }

  return block;
}

/***/ }),

/***/ 54741:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ DataTableField; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(94578);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(67294);
/* harmony import */ var _ReactInlineField__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(12702);
/* harmony import */ var _DataTableWidget__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(11472);
/* harmony import */ var _toolbox__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(16582);





var MAX_ITEMS = 256;

var DataTableField = /*#__PURE__*/function (_ReactInlineField) {
  (0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(DataTableField, _ReactInlineField);

  DataTableField.fromJson = function fromJson(options) {
    return new DataTableField(options);
  } // eslint-disable-next-line @typescript-eslint/no-explicit-any
  ;

  function DataTableField(options) {
    var _this;

    _this = _ReactInlineField.call(this, options) || this;
    _this.EDITABLE = false;
    _this.transformed = !!(options !== null && options !== void 0 && options.transformed);
    _this.small = !!(options !== null && options !== void 0 && options.small);
    _this.selectColumns = !!(options !== null && options !== void 0 && options.selectColumns);
    return _this;
  }

  var _proto = DataTableField.prototype;

  _proto.createContainer = function createContainer() {
    var c = document.createElement("div");
    c.style.display = "block";
    c.style.minWidth = "388px";
    c.style.maxWidth = "80vh";
    c.style.maxHeight = "60vh";
    return c;
  };

  _proto.renderInlineField = function renderInlineField() {
    var tableHeight = this.small ? _toolbox__WEBPACK_IMPORTED_MODULE_3__/* .SMALL_TABLE_HEIGHT */ .IP : undefined;
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_DataTableWidget__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z, {
      maxItems: MAX_ITEMS,
      tableHeight: tableHeight,
      transformed: this.transformed,
      selectColumns: this.selectColumns
    });
  };

  return DataTableField;
}(_ReactInlineField__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z);

DataTableField.KEY = "jacdac_field_data_table";


/***/ }),

/***/ 11472:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ DataTableWidget; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(15861);
/* harmony import */ var _babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(15785);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(67294);
/* harmony import */ var _mui_material_styles__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(98348);
/* harmony import */ var _WorkspaceContext__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(89801);
/* harmony import */ var _useBlockData__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(53851);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(4320);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(49308);
/* harmony import */ var _toolbox__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(16582);
/* harmony import */ var _PointerBoundary__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(77298);
/* harmony import */ var _ui_CopyButton__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(18568);
/* harmony import */ var _dsl_workers_csv_proxy__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(53480);
/* harmony import */ var _jacdac_ts_src_jdom_utils__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(81794);
/* harmony import */ var _tidy__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(47554);
/* harmony import */ var _jacdac_ts_jacdac_spec_spectool_jdspec__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(13996);














var PREFIX = "DataTableWidget";
var classes = {
  empty: PREFIX + "-empty",
  button: PREFIX + "-button",
  root: PREFIX + "-root",
  table: PREFIX + "-table"
}; // TODO jss-to-styled codemod: The Fragment root was replaced by div. Change the tag if needed.

var Root = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .ZP)("div")(() => ({
  background: "#fff",
  ["& ." + classes.empty]: {
    paddingLeft: "0.5rem",
    paddingRight: "0.5rem",
    color: "#000",
    borderRadius: "0.25rem"
  },
  ["& ." + classes.button]: {
    color: "grey"
  },
  ["& ." + classes.root]: props => ({
    marginTop: "0.25rem",
    paddingLeft: "0.5rem",
    paddingRight: "0.5rem",
    background: "#fff",
    color: "#000",
    borderRadius: "0.25rem",
    width: "calc(" + _toolbox__WEBPACK_IMPORTED_MODULE_3__/* .TABLE_WIDTH */ .KH + "px - 0.25rem)",
    height: "calc(" + props.tableHeight + "px - 0.25rem)",
    overflow: "auto"
  }),
  ["& ." + classes.table]: {
    margin: 0,
    fontSize: "0.8rem",
    lineHeight: "1rem",
    "& th, td": {
      backgroundClip: "padding-box",
      scrollSnapAlign: "start"
    },
    "& th": {
      position: "sticky",
      top: 0
    },
    "& td": {
      borderColor: "#ccc",
      borderRightStyle: "solid 1px"
    }
  }
}));
function DataTableWidget(props) {
  var {
    label,
    transformed,
    tableHeight = _toolbox__WEBPACK_IMPORTED_MODULE_3__/* .TABLE_HEIGHT */ .U2,
    empty,
    maxItems,
    selectColumns
  } = props;
  var {
    sourceBlock
  } = (0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(_WorkspaceContext__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .ZP);
  var {
    data,
    transformedData
  } = (0,_useBlockData__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(sourceBlock);
  var raw = transformed ? transformedData : data;
  if (!(raw !== null && raw !== void 0 && raw.length)) return empty ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", {
    className: classes.empty
  }, empty) : null;
  var selectedColumns = selectColumns ? [0, 1, 2, 3].map(i => "column" + i).map(n => (0,_tidy__WEBPACK_IMPORTED_MODULE_8__/* .tidyResolveHeader */ .gc)(raw, sourceBlock === null || sourceBlock === void 0 ? void 0 : sourceBlock.getFieldValue(n))).filter(c => !!c) : [];
  var columns = selectedColumns.length ? selectedColumns : (0,_tidy__WEBPACK_IMPORTED_MODULE_8__/* .tidyHeaders */ .P2)(raw).headers;
  var table = raw.length > maxItems ? [].concat((0,_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z)(raw.slice(0, maxItems)), [(0,_jacdac_ts_src_jdom_utils__WEBPACK_IMPORTED_MODULE_7__/* .toMap */ .qL)(columns, c => c, () => "...")]) : raw; // console.log({
  //     raw,
  //     transformed,
  //     transformedData,
  //     data,
  //     table,
  //     selectedColumns,
  //     columns,
  // })
  // eslint-disable-next-line @typescript-eslint/no-explicit-any

  var renderCell = v => v === undefined ? "" : typeof v === "boolean" ? v ? "true" : "false" : typeof v === "number" ? (0,_jacdac_ts_src_jdom_utils__WEBPACK_IMPORTED_MODULE_7__/* .roundWithPrecision */ .JI)(v, 3) : v + "";

  var handleCopy = /*#__PURE__*/function () {
    var _ref = (0,_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z)(function* () {
      var text = (0,_dsl_workers_csv_proxy__WEBPACK_IMPORTED_MODULE_6__/* .unparseCSV */ .sh)(raw);
      return text;
    });

    return function handleCopy() {
      return _ref.apply(this, arguments);
    };
  }();

  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(Root, {
    sx: {
      height: tableHeight + "px - 0.25rem)"
    }
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_PointerBoundary__WEBPACK_IMPORTED_MODULE_4__/* .PointerBoundary */ .A, {
    className: classes.root
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .ZP, {
    container: true,
    direction: "column",
    spacing: 1
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .ZP, {
    item: true,
    xs: 12
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .ZP, {
    container: true,
    direction: "row",
    justifyContent: "flex-start",
    alignItems: "center",
    spacing: 1
  }, label && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .ZP, {
    item: true
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z, {
    variant: "h6"
  }, label)), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .ZP, {
    item: true
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ui_CopyButton__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z, {
    size: "small",
    className: classes.button,
    onCopy: handleCopy
  })), raw.length > 1 && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .ZP, {
    item: true
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z, {
    variant: "caption"
  }, raw.length, " rows x ", columns.length, " ", "columns")))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .ZP, {
    item: true,
    xs: 12
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("table", {
    className: classes.table
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("thead", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", null, columns.map(c => /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("th", {
    key: c
  }, (0,_jacdac_ts_jacdac_spec_spectool_jdspec__WEBPACK_IMPORTED_MODULE_9__/* .humanify */ .lW)(c))))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tbody", null, table.map((r, i) => /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", {
    key: r.id || i
  }, columns.map(c => /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", {
    key: c
  }, renderCell(r[c])))))))))));
}

/***/ }),

/***/ 39311:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ FileOpenField; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(15861);
/* harmony import */ var _babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(15785);
/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(94578);
/* harmony import */ var blockly__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(74640);
/* harmony import */ var blockly__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(blockly__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _jacdac_ts_src_jdom_constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(71815);
/* harmony import */ var _dsl_workers_csv_proxy__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(53480);
/* harmony import */ var _WorkspaceContext__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(89801);




/* eslint-disable @typescript-eslint/no-explicit-any */





var FileOpenField = /*#__PURE__*/function (_FieldDropdown) {
  (0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(FileOpenField, _FieldDropdown);

  FileOpenField.fromJson = function fromJson(options) {
    return new FileOpenField(options);
  };

  function FileOpenField(options) {
    var _this;

    _this = _FieldDropdown.call(this, () => [["", ""]], undefined, options) || this;
    _this.SERIALIZABLE = true;
    return _this;
  }

  var _proto = FileOpenField.prototype;

  _proto.fromXml = function fromXml(fieldElement) {
    this.setValue(fieldElement.textContent);
  };

  _proto.getOptions = function getOptions() {
    var _this$resolveFiles;

    var options = ((_this$resolveFiles = this.resolveFiles()) === null || _this$resolveFiles === void 0 ? void 0 : _this$resolveFiles.map(f => [f.name, f.name])) || [];
    var value = this.getValue();
    return options.length < 1 ? [[value || "", value || ""]] : [].concat((0,_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(options), [["", ""]]);
  };

  _proto.doClassValidation_ = function doClassValidation_(newValue) {
    // skip super class validationervices chan
    return newValue;
  };

  _proto.init = function init() {
    _FieldDropdown.prototype.init.call(this);

    this.updateData();
  };

  _proto.setSourceBlock = function setSourceBlock(block) {
    _FieldDropdown.prototype.setSourceBlock.call(this, block);

    this.updateData();
  };

  _proto.doValueUpdate_ = function doValueUpdate_(newValue) {
    _FieldDropdown.prototype.doValueUpdate_.call(this, newValue);

    this.parseSource();
  };

  _proto.notifyServicesChanged = function notifyServicesChanged() {
    this.updateData();
  };

  _proto.dispose = function dispose() {
    _FieldDropdown.prototype.dispose.call(this);

    this.unmount();
  };

  _proto.resolveFiles = function resolveFiles() {
    var sourceBlock = this.getSourceBlock();
    var services = (0,_WorkspaceContext__WEBPACK_IMPORTED_MODULE_3__/* .resolveWorkspaceServices */ .O7)(sourceBlock === null || sourceBlock === void 0 ? void 0 : sourceBlock.workspace);
    var directory = services === null || services === void 0 ? void 0 : services.workingDirectory;
    return directory === null || directory === void 0 ? void 0 : directory.files.filter(f => /\.csv$/i.test(f.name));
  };

  _proto.parseSource = /*#__PURE__*/function () {
    var _parseSource = (0,_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(function* () {
      var _this$resolveFiles2;

      var filename = this.getValue();
      var file = (_this$resolveFiles2 = this.resolveFiles()) === null || _this$resolveFiles2 === void 0 ? void 0 : _this$resolveFiles2.find(f => f.name === filename);

      if (file) {
        try {
          console.debug("file: loading " + file.name);
          var source = yield file.textAsync();
          console.debug("file: loaded " + ((source === null || source === void 0 ? void 0 : source.length) || 0) / 1024 + "kb");

          if (source) {
            var csv = yield (0,_dsl_workers_csv_proxy__WEBPACK_IMPORTED_MODULE_2__/* .parseCSV */ .bW)(source);
            this._data = csv === null || csv === void 0 ? void 0 : csv.data;
            this.updateData();
          }
        } catch (e) {
          console.log(e);
          this.value_ = undefined;
        }
      }
    });

    function parseSource() {
      return _parseSource.apply(this, arguments);
    }

    return parseSource;
  }();

  _proto.updateData = /*#__PURE__*/function () {
    var _updateData = (0,_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(function* () {
      var sourceBlock = this.getSourceBlock(); // update current data

      var blockServices = (0,_WorkspaceContext__WEBPACK_IMPORTED_MODULE_3__/* .resolveBlockServices */ .Ys)(sourceBlock);
      if (blockServices) blockServices.data = this._data; // register file system changes

      this.unmount();
      var wsServices = (0,_WorkspaceContext__WEBPACK_IMPORTED_MODULE_3__/* .resolveWorkspaceServices */ .O7)(sourceBlock === null || sourceBlock === void 0 ? void 0 : sourceBlock.workspace);

      if (wsServices) {
        var {
          workingDirectory
        } = wsServices;
        this._unmount = workingDirectory === null || workingDirectory === void 0 ? void 0 : workingDirectory.subscribe(_jacdac_ts_src_jdom_constants__WEBPACK_IMPORTED_MODULE_1__/* .CHANGE */ .Ver, () => this.updateData());
      }
    });

    function updateData() {
      return _updateData.apply(this, arguments);
    }

    return updateData;
  }();

  _proto.unmount = function unmount() {
    if (this._unmount) {
      this._unmount();

      this._unmount = undefined;
    }
  };

  return FileOpenField;
}(blockly__WEBPACK_IMPORTED_MODULE_0__.FieldDropdown);

FileOpenField.KEY = "jacdac_field_file_open";


/***/ }),

/***/ 4383:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ FileSaveField; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(15861);
/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(94578);
/* harmony import */ var blockly__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(74640);
/* harmony import */ var blockly__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(blockly__WEBPACK_IMPORTED_MODULE_0__);



/* eslint-disable @typescript-eslint/no-explicit-any */


var FileSaveField = /*#__PURE__*/function (_Field) {
  (0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z)(FileSaveField, _Field);

  function FileSaveField(options) {
    var _this;

    _this = _Field.call(this, "...", null, options) || this;
    _this.SERIALIZABLE = true;
    _this.fileType = (options === null || options === void 0 ? void 0 : options.fileType) || "csv";
    return _this;
  }

  FileSaveField.fromJson = function fromJson(options) {
    return new FileSaveField(options);
  };

  var _proto = FileSaveField.prototype;

  _proto.showEditor_ = function showEditor_() {
    this.openFileHandle();
  };

  _proto.openFileHandle = /*#__PURE__*/function () {
    var _openFileHandle = (0,_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(function* () {
      var _window$showSaveFileP, _window, _this$fileHandle;

      var options = {
        types: [{
          id: "text",
          description: "Text Files",
          accept: {
            "text/plain": [".txt"]
          }
        }, {
          id: "csv",
          description: "CSV Files",
          accept: {
            "text/csv": [".csv"]
          }
        }, {
          id: "json",
          description: "JSON Files",
          accept: {
            "application/json": [".json"]
          }
        }].filter(_ref => {
          var {
            id
          } = _ref;
          return this.fileType === id;
        }),
        excludeAcceptAllOption: true
      };
      this.fileHandle = yield (_window$showSaveFileP = (_window = window).showSaveFilePicker) === null || _window$showSaveFileP === void 0 ? void 0 : _window$showSaveFileP.call(_window, options);
      this.setValue(((_this$fileHandle = this.fileHandle) === null || _this$fileHandle === void 0 ? void 0 : _this$fileHandle.name) || "");
    });

    function openFileHandle() {
      return _openFileHandle.apply(this, arguments);
    }

    return openFileHandle;
  }();

  return FileSaveField;
}(blockly__WEBPACK_IMPORTED_MODULE_0__.Field);

FileSaveField.KEY = "jacdac_field_file_save";


/***/ }),

/***/ 61162:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ GaugeWidgetField; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(94578);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(67294);
/* harmony import */ var _WorkspaceContext__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(89801);
/* harmony import */ var _ReactInlineField__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(12702);
/* harmony import */ var _useBlockData__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(53851);
/* harmony import */ var _ui_Suspense__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(6890);
/* harmony import */ var _tidy__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(47554);
/* harmony import */ var _tidyjs_tidy__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(86388);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(4320);
/* harmony import */ var _jacdac_ts_src_jdom_utils__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(81794);










var GaugeWidget = /*#__PURE__*/(0,react__WEBPACK_IMPORTED_MODULE_0__.lazy)(() => Promise.resolve(/* import() */).then(__webpack_require__.bind(__webpack_require__, 10719)));

function GaugeWidgetView() {
  var {
    sourceBlock
  } = (0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(_WorkspaceContext__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .ZP); // eslint-disable-next-line @typescript-eslint/no-explicit-any

  var {
    data
  } = (0,_useBlockData__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)(sourceBlock);
  if (!(data !== null && data !== void 0 && data.length)) return null;
  var field = sourceBlock === null || sourceBlock === void 0 ? void 0 : sourceBlock.getFieldValue("field");
  var value = (0,_tidy__WEBPACK_IMPORTED_MODULE_5__/* .tidyFindLastValue */ .pc)(data, field);
  if (value === undefined) return null;
  var min = Number(sourceBlock === null || sourceBlock === void 0 ? void 0 : sourceBlock.getFieldValue("min"));
  var max = Number(sourceBlock === null || sourceBlock === void 0 ? void 0 : sourceBlock.getFieldValue("max"));

  if (min === max) {
    min = undefined;
    max = undefined;
  }

  if (isNaN(min)) min = (0,_tidyjs_tidy__WEBPACK_IMPORTED_MODULE_6__/* .tidy */ .lu)(data, (0,_tidyjs_tidy__WEBPACK_IMPORTED_MODULE_6__/* .summarize */ .Iz)({
    min: (0,_tidyjs_tidy__WEBPACK_IMPORTED_MODULE_6__/* .min */ .VV)(field)
  }))[0].min;
  if (isNaN(max)) max = (0,_tidyjs_tidy__WEBPACK_IMPORTED_MODULE_6__/* .tidy */ .lu)(data, (0,_tidyjs_tidy__WEBPACK_IMPORTED_MODULE_6__/* .summarize */ .Iz)({
    max: (0,_tidyjs_tidy__WEBPACK_IMPORTED_MODULE_6__/* .max */ .Fp)(field)
  }))[0].max; // round with precision

  var step = Math.ceil(Math.abs(value)) / 10;
  var precision = step < 1 ? Math.ceil(-Math.log10(step)) : 0;
  value = (0,_jacdac_ts_src_jdom_utils__WEBPACK_IMPORTED_MODULE_7__/* .roundWithPrecision */ .JI)(value, precision); // clamp values

  value = Math.min(max, Math.max(min, value));
  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .ZP, {
    container: true,
    justifyContent: "center",
    alignContent: "center",
    alignItems: "center"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .ZP, {
    item: true
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ui_Suspense__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(GaugeWidget, {
    value: value,
    min: min,
    max: max
  }))));
}

var GaugeWidgetField = /*#__PURE__*/function (_ReactInlineField) {
  (0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(GaugeWidgetField, _ReactInlineField);

  GaugeWidgetField.fromJson = function fromJson(options) {
    return new GaugeWidgetField(options);
  };

  var _proto = GaugeWidgetField.prototype;

  _proto.createContainer = function createContainer() {
    var c = document.createElement("div");
    c.style.width = "20rem";
    return c;
  } // eslint-disable-next-line @typescript-eslint/no-explicit-any
  ;

  function GaugeWidgetField(options) {
    var _this;

    _this = _ReactInlineField.call(this, options) || this;
    _this.EDITABLE = false;
    return _this;
  }

  _proto.renderInlineField = function renderInlineField() {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(GaugeWidgetView, null);
  };

  return GaugeWidgetField;
}(_ReactInlineField__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z);

GaugeWidgetField.KEY = "jacdac_field_gauge_widget";


/***/ }),

/***/ 84152:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "e": function() { return /* binding */ AllOptions; },
/* harmony export */   "Z": function() { return /* binding */ IFrameDataChooserField; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(94578);
/* harmony import */ var blockly__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(74640);
/* harmony import */ var blockly__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(blockly__WEBPACK_IMPORTED_MODULE_0__);


var AllOptions = {};

var IFrameDataChooserField = /*#__PURE__*/function (_FieldDropdown) {
  (0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z)(IFrameDataChooserField, _FieldDropdown);

  IFrameDataChooserField.fromJson = function fromJson(options) {
    return new IFrameDataChooserField(options);
  } // eslint-disable-next-line @typescript-eslint/no-explicit-any
  // the first argument is a dummy and never used
  ;

  function IFrameDataChooserField(options) {
    var _this;

    _this = _FieldDropdown.call(this, () => [["", ""]], undefined, options) || this;
    _this.SERIALIZABLE = true;
    _this.dataId = options.dataId || "";
    return _this;
  }

  var _proto = IFrameDataChooserField.prototype;

  _proto.fromXml = function fromXml(fieldElement) {
    this.setValue(fieldElement.textContent);
  };

  _proto.getOptions = function getOptions() {
    var _AllOptions$this$data;

    var options = (_AllOptions$this$data = AllOptions[this.dataId]) === null || _AllOptions$this$data === void 0 ? void 0 : _AllOptions$this$data.slice(0);
    return !(options !== null && options !== void 0 && options.length) ? [["", ""]] : options;
  };

  _proto.doClassValidation_ = function doClassValidation_(newValue) {
    // skip super class validationervices chan
    return newValue;
  };

  return IFrameDataChooserField;
}(blockly__WEBPACK_IMPORTED_MODULE_0__.FieldDropdown);

IFrameDataChooserField.KEY = "jacdac_field_iframe_data_chooser";


/***/ }),

/***/ 90263:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ JDomTreeField; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(94578);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(67294);
/* harmony import */ var _WorkspaceContext__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(89801);
/* harmony import */ var _ReactInlineField__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(12702);
/* harmony import */ var _ui_Suspense__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(6890);
/* harmony import */ var _NoServiceAlert__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(42825);






var JDomServiceTreeView = /*#__PURE__*/(0,react__WEBPACK_IMPORTED_MODULE_0__.lazy)(() => Promise.all(/* import() */[__webpack_require__.e(317), __webpack_require__.e(272)]).then(__webpack_require__.bind(__webpack_require__, 60272)));

function JDomTreeWidget() {
  var {
    twinService,
    flyout
  } = (0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(_WorkspaceContext__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .ZP);

  var onPointerStopPropagation = event => {
    // make sure blockly does not handle drags when interacting with UI
    event.stopPropagation();
  };

  if (flyout) return null;
  if (!twinService) return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_NoServiceAlert__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z, null);
  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
    style: {
      minWidth: "12rem",
      cursor: "inherit"
    },
    onPointerDown: onPointerStopPropagation,
    onPointerUp: onPointerStopPropagation,
    onPointerMove: onPointerStopPropagation
  }, twinService && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ui_Suspense__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(JDomServiceTreeView, {
    service: twinService,
    defaultExpanded: [twinService.id]
  })));
}

var JDomTreeField = /*#__PURE__*/function (_ReactInlineField) {
  (0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(JDomTreeField, _ReactInlineField);

  JDomTreeField.fromJson = function fromJson(options) {
    return new JDomTreeField(options);
  } // eslint-disable-next-line @typescript-eslint/no-explicit-any
  ;

  function JDomTreeField(options) {
    var _this;

    _this = _ReactInlineField.call(this, options) || this;
    _this.EDITABLE = false;
    return _this;
  }

  var _proto = JDomTreeField.prototype;

  _proto.renderInlineField = function renderInlineField() {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(JDomTreeWidget, null);
  };

  return JDomTreeField;
}(_ReactInlineField__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z);

JDomTreeField.KEY = "jacdac_field_jdom_service_tree";


/***/ }),

/***/ 68494:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ JSONSettingsField; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(43144);
/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(94578);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(67294);
/* harmony import */ var _ReactField__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(77576);
/* harmony import */ var _ui_Suspense__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(6890);
/* harmony import */ var _jacdac_ts_src_jdom_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(81794);



/* eslint-disable @typescript-eslint/no-explicit-any */

/* eslint-disable @typescript-eslint/ban-types */




var JSONSchemaForm = /*#__PURE__*/(0,react__WEBPACK_IMPORTED_MODULE_0__.lazy)(() => __webpack_require__.e(/* import() */ 2184).then(__webpack_require__.bind(__webpack_require__, 12184)));

function JSONSettingsWidget(props) {
  var {
    schema,
    value,
    setValue,
    events
  } = props;
  var {
    0: editValue,
    1: setEditValue
  } = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(value);
  (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => events.subscribe(_ReactField__WEBPACK_IMPORTED_MODULE_1__/* .UNMOUNT */ .lo, () => setValue(editValue)), [editValue]);
  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
    style: {
      maxWidth: "22rem",
      minHeight: "20rem",
      padding: "0.5rem"
    }
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ui_Suspense__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(JSONSchemaForm, {
    schema: schema,
    value: editValue,
    setValue: setEditValue
  })));
} // eslint-disable-next-line @typescript-eslint/no-explicit-any


var JSONSettingsField = /*#__PURE__*/function (_ReactField) {
  (0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(JSONSettingsField, _ReactField);

  JSONSettingsField.fromJson = function fromJson(options) {
    return new JSONSettingsField(options === null || options === void 0 ? void 0 : options.value, undefined, options);
  } // the first argument is a dummy and never used
  ;

  function JSONSettingsField(value, validator, options) {
    var _this;

    _this = _ReactField.call(this, value, validator, options) || this;
    _this.SERIALIZABLE = true;
    _this.schema = (options === null || options === void 0 ? void 0 : options.schema) || {};
    _this.darkMode = "light";
    (0,_jacdac_ts_src_jdom_utils__WEBPACK_IMPORTED_MODULE_3__/* .assert */ .hu)(!!_this.schema, "schema missing");
    return _this;
  }

  var _proto = JSONSettingsField.prototype;

  _proto.initCustomView = function initCustomView() {
    var group = this.fieldGroup_;
    group.classList.add("blocklyFieldButton");
    return undefined;
  };

  _proto.getText_ = function getText_() {
    return "⚙️";
  };

  _proto.renderField = function renderField() {
    var {
      schema,
      value = {},
      events
    } = this;

    var setValue = v => this.value = v;

    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(JSONSettingsWidget, {
      schema: schema,
      value: value,
      events: events,
      setValue: setValue
    });
  };

  (0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(JSONSettingsField, [{
    key: "defaultValue",
    get: function get() {
      return {};
    }
  }]);

  return JSONSettingsField;
}(_ReactField__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .ZP);

JSONSettingsField.KEY = "jacdac_field_json_settings";


/***/ }),

/***/ 90422:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ KeyboardKeyField; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(43144);
/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(94578);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(67294);
/* harmony import */ var _ReactField__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(77576);
/* harmony import */ var _ui_Suspense__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(6890);
/* harmony import */ var _jacdac_ts_src_servers_hidkeyboardserver__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(41577);






var KeyboardKeyInput = /*#__PURE__*/(0,react__WEBPACK_IMPORTED_MODULE_0__.lazy)(() => Promise.all(/* import() */[__webpack_require__.e(532), __webpack_require__.e(7919), __webpack_require__.e(6753)]).then(__webpack_require__.bind(__webpack_require__, 82860)));

var KeyboardKeyField = /*#__PURE__*/function (_ReactField) {
  (0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(KeyboardKeyField, _ReactField);

  function KeyboardKeyField() {
    return _ReactField.apply(this, arguments) || this;
  }

  KeyboardKeyField.fromJson = function fromJson(options) {
    return new KeyboardKeyField(options === null || options === void 0 ? void 0 : options.value, undefined, options);
  };

  var _proto = KeyboardKeyField.prototype;

  _proto.getText_ = function getText_() {
    var {
      selector,
      modifiers
    } = this.value;
    return (0,_jacdac_ts_src_servers_hidkeyboardserver__WEBPACK_IMPORTED_MODULE_3__/* .renderKeyboardKey */ .OJ)(selector, modifiers, true);
  };

  _proto.renderField = function renderField() {
    var {
      selector,
      modifiers
    } = this.value;

    var handleChange = (newSelector, newModifiers) => {
      this.value = {
        selector: newSelector,
        modifiers: newModifiers
      };
    };

    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ui_Suspense__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(KeyboardKeyInput, {
      initialSelector: selector,
      initialModifiers: modifiers,
      onChange: handleChange
    }));
  };

  (0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(KeyboardKeyField, [{
    key: "defaultValue",
    get: function get() {
      return {
        selector: 4,
        modifiers: 0
      };
    }
  }]);

  return KeyboardKeyField;
}(_ReactField__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .ZP);

KeyboardKeyField.KEY = "jacdac_field_keyboard_key";


/***/ }),

/***/ 68514:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ LEDColorField; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(94578);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(67294);
/* harmony import */ var _ui_Suspense__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(6890);
/* harmony import */ var _ReactField__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(77576);
/* harmony import */ var _jacdac_ts_src_jdom_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(81794);
/* harmony import */ var _widgets_svg__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(41173);
/* harmony import */ var _ValueContext__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(86415);







var LEDWidget = /*#__PURE__*/(0,react__WEBPACK_IMPORTED_MODULE_0__.lazy)(() => __webpack_require__.e(/* import() */ 317).then(__webpack_require__.bind(__webpack_require__, 56931)));

function LEDColorFieldWidget() {
  var {
    value,
    onValueChange
  } = (0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(_ValueContext__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .ZP);
  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ui_Suspense__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(LEDWidget, {
    ledColor: value,
    onLedColorChange: onValueChange,
    ledCount: 3,
    color: "secondary"
  }));
}

var LEDColorField = /*#__PURE__*/function (_ReactField) {
  (0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(LEDColorField, _ReactField);

  LEDColorField.fromJson = function fromJson(options) {
    return new LEDColorField(options);
  } // eslint-disable-next-line @typescript-eslint/no-explicit-any
  ;

  function LEDColorField(options) {
    return _ReactField.call(this, options === null || options === void 0 ? void 0 : options.value, undefined, options, {
      width: 28,
      height: 28
    }) || this;
  }

  var _proto = LEDColorField.prototype;

  _proto.initCustomView = function initCustomView() {
    var {
      width
    } = this.size_;
    var r = width >> 1;
    return (0,_widgets_svg__WEBPACK_IMPORTED_MODULE_6__/* .child */ .iU)(this.fieldGroup_, "circle", {
      r: width >> 1,
      cx: r,
      cy: r,
      strokeWidth: 2,
      stroke: "#777"
    });
  };

  _proto.updateView = function updateView() {
    var c = (0,_jacdac_ts_src_jdom_utils__WEBPACK_IMPORTED_MODULE_3__/* .rgbToHtmlColor */ .b)(this.value);
    var circle = this.view;

    if (c) {
      circle === null || circle === void 0 ? void 0 : circle.setAttribute("fill", c);
    }
  };

  _proto.getText_ = function getText_() {
    return (0,_jacdac_ts_src_jdom_utils__WEBPACK_IMPORTED_MODULE_3__/* .rgbToHtmlColor */ .b)(this.value);
  };

  _proto.renderField = function renderField() {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(LEDColorFieldWidget, null);
  };

  return LEDColorField;
}(_ReactField__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .ZP);

LEDColorField.KEY = "jacdac_field_led_color";
LEDColorField.SHADOW = (0,_ReactField__WEBPACK_IMPORTED_MODULE_2__/* .toShadowDefinition */ ._t)(LEDColorField);


/***/ }),

/***/ 11772:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";

// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  "Z": function() { return /* binding */ LEDMatrixField; }
});

// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/createClass.js
var createClass = __webpack_require__(43144);
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js
var inheritsLoose = __webpack_require__(94578);
// EXTERNAL MODULE: ./node_modules/react/index.js
var react = __webpack_require__(67294);
// EXTERNAL MODULE: ./jacdac-ts/src/jdom/utils.ts
var utils = __webpack_require__(81794);
// EXTERNAL MODULE: ./src/components/ui/Suspense.tsx + 2 modules
var Suspense = __webpack_require__(6890);
// EXTERNAL MODULE: ./src/components/blockly/fields/ReactField.tsx
var ReactField = __webpack_require__(77576);
// EXTERNAL MODULE: ./src/components/widgets/svg.ts
var svg = __webpack_require__(41173);
// EXTERNAL MODULE: ./node_modules/blockly/index.js
var blockly = __webpack_require__(74640);
;// CONCATENATED MODULE: ./src/components/blockly/fields/ReactImageField.tsx





var ReactImageField = /*#__PURE__*/function (_ReactField) {
  (0,inheritsLoose/* default */.Z)(ReactImageField, _ReactField);

  function ReactImageField(value, width, height) {
    if (width === void 0) {
      width = 32;
    }

    if (height === void 0) {
      height = 32;
    }

    return _ReactField.call(this, value, undefined, undefined, {
      width,
      height
    }) || this;
  }

  var _proto = ReactImageField.prototype;

  _proto.setSize = function setSize(width, height) {
    this.size_ = new blockly.utils.Size(width, height);
    var img = this.view;

    if (img) {
      img.setAttribute("width", width + "");
      img.setAttribute("height", height + "");
    }
  };

  _proto.updateView = function updateView() {
    var imgUri = this.renderValue();
    var img = this.view;

    if (imgUri) {
      img === null || img === void 0 ? void 0 : img.setAttributeNS("http://www.w3.org/1999/xlink", "xlink:href", imgUri);
      img === null || img === void 0 ? void 0 : img.setAttribute("alt", this.getText());
    }
  }
  /**
   * Renders the value to a data uri string
   */
  ;

  _proto.renderValue = function renderValue() {
    return undefined;
  };

  _proto.initCustomView = function initCustomView() {
    var {
      width,
      height
    } = this.size_;
    return (0,svg/* child */.iU)(this.fieldGroup_, "image", {
      height,
      width,
      alt: this.getText()
    });
  };

  return ReactImageField;
}(ReactField/* default */.ZP);


;// CONCATENATED MODULE: ./src/components/blockly/fields/LEDMatrixField.tsx







var LEDMatrixWidget = /*#__PURE__*/(0,react.lazy)(() => __webpack_require__.e(/* import() */ 317).then(__webpack_require__.bind(__webpack_require__, 71598)));

var LEDMatrixField = /*#__PURE__*/function (_ReactImageField) {
  (0,inheritsLoose/* default */.Z)(LEDMatrixField, _ReactImageField);

  function LEDMatrixField(value) {
    var _this;

    _this = _ReactImageField.call(this, value) || this;

    _this.events.on(ReactField/* VALUE_CHANGE */.Z8, () => {
      var {
        rows,
        columns
      } = _this.value;

      _this.setSize(32, 32 / columns * rows);
    });

    return _this;
  }

  LEDMatrixField.fromJson = function fromJson(options) {
    return new LEDMatrixField(options === null || options === void 0 ? void 0 : options.value);
  };

  var _proto = LEDMatrixField.prototype;

  _proto.getText_ = function getText_() {
    var {
      leds,
      rows,
      columns
    } = this.value;
    return leds + " (" + rows + "x" + columns + ")";
  };

  _proto.renderValue = function renderValue() {
    var {
      leds,
      rows,
      columns
    } = this.value; // render current state to LEDmatrix field

    var columnspadded = columns + (8 - columns % 8);
    var ledsBytes = (0,utils/* fromHex */.H_)(leds);
    var cvs = document.createElement("canvas");
    var b = 3;
    var pw = 8;
    var ph = 8;
    var w = rows * pw + (rows - 1) * b;
    var h = columns * ph + (columns - 1) * b;
    cvs.width = w + 2 * b;
    cvs.height = h + 2 * b;
    var ctx = cvs.getContext("2d");
    ctx.fillStyle = "#444";
    ctx.fillRect(b, b, w, h);
    ctx.fillStyle = "blue";

    for (var x = 0; x < columns; ++x) {
      for (var y = 0; y < rows; ++y) {
        var bitindex = y * columnspadded + x;
        var byte = ledsBytes[bitindex >> 3];
        var bit = bitindex % 8;
        var on = 1 === (byte >> bit & 1);
        ctx.fillStyle = on ? "#ffc400" : "#000";
        ctx.fillRect(x * (pw + b) + b, y * (ph + b) + b, pw, ph);
      }
    }

    var dataUri = cvs.toDataURL("image/png");
    return dataUri;
  };

  _proto.renderField = function renderField() {
    var {
      leds,
      rows,
      columns
    } = this.value;
    var ledsBytes = (0,utils/* fromHex */.H_)(leds);
    console.log("led bytes", {
      leds,
      ledsBytes
    });

    var onChange = newLeds => this.value = {
      leds: (0,utils/* toHex */.NC)(newLeds),
      rows,
      columns
    };

    return /*#__PURE__*/react.createElement(Suspense/* default */.Z, null, /*#__PURE__*/react.createElement(LEDMatrixWidget, {
      color: "secondary",
      brightness: 1,
      leds: ledsBytes,
      rows: rows,
      columns: columns,
      onChange: onChange
    }));
  };

  (0,createClass/* default */.Z)(LEDMatrixField, [{
    key: "defaultValue",
    get: function get() {
      return {
        leds: (0,utils/* toHex */.NC)(new Uint8Array(0)),
        rows: 5,
        columns: 5
      };
    }
  }]);

  return LEDMatrixField;
}(ReactImageField);

LEDMatrixField.KEY = "jacdac_field_led_matrix";


/***/ }),

/***/ 86899:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ LogViewField; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(94578);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(67294);
/* harmony import */ var _ui_Suspense__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(6890);
/* harmony import */ var _ReactInlineField__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(12702);




var LogViewWidget = /*#__PURE__*/(0,react__WEBPACK_IMPORTED_MODULE_0__.lazy)(() => __webpack_require__.e(/* import() */ 7124).then(__webpack_require__.bind(__webpack_require__, 27124)));

var LogViewField = /*#__PURE__*/function (_ReactInlineField) {
  (0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)(LogViewField, _ReactInlineField);

  LogViewField.fromJson = function fromJson(options) {
    return new LogViewField(options);
  } // eslint-disable-next-line @typescript-eslint/no-explicit-any
  ;

  function LogViewField(options) {
    var _this;

    _this = _ReactInlineField.call(this, options) || this;
    _this.EDITABLE = false;
    return _this;
  }

  var _proto = LogViewField.prototype;

  _proto.renderInlineField = function renderInlineField() {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ui_Suspense__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(LogViewWidget, null));
  };

  return LogViewField;
}(_ReactInlineField__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z);

LogViewField.KEY = "jacdac_field_log_view";


/***/ }),

/***/ 42825:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ NoServiceAlert; }
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(67294);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(66449);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(76968);
/* harmony import */ var _mui_icons_material_Add__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(63015);
/* harmony import */ var _jacdac_ts_src_servers_servers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(38116);
/* harmony import */ var _jacdac_Context__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(20392);
/* harmony import */ var _WorkspaceContext__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(89801);
/* harmony import */ var _jacdac_ts_src_jdom_spec__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(26799);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(79764);








function NoServiceAlert() {
  var {
    bus
  } = (0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(_jacdac_Context__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z);
  var {
    twinService,
    roleServiceClass,
    flyout
  } = (0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(_WorkspaceContext__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .ZP);
  var theme = (0,_mui_material__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)();
  var spec = (0,_jacdac_ts_src_jdom_spec__WEBPACK_IMPORTED_MODULE_4__/* .serviceSpecificationFromClassIdentifier */ .d5)(roleServiceClass);

  var handleStartSimulator = () => (0,_jacdac_ts_src_servers_servers__WEBPACK_IMPORTED_MODULE_1__/* .startServiceProviderFromServiceClass */ .V6)(bus, spec.classIdentifier); // nothing to do here


  if (twinService || flyout) return null; // unresolved, unknown service

  if (!twinService && !roleServiceClass) return null; // unknown spec

  if (!spec) return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z, {
    severity: "warning"
  }, "Unknown service");
  var {
    palette
  } = theme;
  var style = {
    color: palette.text.primary
  };
  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z, {
    variant: "outlined",
    color: "inherit",
    startIcon: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_icons_material_Add__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z, null),
    onClick: handleStartSimulator,
    style: style
  }, "start ", spec.name);
}

/***/ }),

/***/ 50585:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ NoteField; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(15861);
/* harmony import */ var _babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(43144);
/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(94578);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(67294);
/* harmony import */ var _ui_WebAudioContext__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(94564);
/* harmony import */ var _ui_Suspense__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(6890);
/* harmony import */ var _ReactField__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(77576);







var PianoWidget = /*#__PURE__*/(0,react__WEBPACK_IMPORTED_MODULE_0__.lazy)(() => Promise.all(/* import() */[__webpack_require__.e(532), __webpack_require__.e(317)]).then(__webpack_require__.bind(__webpack_require__, 28937)));

var NoteField = /*#__PURE__*/function (_ReactField) {
  (0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(NoteField, _ReactField);

  NoteField.fromJson = function fromJson(options) {
    return new NoteField(options);
  } // eslint-disable-next-line @typescript-eslint/no-explicit-any
  ;

  function NoteField(options) {
    return _ReactField.call(this, options === null || options === void 0 ? void 0 : options.value, undefined, options) || this;
  }

  var _proto = NoteField.prototype;

  _proto.getText_ = function getText_() {
    return (this.value | 0) + "";
  };

  _proto.renderField = function renderField() {
    var _this = this;

    var handlePlayTone = /*#__PURE__*/function () {
      var _ref = (0,_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(function* (newFrequency) {
        var _this$toneContext;

        _this.value = newFrequency;
        if (!_this.toneContext) _this.toneContext = (0,_ui_WebAudioContext__WEBPACK_IMPORTED_MODULE_1__/* .createToneContext */ .WW)();
        (_this$toneContext = _this.toneContext) === null || _this$toneContext === void 0 ? void 0 : _this$toneContext.playTone(newFrequency, 400, 0.5);
      });

      return function handlePlayTone(_x) {
        return _ref.apply(this, arguments);
      };
    }();

    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ui_Suspense__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(PianoWidget, {
      playTone: handlePlayTone
    }));
  };

  (0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(NoteField, [{
    key: "defaultValue",
    get: function get() {
      return 440;
    }
  }]);

  return NoteField;
}(_ReactField__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .ZP);

NoteField.KEY = "jacdac_field_note";
NoteField.SHADOW = (0,_ReactField__WEBPACK_IMPORTED_MODULE_3__/* .toShadowDefinition */ ._t)(NoteField);


/***/ }),

/***/ 77298:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "A": function() { return /* binding */ PointerBoundary; }
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(67294);
/* harmony import */ var _WorkspaceContext__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(89801);


function PointerBoundary(props) {
  var {
    dragging
  } = (0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(_WorkspaceContext__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .ZP);
  var {
    className,
    children
  } = props;

  var onPointerStopPropagation = event => {
    // make sure blockly does not handle drags when interacting with UI
    if (!dragging) event.stopPropagation();
  };

  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", {
    className: className,
    style: dragging ? undefined : {
      cursor: "inherit"
    },
    onPointerDown: dragging ? undefined : onPointerStopPropagation,
    onPointerUp: dragging ? undefined : onPointerStopPropagation,
    onPointerMove: dragging ? undefined : onPointerStopPropagation
  }, children);
}

/***/ }),

/***/ 77576:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z8": function() { return /* binding */ VALUE_CHANGE; },
/* harmony export */   "lo": function() { return /* binding */ UNMOUNT; },
/* harmony export */   "ZP": function() { return /* binding */ ReactField; },
/* harmony export */   "_t": function() { return /* binding */ toShadowDefinition; }
/* harmony export */ });
/* unused harmony exports SOURCE_BLOCK_CHANGE, MOUNT */
/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(94578);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(67294);
/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(73935);
/* harmony import */ var blockly__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(74640);
/* harmony import */ var blockly__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(blockly__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _jacdac_Provider__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(727);
/* harmony import */ var react_use_id_hook__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(19640);
/* harmony import */ var _ui_DarkModeProvider__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(7796);
/* harmony import */ var _ui_AppTheme__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(25853);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(39211);
/* harmony import */ var _jacdac_ts_src_jdom_utils__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(81794);
/* harmony import */ var _ValueContext__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(86415);
/* harmony import */ var _jacdac_ts_src_jdom_eventsource__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(45484);
/* harmony import */ var _jacdac_ts_src_jdom_constants__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(71815);
/* harmony import */ var _WorkspaceContext__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(89801);
/* harmony import */ var _ui_WebAudioContext__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(94564);
/* harmony import */ var _ReactFieldBase__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(34964);


/* eslint-disable @typescript-eslint/no-explicit-any */















var SOURCE_BLOCK_CHANGE = "sourceBlockChange";
var VALUE_CHANGE = "valueChange";
var MOUNT = "mount";
var UNMOUNT = "unmount";

var ReactField = /*#__PURE__*/function (_ReactFieldBase) {
  (0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(ReactField, _ReactFieldBase);

  function ReactField() {
    var _this;

    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    _this = _ReactFieldBase.call.apply(_ReactFieldBase, [this].concat(args)) || this;
    _this.SERIALIZABLE = true;
    _this.events = new _jacdac_ts_src_jdom_eventsource__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .ZP();
    _this.darkMode = "dark";
    return _this;
  }

  var _proto = ReactField.prototype;

  // override to support custom view
  _proto.initCustomView = function initCustomView() {
    return null;
  } // override to update view
  ;

  _proto.updateView = function updateView() {};

  _proto.getText_ = function getText_() {
    return JSON.stringify(this.value);
  };

  _proto.toXml = function toXml(fieldElement) {
    fieldElement.textContent = JSON.stringify(this.value);
    return fieldElement;
  };

  _proto.fromXml = function fromXml(fieldElement) {
    try {
      var v = JSON.parse(fieldElement.textContent);
      this.value = v;
    } catch (e) {
      console.log(e, {
        text: fieldElement.textContent
      });
      this.value = undefined;
    }
  };

  _proto.emitChange = function emitChange() {
    this.events.emit(_jacdac_ts_src_jdom_constants__WEBPACK_IMPORTED_MODULE_10__/* .CHANGE */ .Ver);
  };

  _proto.setSourceBlock = function setSourceBlock(block) {
    var changed = block !== this.sourceBlock_;

    _ReactFieldBase.prototype.setSourceBlock.call(this, block);

    if (changed && !(block !== null && block !== void 0 && block.isInsertionMarker())) {
      var bs = block;

      if (!bs.jacdacServices) {
        var _bs$inputList;

        bs.jacdacServices = new _WorkspaceContext__WEBPACK_IMPORTED_MODULE_11__/* .BlockServices */ .LL();
        (_bs$inputList = bs.inputList) === null || _bs$inputList === void 0 ? void 0 : _bs$inputList.forEach(i => {
          var _i$fieldRow;

          return (_i$fieldRow = i.fieldRow) === null || _i$fieldRow === void 0 ? void 0 : _i$fieldRow.forEach(f => {
            var _notifyServicesChange, _ref;

            return (_notifyServicesChange = (_ref = f).notifyServicesChanged) === null || _notifyServicesChange === void 0 ? void 0 : _notifyServicesChange.call(_ref);
          });
        });
      }

      this.events.emit(SOURCE_BLOCK_CHANGE, block);
      this.emitChange();
    }
  };

  _proto.initView = function initView() {
    this.view = this.initCustomView();
    if (this.view) this.updateView();else _ReactFieldBase.prototype.initView.call(this);
  };

  _proto.updateSize_ = function updateSize_() {
    if (!this.view) _ReactFieldBase.prototype.updateSize_.call(this);
  };

  _proto.doValueUpdate_ = function doValueUpdate_(newValue) {
    var change = this.value_ !== newValue;

    if (this.view) {
      this.value_ = newValue;
      this.updateView();
    } else _ReactFieldBase.prototype.doValueUpdate_.call(this, newValue);

    if (change) {
      this.events.emit(VALUE_CHANGE, this.value);
      this.emitChange();
    }
  };

  _proto.showEditor_ = function showEditor_() {
    this.div_ = blockly__WEBPACK_IMPORTED_MODULE_2___default().DropDownDiv.getContentDiv();
    react_dom__WEBPACK_IMPORTED_MODULE_1__.render(this.render(), this.div_);
    var border = this.sourceBlock_.getColourTertiary();
    blockly__WEBPACK_IMPORTED_MODULE_2___default().DropDownDiv.setColour(this.sourceBlock_.getColour(), border); // the div_ size has not been computed yet, so let the browse handle this

    setTimeout(() => {
      blockly__WEBPACK_IMPORTED_MODULE_2___default().DropDownDiv.showPositionedByField(this, this.dropdownDispose_.bind(this));
      this.events.emit(MOUNT);
    }, 200);
  };

  _proto.hide = function hide() {
    blockly__WEBPACK_IMPORTED_MODULE_2___default().DropDownDiv.hideIfOwner(this, true);
  };

  _proto.dropdownDispose_ = function dropdownDispose_() {
    // this blows on hot reloads
    try {
      this.events.emit(UNMOUNT);
      react_dom__WEBPACK_IMPORTED_MODULE_1__.unmountComponentAtNode(this.div_);
    } catch (e) {
      console.error(e);
    }
  };

  _proto.render = function render() {
    var onValueChange = newValue => this.value = newValue;

    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_WorkspaceContext__WEBPACK_IMPORTED_MODULE_11__/* .WorkspaceProvider */ .W5, {
      field: this
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ui_DarkModeProvider__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z, {
      fixedDarkMode: this.darkMode
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_use_id_hook__WEBPACK_IMPORTED_MODULE_4__/* .IdProvider */ .vc, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ui_WebAudioContext__WEBPACK_IMPORTED_MODULE_12__/* .WebAudioProvider */ .IH, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_jacdac_Provider__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ui_AppTheme__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ValueContext__WEBPACK_IMPORTED_MODULE_8__/* .ValueProvider */ .Lt, {
      value: this.value,
      onValueChange: onValueChange
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z, {
      m: 0.5,
      borderRadius: "0.25rempx",
      bgcolor: "background.paper"
    }, this.renderField()))))))));
  };

  _proto.renderField = function renderField() {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("span", null, "not implemented");
  };

  _proto.dispose = function dispose() {
    this.view = undefined;

    _ReactFieldBase.prototype.dispose.call(this);
  };

  return ReactField;
}(_ReactFieldBase__WEBPACK_IMPORTED_MODULE_13__/* .ReactFieldBase */ .y); // eslint-disable-next-line @typescript-eslint/no-explicit-any



function toShadowDefinition(fieldType) {
  (0,_jacdac_ts_src_jdom_utils__WEBPACK_IMPORTED_MODULE_7__/* .assert */ .hu)(!!fieldType.KEY);
  var type = fieldType.KEY + "_shadow";
  return {
    kind: "block",
    type,
    message0: "%1",
    args0: [{
      type: fieldType.KEY,
      name: "value"
    }],
    style: "math_blocks",
    output: "Number",
    template: "shadow"
  };
}

/***/ }),

/***/ 34964:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "y": function() { return /* binding */ ReactFieldBase; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(43144);
/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(94578);
/* harmony import */ var blockly__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(74640);
/* harmony import */ var blockly__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(blockly__WEBPACK_IMPORTED_MODULE_0__);



var ReactFieldBase = /*#__PURE__*/function (_Blockly$Field) {
  (0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z)(ReactFieldBase, _Blockly$Field);

  // eslint-disable-next-line @typescript-eslint/no-explicit-any
  function ReactFieldBase(value, validator, options, size) {
    var _this;

    _this = _Blockly$Field.call(this, value, validator, options) || this;
    if (size) _this.size_ = new (blockly__WEBPACK_IMPORTED_MODULE_0___default().utils.Size)(size.width, size.height);
    return _this;
  }

  (0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(ReactFieldBase, [{
    key: "defaultValue",
    get: function get() {
      return {};
    }
  }, {
    key: "value",
    get: function get() {
      try {
        var v = JSON.parse(this.getValue());
        return v || this.defaultValue;
      } catch (e) {
        console.warn(e);
        return this.defaultValue;
      }
    },
    set: function set(v) {
      this.setValue(JSON.stringify(v));
    }
  }]);

  return ReactFieldBase;
}((blockly__WEBPACK_IMPORTED_MODULE_0___default().Field));

/***/ }),

/***/ 12702:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ ReactInlineField; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(94578);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(67294);
/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(73935);
/* harmony import */ var _ReactField__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(77576);
/* harmony import */ var _widgets_svg__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(41173);
/* harmony import */ var _ui_DarkModeProvider__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(7796);
/* harmony import */ var react_use_id_hook__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(19640);
/* harmony import */ var _jacdac_Provider__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(727);
/* harmony import */ var _ui_AppTheme__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(25853);
/* harmony import */ var blockly__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(74640);
/* harmony import */ var blockly__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(blockly__WEBPACK_IMPORTED_MODULE_7__);
/* harmony import */ var _WorkspaceContext__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(89801);
/* harmony import */ var _ui_WebAudioContext__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(94564);













var ReactInlineField = /*#__PURE__*/function (_ReactField) {
  (0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(ReactInlineField, _ReactField);

  // eslint-disable-next-line @typescript-eslint/no-explicit-any
  function ReactInlineField(options) {
    return _ReactField.call(this, options === null || options === void 0 ? void 0 : options.value, undefined, options, {
      width: 1,
      height: 1
    }) || this;
  }

  var _proto = ReactInlineField.prototype;

  _proto.createContainer = function createContainer() {
    var c = document.createElement("div");
    c.style.display = "inline-block";
    c.style.minWidth = "14rem";
    return c;
  };

  _proto.initCustomView = function initCustomView() {
    var {
      width,
      height
    } = this.size_;
    var fo = (0,_widgets_svg__WEBPACK_IMPORTED_MODULE_11__/* .child */ .iU)(this.fieldGroup_, "foreignObject", {
      x: 0,
      y: 0,
      width,
      height
    });
    this.container = this.createContainer();
    fo.appendChild(this.container);
    this.resizeObserver = new ResizeObserver(entries => {
      var entry = entries[0];
      var {
        contentRect
      } = entry;
      this.size_.width = contentRect.width;
      this.size_.height = contentRect.height;
      fo.setAttribute("width", this.size_.width + "");
      fo.setAttribute("height", this.size_.height + "");
      this.forceRerender();
      var b = this.sourceBlock_;

      if (b !== null && b !== void 0 && b.workspace) {
        // eslint-disable-next-line @typescript-eslint/no-explicit-any
        var ev = new (blockly__WEBPACK_IMPORTED_MODULE_7__.Events.get(blockly__WEBPACK_IMPORTED_MODULE_7__.Events.BLOCK_MOVE))(b);
        blockly__WEBPACK_IMPORTED_MODULE_7__.Events.fire(ev);
      }
    });
    this.resizeObserver.observe(this.container);
    react_dom__WEBPACK_IMPORTED_MODULE_1__.render(this.renderBlock(), this.container);
    return fo;
  };

  _proto.dispose = function dispose() {
    if (this.container) {
      react_dom__WEBPACK_IMPORTED_MODULE_1__.unmountComponentAtNode(this.container);
      this.container = undefined;
    }

    if (this.resizeObserver) {
      this.resizeObserver.disconnect();
      this.resizeObserver = undefined;
    }

    _ReactField.prototype.dispose.call(this);
  };

  _proto.renderField = function renderField() {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("div", null, "not used");
  };

  _proto.renderInlineField = function renderInlineField() {
    return null;
  };

  _proto.renderBlock = function renderBlock() {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_WorkspaceContext__WEBPACK_IMPORTED_MODULE_8__/* .WorkspaceProvider */ .W5, {
      field: this
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ui_DarkModeProvider__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z, {
      fixedDarkMode: "dark"
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_use_id_hook__WEBPACK_IMPORTED_MODULE_4__/* .IdProvider */ .vc, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ui_WebAudioContext__WEBPACK_IMPORTED_MODULE_9__/* .WebAudioProvider */ .IH, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_jacdac_Provider__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ui_AppTheme__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z, null, this.renderInlineField()))))));
  };

  _proto.getText_ = function getText_() {
    return "...";
  } // don't bind any mouse event
  ;

  _proto.bindEvents_ = function bindEvents_() {
    blockly__WEBPACK_IMPORTED_MODULE_7___default().Tooltip.bindMouseEvents(this.getClickTarget_());
  };

  return ReactInlineField;
}(_ReactField__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .ZP);



/***/ }),

/***/ 891:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";

// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  "Z": function() { return /* binding */ ServoAngleField; }
});

// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js
var inheritsLoose = __webpack_require__(94578);
// EXTERNAL MODULE: ./node_modules/react/index.js
var react = __webpack_require__(67294);
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/createClass.js
var createClass = __webpack_require__(43144);
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js
var asyncToGenerator = __webpack_require__(15861);
// EXTERNAL MODULE: ./node_modules/@mui/material/Grid/Grid.js + 2 modules
var Grid = __webpack_require__(4320);
// EXTERNAL MODULE: ./node_modules/@mui/material/Slider/Slider.js + 4 modules
var Slider = __webpack_require__(879);
// EXTERNAL MODULE: ./src/components/blockly/fields/ReactField.tsx
var ReactField = __webpack_require__(77576);
// EXTERNAL MODULE: ./src/components/blockly/fields/ValueContext.tsx
var ValueContext = __webpack_require__(86415);
;// CONCATENATED MODULE: ./src/components/blockly/fields/SliderField.tsx








function FieldWithSlider(props) {
  var {
    children
  } = props;
  var {
    value,
    onValueChange
  } = (0,react.useContext)(ValueContext/* default */.ZP);

  var handleChange = /*#__PURE__*/function () {
    var _ref = (0,asyncToGenerator/* default */.Z)(function* (ev, nv) {
      var newValue = nv;
      onValueChange(newValue);
    });

    return function handleChange(_x, _x2) {
      return _ref.apply(this, arguments);
    };
  }();

  return /*#__PURE__*/react.createElement(Grid/* default */.ZP, {
    container: true,
    spacing: 1
  }, /*#__PURE__*/react.createElement(Grid/* default */.ZP, {
    item: true,
    xs: 12
  }, children), /*#__PURE__*/react.createElement(Grid/* default */.ZP, {
    item: true,
    xs: 12
  }, /*#__PURE__*/react.createElement(Slider/* default */.ZP, {
    color: "secondary",
    valueLabelDisplay: "auto",
    valueLabelFormat: Math.round(value) + "\xB0",
    min: -90,
    max: 90,
    step: 5,
    value: value,
    onChange: handleChange,
    "aria-label": "angle"
  })));
}

var SliderField = /*#__PURE__*/function (_ReactField) {
  (0,inheritsLoose/* default */.Z)(SliderField, _ReactField);

  // eslint-disable-next-line @typescript-eslint/no-explicit-any
  function SliderField(value, options) {
    return _ReactField.call(this, value, undefined, options) || this;
  }

  var _proto = SliderField.prototype;

  _proto.getText_ = function getText_() {
    return this.value + "";
  };

  _proto.renderField = function renderField() {
    return /*#__PURE__*/react.createElement(FieldWithSlider, null, this.renderWidget());
  };

  _proto.renderWidget = function renderWidget() {
    return null;
  };

  (0,createClass/* default */.Z)(SliderField, [{
    key: "defaultValue",
    get: function get() {
      return 0;
    }
  }]);

  return SliderField;
}(ReactField/* default */.ZP);


// EXTERNAL MODULE: ./src/components/ui/Suspense.tsx + 2 modules
var Suspense = __webpack_require__(6890);
;// CONCATENATED MODULE: ./src/components/blockly/fields/ServoAngleField.tsx






var ServoWidget = /*#__PURE__*/(0,react.lazy)(() => __webpack_require__.e(/* import() */ 317).then(__webpack_require__.bind(__webpack_require__, 9422)));

function ServiceFieldWidget() {
  var {
    value
  } = (0,react.useContext)(ValueContext/* default */.ZP);
  return /*#__PURE__*/react.createElement(Suspense/* default */.Z, null, /*#__PURE__*/react.createElement(ServoWidget, {
    angle: value,
    offset: 0,
    color: "secondary",
    enabled: true
  }));
}

var ServoAngleField = /*#__PURE__*/function (_SliderField) {
  (0,inheritsLoose/* default */.Z)(ServoAngleField, _SliderField);

  function ServoAngleField() {
    return _SliderField.apply(this, arguments) || this;
  }

  ServoAngleField.fromJson = function fromJson(options) {
    return new ServoAngleField(options === null || options === void 0 ? void 0 : options.value, options);
  };

  var _proto = ServoAngleField.prototype;

  _proto.getText_ = function getText_() {
    return this.value + "°";
  };

  _proto.renderWidget = function renderWidget() {
    return /*#__PURE__*/react.createElement(ServiceFieldWidget, null);
  };

  return ServoAngleField;
}(SliderField);

ServoAngleField.KEY = "jacdac_field_servo_angle";
ServoAngleField.SHADOW = (0,ReactField/* toShadowDefinition */._t)(ServoAngleField);


/***/ }),

/***/ 35361:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ TwinField; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(94578);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(67294);
/* harmony import */ var _ui_Suspense__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(6890);
/* harmony import */ var _ReactInlineField__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(12702);




var TwinWidget = /*#__PURE__*/(0,react__WEBPACK_IMPORTED_MODULE_0__.lazy)(() => __webpack_require__.e(/* import() */ 661).then(__webpack_require__.bind(__webpack_require__, 10661)));

var TwinField = /*#__PURE__*/function (_ReactInlineField) {
  (0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)(TwinField, _ReactInlineField);

  TwinField.fromJson = function fromJson(options) {
    return new TwinField(options);
  } // eslint-disable-next-line @typescript-eslint/no-explicit-any
  ;

  function TwinField(options) {
    var _this;

    _this = _ReactInlineField.call(this, options) || this;
    _this.EDITABLE = false;
    return _this;
  }

  var _proto = TwinField.prototype;

  _proto.renderInlineField = function renderInlineField() {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ui_Suspense__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(TwinWidget, null));
  };

  return TwinField;
}(_ReactInlineField__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z);

TwinField.KEY = "jacdac_field_twin";


/***/ }),

/***/ 86188:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ UseModelField; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(15861);
/* harmony import */ var _babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(15785);
/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(94578);
/* harmony import */ var blockly__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(74640);
/* harmony import */ var blockly__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(blockly__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _WorkspaceContext__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(89801);




/* eslint-disable @typescript-eslint/no-explicit-any */



var UseModelField = /*#__PURE__*/function (_FieldDropdown) {
  (0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(UseModelField, _FieldDropdown);

  UseModelField.fromJson = function fromJson(options) {
    return new UseModelField(options);
  };

  function UseModelField(options) {
    var _this;

    _this = _FieldDropdown.call(this, () => [["", ""]], undefined, options) || this;
    _this.SERIALIZABLE = true;
    _this._models = {};
    return _this;
  }

  var _proto = UseModelField.prototype;

  _proto.fromXml = function fromXml(fieldElement) {
    this.setValue(fieldElement.textContent);
  };

  _proto.getOptions = function getOptions() {
    var options = [];
    if (this._models) options = Object.keys(this._models).map(m => [m, m]);
    var value = this.getValue();
    return options.length < 1 ? [[value || "", value || ""]] : [].concat((0,_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)(options), [["", ""]]);
  };

  _proto.doClassValidation_ = function doClassValidation_(newValue) {
    // skip super class validation
    return newValue;
  };

  _proto.init = function init() {
    _FieldDropdown.prototype.init.call(this);

    this.populateModels();
  };

  _proto.setSourceBlock = function setSourceBlock(block) {
    _FieldDropdown.prototype.setSourceBlock.call(this, block);

    this.populateModels();
  };

  _proto.doValueUpdate_ = function doValueUpdate_(newValue) {
    _FieldDropdown.prototype.doValueUpdate_.call(this, newValue);
  };

  _proto.notifyServicesChanged = function notifyServicesChanged() {
    this.populateModels();
  };

  _proto.dispose = function dispose() {
    _FieldDropdown.prototype.dispose.call(this);

    this.unmount();
  };

  _proto.resolveFiles = function resolveFiles() {
    var sourceBlock = this.getSourceBlock();
    var services = (0,_WorkspaceContext__WEBPACK_IMPORTED_MODULE_1__/* .resolveWorkspaceServices */ .O7)(sourceBlock === null || sourceBlock === void 0 ? void 0 : sourceBlock.workspace);
    var directory = services === null || services === void 0 ? void 0 : services.workingDirectory;
    return directory === null || directory === void 0 ? void 0 : directory.files.filter(f => /\.json$/i.test(f.name));
  };

  _proto.populateModels = /*#__PURE__*/function () {
    var _populateModels = (0,_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(function* () {
      var _this2 = this;

      var files = this.resolveFiles();
      if (!files) return;
      files.forEach( /*#__PURE__*/function () {
        var _ref = (0,_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(function* (file) {
          if (file) {
            try {
              // grab the content of the JSON file
              var source = yield file.textAsync();
              var model = JSON.parse(source);
              if (model && model.status == "trained") _this2._models[file.name] = model;
            } catch (e) {
              console.log(e);
            }
          }
        });

        return function (_x) {
          return _ref.apply(this, arguments);
        };
      }());
    });

    function populateModels() {
      return _populateModels.apply(this, arguments);
    }

    return populateModels;
  }();

  _proto.getModel = /*#__PURE__*/function () {
    var _getModel = (0,_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(function* () {
      var filename = this.getValue();
      var selectedModel = this._models[filename];

      if (!selectedModel) {
        // if that did not work, refresh model list and try again
        this.populateModels();
        selectedModel = this._models[filename];
      } // if that did not work, this model cannot be loaded


      if (!selectedModel) this.value_ = undefined;
      return selectedModel;
    });

    function getModel() {
      return _getModel.apply(this, arguments);
    }

    return getModel;
  }();

  _proto.unmount = function unmount() {
    if (this._unmount) {
      this._unmount();

      this._unmount = undefined;
    }
  };

  return UseModelField;
}(blockly__WEBPACK_IMPORTED_MODULE_0__.FieldDropdown);

UseModelField.KEY = "jacdac_field_mlblocks_model_open";


/***/ }),

/***/ 86415:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Lt": function() { return /* binding */ ValueProvider; }
/* harmony export */ });
/* unused harmony export ValueContext */
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(67294);
/* eslint-disable @typescript-eslint/no-explicit-any */

var ValueContext = /*#__PURE__*/(0,react__WEBPACK_IMPORTED_MODULE_0__.createContext)({
  value: undefined,
  onValueChange: undefined
});
ValueContext.displayName = "Value";
/* harmony default export */ __webpack_exports__["ZP"] = (ValueContext);
function ValueProvider(props) {
  var {
    children,
    value: initialValue,
    onValueChange: onFieldValueChange
  } = props;
  var {
    0: value,
    1: setValue
  } = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(initialValue);

  var onValueChange = newValue => {
    setValue(newValue);
    onFieldValueChange === null || onFieldValueChange === void 0 ? void 0 : onFieldValueChange(newValue);
  };

  return (
    /*#__PURE__*/
    // eslint-disable-next-line react/react-in-jsx-scope
    react__WEBPACK_IMPORTED_MODULE_0__.createElement(ValueContext.Provider, {
      value: {
        value,
        onValueChange
      }
    }, children)
  );
}

/***/ }),

/***/ 15757:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ VariablesField; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(94578);
/* harmony import */ var _mui_material_styles__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(98348);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(67294);
/* harmony import */ var _jacdac_ts_src_vm_events__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(59448);
/* harmony import */ var _WorkspaceContext__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(89801);
/* harmony import */ var _ReactInlineField__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(12702);






var PREFIX = "VariablesFields";
var classes = {
  table: PREFIX + "-table"
};
var Root = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .ZP)("div")(_ref => {
  var {
    theme
  } = _ref;
  return {
    ["& ." + classes.table]: {
      padding: 0,
      margin: 0,
      fontSize: "0.9rem",
      lineHeight: "1rem",
      color: theme.palette.text.primary,
      "& td": {
        borderColor: "#ccc"
      }
    }
  };
});

function VariablesWidget() {
  var {
    runner
  } = (0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(_WorkspaceContext__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .ZP);
  var {
    0: variables,
    1: setVariables
  } = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(runner === null || runner === void 0 ? void 0 : runner.globals());
  (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => runner === null || runner === void 0 ? void 0 : runner.subscribe(_jacdac_ts_src_vm_events__WEBPACK_IMPORTED_MODULE_4__/* .VM_GLOBAL_CHANGE */ .b4, () => setVariables(runner.globals())), [runner]);
  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment, null, variables && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("table", {
    className: classes.table
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tbody", null, variables === null || variables === void 0 ? void 0 : variables.map(_ref2 => {
    var {
      name,
      value
    } = _ref2;
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("tr", {
      key: name
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, name), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement("td", null, value));
  }))));
}

var VariablesField = /*#__PURE__*/function (_ReactInlineField) {
  (0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(VariablesField, _ReactInlineField);

  VariablesField.fromJson = function fromJson(options) {
    return new VariablesField(options);
  } // eslint-disable-next-line @typescript-eslint/no-explicit-any
  ;

  function VariablesField(options) {
    var _this;

    _this = _ReactInlineField.call(this, options) || this;
    _this.EDITABLE = false;
    return _this;
  }

  var _proto = VariablesField.prototype;

  _proto.renderInlineField = function renderInlineField() {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(Root, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(VariablesWidget, null));
  };

  return VariablesField;
}(_ReactInlineField__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z);

VariablesField.KEY = "jacdac_field_variables_view";


/***/ }),

/***/ 2006:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ WatchValueField; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(94578);
/* harmony import */ var _babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(15785);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(67294);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(66449);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(39211);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(4320);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(49308);
/* harmony import */ var _WorkspaceContext__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(89801);
/* harmony import */ var _ReactInlineField__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(12702);
/* harmony import */ var _PointerBoundary__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(77298);
/* harmony import */ var _jacdac_ts_src_vm_events__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(59448);
/* harmony import */ var _jacdac_ts_src_jdom_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(81794);
/* harmony import */ var _useBlockData__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(53851);
/* harmony import */ var _jacdac_Context__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(20392);
/* harmony import */ var _ui_SwitchWithLabel__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(64973);












var HORIZON = 10;

function WatchValueWidget() {
  var {
    bus
  } = (0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(_jacdac_Context__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z);
  var {
    runner,
    sourceId,
    sourceBlock
  } = (0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(_WorkspaceContext__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .ZP);
  var {
    data,
    setData
  } = (0,_useBlockData__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(sourceBlock, []);
  var theme = (0,_mui_material__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z)(); // track changes

  var {
    0: value,
    1: setValue
  } = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(runner === null || runner === void 0 ? void 0 : runner.lookupWatch(sourceId));
  (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => runner === null || runner === void 0 ? void 0 : runner.subscribe(_jacdac_ts_src_vm_events__WEBPACK_IMPORTED_MODULE_9__/* .VM_WATCH_CHANGE */ .UM, watchSourceId => {
    if (watchSourceId === sourceId) {
      var newValue = runner.lookupWatch(sourceId);
      setValue(newValue);

      if (!isNaN(newValue)) {
        var newData = [].concat((0,_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(data || []), [{
          time: bus.timestamp / 1000,
          value: newValue
        }]).slice(-HORIZON);
        setData(newData);
      }
    }
  }), [runner, sourceId, data]);
  var valueNumber = typeof value === "number" ? value : undefined;

  if (!isNaN(valueNumber)) {
    var step = Math.ceil(Math.abs(valueNumber)) / 10;
    var precision = step < 1 ? Math.ceil(-Math.log10(step)) : 0;
    valueNumber = (0,_jacdac_ts_src_jdom_utils__WEBPACK_IMPORTED_MODULE_4__/* .roundWithPrecision */ .JI)(valueNumber, precision);
  }

  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z, {
    bgcolor: theme.palette.background.paper,
    borderRadius: "undefinedpx",
    color: theme.palette.text.primary
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .ZP, {
    container: true,
    alignItems: "flex-end",
    alignContent: "center",
    justifyContent: "center",
    spacing: 1
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .ZP, {
    item: true
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_PointerBoundary__WEBPACK_IMPORTED_MODULE_3__/* .PointerBoundary */ .A, null, !isNaN(valueNumber) ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .Z, {
    variant: "body1"
  }, valueNumber) : typeof value === "boolean" ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z, {
    pl: 1
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ui_SwitchWithLabel__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z, {
    readOnly: true,
    checked: !!value,
    label: value ? "true" : "false"
  })) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .Z, {
    variant: "body1"
  }, value === undefined ? "..." : value + "")))));
}

var WatchValueField = /*#__PURE__*/function (_ReactInlineField) {
  (0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(WatchValueField, _ReactInlineField);

  WatchValueField.fromJson = function fromJson(options) {
    return new WatchValueField(options);
  } // eslint-disable-next-line @typescript-eslint/no-explicit-any
  ;

  function WatchValueField(options) {
    var _this;

    _this = _ReactInlineField.call(this, options) || this;
    _this.EDITABLE = false;
    return _this;
  }

  var _proto = WatchValueField.prototype;

  _proto.createContainer = function createContainer() {
    var c = document.createElement("div");
    c.style.display = "inline-block";
    c.style.minWidth = "4rem";
    return c;
  };

  _proto.renderInlineField = function renderInlineField() {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(WatchValueWidget, null);
  };

  return WatchValueField;
}(_ReactInlineField__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z);

WatchValueField.KEY = "jacdac_field_watch_value";


/***/ }),

/***/ 95702:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ BarField; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(94578);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(67294);
/* harmony import */ var _WorkspaceContext__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(89801);
/* harmony import */ var _ReactInlineField__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(12702);
/* harmony import */ var _useBlockData__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(53851);
/* harmony import */ var _VegaLiteWidget__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(11961);
/* harmony import */ var _tidy__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(47554);
/* harmony import */ var _toolbox__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(16582);









function BarWidget() {
  var {
    sourceBlock
  } = (0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(_WorkspaceContext__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .ZP);
  var {
    data
  } = (0,_useBlockData__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)(sourceBlock);
  var index = (0,_tidy__WEBPACK_IMPORTED_MODULE_5__/* .tidyResolveHeader */ .gc)(data, sourceBlock === null || sourceBlock === void 0 ? void 0 : sourceBlock.getFieldValue("index"));
  var value = (0,_tidy__WEBPACK_IMPORTED_MODULE_5__/* .tidyResolveHeader */ .gc)(data, sourceBlock === null || sourceBlock === void 0 ? void 0 : sourceBlock.getFieldValue("value"), "number");
  if (!index || !value) return null;
  var sliceOptions = {
    sliceMax: _toolbox__WEBPACK_IMPORTED_MODULE_6__/* .BAR_MAX_ITEMS */ .kC
  };
  var spec = {
    mark: {
      type: "bar",
      cornerRadius: _toolbox__WEBPACK_IMPORTED_MODULE_6__/* .BAR_CORNER_RADIUS */ .Fd,
      tooltip: true
    },
    encoding: {
      x: {
        field: index,
        type: "nominal"
      },
      y: {
        field: value,
        type: "quantitative"
      }
    },
    data: {
      name: "values"
    }
  };
  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_VegaLiteWidget__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z, {
    spec: spec,
    slice: sliceOptions
  });
}

var BarField = /*#__PURE__*/function (_ReactInlineField) {
  (0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(BarField, _ReactInlineField);

  BarField.fromJson = function fromJson(options) {
    return new BarField(options);
  } // eslint-disable-next-line @typescript-eslint/no-explicit-any
  ;

  function BarField(options) {
    var _this;

    _this = _ReactInlineField.call(this, options) || this;
    _this.EDITABLE = false;
    return _this;
  }

  var _proto = BarField.prototype;

  _proto.renderInlineField = function renderInlineField() {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(BarWidget, null);
  };

  return BarField;
}(_ReactInlineField__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z);

BarField.KEY = "jacdac_field_bar_plot";


/***/ }),

/***/ 62953:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ BoxPlotField; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(94578);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(67294);
/* harmony import */ var _WorkspaceContext__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(89801);
/* harmony import */ var _ReactInlineField__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(12702);
/* harmony import */ var _useBlockData__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(53851);
/* harmony import */ var _VegaLiteWidget__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(11961);
/* harmony import */ var _tidy__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(47554);
/* harmony import */ var _toolbox__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(16582);









function BoxPlotWidget() {
  var {
    sourceBlock
  } = (0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(_WorkspaceContext__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .ZP);
  var {
    data
  } = (0,_useBlockData__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)(sourceBlock);
  var index = (0,_tidy__WEBPACK_IMPORTED_MODULE_5__/* .tidyResolveHeader */ .gc)(data, sourceBlock === null || sourceBlock === void 0 ? void 0 : sourceBlock.getFieldValue("index"));
  var value = (0,_tidy__WEBPACK_IMPORTED_MODULE_5__/* .tidyResolveHeader */ .gc)(data, sourceBlock === null || sourceBlock === void 0 ? void 0 : sourceBlock.getFieldValue("value"), "number");
  if (!index || !value) return null;
  var spec = {
    mark: {
      type: "boxplot",
      cornerRadius: _toolbox__WEBPACK_IMPORTED_MODULE_6__/* .BAR_CORNER_RADIUS */ .Fd,
      tooltip: true // eslint-disable-next-line @typescript-eslint/no-explicit-any

    },
    encoding: {
      x: {
        field: index,
        type: "nominal",
        scale: {
          zero: false
        }
      },
      y: {
        field: value,
        type: "quantitative",
        scale: {
          zero: false
        }
      }
    },
    data: {
      name: "values"
    }
  };
  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_VegaLiteWidget__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z, {
    spec: spec
  });
}

var BoxPlotField = /*#__PURE__*/function (_ReactInlineField) {
  (0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(BoxPlotField, _ReactInlineField);

  BoxPlotField.fromJson = function fromJson(options) {
    return new BoxPlotField(options);
  } // eslint-disable-next-line @typescript-eslint/no-explicit-any
  ;

  function BoxPlotField(options) {
    var _this;

    _this = _ReactInlineField.call(this, options) || this;
    _this.EDITABLE = false;
    return _this;
  }

  var _proto = BoxPlotField.prototype;

  _proto.renderInlineField = function renderInlineField() {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(BoxPlotWidget, null);
  };

  return BoxPlotField;
}(_ReactInlineField__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z);

BoxPlotField.KEY = "jacdac_field_box_plot";


/***/ }),

/***/ 49211:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ HeatMapPlotField; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(94578);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(67294);
/* harmony import */ var _WorkspaceContext__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(89801);
/* harmony import */ var _ReactInlineField__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(12702);
/* harmony import */ var _useBlockData__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(53851);
/* harmony import */ var _VegaLiteWidget__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(11961);
/* harmony import */ var _tidy__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(47554);
/* harmony import */ var _toolbox__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(16582);









function HeatMapWidget() {
  var {
    sourceBlock
  } = (0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(_WorkspaceContext__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .ZP);
  var {
    data
  } = (0,_useBlockData__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)(sourceBlock);
  var x = (0,_tidy__WEBPACK_IMPORTED_MODULE_5__/* .tidyResolveHeader */ .gc)(data, sourceBlock === null || sourceBlock === void 0 ? void 0 : sourceBlock.getFieldValue("x"));
  var y = (0,_tidy__WEBPACK_IMPORTED_MODULE_5__/* .tidyResolveHeader */ .gc)(data, sourceBlock === null || sourceBlock === void 0 ? void 0 : sourceBlock.getFieldValue("y"));
  var color = (0,_tidy__WEBPACK_IMPORTED_MODULE_5__/* .tidyResolveHeader */ .gc)(data, sourceBlock === null || sourceBlock === void 0 ? void 0 : sourceBlock.getFieldValue("color"), "number");
  if (!x || !y || !color) return null;
  var sliceOptions = {
    sliceHead: _toolbox__WEBPACK_IMPORTED_MODULE_6__/* .LINE_MAX_ITEMS */ .bH
  };
  var spec = {
    mark: {
      type: "rect",
      tooltip: true
    },
    encoding: {
      x: {
        field: x,
        type: "ordinal"
      },
      y: {
        field: y,
        type: "ordinal"
      },
      color: {
        field: color,
        type: "quantitative",
        scale: {
          zero: false
        }
      }
    },
    data: {
      name: "values"
    }
  };
  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_VegaLiteWidget__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z, {
    spec: spec,
    slice: sliceOptions
  });
}

var HeatMapPlotField = /*#__PURE__*/function (_ReactInlineField) {
  (0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(HeatMapPlotField, _ReactInlineField);

  HeatMapPlotField.fromJson = function fromJson(options) {
    return new HeatMapPlotField(options);
  } // eslint-disable-next-line @typescript-eslint/no-explicit-any
  ;

  function HeatMapPlotField(options) {
    var _this;

    _this = _ReactInlineField.call(this, options) || this;
    _this.EDITABLE = false;
    return _this;
  }

  var _proto = HeatMapPlotField.prototype;

  _proto.renderInlineField = function renderInlineField() {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(HeatMapWidget, null);
  };

  return HeatMapPlotField;
}(_ReactInlineField__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z);

HeatMapPlotField.KEY = "jacdac_field_heat_map";


/***/ }),

/***/ 76295:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ HistogramField; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(94578);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(67294);
/* harmony import */ var _WorkspaceContext__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(89801);
/* harmony import */ var _ReactInlineField__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(12702);
/* harmony import */ var _useBlockData__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(53851);
/* harmony import */ var _VegaLiteWidget__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(11961);
/* harmony import */ var _tidy__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(47554);
/* harmony import */ var _toolbox__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(16582);









function HistogramWidget() {
  var {
    sourceBlock
  } = (0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(_WorkspaceContext__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .ZP);
  var {
    data
  } = (0,_useBlockData__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)(sourceBlock);
  var index = (0,_tidy__WEBPACK_IMPORTED_MODULE_5__/* .tidyResolveHeader */ .gc)(data, sourceBlock === null || sourceBlock === void 0 ? void 0 : sourceBlock.getFieldValue("index"));
  if (!index) return null;
  var spec = {
    mark: {
      type: "bar",
      cornerRadius: _toolbox__WEBPACK_IMPORTED_MODULE_6__/* .BAR_CORNER_RADIUS */ .Fd,
      tooltip: true
    },
    encoding: {
      x: {
        bin: true,
        field: index
      },
      y: {
        aggregate: "count"
      }
    },
    data: {
      name: "values"
    }
  };
  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_VegaLiteWidget__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z, {
    spec: spec
  });
}

var HistogramField = /*#__PURE__*/function (_ReactInlineField) {
  (0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(HistogramField, _ReactInlineField);

  HistogramField.fromJson = function fromJson(options) {
    return new HistogramField(options);
  } // eslint-disable-next-line @typescript-eslint/no-explicit-any
  ;

  function HistogramField(options) {
    var _this;

    _this = _ReactInlineField.call(this, options) || this;
    _this.EDITABLE = false;
    return _this;
  }

  var _proto = HistogramField.prototype;

  _proto.renderInlineField = function renderInlineField() {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(HistogramWidget, null);
  };

  return HistogramField;
}(_ReactInlineField__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z);

HistogramField.KEY = "jacdac_field_histogram";


/***/ }),

/***/ 23030:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ LinePlotField; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(94578);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(67294);
/* harmony import */ var _WorkspaceContext__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(89801);
/* harmony import */ var _ReactInlineField__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(12702);
/* harmony import */ var _useBlockData__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(53851);
/* harmony import */ var _VegaLiteWidget__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(11961);
/* harmony import */ var _tidy__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(47554);
/* harmony import */ var _toolbox__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(16582);









function LinePlotWidget() {
  var {
    sourceBlock
  } = (0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(_WorkspaceContext__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .ZP);
  var {
    data
  } = (0,_useBlockData__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)(sourceBlock);
  var x = (0,_tidy__WEBPACK_IMPORTED_MODULE_5__/* .tidyResolveHeader */ .gc)(data, sourceBlock === null || sourceBlock === void 0 ? void 0 : sourceBlock.getFieldValue("x"), "number");
  var ys = ["y", "y2", "y3"].map(n => (0,_tidy__WEBPACK_IMPORTED_MODULE_5__/* .tidyResolveHeader */ .gc)(data, sourceBlock === null || sourceBlock === void 0 ? void 0 : sourceBlock.getFieldValue(n), "number")).filter(y => !!y);
  if (!x || !ys.length) return null;
  var timeSeries = x === "time";
  var sliceOptions = {
    sliceHead: _toolbox__WEBPACK_IMPORTED_MODULE_6__/* .LINE_MAX_ITEMS */ .bH
  };
  var spec = {
    layer: ys.map(y => ({
      mark: {
        type: "line",
        tooltip: true,
        point: {
          filled: timeSeries
        }
      },
      encoding: {
        x: {
          field: x,
          type: "quantitative",
          scale: {
            zero: false
          }
        },
        y: {
          field: y,
          type: "quantitative",
          scale: {
            zero: false
          }
        }
      },
      data: {
        name: "values"
      }
    }))
  };
  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_VegaLiteWidget__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z, {
    spec: spec,
    slice: sliceOptions
  });
}

var LinePlotField = /*#__PURE__*/function (_ReactInlineField) {
  (0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(LinePlotField, _ReactInlineField);

  LinePlotField.fromJson = function fromJson(options) {
    return new LinePlotField(options);
  } // eslint-disable-next-line @typescript-eslint/no-explicit-any
  ;

  function LinePlotField(options) {
    var _this;

    _this = _ReactInlineField.call(this, options) || this;
    _this.EDITABLE = false;
    return _this;
  }

  var _proto = LinePlotField.prototype;

  _proto.renderInlineField = function renderInlineField() {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(LinePlotWidget, null);
  };

  return LinePlotField;
}(_ReactInlineField__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z);

LinePlotField.KEY = "jacdac_field_line_plot";


/***/ }),

/***/ 88533:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ ScatterPlotField; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(94578);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(67294);
/* harmony import */ var _WorkspaceContext__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(89801);
/* harmony import */ var _ReactInlineField__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(12702);
/* harmony import */ var _useBlockData__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(53851);
/* harmony import */ var _VegaLiteWidget__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(11961);
/* harmony import */ var _tidy__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(47554);
/* harmony import */ var _toolbox__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(16582);
/* harmony import */ var _jacdac_ts_jacdac_spec_spectool_jdspec__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(13996);










function ScatterPlotWidget(props) {
  var {
    linearRegression
  } = props;
  var {
    sourceBlock
  } = (0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(_WorkspaceContext__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .ZP);
  var {
    data,
    transformedData
  } = (0,_useBlockData__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)(sourceBlock);
  var x = (0,_tidy__WEBPACK_IMPORTED_MODULE_5__/* .tidyResolveHeader */ .gc)(data, sourceBlock === null || sourceBlock === void 0 ? void 0 : sourceBlock.getFieldValue("x"), "number");
  var y = (0,_tidy__WEBPACK_IMPORTED_MODULE_5__/* .tidyResolveHeader */ .gc)(data, sourceBlock === null || sourceBlock === void 0 ? void 0 : sourceBlock.getFieldValue("y"), "number");
  var size = (0,_tidy__WEBPACK_IMPORTED_MODULE_5__/* .tidyResolveHeader */ .gc)(data, sourceBlock === null || sourceBlock === void 0 ? void 0 : sourceBlock.getFieldValue("size"), "number");
  if (!x || !y) return null;
  var sliceOptions = {
    sliceSample: _toolbox__WEBPACK_IMPORTED_MODULE_6__/* .SCATTER_MAX_ITEMS */ .VN
  }; // eslint-disable-next-line @typescript-eslint/no-explicit-any

  var spec = {
    mark: {
      type: "point",
      filled: true,
      tooltip: true
    },
    encoding: {
      x: {
        field: x,
        type: "quantitative",
        scale: {
          zero: false
        },
        title: (0,_jacdac_ts_jacdac_spec_spectool_jdspec__WEBPACK_IMPORTED_MODULE_7__/* .humanify */ .lW)(x)
      },
      y: {
        field: y,
        title: (0,_jacdac_ts_jacdac_spec_spectool_jdspec__WEBPACK_IMPORTED_MODULE_7__/* .humanify */ .lW)(y),
        type: "quantitative",
        scale: {
          zero: false
        }
      }
    }
  };
  if (size) spec.encoding.size = {
    field: size,
    type: "quantitative",
    scale: {
      zero: false
    }
  };

  if (linearRegression) {
    var {
      slope,
      intercept
    } = (transformedData === null || transformedData === void 0 ? void 0 : transformedData[0]) || {};
    spec = {
      title: slope !== undefined ? "slope: " + slope + ", intercept: " + intercept : undefined,
      layer: [spec, {
        mark: {
          type: "line",
          color: "firebrick"
        },
        transform: [{
          regression: y,
          on: x
        }],
        encoding: {
          x: {
            field: x,
            type: "quantitative"
          },
          y: {
            field: y,
            type: "quantitative"
          }
        }
      }]
    };
  }

  spec.data = {
    name: "values"
  };
  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_VegaLiteWidget__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z, {
    spec: spec,
    slice: sliceOptions
  });
}

var ScatterPlotField = /*#__PURE__*/function (_ReactInlineField) {
  (0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z)(ScatterPlotField, _ReactInlineField);

  ScatterPlotField.fromJson = function fromJson(options) {
    return new ScatterPlotField(options);
  } // eslint-disable-next-line @typescript-eslint/no-explicit-any
  ;

  function ScatterPlotField(options) {
    var _this;

    _this = _ReactInlineField.call(this, options) || this;
    _this.EDITABLE = false;
    _this.linearRegression = !!(options !== null && options !== void 0 && options.linearRegression);
    return _this;
  }

  var _proto = ScatterPlotField.prototype;

  _proto.renderInlineField = function renderInlineField() {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(ScatterPlotWidget, {
      linearRegression: this.linearRegression
    });
  };

  return ScatterPlotField;
}(_ReactInlineField__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z);

ScatterPlotField.KEY = "jacdac_field_scatter_plot";


/***/ }),

/***/ 61562:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ VegaChartField; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(94578);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(67294);
/* harmony import */ var _WorkspaceContext__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(89801);
/* harmony import */ var _ReactInlineField__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(12702);
/* harmony import */ var _useBlockData__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(53851);
/* harmony import */ var _VegaLiteWidget__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(11961);
/* harmony import */ var _dsl_chartdsl__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(57611);









function VegaChartWidget() {
  var {
    sourceBlock,
    workspace
  } = (0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(_WorkspaceContext__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .ZP);
  var {
    data
  } = (0,_useBlockData__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)(sourceBlock);
  var services = workspace === null || workspace === void 0 ? void 0 : workspace.jacdacServices; // track workspace changes and re-render

  var {
    1: setWorkspaceJSON
  } = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(services === null || services === void 0 ? void 0 : services.workspaceJSON);
  (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => services === null || services === void 0 ? void 0 : services.subscribe(_WorkspaceContext__WEBPACK_IMPORTED_MODULE_1__/* .WorkspaceServices.WORKSPACE_CHANGE */ .yq.WORKSPACE_CHANGE, () => setWorkspaceJSON(services.workspaceJSON)), [services]);
  var spec = (0,_dsl_chartdsl__WEBPACK_IMPORTED_MODULE_5__/* .blockToVisualizationSpec */ .w)(sourceBlock, data);
  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_VegaLiteWidget__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z, {
    spec: spec
  });
}

var VegaChartField = /*#__PURE__*/function (_ReactInlineField) {
  (0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(VegaChartField, _ReactInlineField);

  VegaChartField.fromJson = function fromJson(options) {
    return new VegaChartField(options);
  } // eslint-disable-next-line @typescript-eslint/no-explicit-any
  ;

  function VegaChartField(options) {
    var _this;

    _this = _ReactInlineField.call(this, options) || this;
    _this.EDITABLE = false;
    return _this;
  }

  var _proto = VegaChartField.prototype;

  _proto.renderInlineField = function renderInlineField() {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(VegaChartWidget, null);
  };

  return VegaChartField;
}(_ReactInlineField__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z);

VegaChartField.KEY = "jacdac_field_vega_chart";


/***/ }),

/***/ 11961:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ VegaLiteWidget; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(15861);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(67294);
/* harmony import */ var _mui_material_styles__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(98348);
/* harmony import */ var _WorkspaceContext__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(89801);
/* harmony import */ var _useBlockData__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(53851);
/* harmony import */ var _PointerBoundary__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(77298);
/* harmony import */ var _ui_Suspense__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(6890);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(5061);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(4320);
/* harmony import */ var _toolbox__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(16582);
/* harmony import */ var _useEffectAsync__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(7751);
/* harmony import */ var _tidy__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(47554);
/* harmony import */ var _jacdac_ts_src_jdom_utils__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(81794);
/* harmony import */ var _jacdac_ts_jacdac_spec_spectool_jdspec__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(13996);
/* harmony import */ var _ui_CopyButton__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(18568);
/* harmony import */ var _ui_IconButtonWithTooltip__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(71973);
/* harmony import */ var _jacdac_providerbus__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(24725);
/* harmony import */ var _mui_icons_material_SaveAlt__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(10132);

















var PREFIX = "VegaLiteWidget";
var classes = {
  button: PREFIX + "-button"
};
var Root = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .ZP)("div")(() => ({
  ["& ." + classes.button]: {
    color: "grey"
  }
}));
var VegaLite = /*#__PURE__*/(0,react__WEBPACK_IMPORTED_MODULE_0__.lazy)(() => __webpack_require__.e(/* import() */ 317).then(__webpack_require__.bind(__webpack_require__, 43670))); // eslint-disable-next-line @typescript-eslint/no-explicit-any

function clone(v) {
  return v ? JSON.parse(JSON.stringify(v)) : v;
} // eslint-disable-next-line @typescript-eslint/no-explicit-any


function isKV(v) {
  return !!v && typeof v === "object" && !Array.isArray(v);
} // eslint-disable-next-line @typescript-eslint/ban-types


function jsonMergeFrom(trg, src) {
  if (!src) return;
  Object.keys(src).forEach(k => {
    if (isKV(trg[k]) && isKV(src[k])) jsonMergeFrom(trg[k], src[k]);else trg[k] = clone(src[k]);
  });
}

function VegaLiteWidget(props) {
  var _vegaData$values;

  var {
    spec,
    slice
  } = props;
  var {
    sourceBlock
  } = (0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(_WorkspaceContext__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .ZP);
  var {
    data
  } = (0,_useBlockData__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(sourceBlock); // eslint-disable-next-line @typescript-eslint/ban-types

  var {
    0: vegaData,
    1: setVegaData
  } = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(undefined);
  var viewRef = (0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)();
  var group = (0,_tidy__WEBPACK_IMPORTED_MODULE_7__/* .tidyResolveHeader */ .gc)(data, sourceBlock === null || sourceBlock === void 0 ? void 0 : sourceBlock.getFieldValue("group")); // eslint-disable-next-line @typescript-eslint/no-explicit-any

  var settings = (0,_jacdac_ts_src_jdom_utils__WEBPACK_IMPORTED_MODULE_8__/* .JSONTryParse */ .ZZ)(sourceBlock === null || sourceBlock === void 0 ? void 0 : sourceBlock.getFieldValue("settings"));

  var handleNewView = view => viewRef.current = view;

  var fullSpec = (0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)(() => {
    if (!settings) return spec;
    var s = clone(spec);
    if (s.encoding) Object.values(s.encoding) // eslint-disable-next-line @typescript-eslint/no-explicit-any
    .filter(e => !e.title) // eslint-disable-next-line @typescript-eslint/no-explicit-any
    .forEach(e => e.title = (0,_jacdac_ts_jacdac_spec_spectool_jdspec__WEBPACK_IMPORTED_MODULE_9__/* .humanify */ .lW)(e.field));
    jsonMergeFrom(s, settings);

    if (Object.values(s.encoding || {}).some( // eslint-disable-next-line @typescript-eslint/no-explicit-any
    encoding => {
      var _encoding$scale, _encoding$scale2;

      return (encoding === null || encoding === void 0 ? void 0 : (_encoding$scale = encoding.scale) === null || _encoding$scale === void 0 ? void 0 : _encoding$scale.domainMin) !== undefined || (encoding === null || encoding === void 0 ? void 0 : (_encoding$scale2 = encoding.scale) === null || _encoding$scale2 === void 0 ? void 0 : _encoding$scale2.domainMax) !== undefined;
    })) {
      s.mark.clip = true;
    }

    if (group) {
      s.encoding.color = {
        field: group,
        title: (0,_jacdac_ts_jacdac_spec_spectool_jdspec__WEBPACK_IMPORTED_MODULE_9__/* .humanify */ .lW)(group),
        type: "nominal"
      };
      s.encoding.strokeDash = {
        field: group,
        title: (0,_jacdac_ts_jacdac_spec_spectool_jdspec__WEBPACK_IMPORTED_MODULE_9__/* .humanify */ .lW)(group),
        type: "nominal"
      };
    }

    return s;
  }, [spec, group, settings]);
  (0,_useEffectAsync__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)( /*#__PURE__*/function () {
    var _ref = (0,_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(function* (mounted) {
      if (!slice) {
        setVegaData({
          values: data
        });
      } else {
        var sliced = yield (0,_tidy__WEBPACK_IMPORTED_MODULE_7__/* .tidySlice */ .HA)(data, slice);
        if (mounted()) setVegaData({
          values: sliced
        });
      }
    });

    return function (_x) {
      return _ref.apply(this, arguments);
    };
  }(), [data]);
  if (!(vegaData !== null && vegaData !== void 0 && (_vegaData$values = vegaData.values) !== null && _vegaData$values !== void 0 && _vegaData$values.length) || !spec) return null;
  var renderer = vegaData.values.length < _toolbox__WEBPACK_IMPORTED_MODULE_5__/* .CHART_SVG_MAX_ITEMS */ .TP ? "svg" : "canvas";
  var handleCopy = _jacdac_providerbus__WEBPACK_IMPORTED_MODULE_12__/* .UIFlags.hosted */ .A.hosted ? undefined : /*#__PURE__*/(0,_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(function* () {
    var view = viewRef.current;
    var canvas = yield view === null || view === void 0 ? void 0 : view.toCanvas(2);
    return canvas;
  });
  var handleExport = _jacdac_providerbus__WEBPACK_IMPORTED_MODULE_12__/* .UIFlags.hosted */ .A.hosted ? /*#__PURE__*/(0,_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(function* () {
    var _window$parent;

    (_window$parent = window.parent) === null || _window$parent === void 0 ? void 0 : _window$parent.postMessage({
      type: "dsl",
      action: "chartexport",
      vega: fullSpec,
      slice,
      dataset: data,
      vegaDataset: vegaData
    });
  }) : undefined;
  var showToolbar = !!handleCopy || !!handleExport;
  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_PointerBoundary__WEBPACK_IMPORTED_MODULE_3__/* .PointerBoundary */ .A, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(Root, {
    style: {
      background: "#fff",
      borderRadius: "0.25rem"
    }
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_16__/* ["default"] */ .ZP, {
    container: true,
    direction: "column",
    spacing: 1
  }, showToolbar && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_16__/* ["default"] */ .ZP, {
    item: true,
    xs: 12
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_16__/* ["default"] */ .ZP, {
    container: true,
    direction: "row",
    justifyContent: "flex-start",
    alignItems: "center",
    spacing: 1
  }, !!handleCopy && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_16__/* ["default"] */ .ZP, {
    item: true
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ui_CopyButton__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z, {
    size: "small",
    className: classes.button,
    onCopy: handleCopy
  })), !!handleExport && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_16__/* ["default"] */ .ZP, {
    item: true
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ui_IconButtonWithTooltip__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z, {
    title: "save",
    size: "small",
    className: classes.button,
    onClick: handleExport
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_icons_material_SaveAlt__WEBPACK_IMPORTED_MODULE_17__/* ["default"] */ .Z, null))))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_16__/* ["default"] */ .ZP, {
    item: true,
    xs: 12
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_ui_Suspense__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(VegaLite, {
    actions: false,
    width: _toolbox__WEBPACK_IMPORTED_MODULE_5__/* .CHART_WIDTH */ .xx,
    height: _toolbox__WEBPACK_IMPORTED_MODULE_5__/* .CHART_HEIGHT */ .Fh,
    spec: fullSpec,
    data: vegaData,
    renderer: renderer,
    tooltip: true,
    onNewView: handleNewView
  })))))));
}

/***/ }),

/***/ 29434:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "k": function() { return /* binding */ registerFields; },
/* harmony export */   "w": function() { return /* binding */ fieldShadows; }
/* harmony export */ });
/* harmony import */ var blockly__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(74640);
/* harmony import */ var blockly__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(blockly__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _NoteField__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(50585);
/* harmony import */ var _KeyboardKeyField__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(90422);
/* harmony import */ var _LEDMatrixField__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(11772);
/* harmony import */ var _ServoAngleField__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(891);
/* harmony import */ var _jacdac_ts_src_jdom_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(81794);
/* harmony import */ var _LEDColorField__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(68514);
/* harmony import */ var _TwinField__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(35361);
/* harmony import */ var _JDomTreeField__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(90263);
/* harmony import */ var _WatchValueField__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(2006);
/* harmony import */ var _LogViewField__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(86899);
/* harmony import */ var _VariablesFields__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(15757);
/* harmony import */ var _DataTableField__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(54741);
/* harmony import */ var _DataColumnChooserField__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(44393);
/* harmony import */ var _BuiltinDataSetField__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(69223);
/* harmony import */ var _DataPreviewField__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(16229);
/* harmony import */ var _chart_LinePlotField__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(23030);
/* harmony import */ var _GaugeWidgetField__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(61162);
/* harmony import */ var _chart_ScatterPlotField__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(88533);
/* harmony import */ var _chart_BarField__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(95702);
/* harmony import */ var _chart_HistogramField__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(76295);
/* harmony import */ var _chart_BoxPlotField__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(62953);
/* harmony import */ var _chart_HeatMapField__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(49211);
/* harmony import */ var _chart_VegaChartField__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(61562);
/* harmony import */ var _FileSaveField__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(4383);
/* harmony import */ var _FileOpenField__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(39311);
/* harmony import */ var _UseModelField__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(86188);
/* harmony import */ var _mb_ExpandModelBlockField__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(14639);
/* harmony import */ var _mb_DataSetBlockField__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(41187);
/* harmony import */ var _mb_DataSetBlockButton__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(47740);
/* harmony import */ var _mb_RecordingBlockField__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(431);
/* harmony import */ var _mb_NeuralNetworkBlockField__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(53297);
/* harmony import */ var _mb_NeuralNetworkBlockButtons__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(19774);
/* harmony import */ var _mb_ConvLayerBlockField__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(66967);
/* harmony import */ var _mb_PoolingLayerBlockField__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(36916);
/* harmony import */ var _mb_DropoutLayerBlockField__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(63562);
/* harmony import */ var _mb_FlattenLayerBlockField__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__(82584);
/* harmony import */ var _mb_DenseLayerBlockField__WEBPACK_IMPORTED_MODULE_37__ = __webpack_require__(35121);
/* harmony import */ var _mb_TrainedModelBlockField__WEBPACK_IMPORTED_MODULE_38__ = __webpack_require__(90461);
/* harmony import */ var _JSONSettingsField__WEBPACK_IMPORTED_MODULE_39__ = __webpack_require__(68494);
/* harmony import */ var _IFrameDataChooserField__WEBPACK_IMPORTED_MODULE_40__ = __webpack_require__(84152);









































var reactFieldShadows;
function registerFields() {
  if (reactFieldShadows) return;
  reactFieldShadows = []; // eslint-disable-next-line @typescript-eslint/no-explicit-any

  var registerType = fieldType => {
    var key = fieldType.KEY;
    (0,_jacdac_ts_src_jdom_utils__WEBPACK_IMPORTED_MODULE_5__/* .assert */ .hu)(!!key);

    try {
      blockly__WEBPACK_IMPORTED_MODULE_0___default().fieldRegistry.unregister(key); // hot reload issues
    } catch (e) {// ignore hot reload issues
    }

    blockly__WEBPACK_IMPORTED_MODULE_0___default().fieldRegistry.register(key, fieldType);
    if (fieldType.SHADOW) reactFieldShadows.push(fieldType.SHADOW);
  };

  var fieldTypes = [_KeyboardKeyField__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z, _NoteField__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z, _LEDMatrixField__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z, _ServoAngleField__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z, _LEDColorField__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z, _TwinField__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z, _JDomTreeField__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z, _GaugeWidgetField__WEBPACK_IMPORTED_MODULE_17__/* ["default"] */ .Z, _WatchValueField__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z, _LogViewField__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z, _VariablesFields__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z, _DataTableField__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z, _DataPreviewField__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z, _DataColumnChooserField__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .Z, _BuiltinDataSetField__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z, _chart_ScatterPlotField__WEBPACK_IMPORTED_MODULE_18__/* ["default"] */ .Z, _chart_LinePlotField__WEBPACK_IMPORTED_MODULE_16__/* ["default"] */ .Z, _chart_BarField__WEBPACK_IMPORTED_MODULE_19__/* ["default"] */ .Z, _chart_HistogramField__WEBPACK_IMPORTED_MODULE_20__/* ["default"] */ .Z, _chart_BoxPlotField__WEBPACK_IMPORTED_MODULE_21__/* ["default"] */ .Z, _chart_HeatMapField__WEBPACK_IMPORTED_MODULE_22__/* ["default"] */ .Z, _chart_VegaChartField__WEBPACK_IMPORTED_MODULE_23__/* ["default"] */ .Z, _mb_ExpandModelBlockField__WEBPACK_IMPORTED_MODULE_27__/* ["default"] */ .Z, _mb_DataSetBlockField__WEBPACK_IMPORTED_MODULE_28__/* ["default"] */ .Z, _mb_DataSetBlockButton__WEBPACK_IMPORTED_MODULE_29__/* ["default"] */ .Z, _mb_RecordingBlockField__WEBPACK_IMPORTED_MODULE_30__/* ["default"] */ .Z, _mb_NeuralNetworkBlockField__WEBPACK_IMPORTED_MODULE_31__/* ["default"] */ .Z, _mb_NeuralNetworkBlockButtons__WEBPACK_IMPORTED_MODULE_32__/* ["default"] */ .Z, _mb_ConvLayerBlockField__WEBPACK_IMPORTED_MODULE_33__/* ["default"] */ .Z, _mb_PoolingLayerBlockField__WEBPACK_IMPORTED_MODULE_34__/* ["default"] */ .Z, _mb_DropoutLayerBlockField__WEBPACK_IMPORTED_MODULE_35__/* ["default"] */ .Z, _mb_FlattenLayerBlockField__WEBPACK_IMPORTED_MODULE_36__/* ["default"] */ .Z, _mb_DenseLayerBlockField__WEBPACK_IMPORTED_MODULE_37__/* ["default"] */ .Z, _mb_TrainedModelBlockField__WEBPACK_IMPORTED_MODULE_38__/* ["default"] */ .Z, _FileSaveField__WEBPACK_IMPORTED_MODULE_24__/* ["default"] */ .Z, _FileOpenField__WEBPACK_IMPORTED_MODULE_25__/* ["default"] */ .Z, _UseModelField__WEBPACK_IMPORTED_MODULE_26__/* ["default"] */ .Z, _JSONSettingsField__WEBPACK_IMPORTED_MODULE_39__/* ["default"] */ .Z, _IFrameDataChooserField__WEBPACK_IMPORTED_MODULE_40__/* ["default"] */ .Z];
  fieldTypes.forEach(registerType);
}
function fieldShadows() {
  registerFields();
  return reactFieldShadows.slice(0);
}

/***/ }),

/***/ 66967:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ ConvLayerBlockField; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(4942);
/* harmony import */ var _babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(43144);
/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(94578);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(67294);
/* harmony import */ var _mui_material_styles__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(98348);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(4320);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(39211);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(23961);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(65970);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(67486);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(87122);
/* harmony import */ var _ReactInlineField__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(12702);
/* harmony import */ var _PointerBoundary__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(77298);
/* harmony import */ var _WorkspaceContext__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(89801);
/* harmony import */ var react_use_id_hook__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(19640);




function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }








var PREFIX = "ConvLayerBlockField";
var classes = {
  fieldContainer: PREFIX + "-fieldContainer",
  field: PREFIX + "-field"
};
var Root = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .ZP)("div")(_ref => {
  var {
    theme
  } = _ref;
  return {
    ["& ." + classes.fieldContainer]: {
      lineHeight: "2.5rem",
      width: "15rem"
    },
    ["& ." + classes.field]: {
      width: theme.spacing(10)
    }
  };
});

function LayerParameterWidget(props) {
  var {
    initFieldValue
  } = props;
  var {
    sourceBlock
  } = (0,react__WEBPACK_IMPORTED_MODULE_1__.useContext)(_WorkspaceContext__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .ZP);
  var {
    percentSize,
    percentParams,
    outputShape,
    runTimeInMs
  } = initFieldValue;
  var {
    numFilters,
    kernelSize,
    strideSize,
    activation
  } = initFieldValue;

  var updateParameters = () => {
    // push changes to field values to the parent
    var updatedValue = {
      numFilters: numFilters,
      kernelSize: kernelSize,
      strideSize: strideSize,
      activation: activation
    }; // send new value to the parameter holder

    var expandField = sourceBlock.getField("EXPAND_BUTTON");
    expandField.updateFieldValue(updatedValue);
  };

  var handleChangedFilters = event => {
    var newValue = event.target.valueAsNumber;

    if (newValue && !isNaN(newValue)) {
      numFilters = newValue;
      updateParameters();
    }
  };

  var handleChangedKernelSize = event => {
    var newValue = event.target.valueAsNumber;

    if (newValue && !isNaN(newValue)) {
      kernelSize = newValue;
      updateParameters();
    }
  };

  var handleChangedStrides = event => {
    var newValue = event.target.valueAsNumber;

    if (newValue && !isNaN(newValue)) {
      strideSize = newValue;
      updateParameters();
    }
  };

  var handleChangedActivation = event => {
    var newValue = event.target.value;

    if (newValue) {
      activation = newValue;
      updateParameters();
    }
  };

  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(Root, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_PointerBoundary__WEBPACK_IMPORTED_MODULE_3__/* .PointerBoundary */ .A, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .ZP, {
    container: true,
    spacing: 1,
    direction: "column"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .ZP, {
    item: true,
    className: classes.fieldContainer
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z, {
    color: "text.secondary"
  }, "filters\u2003", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z, {
    title: "Update the kernel size"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z, {
    id: (0,react_use_id_hook__WEBPACK_IMPORTED_MODULE_5__/* .useId */ .Me)() + "filters",
    type: "number",
    size: "small",
    variant: "outlined",
    defaultValue: numFilters,
    onChange: handleChangedFilters,
    className: classes.field
  }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z, {
    color: "text.secondary"
  }, "kernel size\u2003", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z, {
    title: "Update the kernel size"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z, {
    id: (0,react_use_id_hook__WEBPACK_IMPORTED_MODULE_5__/* .useId */ .Me)() + "kernelSize",
    type: "number",
    size: "small",
    variant: "outlined",
    defaultValue: kernelSize,
    onChange: handleChangedKernelSize,
    className: classes.field
  }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z, {
    color: "text.secondary"
  }, "stride\u2003", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z, {
    title: "Update the stride"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z, {
    id: (0,react_use_id_hook__WEBPACK_IMPORTED_MODULE_5__/* .useId */ .Me)() + "stride",
    type: "number",
    size: "small",
    variant: "outlined",
    defaultValue: strideSize,
    onChange: handleChangedStrides,
    className: classes.field
  }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z, {
    color: "text.secondary"
  }, "activation\u2003", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z, {
    title: "Update the activation function"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z, {
    id: (0,react_use_id_hook__WEBPACK_IMPORTED_MODULE_5__/* .useId */ .Me)() + "activation",
    variant: "outlined",
    defaultValue: activation,
    onChange: handleChangedActivation
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z, {
    value: "softmax"
  }, "softmax"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z, {
    value: "linear"
  }, "linear"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z, {
    value: "relu"
  }, "relu"))))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .ZP, {
    item: true
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z, {
    color: "text.secondary"
  }, "Output shape: [", outputShape.join(", "), "]", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("br", null), "Percent of total size: ", percentSize.toPrecision(2), "%", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("br", null), "Percent of total params:", " ", percentParams.toPrecision(2), "%", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("br", null), "Run time: ", runTimeInMs.toPrecision(2), " ms ", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("br", null))))));
}

var ConvLayerBlockField = /*#__PURE__*/function (_ReactInlineField) {
  (0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .Z)(ConvLayerBlockField, _ReactInlineField);

  function ConvLayerBlockField(value, previousValue) {
    var _this;

    _this = _ReactInlineField.call(this, value) || this;
    if (previousValue) _this.value = _objectSpread(_objectSpread({}, _this.defaultValue), previousValue);
    return _this;
  }

  ConvLayerBlockField.fromJson = function fromJson(options) {
    return new ConvLayerBlockField(options === null || options === void 0 ? void 0 : options.value);
  }
  /* This default value is specified here and in modelblockdsl.ts */
  ;

  var _proto = ConvLayerBlockField.prototype;

  _proto.getText_ = function getText_() {
    return "";
  };

  _proto.renderInlineField = function renderInlineField() {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(LayerParameterWidget, {
      initFieldValue: this.value
    });
  };

  (0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(ConvLayerBlockField, [{
    key: "defaultValue",
    get: function get() {
      return {
        percentParams: 0,
        percentSize: 0,
        runTimeInMs: 0,
        outputShape: [0, 0],
        numFilters: 16,
        kernelSize: 2,
        strideSize: 1
      };
    }
  }]);

  return ConvLayerBlockField;
}(_ReactInlineField__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z);

ConvLayerBlockField.KEY = "conv_layer_block_field_key";


/***/ }),

/***/ 47740:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ DataSetBlockButtons; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(94578);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(67294);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(4320);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(23961);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(76968);
/* harmony import */ var _mui_icons_material_Visibility__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(94093);
/* harmony import */ var _mui_icons_material_GetApp__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(42594);
/* harmony import */ var _ReactInlineField__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(12702);
/* harmony import */ var _WorkspaceContext__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(89801);



 // tslint:disable-next-line: no-submodule-imports match-default-export-name

 // tslint:disable-next-line: no-submodule-imports match-default-export-name




function DataSetButtonWidget() {
  var {
    sourceBlock
  } = (0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(_WorkspaceContext__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .ZP);

  var handleViewDataSet = () => {
    console.log("View and edit dataset modal");
    sourceBlock.data = "click.edit";
  };

  var handleDownloadDataSet = () => {
    console.log("Download dataset");
    sourceBlock.data = "click.download";
  };

  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .ZP, {
    container: true,
    spacing: 1,
    direction: "row"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .ZP, {
    item: true,
    style: {
      display: "inline-flex",
      width: 300
    }
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z, {
    title: "View this data set and perform actions like splitting it"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z, {
    onClick: handleViewDataSet,
    startIcon: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_icons_material_Visibility__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z, null),
    variant: "outlined",
    size: "small"
  }, "View")), "\u2002", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z, {
    title: "Download dataset as csv file"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z, {
    onClick: handleDownloadDataSet,
    startIcon: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_icons_material_GetApp__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z, null),
    variant: "outlined",
    size: "small"
  }, "Download"))));
}

var DataSetBlockButtons = /*#__PURE__*/function (_ReactInlineField) {
  (0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z)(DataSetBlockButtons, _ReactInlineField);

  function DataSetBlockButtons(value) {
    return _ReactInlineField.call(this, value) || this;
  }

  DataSetBlockButtons.fromJson = function fromJson(options) {
    return new DataSetBlockButtons(options === null || options === void 0 ? void 0 : options.value);
  };

  var _proto = DataSetBlockButtons.prototype;

  _proto.getText_ = function getText_() {
    return "nn";
  };

  _proto.renderInlineField = function renderInlineField() {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(DataSetButtonWidget, null);
  };

  return DataSetBlockButtons;
}(_ReactInlineField__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z);

DataSetBlockButtons.KEY = "ds_block_buttons_key";


/***/ }),

/***/ 41187:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ DataSetBlockField; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(4942);
/* harmony import */ var _babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(43144);
/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(94578);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(67294);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(4320);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(39211);
/* harmony import */ var _ReactInlineField__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(12702);
/* harmony import */ var _PointerBoundary__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(77298);
/* harmony import */ var _WorkspaceContext__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(89801);
/* harmony import */ var _jacdac_ts_src_jdom_constants__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(71815);




function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }








function DataSetParameterWidget(props) {
  var {
    initFieldValue
  } = props;
  var {
    inputClasses,
    inputTypes
  } = initFieldValue;
  var {
    sourceBlock
  } = (0,react__WEBPACK_IMPORTED_MODULE_1__.useContext)(_WorkspaceContext__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .ZP);
  var services = (0,_WorkspaceContext__WEBPACK_IMPORTED_MODULE_4__/* .resolveBlockServices */ .Ys)(sourceBlock); // track workspace changes and re-render

  var {
    1: setBlockData
  } = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(services.data);
  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => services === null || services === void 0 ? void 0 : services.subscribe(_jacdac_ts_src_jdom_constants__WEBPACK_IMPORTED_MODULE_5__/* .CHANGE */ .Ver, () => {
    setBlockData(services.data);
  }), [services]);
  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_PointerBoundary__WEBPACK_IMPORTED_MODULE_3__/* .PointerBoundary */ .A, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .ZP, {
    container: true,
    spacing: 1,
    direction: "column"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .ZP, {
    item: true
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z, {
    color: "text.secondary"
  }, "Classes:", " ", inputClasses.length ? inputClasses.join(", ") : "none", " ", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("br", null), "Input type(s):", " ", inputTypes.length ? inputTypes.join(", ") : "none"))));
}

var DataSetBlockField = /*#__PURE__*/function (_ReactInlineField) {
  (0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z)(DataSetBlockField, _ReactInlineField);

  function DataSetBlockField(value, previousValue) {
    var _this;

    _this = _ReactInlineField.call(this, value) || this;
    if (previousValue) _this.value = _objectSpread(_objectSpread({}, _this.defaultValue), previousValue);
    return _this;
  }

  DataSetBlockField.fromJson = function fromJson(options) {
    return new DataSetBlockField(options === null || options === void 0 ? void 0 : options.value);
  }
  /* This default value is specified here and in modelblockdsl.ts */
  ;

  var _proto = DataSetBlockField.prototype;

  _proto.getText_ = function getText_() {
    var totalRecordings = this.value.numRecordings;
    return totalRecordings + " recording(s)";
  };

  _proto.renderInlineField = function renderInlineField() {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(DataSetParameterWidget, {
      initFieldValue: this.value
    });
  };

  (0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(DataSetBlockField, [{
    key: "defaultValue",
    get: function get() {
      return {
        numRecordings: 0,
        numSamples: 0,
        inputClasses: [],
        inputTypes: []
      };
    }
  }]);

  return DataSetBlockField;
}(_ReactInlineField__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z);

DataSetBlockField.KEY = "dataset_block_field_key";


/***/ }),

/***/ 35121:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ DenseLayerBlockField; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(4942);
/* harmony import */ var _babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(43144);
/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(94578);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(67294);
/* harmony import */ var _mui_material_styles__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(98348);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(4320);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(39211);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(23961);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(65970);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(67486);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(87122);
/* harmony import */ var _ReactInlineField__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(12702);
/* harmony import */ var _PointerBoundary__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(77298);
/* harmony import */ var _WorkspaceContext__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(89801);
/* harmony import */ var react_use_id_hook__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(19640);




function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }








var PREFIX = "DenseLayerBlockField";
var classes = {
  fieldContainer: PREFIX + "-fieldContainer",
  field: PREFIX + "-field"
}; // TODO jss-to-styled codemod: The Fragment root was replaced by div. Change the tag if needed.

var Root = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .ZP)("div")(_ref => {
  var {
    theme
  } = _ref;
  return {
    ["& ." + classes.fieldContainer]: {
      lineHeight: "2.5rem",
      width: "15rem"
    },
    ["& ." + classes.field]: {
      width: theme.spacing(10)
    }
  };
});

function LayerParameterWidget(props) {
  var {
    initFieldValue
  } = props;
  var {
    sourceBlock
  } = (0,react__WEBPACK_IMPORTED_MODULE_1__.useContext)(_WorkspaceContext__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .ZP);
  var {
    percentSize,
    percentParams,
    outputShape,
    runTimeInMs
  } = initFieldValue;
  var {
    numUnits,
    activation
  } = initFieldValue;

  var updateParameters = () => {
    // push changes to field values to the parent
    var updatedValue = {
      numUnits: numUnits,
      activation: activation
    }; // send new value to the parameter holder

    var expandField = sourceBlock.getField("EXPAND_BUTTON");
    expandField.updateFieldValue(updatedValue);
  };

  var handleChangedUnits = event => {
    var newValue = event.target.valueAsNumber;

    if (newValue && !isNaN(newValue)) {
      numUnits = newValue;
      updateParameters();
    }
  };

  var handleChangedActivation = event => {
    var newValue = event.target.value;

    if (newValue) {
      activation = newValue;
      updateParameters();
    }
  };

  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(Root, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_PointerBoundary__WEBPACK_IMPORTED_MODULE_3__/* .PointerBoundary */ .A, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .ZP, {
    container: true,
    spacing: 1,
    direction: "column"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .ZP, {
    item: true,
    className: classes.fieldContainer
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z, {
    color: "text.secondary"
  }, "units\u2003", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z, {
    title: "Update the number of units"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z, {
    id: (0,react_use_id_hook__WEBPACK_IMPORTED_MODULE_5__/* .useId */ .Me)() + "filters",
    type: "number",
    size: "small",
    variant: "outlined",
    defaultValue: numUnits,
    onChange: handleChangedUnits,
    className: classes.field
  }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z, {
    color: "text.secondary"
  }, "activation\u2003", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z, {
    title: "Update the activation function"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z, {
    id: (0,react_use_id_hook__WEBPACK_IMPORTED_MODULE_5__/* .useId */ .Me)() + "activation",
    variant: "outlined",
    defaultValue: activation,
    onChange: handleChangedActivation
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z, {
    value: "softmax"
  }, "softmax"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z, {
    value: "linear"
  }, "linear"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z, {
    value: "relu"
  }, "relu"))))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .ZP, {
    item: true
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z, {
    color: "text.secondary"
  }, "Output shape: [", outputShape.join(", "), "]", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("br", null), "Percent of total size: ", percentSize.toPrecision(2), "%", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("br", null), "Percent of total params:", " ", percentParams.toPrecision(2), "%", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("br", null), "Run time: ", runTimeInMs.toPrecision(2), " ms ", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("br", null))))));
}

var DenseLayerBlockField = /*#__PURE__*/function (_ReactInlineField) {
  (0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .Z)(DenseLayerBlockField, _ReactInlineField);

  function DenseLayerBlockField(value, previousValue) {
    var _this;

    _this = _ReactInlineField.call(this, value) || this;
    if (previousValue) _this.value = _objectSpread(_objectSpread({}, _this.defaultValue), previousValue);
    return _this;
  }

  DenseLayerBlockField.fromJson = function fromJson(options) {
    return new DenseLayerBlockField(options === null || options === void 0 ? void 0 : options.value);
  }
  /* This default value is specified here and in modelblockdsl.ts */
  ;

  var _proto = DenseLayerBlockField.prototype;

  _proto.getText_ = function getText_() {
    return "";
  };

  _proto.renderInlineField = function renderInlineField() {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(LayerParameterWidget, {
      initFieldValue: this.value
    });
  };

  (0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(DenseLayerBlockField, [{
    key: "defaultValue",
    get: function get() {
      return {
        percentParams: 0,
        percentSize: 0,
        runTimeInMs: 0,
        outputShape: [0],
        numUnits: 4,
        activation: "relu"
      };
    }
  }]);

  return DenseLayerBlockField;
}(_ReactInlineField__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z);

DenseLayerBlockField.KEY = "dense_layer_block_field_key";


/***/ }),

/***/ 63562:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ DropoutLayerBlockField; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(4942);
/* harmony import */ var _babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(43144);
/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(94578);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(67294);
/* harmony import */ var _mui_material_styles__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(98348);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(4320);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(39211);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(23961);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(65970);
/* harmony import */ var _ReactInlineField__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(12702);
/* harmony import */ var _PointerBoundary__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(77298);
/* harmony import */ var _WorkspaceContext__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(89801);
/* harmony import */ var react_use_id_hook__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(19640);




function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }








var PREFIX = "DropoutLayerBlockField";
var classes = {
  fieldContainer: PREFIX + "-fieldContainer",
  field: PREFIX + "-field"
};
var Root = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .ZP)("div")(_ref => {
  var {
    theme
  } = _ref;
  return {
    ["& ." + classes.fieldContainer]: {
      lineHeight: "2.5rem",
      width: "15rem"
    },
    ["& ." + classes.field]: {
      width: theme.spacing(10)
    }
  };
});

function LayerParameterWidget(props) {
  var {
    initFieldValue
  } = props;
  var {
    sourceBlock
  } = (0,react__WEBPACK_IMPORTED_MODULE_1__.useContext)(_WorkspaceContext__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .ZP);
  var {
    percentSize,
    percentParams,
    outputShape,
    runTimeInMs
  } = initFieldValue;
  var rate = initFieldValue.rate;

  var updateParameters = () => {
    var rateAsNum;
    if (rate == "0.") rateAsNum = 0;else rateAsNum = parseFloat(rate); // push changes to field values to the parent

    var updatedValue = {
      rate: rateAsNum
    }; // send new value to the parameter holder

    var expandField = sourceBlock.getField("EXPAND_BUTTON");
    expandField.updateFieldValue(updatedValue);
  };

  var handleChangedRate = event => {
    var newValue = event.target.value;

    if (newValue) {
      var valueAsNum; // catch edge case?

      if (newValue == "0.") valueAsNum = 0;else valueAsNum = parseFloat(newValue);

      if (valueAsNum >= 0 && valueAsNum < 1) {
        rate = newValue;
        updateParameters();
      }
    }
  };

  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_PointerBoundary__WEBPACK_IMPORTED_MODULE_3__/* .PointerBoundary */ .A, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .ZP, {
    container: true,
    spacing: 1,
    direction: "column"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .ZP, {
    item: true,
    className: classes.fieldContainer
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z, {
    color: "text.secondary"
  }, "rate\u2003", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z, {
    title: "Update the dropout rate"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z, {
    id: (0,react_use_id_hook__WEBPACK_IMPORTED_MODULE_5__/* .useId */ .Me)() + "rate",
    type: "text",
    size: "small",
    variant: "outlined",
    defaultValue: rate,
    onChange: handleChangedRate,
    className: classes.field
  })))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .ZP, {
    item: true
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z, {
    color: "text.secondary"
  }, "Output shape: [", outputShape.join(", "), "]", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("br", null), "Percent of total size: ", percentSize.toPrecision(2), "%", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("br", null), "Percent of total params: ", percentParams.toPrecision(2), "%", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("br", null), "Run time: ", runTimeInMs.toPrecision(2), " ms ", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("br", null)))));
}

var DropoutLayerBlockField = /*#__PURE__*/function (_ReactInlineField) {
  (0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z)(DropoutLayerBlockField, _ReactInlineField);

  function DropoutLayerBlockField(value, previousValue) {
    var _this;

    _this = _ReactInlineField.call(this, value) || this;
    if (previousValue) _this.value = _objectSpread(_objectSpread({}, _this.defaultValue), previousValue);
    return _this;
  }

  DropoutLayerBlockField.fromJson = function fromJson(options) {
    return new DropoutLayerBlockField(options === null || options === void 0 ? void 0 : options.value);
  }
  /* This default value is specified here and in modelblockdsl.ts */
  ;

  var _proto = DropoutLayerBlockField.prototype;

  _proto.getText_ = function getText_() {
    return "";
  };

  _proto.renderInlineField = function renderInlineField() {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(Root, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(LayerParameterWidget, {
      initFieldValue: this.value
    }));
  };

  (0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z)(DropoutLayerBlockField, [{
    key: "defaultValue",
    get: function get() {
      return {
        percentParams: 0,
        percentSize: 0,
        runTimeInMs: 0,
        outputShape: [0, 0],
        rate: "0.1"
      };
    }
  }]);

  return DropoutLayerBlockField;
}(_ReactInlineField__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z);

DropoutLayerBlockField.KEY = "dropout_layer_block_field_key";


/***/ }),

/***/ 14639:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ ExpandModelBlockField; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(4942);
/* harmony import */ var _babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(43144);
/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(94578);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(67294);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(4320);
/* harmony import */ var _mui_icons_material_AddCircleOutline__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(94325);
/* harmony import */ var _mui_icons_material_RemoveCircleOutline__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(35880);
/* harmony import */ var _ui_IconButtonWithTooltip__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(71973);
/* harmony import */ var _ReactInlineField__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(12702);
/* harmony import */ var _WorkspaceContext__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(89801);
/* harmony import */ var _model_editor_modelblockdsl__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(95149);
/* harmony import */ var _DenseLayerBlockField__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(35121);
/* harmony import */ var _DataSetBlockField__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(41187);
/* harmony import */ var _RecordingBlockField__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(431);
/* harmony import */ var _NeuralNetworkBlockField__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(53297);
/* harmony import */ var _ConvLayerBlockField__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(66967);
/* harmony import */ var _PoolingLayerBlockField__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(36916);
/* harmony import */ var _DropoutLayerBlockField__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(63562);
/* harmony import */ var _FlattenLayerBlockField__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(82584);




function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

















var REMOVABLE_INPUT = "REMOVABLE_INPUT";
var LAYER_INPUT = "LAYER_INPUTS";

function ExpandIconWidget() {
  var {
    sourceBlock
  } = (0,react__WEBPACK_IMPORTED_MODULE_1__.useContext)(_WorkspaceContext__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .ZP);

  var getCurrentValue = () => {
    var expandField = sourceBlock.getField("EXPAND_BUTTON");

    if (expandField.getValue()) {
      var value = JSON.parse(expandField.getValue());
      return value;
    }

    return null;
  };

  var updateCurrentValue = (paramName, paramValue) => {
    var expandField = sourceBlock.getField("EXPAND_BUTTON");
    expandField.updateFieldValue({
      paramName: paramValue
    });
  };

  var appendParamInput = block => {
    block.appendDummyInput(REMOVABLE_INPUT).appendField(getBlockFieldType(block.type), "BLOCK_PARAMS"); // TODO. This is a hack, no moving blocks that are open

    block.setMovable(false); // place the new input before the input statement field

    if (block.getInput(LAYER_INPUT)) block.moveInputBefore(REMOVABLE_INPUT, LAYER_INPUT);
  };

  var getBlockFieldType = blockType => {
    var currentValue = getCurrentValue();

    switch (blockType) {
      case _model_editor_modelblockdsl__WEBPACK_IMPORTED_MODULE_5__/* .MODEL_BLOCKS */ .GJ + "dataset":
        return new _DataSetBlockField__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z("", currentValue);

      case _model_editor_modelblockdsl__WEBPACK_IMPORTED_MODULE_5__/* .MODEL_BLOCKS */ .GJ + "recording":
        return new _RecordingBlockField__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z("", currentValue);

      case _model_editor_modelblockdsl__WEBPACK_IMPORTED_MODULE_5__/* .MODEL_BLOCKS */ .GJ + "nn":
        return new _NeuralNetworkBlockField__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z("", currentValue);

      case _model_editor_modelblockdsl__WEBPACK_IMPORTED_MODULE_5__/* .MODEL_BLOCKS */ .GJ + "conv1d_layer":
        return new _ConvLayerBlockField__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z("", currentValue);

      case _model_editor_modelblockdsl__WEBPACK_IMPORTED_MODULE_5__/* .MODEL_BLOCKS */ .GJ + "conv2d_layer":
        return new _ConvLayerBlockField__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z("", currentValue);

      case _model_editor_modelblockdsl__WEBPACK_IMPORTED_MODULE_5__/* .MODEL_BLOCKS */ .GJ + "dense_layer":
        return new _DenseLayerBlockField__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z("", currentValue);

      case _model_editor_modelblockdsl__WEBPACK_IMPORTED_MODULE_5__/* .MODEL_BLOCKS */ .GJ + "dropout_layer":
        return new _DropoutLayerBlockField__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z("", currentValue);

      case _model_editor_modelblockdsl__WEBPACK_IMPORTED_MODULE_5__/* .MODEL_BLOCKS */ .GJ + "flatten_layer":
        return new _FlattenLayerBlockField__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .Z("", currentValue);

      case _model_editor_modelblockdsl__WEBPACK_IMPORTED_MODULE_5__/* .MODEL_BLOCKS */ .GJ + "maxpool1d_layer":
        return new _PoolingLayerBlockField__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z("", currentValue);

      case _model_editor_modelblockdsl__WEBPACK_IMPORTED_MODULE_5__/* .MODEL_BLOCKS */ .GJ + "maxpool2d_layer":
        return new _PoolingLayerBlockField__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z("", currentValue);

      case _model_editor_modelblockdsl__WEBPACK_IMPORTED_MODULE_5__/* .MODEL_BLOCKS */ .GJ + "avgpool1d_layer":
        return new _PoolingLayerBlockField__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z("", currentValue);

      case _model_editor_modelblockdsl__WEBPACK_IMPORTED_MODULE_5__/* .MODEL_BLOCKS */ .GJ + "avgpool2d_layer":
        return new _PoolingLayerBlockField__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z("", currentValue);

      default:
        console.error("Got inappropriate input for expanding block");
        return null;
    }
  };

  var {
    0: parametersVisible,
    1: setParametersVisible
  } = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(() => {
    var fieldValue = getCurrentValue();

    if (fieldValue) {
      var paramsVisible = fieldValue["parametersVisible"];
      if (paramsVisible) appendParamInput(sourceBlock);
      return paramsVisible;
    }

    return false;
  });

  var handleExpandBlock = () => {
    var parameterField = sourceBlock.getField("BLOCK_PARAMS");

    if (parameterField) {
      // save the parameters written to that block
      var paramValues = JSON.parse(parameterField.getValue());
      Object.keys(paramValues).forEach(key => {
        updateCurrentValue(key, paramValues[key]);
      }); // identify which input to remove and remove it

      parameterField.getParentInput().name = REMOVABLE_INPUT;
      sourceBlock.removeInput(REMOVABLE_INPUT); // TODO this is a hack. Need to implement textToDom and domToText for these mutator blocks

      sourceBlock.setMovable(true); // update the value of the expand button field

      updateCurrentValue("parametersVisible", false);
      setParametersVisible(false);
    } else {
      // add a removable field with the appropriate field type
      appendParamInput(sourceBlock); // update the value of the expand button field

      updateCurrentValue("parametersVisible", true);
      setParametersVisible(true);
    }
  };

  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .ZP, {
    container: true,
    spacing: 1
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .ZP, {
    item: true
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_ui_IconButtonWithTooltip__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z, {
    style: {
      backgroundColor: "transparent"
    },
    onClick: handleExpandBlock,
    title: "Expand dataset block to see all dataset info"
  }, parametersVisible ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_icons_material_RemoveCircleOutline__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z, null) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_icons_material_AddCircleOutline__WEBPACK_IMPORTED_MODULE_16__/* ["default"] */ .Z, null))));
}

var ExpandModelBlockField = /*#__PURE__*/function (_ReactInlineField) {
  (0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_17__/* ["default"] */ .Z)(ExpandModelBlockField, _ReactInlineField);

  function ExpandModelBlockField(value) {
    return _ReactInlineField.call(this, value) || this;
  }

  var _proto = ExpandModelBlockField.prototype;

  _proto.createContainer = function createContainer() {
    var c = document.createElement("div");
    c.style.display = "inline-block";
    c.style.minWidth = "2rem";
    return c;
  };

  ExpandModelBlockField.fromJson = function fromJson(options) {
    return new ExpandModelBlockField(options === null || options === void 0 ? void 0 : options.value);
  };

  _proto.fromXml = function fromXml(fieldElement) {
    this.setValue(fieldElement.textContent);
    this.updateBlockName();
  };

  _proto.updateBlockName = function updateBlockName() {
    var sourceBlock = this.getSourceBlock();
    var nameField = sourceBlock.inputList[0].fieldRow[0];
    var name = nameField.getValue();
    var blockName = name.substr(0, name.indexOf("(") - 1);

    if (sourceBlock.type.indexOf("conv") > 0) {
      // display filters, kernel size, and stride size for convolutional blocks
      nameField.setValue(blockName + " (" + this.value.numFilters + ", " + this.value.kernelSize + ", " + this.value.strideSize + ")");
    } else if (sourceBlock.type.indexOf("pool") > 0) {
      // display kernel size and stride for pooling blocks
      // update the name of the block
      nameField.setValue(blockName + " (" + this.value.poolSize + ", " + this.value.strideSize + ")");
    } else if (sourceBlock.type.indexOf("dense") > 0) {
      // display number of units and activation functions for dense blocks
      nameField.setValue(blockName + " (" + this.value.numUnits + ", " + this.value.activation + ")");
    } else if (sourceBlock.type.indexOf("drop") > 0) {
      // display the dropout rate for dropout layers
      nameField.setValue(blockName + " (" + this.value.rate + ")");
    } // don't list parameters of other blocks

  };

  _proto.getText_ = function getText_() {
    return ",";
  };

  _proto.renderInlineField = function renderInlineField() {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(ExpandIconWidget, null);
  };

  _proto.updateFieldValue = function updateFieldValue(msg) {
    this.value = _objectSpread(_objectSpread({}, this.value), msg);
    this.updateBlockName();
  };

  (0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_18__/* ["default"] */ .Z)(ExpandModelBlockField, [{
    key: "defaultValue",
    get: function get() {
      return {
        parametersVisible: false
      };
    }
  }]);

  return ExpandModelBlockField;
}(_ReactInlineField__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z);

ExpandModelBlockField.KEY = "model_field_key";


/***/ }),

/***/ 82584:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ FlattenLayerBlockField; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(4942);
/* harmony import */ var _babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(43144);
/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(94578);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(67294);
/* harmony import */ var _mui_material_styles__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(98348);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(4320);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(39211);
/* harmony import */ var _ReactInlineField__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(12702);
/* harmony import */ var _PointerBoundary__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(77298);




function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }






var PREFIX = "FlattenLayerBlockField";
var classes = {
  fieldContainer: PREFIX + "-fieldContainer",
  field: PREFIX + "-field"
}; // TODO jss-to-styled codemod: The Fragment root was replaced by div. Change the tag if needed.

var Root = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .ZP)("div")(_ref => {
  var {
    theme
  } = _ref;
  return {
    ["& ." + classes.fieldContainer]: {
      lineHeight: "2.5rem",
      width: "15rem"
    },
    ["& ." + classes.field]: {
      width: theme.spacing(10)
    }
  };
});

function LayerParameterWidget(props) {
  var {
    initFieldValue
  } = props;
  var {
    percentSize,
    percentParams,
    outputShape,
    runTimeInMs
  } = initFieldValue;
  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_PointerBoundary__WEBPACK_IMPORTED_MODULE_3__/* .PointerBoundary */ .A, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .ZP, {
    container: true,
    spacing: 1,
    direction: "column"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .ZP, {
    item: true
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z, {
    color: "text.secondary"
  }, "Output shape: [", outputShape.join(", "), "]", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("br", null), "Percent of total size: ", percentSize.toPrecision(2), "%", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("br", null), "Percent of total params: ", percentParams.toPrecision(2), "%", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("br", null), "Run time: ", runTimeInMs.toPrecision(2), " ms ", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("br", null)))));
}

var FlattenLayerBlockField = /*#__PURE__*/function (_ReactInlineField) {
  (0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(FlattenLayerBlockField, _ReactInlineField);

  function FlattenLayerBlockField(value, previousValue) {
    var _this;

    _this = _ReactInlineField.call(this, value) || this;
    if (previousValue) _this.value = _objectSpread(_objectSpread({}, _this.defaultValue), previousValue);
    return _this;
  }

  FlattenLayerBlockField.fromJson = function fromJson(options) {
    return new FlattenLayerBlockField(options === null || options === void 0 ? void 0 : options.value);
  }
  /* This default value is specified here and in modelblockdsl.ts */
  ;

  var _proto = FlattenLayerBlockField.prototype;

  _proto.getText_ = function getText_() {
    return "";
  };

  _proto.renderInlineField = function renderInlineField() {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(Root, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(LayerParameterWidget, {
      initFieldValue: this.value
    }));
  };

  (0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z)(FlattenLayerBlockField, [{
    key: "defaultValue",
    get: function get() {
      return {
        runTimeInMs: 0,
        outputShape: [0],
        percentParams: 0,
        percentSize: 0,
        numUnits: 4,
        activation: "relu"
      };
    }
  }]);

  return FlattenLayerBlockField;
}(_ReactInlineField__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z);

FlattenLayerBlockField.KEY = "flatten_layer_block_field_key";


/***/ }),

/***/ 19774:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ NeuralNetworkBlockButtons; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(94578);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(67294);
/* harmony import */ var _mui_material_styles__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(98348);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(4320);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(23961);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(76968);
/* harmony import */ var _mui_icons_material_Autorenew__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(47450);
/* harmony import */ var _mui_icons_material_GetApp__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(42594);
/* harmony import */ var _ReactInlineField__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(12702);
/* harmony import */ var _WorkspaceContext__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(89801);




 // tslint:disable-next-line: no-submodule-imports match-default-export-name

 // tslint:disable-next-line: no-submodule-imports match-default-export-name



var PREFIX = "NeuralNetworkBlockButtons";
var classes = {
  numberField: PREFIX + "-numberField",
  buttonContainer: PREFIX + "-buttonContainer"
};
var Root = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .ZP)("div")(_ref => {
  var {
    theme
  } = _ref;
  return {
    ["& ." + classes.numberField]: {
      marginBottom: theme.spacing(1)
    },
    ["& ." + classes.buttonContainer]: {
      display: "inline-flex",
      width: 300
    }
  };
});

function NeuralNetworkButtonWidget() {
  var {
    sourceBlock
  } = (0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(_WorkspaceContext__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .ZP);

  var handleTrainModel = () => {
    console.log("Open NN classifier modal");
    sourceBlock.data = "click.train";
  };

  var handleDownloadModel = () => {
    console.log("Download model");
    sourceBlock.data = "click.download";
  };

  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .ZP, {
    container: true,
    spacing: 1,
    direction: "row"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .ZP, {
    item: true,
    className: classes.buttonContainer
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z, {
    title: "Open modal to view and run classifier"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z, {
    onClick: handleTrainModel,
    startIcon: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_icons_material_Autorenew__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z, null),
    variant: "outlined",
    size: "small"
  }, "Train")), "\u2002", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z, {
    title: "Download model JSON and weights file"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z, {
    onClick: handleDownloadModel,
    startIcon: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_icons_material_GetApp__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z, null),
    variant: "outlined",
    size: "small"
  }, "Download"))));
}

var NeuralNetworkBlockButtons = /*#__PURE__*/function (_ReactInlineField) {
  (0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z)(NeuralNetworkBlockButtons, _ReactInlineField);

  function NeuralNetworkBlockButtons(value) {
    return _ReactInlineField.call(this, value) || this;
  }

  NeuralNetworkBlockButtons.fromJson = function fromJson(options) {
    return new NeuralNetworkBlockButtons(options === null || options === void 0 ? void 0 : options.value);
  };

  var _proto = NeuralNetworkBlockButtons.prototype;

  _proto.getText_ = function getText_() {
    return "nn";
  };

  _proto.renderInlineField = function renderInlineField() {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(Root, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(NeuralNetworkButtonWidget, null));
  };

  return NeuralNetworkBlockButtons;
}(_ReactInlineField__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z);

NeuralNetworkBlockButtons.KEY = "nn_block_buttons_key";


/***/ }),

/***/ 53297:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ NeuralNetworkBlockField; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(4942);
/* harmony import */ var _babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(43144);
/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(94578);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(67294);
/* harmony import */ var _mui_material_styles__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(98348);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(4320);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(39211);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(23961);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(67486);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(87122);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(65970);
/* harmony import */ var _ReactInlineField__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(12702);
/* harmony import */ var _PointerBoundary__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(77298);
/* harmony import */ var _WorkspaceContext__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(89801);
/* harmony import */ var react_use_id_hook__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(19640);




function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }








var PREFIX = "NeuralNetworkBlockField";
var classes = {
  fieldContainer: PREFIX + "-fieldContainer",
  field: PREFIX + "-field"
}; // TODO jss-to-styled codemod: The Fragment root was replaced by div. Change the tag if needed.

var Root = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .ZP)("div")(_ref => {
  var {
    theme
  } = _ref;
  return {
    ["& ." + classes.fieldContainer]: {
      lineHeight: "2.5rem",
      width: "15rem"
    },
    ["& ." + classes.field]: {
      width: theme.spacing(10)
    }
  };
});

function NNParameterWidget(props) {
  var {
    initFieldValue
  } = props;
  var {
    sourceBlock
  } = (0,react__WEBPACK_IMPORTED_MODULE_1__.useContext)(_WorkspaceContext__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .ZP);
  var {
    totalLayers,
    totalSize,
    totalParams,
    runTimeInMs,
    inputShape
  } = initFieldValue;
  var {
    0: optimizer,
    1: setOptimizer
  } = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(initFieldValue.optimizer);
  var {
    0: numEpochs,
    1: setNumEpochs
  } = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(initFieldValue.numEpochs);
  var {
    0: lossFn,
    1: setLossFn
  } = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(initFieldValue.lossFn);
  var {
    0: metrics,
    1: setMetrics
  } = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(initFieldValue.metrics);
  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {
    // push changes to source block after state values update
    updateParameters();
  }, [optimizer, numEpochs, lossFn, metrics]);

  var updateParameters = () => {
    // push changes to field values to the parent
    var updatedValue = {
      optimizer: optimizer,
      numEpochs: numEpochs,
      lossFn: lossFn,
      metrics: metrics
    }; // send new value to the parameter holder

    var expandField = sourceBlock.getField("EXPAND_BUTTON");
    expandField.updateFieldValue(updatedValue);
  };

  var handleChangedEpochs = event => {
    var newValue = event.target.valueAsNumber;

    if (newValue && !isNaN(newValue)) {
      setNumEpochs(newValue);
    }
  };

  var handleChangedOptimizer = event => {
    var newValue = event.target.value;
    if (newValue) setOptimizer(newValue);
  };

  var handleChangedLossFn = event => {
    var newValue = event.target.value;
    if (newValue) setLossFn(newValue);
  };

  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_PointerBoundary__WEBPACK_IMPORTED_MODULE_3__/* .PointerBoundary */ .A, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .ZP, {
    container: true,
    spacing: 1,
    direction: "column"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .ZP, {
    item: true,
    className: classes.fieldContainer
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z, {
    color: "text.secondary"
  }, "optimizer\u2002", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z, {
    title: "Update the optimizer"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z, {
    id: (0,react_use_id_hook__WEBPACK_IMPORTED_MODULE_5__/* .useId */ .Me)() + "optimizer",
    variant: "outlined",
    value: optimizer,
    onChange: handleChangedOptimizer
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z, {
    value: "adam"
  }, "adam"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z, {
    value: "sgd"
  }, "SGD"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z, {
    value: "adagrad"
  }, "adagrad"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z, {
    value: "adadelta"
  }, "adadelta")))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z, {
    color: "text.secondary"
  }, "loss\u2002", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z, {
    title: "Update the loss function"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z, {
    id: (0,react_use_id_hook__WEBPACK_IMPORTED_MODULE_5__/* .useId */ .Me)() + "lossFn",
    variant: "outlined",
    value: lossFn,
    onChange: handleChangedLossFn
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z, {
    value: "categoricalCrossentropy"
  }, "CCE"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z, {
    value: "meanSquaredError"
  }, "MSE"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z, {
    value: "hinge"
  }, "hinge")))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z, {
    color: "text.secondary"
  }, "epochs\u2002", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z, {
    title: "Update the batch size to train on"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z, {
    id: (0,react_use_id_hook__WEBPACK_IMPORTED_MODULE_5__/* .useId */ .Me)() + "epochs",
    type: "number",
    size: "small",
    variant: "outlined",
    value: numEpochs,
    onChange: handleChangedEpochs,
    className: classes.field
  })))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .ZP, {
    item: true
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z, {
    color: "text.secondary"
  }, "Input shape: [", inputShape.join(", "), "]", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("br", null), "No. of layers: ", totalLayers, " ", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("br", null), "No. of parameters: ", totalParams, " ", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("br", null), "Total size: ", (totalSize / 1000).toPrecision(2), " KB", " ", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("br", null), "Run time: ", runTimeInMs.toPrecision(2), "ms @ 64MHz ", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("br", null)))));
}

var NeuralNetworkBlockField = /*#__PURE__*/function (_ReactInlineField) {
  (0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .Z)(NeuralNetworkBlockField, _ReactInlineField);

  function NeuralNetworkBlockField(value, previousValue) {
    var _this;

    _this = _ReactInlineField.call(this, value) || this;
    if (previousValue) _this.value = _objectSpread(_objectSpread({}, _this.defaultValue), previousValue);
    return _this;
  }

  NeuralNetworkBlockField.fromJson = function fromJson(options) {
    return new NeuralNetworkBlockField(options === null || options === void 0 ? void 0 : options.value);
  }
  /* This default value is specified here and in modelblockdsl.ts */
  ;

  var _proto = NeuralNetworkBlockField.prototype;

  _proto.getText_ = function getText_() {
    var {
      totalLayers
    } = this.value;
    return totalLayers + " layer(s)";
  };

  _proto.renderInlineField = function renderInlineField() {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(Root, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(NNParameterWidget, {
      initFieldValue: this.value
    }));
  };

  (0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z)(NeuralNetworkBlockField, [{
    key: "defaultValue",
    get: function get() {
      return {
        totalLayers: 0,
        totalParams: 0,
        totalSize: 0,
        runTimeInMs: 0,
        inputShape: [0, 0],
        optimizer: "adam",
        numEpochs: 200,
        lossFn: "categoricalCrossentropy",
        metrics: "acc"
      };
    }
  }]);

  return NeuralNetworkBlockField;
}(_ReactInlineField__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z);

NeuralNetworkBlockField.KEY = "nn_block_field_key";


/***/ }),

/***/ 36916:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ PoolingLayerBlockField; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(4942);
/* harmony import */ var _babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(43144);
/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(94578);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(67294);
/* harmony import */ var _mui_material_styles__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(98348);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(4320);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(39211);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(23961);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(65970);
/* harmony import */ var _ReactInlineField__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(12702);
/* harmony import */ var _PointerBoundary__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(77298);
/* harmony import */ var _WorkspaceContext__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(89801);
/* harmony import */ var react_use_id_hook__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(19640);




function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }








var PREFIX = "PoolingLayerBlockField";
var classes = {
  fieldContainer: PREFIX + "-fieldContainer",
  field: PREFIX + "-field"
};
var Root = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .ZP)("div")(_ref => {
  var {
    theme
  } = _ref;
  return {
    ["& ." + classes.fieldContainer]: {
      lineHeight: "2.5rem",
      width: "15rem"
    },
    ["& ." + classes.field]: {
      width: theme.spacing(10)
    }
  };
});

function LayerParameterWidget(props) {
  var {
    initFieldValue
  } = props;
  var {
    sourceBlock
  } = (0,react__WEBPACK_IMPORTED_MODULE_1__.useContext)(_WorkspaceContext__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .ZP);
  var {
    percentSize,
    percentParams,
    outputShape,
    runTimeInMs
  } = initFieldValue;
  var {
    poolSize,
    strideSize
  } = initFieldValue;

  var updateParameters = () => {
    // push changes to field values to the parent
    var updatedValue = {
      poolSize: poolSize,
      strideSize: strideSize
    }; // send new value to the parameter holder

    var expandField = sourceBlock.getField("EXPAND_BUTTON");
    expandField.updateFieldValue(updatedValue);
  };

  var handleChangedPoolSize = event => {
    var newValue = event.target.valueAsNumber;

    if (newValue && !isNaN(newValue)) {
      poolSize = newValue;
      updateParameters();
    }
  };

  var handleChangedStrides = event => {
    var newValue = event.target.valueAsNumber;

    if (newValue && !isNaN(newValue)) {
      strideSize = newValue;
      updateParameters();
    }
  };

  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_PointerBoundary__WEBPACK_IMPORTED_MODULE_3__/* .PointerBoundary */ .A, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .ZP, {
    container: true,
    spacing: 1,
    direction: "column"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .ZP, {
    item: true,
    className: classes.fieldContainer
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z, {
    color: "text.secondary"
  }, "pool size\u2003", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z, {
    title: "Update the pool size"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z, {
    id: (0,react_use_id_hook__WEBPACK_IMPORTED_MODULE_5__/* .useId */ .Me)() + "poolSize",
    type: "number",
    size: "small",
    variant: "outlined",
    defaultValue: poolSize,
    onChange: handleChangedPoolSize,
    className: classes.field
  }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z, {
    color: "text.secondary"
  }, "stride\u2003", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z, {
    title: "Update the stride"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z, {
    id: (0,react_use_id_hook__WEBPACK_IMPORTED_MODULE_5__/* .useId */ .Me)() + "stride",
    type: "number",
    size: "small",
    variant: "outlined",
    defaultValue: strideSize,
    onChange: handleChangedStrides,
    className: classes.field
  })))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .ZP, {
    item: true
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z, {
    color: "text.secondary"
  }, "Output shape: [", outputShape.join(", "), "]", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("br", null), "Percent of total size: ", percentSize.toPrecision(2), "%", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("br", null), "Percent of total params: ", percentParams.toPrecision(2), "%", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("br", null), "Run time: ", runTimeInMs.toPrecision(2), " ms ", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("br", null)))));
}

var PoolingLayerBlockField = /*#__PURE__*/function (_ReactInlineField) {
  (0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z)(PoolingLayerBlockField, _ReactInlineField);

  function PoolingLayerBlockField(value, previousValue) {
    var _this;

    _this = _ReactInlineField.call(this, value) || this;
    if (previousValue) _this.value = _objectSpread(_objectSpread({}, _this.defaultValue), previousValue);
    return _this;
  }

  PoolingLayerBlockField.fromJson = function fromJson(options) {
    return new PoolingLayerBlockField(options === null || options === void 0 ? void 0 : options.value);
  }
  /* This default value is specified here and in modelblockdsl.ts */
  ;

  var _proto = PoolingLayerBlockField.prototype;

  _proto.getText_ = function getText_() {
    return "";
  };

  _proto.renderInlineField = function renderInlineField() {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(Root, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(LayerParameterWidget, {
      initFieldValue: this.value
    }));
  };

  (0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z)(PoolingLayerBlockField, [{
    key: "defaultValue",
    get: function get() {
      return {
        percentParams: 0,
        percentSize: 0,
        runTimeInMs: 0,
        outputShape: [0, 0],
        poolSize: 2,
        strideSize: 1
      };
    }
  }]);

  return PoolingLayerBlockField;
}(_ReactInlineField__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z);

PoolingLayerBlockField.KEY = "pooling_layer_block_field_key";


/***/ }),

/***/ 431:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ RecordingBlockField; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(4942);
/* harmony import */ var _babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(43144);
/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(94578);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(67294);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(4320);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(39211);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(23961);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(76968);
/* harmony import */ var _mui_icons_material_GetApp__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(42594);
/* harmony import */ var _ReactInlineField__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(12702);
/* harmony import */ var _PointerBoundary__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(77298);
/* harmony import */ var _WorkspaceContext__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(89801);




function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }



 // tslint:disable-next-line: no-submodule-imports match-default-export-name





function RecordingParameterWidget(props) {
  var {
    initFieldValue
  } = props;
  var {
    sourceBlock
  } = (0,react__WEBPACK_IMPORTED_MODULE_1__.useContext)(_WorkspaceContext__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .ZP);
  var {
    numSamples,
    inputTypes
  } = initFieldValue;

  var handleDownloadDataSet = () => {
    console.log("Download recording");
    sourceBlock.data = "click.download";
  };

  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_PointerBoundary__WEBPACK_IMPORTED_MODULE_3__/* .PointerBoundary */ .A, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .ZP, {
    container: true,
    spacing: 1,
    direction: "column"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .ZP, {
    item: true
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z, {
    color: "text.secondary"
  }, "Total samples: ", numSamples, " ", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("br", null), "Input type(s):", " ", inputTypes.length ? inputTypes.join(", ") : "none")), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .ZP, {
    item: true,
    style: {
      display: "inline-flex"
    }
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z, {
    title: "Download recording as csv file"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z, {
    onClick: handleDownloadDataSet,
    startIcon: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_icons_material_GetApp__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z, null),
    variant: "outlined",
    size: "small"
  }, "Download")))));
}

var RecordingBlockField = /*#__PURE__*/function (_ReactInlineField) {
  (0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .Z)(RecordingBlockField, _ReactInlineField);

  function RecordingBlockField(value, previousValue) {
    var _this;

    _this = _ReactInlineField.call(this, value) || this;
    if (previousValue) _this.value = _objectSpread(_objectSpread({}, _this.defaultValue), previousValue);
    return _this;
  }

  RecordingBlockField.fromJson = function fromJson(options) {
    return new RecordingBlockField(options === null || options === void 0 ? void 0 : options.value);
  }
  /* This default value is specified here and in modelblockdsl.ts */
  ;

  var _proto = RecordingBlockField.prototype;

  _proto.getText_ = function getText_() {
    var {
      numSamples
    } = this.value;
    return numSamples + " sample(s)";
  };

  _proto.renderInlineField = function renderInlineField() {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(RecordingParameterWidget, {
      initFieldValue: this.value
    });
  };

  (0,_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z)(RecordingBlockField, [{
    key: "defaultValue",
    get: function get() {
      return {
        numSamples: 0,
        timestamp: 0,
        inputTypes: []
      };
    }
  }]);

  return RecordingBlockField;
}(_ReactInlineField__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z);

RecordingBlockField.KEY = "recording_block_field_key";


/***/ }),

/***/ 90461:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ TrainedModelBlockField; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(4942);
/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(94578);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(67294);
/* harmony import */ var _mui_material_styles__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(98348);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(4320);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(39211);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(23961);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(76968);
/* harmony import */ var _ui_Suspense__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(6890);
/* harmony import */ var _ReactInlineField__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(12702);
/* harmony import */ var _PointerBoundary__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(77298);
/* harmony import */ var _mui_icons_material_Visibility__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(94093);
/* harmony import */ var _mui_icons_material_GetApp__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(42594);
/* harmony import */ var _dsl_workers_tf_proxy__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(83808);
/* harmony import */ var _WorkspaceContext__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(89801);
/* harmony import */ var _jacdac_ts_src_jdom_constants__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(71815);
/* harmony import */ var _model_editor_MBDataSet__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(99941);



function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .Z)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }







 // tslint:disable-next-line: no-submodule-imports match-default-export-name

 // tslint:disable-next-line: no-submodule-imports match-default-export-name





var PREFIX = "TrainedModelBlockField";
var classes = {
  fieldContainer: PREFIX + "-fieldContainer",
  field: PREFIX + "-field",
  inlineItem: PREFIX + "-inlineItem"
}; // TODO jss-to-styled codemod: The Fragment root was replaced by div. Change the tag if needed.

var Root = (0,_mui_material_styles__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .ZP)("div")(_ref => {
  var {
    theme
  } = _ref;
  return {
    ["& ." + classes.fieldContainer]: {
      lineHeight: "2.5rem",
      width: "15rem"
    },
    ["& ." + classes.field]: {
      width: theme.spacing(10)
    },
    ["& ." + classes.inlineItem]: {
      height: theme.spacing(30),
      overflowY: "scroll"
    }
  };
});
var ConfusionMatrixHeatMap = /*#__PURE__*/(0,react__WEBPACK_IMPORTED_MODULE_1__.lazy)(() => __webpack_require__.e(/* import() */ 5063).then(__webpack_require__.bind(__webpack_require__, 75063)));
var DataSetPlot = /*#__PURE__*/(0,react__WEBPACK_IMPORTED_MODULE_1__.lazy)(() => __webpack_require__.e(/* import() */ 9866).then(__webpack_require__.bind(__webpack_require__, 49866)));

function TrainedModelDisplayWidget() {
  var chartProps = {
    CHART_WIDTH: 150,
    CHART_HEIGHT: 150,
    MARK_SIZE: 75,
    TOOLTIP_NUM_FORMAT: "0.2f",
    PALETTE: ["#003f5c", "#ffa600", "#665191", "#a05195", "#ff7c43", "#d45087", "#f95d6a", "#2f4b7c"]
  };
  var {
    0: chartType,
    1: setChartType
  } = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)("confusion matrix");
  var {
    sourceBlock
  } = (0,react__WEBPACK_IMPORTED_MODULE_1__.useContext)(_WorkspaceContext__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .ZP);
  var services = (0,_WorkspaceContext__WEBPACK_IMPORTED_MODULE_6__/* .resolveBlockServices */ .Ys)(sourceBlock);
  var {
    0: dataSet,
    1: setDataSet
  } = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(undefined);
  var {
    0: model,
    1: setModel
  } = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(undefined);
  var {
    0: trainingPredictionResult,
    1: setTrainingPredictionResult
  } = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(undefined);
  var {
    0: trainTimestamp,
    1: setTrainTimestamp
  } = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(Date.now());
  var {
    0: errorMsg,
    1: setErrorMsg
  } = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(""); // track workspace changes and re-render

  (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => services === null || services === void 0 ? void 0 : services.subscribe(_jacdac_ts_src_jdom_constants__WEBPACK_IMPORTED_MODULE_7__/* .CHANGE */ .Ver, () => {
    sourceBlock.data = "click.refreshdisplay";

    if (!services.data) {
      setErrorMsg("Please select a valid dataset");
      return;
    }

    setErrorMsg(""); // grab the model and dataset to test with

    var updatedDataSet = services.data[0];
    var updatedModel = services.data[1];
    if (!updatedModel || !updatedDataSet) return; // make sure dataset and model are compatible (same input data)

    if (!(0,_model_editor_MBDataSet__WEBPACK_IMPORTED_MODULE_8__/* .arraysEqual */ .cO)(updatedDataSet.inputTypes, updatedModel.inputTypes) || updatedDataSet.length != updatedModel.inputShape[0] || updatedDataSet.width != updatedModel.inputShape[1]) {
      setErrorMsg("The selected dataset does not have the same input/output type as the trained model");
      setDataSet(updatedDataSet);
      setModel(updatedModel);
      return;
    }

    setErrorMsg(""); // get selected chart

    var selectedChart = sourceBlock.getField("SELECTED_CHART").getText(); // for confusion matrix and dataset plot predict on dataset

    if (selectedChart == "confusion matrix" || selectedChart == "dataset plot") {
      var predictMsg = {
        worker: "tf",
        type: "predict",
        data: {
          zData: updatedDataSet.xs,
          model: updatedModel.toJSON()
        }
      };
      (0,_dsl_workers_tf_proxy__WEBPACK_IMPORTED_MODULE_5__/* .predictRequest */ .iE)(predictMsg).then(result => {
        if (result && result.data) {
          // convert prediction result to string
          var predictions = [];
          result.data.predictTop.forEach(prediction => {
            predictions.push(updatedModel.labels[prediction]);
          });
          setTrainingPredictionResult(predictions);
          setTrainTimestamp(Date.now());
        }
      });
    }

    setDataSet(updatedDataSet);
    setModel(updatedModel);
    setChartType(selectedChart);
  }), [services]);

  var handleViewTrainedModel = () => {
    // open modal to view model
    sourceBlock.data = "click.view";
  };

  var handleDownloadModel = () => {
    // set the model name to what the user typed into the box
    var trainedModelName = sourceBlock.getField("TRAINED_MODEL_NAME").getText();
    if (model) model.name = trainedModelName;
    sourceBlock.data = "click.download";
  };

  if (errorMsg.length) return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .ZP, {
    container: true,
    spacing: 1,
    direction: "column"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .ZP, {
    item: true
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z, {
    color: "text.secondary"
  }, "Error: ", errorMsg, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("br", null)), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("br", null), !!model && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z, {
    color: "text.secondary"
  }, "Model input types: ", model.inputTypes.join(", "), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("br", null), "Input shape: [", model.inputShape.join(", "), "]"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("br", null), !!dataSet && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .Z, {
    color: "text.secondary"
  }, "Data set input types:", " ", dataSet.inputTypes.join(", "), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement("br", null), "Input shape: [", dataSet.length, ", ", dataSet.width, "]")), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .ZP, {
    item: true,
    style: {
      display: "inline-flex"
    }
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z, {
    title: "View this model and perform actions like testing with live data"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .Z, {
    onClick: handleViewTrainedModel,
    startIcon: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_icons_material_Visibility__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z, null),
    variant: "outlined",
    size: "small"
  }, "View")), "\u2002", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z, {
    title: "Download trained model file"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .Z, {
    onClick: handleDownloadModel,
    startIcon: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_icons_material_GetApp__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z, null),
    variant: "outlined",
    size: "small"
  }, "Download"))));else if (chartType == "confusion matrix") return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .ZP, {
    container: true,
    spacing: 1,
    direction: "column"
  }, !!model && !!dataSet && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .ZP, {
    item: true
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_PointerBoundary__WEBPACK_IMPORTED_MODULE_4__/* .PointerBoundary */ .A, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_ui_Suspense__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(ConfusionMatrixHeatMap, {
    chartProps: chartProps,
    yActual: dataSet.ys.map(val => dataSet.labels[val]),
    yPredicted: trainingPredictionResult,
    labels: model.labels,
    timestamp: trainTimestamp
  })))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .ZP, {
    item: true,
    style: {
      display: "inline-flex"
    }
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z, {
    title: "View this model and perform actions like testing with live data"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .Z, {
    onClick: handleViewTrainedModel,
    startIcon: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_icons_material_Visibility__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z, null),
    variant: "outlined",
    size: "small"
  }, "View")), "\u2002", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z, {
    title: "Download trained model file"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .Z, {
    onClick: handleDownloadModel,
    startIcon: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_icons_material_GetApp__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z, null),
    variant: "outlined",
    size: "small"
  }, "Download"))));else if (chartType == "dataset plot") return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .ZP, {
    container: true,
    spacing: 1,
    direction: "column"
  }, !!model && !!dataSet && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .ZP, {
    item: true
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_PointerBoundary__WEBPACK_IMPORTED_MODULE_4__/* .PointerBoundary */ .A, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_ui_Suspense__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(DataSetPlot, {
    chartProps: chartProps,
    reactStyle: classes,
    dataset: dataSet,
    predictedLabels: trainingPredictionResult,
    timestamp: trainTimestamp
  })))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .ZP, {
    item: true,
    style: {
      display: "inline-flex"
    }
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z, {
    title: "View this model and perform actions like testing with live data"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .Z, {
    onClick: handleViewTrainedModel,
    startIcon: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_icons_material_Visibility__WEBPACK_IMPORTED_MODULE_14__/* ["default"] */ .Z, null),
    variant: "outlined",
    size: "small"
  }, "View")), "\u2002", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .Z, {
    title: "Download trained model file"
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_13__/* ["default"] */ .Z, {
    onClick: handleDownloadModel,
    startIcon: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(_mui_icons_material_GetApp__WEBPACK_IMPORTED_MODULE_15__/* ["default"] */ .Z, null),
    variant: "outlined",
    size: "small"
  }, "Download"))));
}

var TrainedModelBlockField = /*#__PURE__*/function (_ReactInlineField) {
  (0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_16__/* ["default"] */ .Z)(TrainedModelBlockField, _ReactInlineField);

  function TrainedModelBlockField(value) {
    return _ReactInlineField.call(this, value) || this;
  }

  TrainedModelBlockField.fromJson = function fromJson(options) {
    return new TrainedModelBlockField(options === null || options === void 0 ? void 0 : options.value);
  };

  var _proto = TrainedModelBlockField.prototype;

  _proto.getText_ = function getText_() {
    return "";
  };

  _proto.renderInlineField = function renderInlineField() {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(Root, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.createElement(TrainedModelDisplayWidget, null));
  };

  _proto.updateFieldValue = function updateFieldValue(msg) {
    this.value = _objectSpread(_objectSpread({}, this.value), msg);
  };

  return TrainedModelBlockField;
}(_ReactInlineField__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z);

TrainedModelBlockField.KEY = "trained_model_block_field_key";


/***/ }),

/***/ 97428:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "v": function() { return /* binding */ workspaceToJSON; }
/* harmony export */ });
/* harmony import */ var blockly__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(74640);
/* harmony import */ var blockly__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(blockly__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _jacdac_ts_src_jdom_flags__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(21258);
/* harmony import */ var _jacdac_ts_src_jdom_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(81794);
/* harmony import */ var _dsl_dsl__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(94113);
/* harmony import */ var _fields_ReactFieldBase__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(34964);





function workspaceToJSON(workspace, dsls, top) {
  // eslint-disable-next-line @typescript-eslint/no-explicit-any
  var clean = o => Object.keys(o).filter(k => o[k] === undefined || o[k] === null).forEach(k => delete o[k]);

  var builtins = {
    logic_null: () => null,
    text: block => block.getFieldValue("TEXT"),
    text_input: block => block.getFieldValue("TEXT"),
    math_number: block => Number(block.getFieldValue("NUM") || "0"),
    logic_boolean: block => block.getFieldValue("BOOL") === "TRUE"
  };

  var variableToJSON = variable => ({
    name: variable.name,
    type: variable.type,
    id: variable.getId()
  });

  var fieldsToJSON = fields => !fields.length ? undefined : (0,_jacdac_ts_src_jdom_utils__WEBPACK_IMPORTED_MODULE_2__/* .toMap */ .qL)(fields, field => {
    var _field$name;

    return (_field$name = field.name) === null || _field$name === void 0 ? void 0 : _field$name.toLowerCase();
  }, fieldToJSON); // eslint-disable-next-line @typescript-eslint/no-explicit-any


  var xmlToJSON = xml => {
    var j = {};
    if (_jacdac_ts_src_jdom_flags__WEBPACK_IMPORTED_MODULE_1__/* ["default"].diagnostics */ .Z.diagnostics) j["xml"] = xml.outerHTML; // dump attributes

    for (var name of xml.getAttributeNames().filter(n => n !== "preview")) {
      var v = xml.getAttribute(name);
      j[name.toLowerCase()] = v;
    }

    for (var child of xml.childNodes) {
      if (child.nodeType === Node.TEXT_NODE) j["value"] = xml.textContent;else if (child.nodeType === Node.ELEMENT_NODE) {
        // eslint-disable-next-line @typescript-eslint/no-explicit-any
        var children = j["children"] || (j["children"] = []);
        children.push(xmlToJSON(child));
      }
    }

    return j;
  };

  var fieldToJSON = field => {
    if (field.isSerializable()) {
      // custom field can just return the value
      if (field instanceof _fields_ReactFieldBase__WEBPACK_IMPORTED_MODULE_4__/* .ReactFieldBase */ .y) {
        // eslint-disable-next-line @typescript-eslint/no-explicit-any
        var value = field.value;
        return {
          value
        };
      } else {
        var container = blockly__WEBPACK_IMPORTED_MODULE_0___default().utils.xml.createElement("field");
        var fieldXml = field.toXml(container);
        return xmlToJSON(fieldXml);
      }
    }

    return undefined;
  };

  var flattenNext = block => {
    // flatten the linked list of next into an array
    var children = [];
    var current = block.next;

    while (current) {
      children.push(current);
      current = current.next;
    }

    if (children.length) {
      block.children = children;
      block.next = undefined;
    }
  };

  var blockToJSON = block => {
    var blockToJSONHidden = block => {
      var _builtins$block$type;

      // skip disabled blocks
      if (!(block !== null && block !== void 0 && block.isEnabled())) return undefined; // skip over insertion markers.

      if (block.isInsertionMarker()) {
        var child = block.getChildren(false)[0];
        if (child) return blockToJSON(child);else return undefined;
      }

      var {
        type
      } = block; // allow DSL to handle conversion

      var value = (_builtins$block$type = builtins[block.type]) === null || _builtins$block$type === void 0 ? void 0 : _builtins$block$type.call(builtins, block);

      if (value === undefined) {
        var _dsl$blockToValue;

        var dsl = (0,_dsl_dsl__WEBPACK_IMPORTED_MODULE_3__/* .resolveDsl */ .u)(dsls, type);
        value = dsl === null || dsl === void 0 ? void 0 : (_dsl$blockToValue = dsl.blockToValue) === null || _dsl$blockToValue === void 0 ? void 0 : _dsl$blockToValue.call(dsl, block);
      }

      var element = {
        type: block.type,
        id: block.id,
        value,
        inputs: value === undefined ? block.inputList.map(input => {
          var _input$connection;

          var container = {
            type: input.type,
            name: input.name,
            fields: fieldsToJSON(input.fieldRow),
            child: blockToJSON((_input$connection = input.connection) === null || _input$connection === void 0 ? void 0 : _input$connection.targetBlock())
          };
          return container;
        }) : undefined,
        next: blockToJSONHidden(block.getNextBlock())
      };
      clean(element);
      return element;
    };

    var top = blockToJSONHidden(block);

    if (top) {
      flattenNext(top);
      clean(top);
    }

    return top;
  };

  try {
    var variables = blockly__WEBPACK_IMPORTED_MODULE_0___default().Variables.allUsedVarModels(workspace).sort((l, r) => l.name.localeCompare(r.name)); // stable sort name

    var todo = top || workspace.getTopBlocks(true);
    var json = {
      variables: variables.map(variableToJSON),
      blocks: todo.map(blockToJSON).filter(b => !!b)
    };
    dsls.forEach(dsl => {
      var _dsl$visitWorkspaceJS;

      return (_dsl$visitWorkspaceJS = dsl.visitWorkspaceJSON) === null || _dsl$visitWorkspaceJS === void 0 ? void 0 : _dsl$visitWorkspaceJS.call(dsl, workspace, json);
    });
    dsls.forEach(dsl => {
      var _dsl$onWorkspaceJSONC;

      return (_dsl$onWorkspaceJSONC = dsl.onWorkspaceJSONChange) === null || _dsl$onWorkspaceJSONC === void 0 ? void 0 : _dsl$onWorkspaceJSONC.call(dsl, json);
    });
    return json;
  } catch (e) {
    console.error(e);
    return undefined;
  }
}

/***/ }),

/***/ 53851:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";

// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  "Z": function() { return /* binding */ useBlockData; }
});

// EXTERNAL MODULE: ./node_modules/react/index.js
var react = __webpack_require__(67294);
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js + 5 modules
var toConsumableArray = __webpack_require__(15785);
// EXTERNAL MODULE: ./jacdac-ts/src/jdom/constants.ts
var constants = __webpack_require__(71815);
// EXTERNAL MODULE: ./node_modules/use-debounce/esm/useDebouncedCallback.js
var useDebouncedCallback = __webpack_require__(87709);
;// CONCATENATED MODULE: ./node_modules/use-debounce/esm/useThrottledCallback.js

/**
 * Creates a throttled function that only invokes `func` at most once per
 * every `wait` milliseconds (or once per browser frame). The throttled function
 * comes with a `cancel` method to cancel delayed `func` invocations and a
 * `flush` method to immediately invoke them. Provide `options` to indicate
 * whether `func` should be invoked on the leading and/or trailing edge of the
 * `wait` timeout. The `func` is invoked with the last arguments provided to the
 * throttled function. Subsequent calls to the throttled function return the
 * result of the last `func` invocation.
 *
 * **Note:** If `leading` and `trailing` options are `true`, `func` is
 * invoked on the trailing edge of the timeout only if the throttled function
 * is invoked more than once during the `wait` timeout.
 *
 * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred
 * until the next tick, similar to `setTimeout` with a timeout of `0`.
 *
 * If `wait` is omitted in an environment with `requestAnimationFrame`, `func`
 * invocation will be deferred until the next frame is drawn (typically about
 * 16ms).
 *
 * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)
 * for details over the differences between `throttle` and `debounce`.
 *
 * @category Function
 * @param {Function} func The function to throttle.
 * @param {number} [wait=0]
 *  The number of milliseconds to throttle invocations to; if omitted,
 *  `requestAnimationFrame` is used (if available, otherwise it will be setTimeout(...,0)).
 * @param {Object} [options={}] The options object.
 * @param {boolean} [options.leading=true]
 *  Specify invoking on the leading edge of the timeout.
 * @param {boolean} [options.trailing=true]
 *  Specify invoking on the trailing edge of the timeout.
 * @returns {Function} Returns the new throttled function.
 * @example
 *
 * // Avoid excessively updating the position while scrolling.
 * const scrollHandler = useThrottledCallback(updatePosition, 100)
 * window.addEventListener('scroll', scrollHandler)
 *
 * // Invoke `renewToken` when the click event is fired, but not more than once every 5 minutes.
 * const { callback } = useThrottledCallback(renewToken, 300000, { 'trailing': false })
 * <button onClick={callback}>click</button>
 *
 * // Cancel the trailing throttled invocation.
 * window.addEventListener('popstate', throttled.cancel);
 */

function useThrottledCallback(func, wait, _a) {
  var _b = _a === void 0 ? {} : _a,
      _c = _b.leading,
      leading = _c === void 0 ? true : _c,
      _d = _b.trailing,
      trailing = _d === void 0 ? true : _d;

  return (0,useDebouncedCallback/* default */.Z)(func, wait, {
    maxWait: wait,
    leading: leading,
    trailing: trailing
  });
}
;// CONCATENATED MODULE: ./src/jacdac/useChangeThrottled.ts




var DEFAULT_THROTTLE = 200;
function useChangeThrottled(node, query, time, deps) {
  // eslint-disable-next-line @typescript-eslint/no-unused-vars
  var {
    0: version,
    1: setVersion
  } = (0,react.useState)((node === null || node === void 0 ? void 0 : node.changeId) || 0);
  var value = query ? query(node) : undefined;
  var throttledSetVersion = useThrottledCallback(setVersion, time || DEFAULT_THROTTLE);
  (0,react.useEffect)(() => node === null || node === void 0 ? void 0 : node.subscribe(constants/* CHANGE */.Ver, () => throttledSetVersion(node.changeId)), [node].concat((0,toConsumableArray/* default */.Z)(deps || [])));
  return value;
}
// EXTERNAL MODULE: ./src/components/blockly/WorkspaceContext.tsx
var WorkspaceContext = __webpack_require__(89801);
;// CONCATENATED MODULE: ./src/components/blockly/useDragDebounce.ts


function useDragDebounce(value) {
  var {
    dragging
  } = (0,react.useContext)(WorkspaceContext/* default */.ZP);
  var {
    0: valueAtDragging,
    1: setValueAtDragging
  } = (0,react.useState)(value); // record value when starting to drag

  (0,react.useEffect)(() => {
    if (dragging) setValueAtDragging(value);
  }, [dragging]); // return value at dragging until drag is completed

  return dragging ? valueAtDragging || value : value;
}
;// CONCATENATED MODULE: ./src/components/blockly/useBlockData.ts


 // eslint-disable-next-line @typescript-eslint/ban-types

function useBlockData(block, initialValue, throttleTime) {
  var services = block === null || block === void 0 ? void 0 : block.jacdacServices; // data on the current node

  var {
    data,
    transformedData
  } = useChangeThrottled(services, _ => ({
    data: _ === null || _ === void 0 ? void 0 : _.data,
    transformedData: _ === null || _ === void 0 ? void 0 : _.transformedData
  }), throttleTime);
  var setData = (0,react.useCallback)(value => {
    if (services) services.data = value;
  }, [services]); // set initial value

  (0,react.useEffect)(() => {
    if (services && initialValue !== undefined && services.data === undefined) services.data = initialValue;
  }, [services]); // debounce with dragging

  var debounced = useDragDebounce(data);
  var debouncedTransformedData = useDragDebounce(transformedData);
  return {
    data: debounced,
    transformedData: debouncedTransformedData,
    setData
  };
}

/***/ }),

/***/ 45430:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";

// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  "Z": function() { return /* binding */ FileTabs; }
});

// EXTERNAL MODULE: ./node_modules/@mui/material/Grid/Grid.js + 2 modules
var Grid = __webpack_require__(4320);
// EXTERNAL MODULE: ./node_modules/react/index.js
var react = __webpack_require__(67294);
// EXTERNAL MODULE: ./src/components/hooks/useKeyboardNavigationProps.ts + 2 modules
var useKeyboardNavigationProps = __webpack_require__(68786);
// EXTERNAL MODULE: ./src/components/FileSystemContext.tsx + 1 modules
var FileSystemContext = __webpack_require__(37258);
// EXTERNAL MODULE: ./src/jacdac/useChange.ts
var useChange = __webpack_require__(54774);
// EXTERNAL MODULE: ./node_modules/@mui/material/Chip/Chip.js + 2 modules
var Chip = __webpack_require__(75985);
// EXTERNAL MODULE: ./node_modules/@mui/icons-material/OpenInBrowser.js
var OpenInBrowser = __webpack_require__(96009);
;// CONCATENATED MODULE: ./src/components/fs/FileSystemChip.tsx





function FileSystemChip() {
  var {
    fileSystem,
    showDirectoryPicker
  } = (0,react.useContext)(FileSystemContext/* default */.Z);
  var root = (0,useChange/* default */.Z)(fileSystem, _ => _ === null || _ === void 0 ? void 0 : _.root);
  var handleOpenDirectory = showDirectoryPicker;

  var handleCloseDirectory = () => fileSystem.root = undefined;

  if (!fileSystem) return null;
  return /*#__PURE__*/react.createElement(Chip/* default */.Z, {
    clickable: true,
    avatar: /*#__PURE__*/react.createElement(OpenInBrowser/* default */.Z, null),
    label: (root === null || root === void 0 ? void 0 : root.name) || "open directory",
    onClick: handleOpenDirectory,
    onDelete: root ? handleCloseDirectory : undefined
  });
}
// EXTERNAL MODULE: ./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js
var asyncToGenerator = __webpack_require__(15861);
// EXTERNAL MODULE: ./node_modules/@mui/material/Dialog/Dialog.js + 1 modules
var Dialog = __webpack_require__(61359);
// EXTERNAL MODULE: ./node_modules/@mui/material/DialogContent/DialogContent.js + 1 modules
var DialogContent = __webpack_require__(86763);
// EXTERNAL MODULE: ./node_modules/@mui/material/DialogContentText/DialogContentText.js + 1 modules
var DialogContentText = __webpack_require__(90460);
// EXTERNAL MODULE: ./node_modules/@mui/material/TextField/TextField.js + 1 modules
var TextField = __webpack_require__(65970);
// EXTERNAL MODULE: ./node_modules/@mui/material/DialogActions/DialogActions.js + 1 modules
var DialogActions = __webpack_require__(18599);
// EXTERNAL MODULE: ./node_modules/@mui/material/Button/Button.js + 2 modules
var Button = __webpack_require__(76968);
// EXTERNAL MODULE: ./node_modules/@mui/icons-material/Add.js
var Add = __webpack_require__(63015);
// EXTERNAL MODULE: ./node_modules/react-use-id-hook/dist/react-use-id-hook.esm.js
var react_use_id_hook_esm = __webpack_require__(19640);
;// CONCATENATED MODULE: ./src/components/fs/FileNewFileChip.tsx






function FileNewFileChip(props) {
  var {
    name: newFileName,
    content: newFileContent,
    label,
    extension
  } = props;
  var {
    fileSystem
  } = (0,react.useContext)(FileSystemContext/* default */.Z);
  var {
    0: open,
    1: setOpen
  } = (0,react.useState)(false);
  var {
    0: value,
    1: setValue
  } = (0,react.useState)("");
  var valueId = (0,react_use_id_hook_esm/* useId */.Me)();

  var handleOpen = () => {
    setValue("");
    setOpen(true);
  };

  var handleOk = /*#__PURE__*/function () {
    var _ref = (0,asyncToGenerator/* default */.Z)(function* () {
      setOpen(false);
      var name = value.toLocaleLowerCase().replace(/\s+/g, "");
      if (newFileName) yield fileSystem.createWorkingDirectory(name, newFileName, newFileContent);else {
        if (extension) name += "." + extension;
        var d = fileSystem.workingDirectory || fileSystem.root;
        var f = yield d.fileAsync(name, {
          create: true
        });
        yield f.write(newFileContent);
        fileSystem.workingFile = f;
      }
    });

    return function handleOk() {
      return _ref.apply(this, arguments);
    };
  }();

  var handleCancel = () => setOpen(false);

  var handleValueChange = event => {
    setValue(event.target.value);
  };

  return /*#__PURE__*/react.createElement(react.Fragment, null, /*#__PURE__*/react.createElement(Chip/* default */.Z, {
    clickable: true,
    label: label || "new...",
    icon: /*#__PURE__*/react.createElement(Add/* default */.Z, null),
    onClick: handleOpen
  }), /*#__PURE__*/react.createElement(Dialog/* default */.Z, {
    open: open,
    fullWidth: true
  }, /*#__PURE__*/react.createElement(DialogContent/* default */.Z, null, /*#__PURE__*/react.createElement(DialogContentText/* default */.Z, null, "Choose a project name"), /*#__PURE__*/react.createElement(TextField/* default */.Z, {
    id: valueId,
    value: value,
    label: "Value",
    fullWidth: true,
    onChange: handleValueChange
  })), /*#__PURE__*/react.createElement(DialogActions/* default */.Z, null, /*#__PURE__*/react.createElement(Button/* default */.Z, {
    variant: "contained",
    onClick: handleCancel
  }, "Cancel"), /*#__PURE__*/react.createElement(Button/* default */.Z, {
    variant: "contained",
    color: "primary",
    disabled: !value,
    onClick: handleOk
  }, "Ok"))));
}
;// CONCATENATED MODULE: ./src/components/fs/FileSystemNodeChip.tsx


function FileSystemNodeChip(props) {
  var {
    node,
    selected,
    onClick
  } = props;
  var {
    name
  } = node;
  return /*#__PURE__*/react.createElement(Chip/* default */.Z, {
    clickable: true,
    label: name.replace(/\.json$/i, ""),
    color: selected ? "primary" : undefined,
    onClick: onClick
  });
}
;// CONCATENATED MODULE: ./src/components/fs/FileTabs.tsx








function FileTabs(props) {
  var {
    newFileName,
    newFileContent,
    hideDirectories,
    hideFiles,
    directoryFilter,
    fileFilter,
    newFileLabel,
    newFileExtension
  } = props;
  var {
    fileSystem
  } = (0,react.useContext)(FileSystemContext/* default */.Z);
  var root = (0,useChange/* default */.Z)(fileSystem, _ => _ === null || _ === void 0 ? void 0 : _.root);
  var workingDirectory = (0,useChange/* default */.Z)(fileSystem, _ => _ === null || _ === void 0 ? void 0 : _.workingDirectory);
  var workingFile = (0,useChange/* default */.Z)(fileSystem, _ => _ === null || _ === void 0 ? void 0 : _.workingFile);
  var directories = (0,useChange/* default */.Z)(root, _ => {
    var _$directories;

    return _ === null || _ === void 0 ? void 0 : (_$directories = _.directories) === null || _$directories === void 0 ? void 0 : _$directories.filter(d => !directoryFilter || directoryFilter(d.name));
  });
  var files = (0,useChange/* default */.Z)(root, _ => {
    var _$files;

    return _ === null || _ === void 0 ? void 0 : (_$files = _.files) === null || _$files === void 0 ? void 0 : _$files.filter(d => !fileFilter || fileFilter(d.name));
  });
  var gridRef = (0,react.useRef)();
  var keyboardProps = (0,useKeyboardNavigationProps/* default */.Z)(gridRef.current);

  var handleDirectorySelected = handle => () => fileSystem.workingDirectory = handle;

  var handleFileSelected = handle => () => fileSystem.workingFile = handle;

  if (!fileSystem) return null;
  return /*#__PURE__*/react.createElement(Grid/* default */.ZP, Object.assign({
    ref: gridRef,
    container: true,
    spacing: 1
  }, keyboardProps), /*#__PURE__*/react.createElement(Grid/* default */.ZP, {
    item: true
  }, /*#__PURE__*/react.createElement(FileSystemChip, null)), !hideDirectories && (directories === null || directories === void 0 ? void 0 : directories.map(node => /*#__PURE__*/react.createElement(Grid/* default */.ZP, {
    item: true,
    key: node.name
  }, /*#__PURE__*/react.createElement(FileSystemNodeChip, {
    node: node,
    selected: node === workingDirectory,
    onClick: handleDirectorySelected(node)
  })))), !hideFiles && (files === null || files === void 0 ? void 0 : files.map(node => /*#__PURE__*/react.createElement(Grid/* default */.ZP, {
    item: true,
    key: node.name
  }, /*#__PURE__*/react.createElement(FileSystemNodeChip, {
    node: node,
    selected: node === workingFile,
    onClick: handleFileSelected(node)
  })))), root && newFileContent && /*#__PURE__*/react.createElement(Grid/* default */.ZP, {
    item: true
  }, /*#__PURE__*/react.createElement(FileNewFileChip, {
    name: newFileName,
    content: newFileContent,
    label: newFileLabel,
    extension: newFileExtension
  })));
}

/***/ }),

/***/ 68786:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";

// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  "Z": function() { return /* binding */ useKeyboardNavigationProps; }
});

// EXTERNAL MODULE: ./src/components/hooks/useFireKey.ts
var useFireKey = __webpack_require__(8966);
;// CONCATENATED MODULE: ./src/components/hooks/useArrowKeys.ts

var LEFT_KEY = 37;
var UP_KEY = 38;
var RIGHT_KEY = 39;
var DOWN_KEY = 40;
function useArrowKeys(options) {
  var {
    onLeft,
    onUp,
    onRight,
    onDown,
    symmetric
  } = options;
  if (!onLeft && !onUp && !onRight && !onDown) return undefined;
  var handlers = {
    [LEFT_KEY]: onLeft,
    [RIGHT_KEY]: onRight,
    [UP_KEY]: onUp || symmetric && onRight,
    [DOWN_KEY]: onDown || symmetric && onLeft
  };
  return e => {
    var charCode = (0,useFireKey/* keyCodeFromEvent */.$)(e);
    var handler = handlers[charCode];

    if (handler) {
      e.preventDefault();
      handler();
    }
  };
}
;// CONCATENATED MODULE: ./src/components/hooks/useKeyboardNavigation.ts
function useKeyboardNavigation(parentRef) {
  var query = '[tabindex="0"]';

  var onMove = offset => () => {
    console.log("keyboard move", {
      offset
    });
    var focusable = Array.from((parentRef === null || parentRef === void 0 ? void 0 : parentRef.querySelectorAll(query)) || []);

    if (focusable.length) {
      var me = focusable.findIndex(f => f === document.activeElement);
      var next = (me + offset + focusable.length) % focusable.length;
      focusable[next].focus();
    }
  };

  return onMove;
}
;// CONCATENATED MODULE: ./src/components/hooks/useKeyboardNavigationProps.ts


function useKeyboardNavigationProps(parentRef, vertical) {
  var onMove = useKeyboardNavigation(parentRef);
  var onKeyDown = useArrowKeys({
    onLeft: !vertical && onMove(-1),
    onRight: !vertical && onMove(1),
    onDown: vertical && onMove(1),
    onUp: vertical && onMove(-1)
  });
  return {
    onKeyDown: parentRef && onKeyDown
  };
}

/***/ }),

/***/ 2928:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ useServices; }
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(67294);
/* harmony import */ var _jacdac_Context__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(20392);
/* harmony import */ var _jacdac_useChange__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(54774);



function useServices(options) {
  var {
    bus
  } = (0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(_jacdac_Context__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z);
  var services = (0,_jacdac_useChange__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(bus, _ => (_ === null || _ === void 0 ? void 0 : _.services(options)) || [], [JSON.stringify(options)]);
  return services;
}

/***/ }),

/***/ 95149:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "GJ": function() { return /* binding */ MODEL_BLOCKS; },
/* harmony export */   "vV": function() { return /* binding */ MB_DATASET_VAR_TYPE; },
/* harmony export */   "nc": function() { return /* binding */ MB_CLASS_VAR_TYPE; },
/* harmony export */   "pp": function() { return /* binding */ MB_CLASSIFIER_VAR_TYPE; }
/* harmony export */ });
/* unused harmony export ModelBlockDomainSpecificLanguage */
/* harmony import */ var _blockly_toolbox__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(16582);
/* harmony import */ var _blockly_fields_mb_ExpandModelBlockField__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(14639);
/* harmony import */ var _blockly_fields_mb_DataSetBlockButton__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(47740);
/* harmony import */ var _blockly_fields_mb_NeuralNetworkBlockButtons__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(19774);
/* harmony import */ var _blockly_fields_mb_TrainedModelBlockField__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(90461);





var MODEL_BLOCKS = "model_block_";
var MB_DATASET_VAR_TYPE = "ModelBlockDataSet";
var MB_CLASS_VAR_TYPE = "ModelBlockClass";
var MB_CLASSIFIER_VAR_TYPE = "ModelBlockClassifier";
var dataset_color = "#123456";
var class_color = "#2466A8";
var learning_color = "#561234";
var layer_color = "#97207a";
var ModelBlockDomainSpecificLanguage = /*#__PURE__*/function () {
  function ModelBlockDomainSpecificLanguage() {
    this.id = "modelBlocks";
  }

  var _proto = ModelBlockDomainSpecificLanguage.prototype;

  _proto.createBlocks = function createBlocks() {
    var blocks = [
    /* DataSet blocks */
    {
      kind: "block",
      type: MODEL_BLOCKS + "dataset",
      message0: "dataset %1 %2",
      args0: [{
        type: "field_variable",
        name: "DATASET_NAME",
        variable: "dataset1",
        variableTypes: [MB_DATASET_VAR_TYPE],
        defaultType: MB_DATASET_VAR_TYPE
      }, {
        type: _blockly_fields_mb_ExpandModelBlockField__WEBPACK_IMPORTED_MODULE_1__/* ["default"].KEY */ .Z.KEY,
        name: "EXPAND_BUTTON"
      }],
      message1: "%1",
      args1: [{
        type: _blockly_fields_mb_DataSetBlockButton__WEBPACK_IMPORTED_MODULE_2__/* ["default"].KEY */ .Z.KEY,
        name: "DATASET_BUTTONS"
      }],
      message2: "%1",
      args2: [{
        type: "input_statement",
        name: "LAYER_INPUTS",
        check: [_blockly_toolbox__WEBPACK_IMPORTED_MODULE_0__/* .MODEL_BLOCK_CLASS_STATEMENT_TYPE */ .Bp]
      }],
      inputsInline: false,
      colour: dataset_color,
      tooltip: "Use this block to define a dataset; it only takes class blocks. Add more information to datasets by creating new classes and stacking them inside dataset blocks. Click on the inspector icon to view more details about this dataset or to generate a new dataset from this one",
      helpUrl: "",
      hat: true
    }, {
      kind: "block",
      type: MODEL_BLOCKS + "recording",
      message0: "recording %1 %2 %3",
      args0: [{
        type: "field_input",
        name: "RECORDING_NAME",
        text: "recording0"
      }, {
        type: "field_variable",
        name: "CLASS_NAME",
        variable: "class1",
        variableTypes: [MB_CLASS_VAR_TYPE],
        defaultType: MB_CLASS_VAR_TYPE
      }, {
        type: _blockly_fields_mb_ExpandModelBlockField__WEBPACK_IMPORTED_MODULE_1__/* ["default"].KEY */ .Z.KEY,
        name: "EXPAND_BUTTON"
      }],
      inputsInline: false,
      previousStatement: _blockly_toolbox__WEBPACK_IMPORTED_MODULE_0__/* .MODEL_BLOCK_CLASS_STATEMENT_TYPE */ .Bp,
      nextStatement: _blockly_toolbox__WEBPACK_IMPORTED_MODULE_0__/* .MODEL_BLOCK_CLASS_STATEMENT_TYPE */ .Bp,
      colour: class_color,
      tooltip: "Use this recording block to define your classes. Click on the plus icon to download this recording",
      helpUrl: ""
    },
    /* Classifier Blocks */
    {
      kind: "block",
      type: MODEL_BLOCKS + "nn",
      message0: "neural network classifier %1",
      args0: [{
        type: "field_variable",
        name: "CLASSIFIER_NAME",
        variable: "classifier1",
        variableTypes: [MB_CLASSIFIER_VAR_TYPE],
        defaultType: MB_CLASSIFIER_VAR_TYPE
      }],
      message1: " training data %1 %2",
      args1: [{
        type: "field_variable",
        name: "NN_TRAINING",
        variable: "dataset1",
        variableTypes: [MB_DATASET_VAR_TYPE],
        defaultType: MB_DATASET_VAR_TYPE
      }, {
        type: _blockly_fields_mb_ExpandModelBlockField__WEBPACK_IMPORTED_MODULE_1__/* ["default"].KEY */ .Z.KEY,
        name: "EXPAND_BUTTON"
      }],
      message2: "%1",
      args2: [{
        type: _blockly_fields_mb_NeuralNetworkBlockButtons__WEBPACK_IMPORTED_MODULE_3__/* ["default"].KEY */ .Z.KEY,
        name: "NN_BUTTONS"
      }],
      message3: "%1",
      args3: [{
        type: "input_statement",
        name: "LAYER_INPUTS",
        check: [_blockly_toolbox__WEBPACK_IMPORTED_MODULE_0__/* .MODEL_BLOCK_LAYER_STATEMENT_TYPE */ .A8]
      }],
      inputsInline: false,
      colour: learning_color,
      tooltip: "Use this block to define a neural network classifier; it only takes layer blocks.",
      helpUrl: ""
    }, {
      kind: "block",
      type: MODEL_BLOCKS + "trained_nn",
      message0: "trained model %1",
      args0: [{
        type: "field_input",
        name: "TRAINED_MODEL_NAME",
        text: "classifier1.t"
      }],
      message1: "testing data %1",
      args1: [{
        type: "field_variable",
        name: "MODEL_TEST_SET",
        variable: "dataset1",
        variableTypes: [MB_DATASET_VAR_TYPE],
        defaultType: MB_DATASET_VAR_TYPE
      }],
      message2: "display %1",
      args2: [{
        type: "field_dropdown",
        options: ["confusion matrix", "dataset plot"].map(s => [s, s]),
        name: "SELECTED_CHART"
      }],
      message3: "%1",
      args3: [{
        type: _blockly_fields_mb_TrainedModelBlockField__WEBPACK_IMPORTED_MODULE_4__/* ["default"].KEY */ .Z.KEY,
        name: "TRAINED_MODEL_DISPLAY"
      }],
      inputsInline: false,
      colour: learning_color,
      tooltip: "Use this block to test a trained model with different datasets.",
      helpUrl: ""
    }, {
      kind: "block",
      type: MODEL_BLOCKS + "conv1d_layer",
      message0: "convolution1d (16, 2, 1) %1",
      args0: [{
        type: _blockly_fields_mb_ExpandModelBlockField__WEBPACK_IMPORTED_MODULE_1__/* ["default"].KEY */ .Z.KEY,
        name: "EXPAND_BUTTON"
      }],
      inputsInline: false,
      previousStatement: [_blockly_toolbox__WEBPACK_IMPORTED_MODULE_0__/* .MODEL_BLOCK_LAYER_STATEMENT_TYPE */ .A8],
      nextStatement: _blockly_toolbox__WEBPACK_IMPORTED_MODULE_0__/* .MODEL_BLOCK_LAYER_STATEMENT_TYPE */ .A8,
      colour: layer_color,
      tooltip: "Use this block to add a 1D convolutional layer to a neural network classifier. Convolutional layers are often used to summarize key features from input data.",
      helpUrl: ""
    }, {
      kind: "block",
      type: MODEL_BLOCKS + "maxpool1d_layer",
      message0: "max pool1d (2, 1) %1",
      args0: [{
        type: _blockly_fields_mb_ExpandModelBlockField__WEBPACK_IMPORTED_MODULE_1__/* ["default"].KEY */ .Z.KEY,
        name: "EXPAND_BUTTON"
      }],
      inputsInline: false,
      previousStatement: [_blockly_toolbox__WEBPACK_IMPORTED_MODULE_0__/* .MODEL_BLOCK_LAYER_STATEMENT_TYPE */ .A8],
      nextStatement: _blockly_toolbox__WEBPACK_IMPORTED_MODULE_0__/* .MODEL_BLOCK_LAYER_STATEMENT_TYPE */ .A8,
      colour: layer_color,
      tooltip: "",
      helpUrl: ""
    }, {
      kind: "block",
      type: MODEL_BLOCKS + "avgpool1d_layer",
      message0: "average pool1d (2, 1) %1",
      args0: [{
        type: _blockly_fields_mb_ExpandModelBlockField__WEBPACK_IMPORTED_MODULE_1__/* ["default"].KEY */ .Z.KEY,
        name: "EXPAND_BUTTON"
      }],
      inputsInline: false,
      previousStatement: [_blockly_toolbox__WEBPACK_IMPORTED_MODULE_0__/* .MODEL_BLOCK_LAYER_STATEMENT_TYPE */ .A8],
      nextStatement: _blockly_toolbox__WEBPACK_IMPORTED_MODULE_0__/* .MODEL_BLOCK_LAYER_STATEMENT_TYPE */ .A8,
      colour: layer_color,
      tooltip: "",
      helpUrl: ""
    }, {
      kind: "block",
      type: MODEL_BLOCKS + "conv2d_layer",
      message0: "convolution2d (16, 2, 1) %1",
      args0: [{
        type: _blockly_fields_mb_ExpandModelBlockField__WEBPACK_IMPORTED_MODULE_1__/* ["default"].KEY */ .Z.KEY,
        name: "EXPAND_BUTTON"
      }],
      inputsInline: false,
      previousStatement: [_blockly_toolbox__WEBPACK_IMPORTED_MODULE_0__/* .MODEL_BLOCK_LAYER_STATEMENT_TYPE */ .A8],
      nextStatement: _blockly_toolbox__WEBPACK_IMPORTED_MODULE_0__/* .MODEL_BLOCK_LAYER_STATEMENT_TYPE */ .A8,
      colour: layer_color,
      tooltip: "Use this block to add a 2D convolutional layer to a neural network classifier. Convolutional layers are often used to summarize key features from input data.",
      helpUrl: ""
    }, {
      kind: "block",
      type: MODEL_BLOCKS + "maxpool2d_layer",
      message0: "max pool2d (2, 1) %1",
      args0: [{
        type: _blockly_fields_mb_ExpandModelBlockField__WEBPACK_IMPORTED_MODULE_1__/* ["default"].KEY */ .Z.KEY,
        name: "EXPAND_BUTTON"
      }],
      inputsInline: false,
      previousStatement: [_blockly_toolbox__WEBPACK_IMPORTED_MODULE_0__/* .MODEL_BLOCK_LAYER_STATEMENT_TYPE */ .A8],
      nextStatement: _blockly_toolbox__WEBPACK_IMPORTED_MODULE_0__/* .MODEL_BLOCK_LAYER_STATEMENT_TYPE */ .A8,
      colour: layer_color,
      tooltip: "",
      helpUrl: ""
    }, {
      kind: "block",
      type: MODEL_BLOCKS + "avgpool2d_layer",
      message0: "average pool2d (2, 1) %1",
      args0: [{
        type: _blockly_fields_mb_ExpandModelBlockField__WEBPACK_IMPORTED_MODULE_1__/* ["default"].KEY */ .Z.KEY,
        name: "EXPAND_BUTTON"
      }],
      inputsInline: false,
      previousStatement: [_blockly_toolbox__WEBPACK_IMPORTED_MODULE_0__/* .MODEL_BLOCK_LAYER_STATEMENT_TYPE */ .A8],
      nextStatement: _blockly_toolbox__WEBPACK_IMPORTED_MODULE_0__/* .MODEL_BLOCK_LAYER_STATEMENT_TYPE */ .A8,
      colour: layer_color,
      tooltip: "",
      helpUrl: ""
    }, {
      kind: "block",
      type: MODEL_BLOCKS + "dropout_layer",
      message0: "dropout (0.1) %1",
      args0: [{
        type: _blockly_fields_mb_ExpandModelBlockField__WEBPACK_IMPORTED_MODULE_1__/* ["default"].KEY */ .Z.KEY,
        name: "EXPAND_BUTTON"
      }],
      inputsInline: false,
      previousStatement: [_blockly_toolbox__WEBPACK_IMPORTED_MODULE_0__/* .MODEL_BLOCK_LAYER_STATEMENT_TYPE */ .A8],
      nextStatement: _blockly_toolbox__WEBPACK_IMPORTED_MODULE_0__/* .MODEL_BLOCK_LAYER_STATEMENT_TYPE */ .A8,
      colour: layer_color,
      tooltip: "",
      helpUrl: ""
    }, {
      kind: "block",
      type: MODEL_BLOCKS + "flatten_layer",
      message0: "flatten %1",
      args0: [{
        type: _blockly_fields_mb_ExpandModelBlockField__WEBPACK_IMPORTED_MODULE_1__/* ["default"].KEY */ .Z.KEY,
        name: "EXPAND_BUTTON"
      }],
      inputsInline: false,
      previousStatement: [_blockly_toolbox__WEBPACK_IMPORTED_MODULE_0__/* .MODEL_BLOCK_LAYER_STATEMENT_TYPE */ .A8],
      nextStatement: _blockly_toolbox__WEBPACK_IMPORTED_MODULE_0__/* .MODEL_BLOCK_LAYER_STATEMENT_TYPE */ .A8,
      colour: layer_color,
      tooltip: "",
      helpUrl: ""
    }, {
      kind: "block",
      type: MODEL_BLOCKS + "dense_layer",
      message0: "dense (4, relu) %1",
      args0: [{
        type: _blockly_fields_mb_ExpandModelBlockField__WEBPACK_IMPORTED_MODULE_1__/* ["default"].KEY */ .Z.KEY,
        name: "EXPAND_BUTTON"
      }],
      inputsInline: false,
      previousStatement: [_blockly_toolbox__WEBPACK_IMPORTED_MODULE_0__/* .MODEL_BLOCK_LAYER_STATEMENT_TYPE */ .A8],
      nextStatement: _blockly_toolbox__WEBPACK_IMPORTED_MODULE_0__/* .MODEL_BLOCK_LAYER_STATEMENT_TYPE */ .A8,
      colour: layer_color,
      tooltip: "",
      helpUrl: ""
    }];
    return blocks;
  };

  _proto.createCategory = function createCategory() {
    return [{
      kind: "category",
      name: "Data sets",
      colour: dataset_color,
      contents: [{
        kind: "label",
        text: "Recordings"
      }, {
        kind: "button",
        text: "Create new recording...",
        callbackKey: "createNewRecordingButton"
      }, {
        kind: "label",
        text: "Datasets"
      }, {
        kind: "button",
        text: "Create new dataset variable...",
        callbackKey: "createNewDataSetButton"
      }, {
        kind: "block",
        type: MODEL_BLOCKS + "dataset"
      }]
    }, {
      kind: "category",
      name: "Models",
      colour: learning_color,
      contents: [{
        kind: "label",
        text: "Classifiers"
      }, {
        kind: "button",
        text: "Create new classifier variable...",
        callbackKey: "createNewClassifierButton"
      }, {
        kind: "label",
        text: "Layers"
      }, {
        kind: "block",
        blockxml: "<block type=\"model_block_conv1d_layer\"><field name=\"EXPAND_BUTTON\">{\"parametersVisible\":false,\"percentSize\":0,\"percentParams\":0,\"runTimeInMs\":0,\"outputShape\":[0,0],\"numFilters\":16,\"kernelSize\":2,\"strideSize\":1,\"activation\":\"relu\"}</field></block>"
      }, {
        kind: "block",
        blockxml: "<block type=\"model_block_maxpool1d_layer\"><field name=\"EXPAND_BUTTON\">{\"parametersVisible\":false,\"percentSize\":0,\"percentParams\":0,\"runTimeInMs\":0,\"outputShape\":[0,0],\"poolSize\":2,\"strideSize\":1}</field></block>"
      },
      /*{
          kind: "block",
          blockxml: `<block type="model_block_avgpool1d_layer"><field name="EXPAND_BUTTON">{"parametersVisible":false,"percentSize":0,"percentParams":0,"runTimeInMs":0,"outputShape":[0,0],"poolSize":2,"strideSize":1}</field></block>`,
      },*/
      {
        kind: "block",
        blockxml: "<block type=\"model_block_conv2d_layer\"><field name=\"EXPAND_BUTTON\">{\"parametersVisible\":false,\"percentSize\":0,\"percentParams\":0,\"runTimeInMs\":0,\"outputShape\":[0,0,0],\"numFilters\":16,\"kernelSize\":2,\"strideSize\":1,\"activation\":\"relu\"}</field></block>"
      }, {
        kind: "block",
        blockxml: "<block type=\"model_block_maxpool2d_layer\"><field name=\"EXPAND_BUTTON\">{\"parametersVisible\":false,\"percentSize\":0,\"percentParams\":0,\"runTimeInMs\":0,\"outputShape\":[0,0,0],\"poolSize\":2,\"strideSize\":1}</field></block>"
      },
      /*{
          kind: "block",
          blockxml: `<block type="model_block_avgpool2d_layer"><field name="EXPAND_BUTTON">{"parametersVisible":false,"percentSize":0,"percentParams":0,"runTimeInMs":0,"outputShape":[0,0,0],"poolSize":2,"strideSize":1}</field></block>`,
      },*/
      {
        kind: "block",
        blockxml: "<block type=\"model_block_dropout_layer\"><field name=\"EXPAND_BUTTON\">{\"parametersVisible\":false,\"percentSize\":0,\"percentParams\":0,\"runTimeInMs\":0,\"outputShape\":[0,0],\"rate\":0.1}</field></block>"
      }, {
        kind: "block",
        blockxml: "<block type=\"model_block_flatten_layer\"><field name=\"EXPAND_BUTTON\">{\"parametersVisible\":false,\"percentSize\":0,\"percentParams\":0,\"runTimeInMs\":0,\"outputShape\":[0]}</field></block>"
      }, {
        kind: "block",
        blockxml: "<block type=\"model_block_dense_layer\"><field name=\"EXPAND_BUTTON\">{\"parametersVisible\":false,\"percentSize\":0,\"percentParams\":0,\"runTimeInMs\":0,\"outputShape\":[0],\"numUnits\":4,\"activation\":\"relu\"}</field></block>"
      }]
    }];
  };

  return ModelBlockDomainSpecificLanguage;
}();
var modelBlockDsl = new ModelBlockDomainSpecificLanguage();
/* harmony default export */ __webpack_exports__["ZP"] = (modelBlockDsl);

/***/ }),

/***/ 25853:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ AppTheme; }
/* harmony export */ });
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(78790);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(88887);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(38776);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(65668);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(67294);
/* harmony import */ var _DarkModeContext__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(91350);



// eslint-disable-next-line @typescript-eslint/no-explicit-any
function AppTheme(props) {
  var {
    darkMode
  } = (0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(_DarkModeContext__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z);
  var isDark = darkMode === "dark";
  var themeDef = {
    palette: {
      primary: {
        main: isDark ? "#56d364" : "#2e7d32"
      },
      secondary: {
        main: "#ffc400"
      },
      contrastThreshold: isDark ? 5.1 : 3.1,
      mode: darkMode
    }
  };
  var rawTheme = (0,_mui_material__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)(themeDef);
  var theme = (0,_mui_material__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .Z)(rawTheme);
  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z, {
    injectFirst: true
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z, Object.assign({
    theme: theme
  }, props)));
}

/***/ }),

/***/ 18568:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Z": function() { return /* binding */ CopyButton; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(15861);
/* harmony import */ var _babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(45987);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(67294);
/* harmony import */ var _mui_icons_material_FileCopy__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(74639);
/* harmony import */ var _mui_icons_material_Done__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(42971);
/* harmony import */ var _mui_icons_material_ReportProblem__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(93083);
/* harmony import */ var _IconButtonWithTooltip__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(71973);
/* harmony import */ var _mui_material__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(76968);
/* harmony import */ var _hooks_useMounted__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(72179);
/* harmony import */ var _jacdac_ts_src_jdom_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(81794);


var _excluded = ["label", "title", "onCopy"];








function CopyButton(props) {
  var {
    label,
    title = "copy data to clipboard",
    onCopy
  } = props,
      rest = (0,_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .Z)(props, _excluded);

  var {
    0: copied,
    1: setCopied
  } = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(undefined);
  var mounted = (0,_hooks_useMounted__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .Z)();

  var handleClick = /*#__PURE__*/function () {
    var _ref = (0,_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .Z)(function* (ev) {
      ev.stopPropagation();
      ev.preventDefault();

      try {
        setCopied(null);

        var _copied = yield onCopy();

        if (typeof _copied === "string") {
          var _text = _copied;
          yield navigator.clipboard.writeText(_text);
        } else {
          var canvas = _copied;
          var blob = yield new Promise(resolve => canvas.toBlob(blob => resolve(blob)));
          var item = new ClipboardItem({
            "image/png": blob
          });
          navigator.clipboard.write([item]);
        }

        if (mounted()) setCopied(true);
      } catch (e) {
        console.debug(e);
        if (mounted()) setCopied(false);
      } finally {
        yield (0,_jacdac_ts_src_jdom_utils__WEBPACK_IMPORTED_MODULE_3__/* .delay */ .gw)(1000);
        if (mounted()) setCopied(undefined);
      }
    });

    return function handleClick(_x) {
      return _ref.apply(this, arguments);
    };
  }();

  var disabled = copied !== undefined;
  var text = copied === true ? "Copied!" : copied === false ? "Copy failed" : label || "copy to clipboard";
  return label ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_material__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z, Object.assign({
    title: title
  }, rest, {
    onClick: disabled ? undefined : handleClick
  }), text) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_IconButtonWithTooltip__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .Z, Object.assign({
    trackName: "ui.copy",
    title: text
  }, rest, {
    onClick: disabled ? undefined : handleClick
  }), copied === true ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_icons_material_Done__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z, null) : copied === false ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_icons_material_ReportProblem__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z, null) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_mui_icons_material_FileCopy__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .Z, null));
}

/***/ }),

/***/ 15056:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "IZ": function() { return /* binding */ makeVMBase; },
/* harmony export */   "cC": function() { return /* binding */ processErrors; },
/* harmony export */   "ZP": function() { return /* binding */ workspaceJSONToVMProgram; }
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(15785);
/* harmony import */ var _babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(94578);
/* harmony import */ var _babel_runtime_helpers_esm_wrapNativeSuper__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(52146);
/* harmony import */ var _jacdac_ts_src_vm_compile__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(73390);
/* harmony import */ var _blockly_toolbox__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(16582);
/* harmony import */ var blockly__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(74640);
/* harmony import */ var blockly__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(blockly__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _blockly_dsl_dsl__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(94113);
/* harmony import */ var _blockly_dsl_servicesbase__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(21910);
/* harmony import */ var _jacdac_ts_src_jdom_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(81794);









var makeVMBase = (block, command) => {
  return {
    sourceId: block.id,
    type: "cmd",
    command
  };
};
var processErrors = (block, errors) => {
  return errors.map(e => {
    return {
      sourceId: e.sourceId ? e.sourceId : block.id,
      message: e.message
    };
  });
};
function workspaceJSONToVMProgram(workspace, dsls) {
  //console.debug(`compile vm`, { workspace, dsls })
  if (!workspace) return undefined;
  var [roles, serverRoles] = (0,_jacdac_ts_src_jdom_utils__WEBPACK_IMPORTED_MODULE_5__/* .splitFilter */ .ap)(workspace.variables.filter(v => _blockly_toolbox__WEBPACK_IMPORTED_MODULE_1__/* .BUILTIN_TYPES.indexOf */ .Nd.indexOf(v.type) < 0).map(_blockly_dsl_servicesbase__WEBPACK_IMPORTED_MODULE_4__/* .parseRoleType */ .eS), r => r.client);

  var EmptyExpression = /*#__PURE__*/function (_Error) {
    (0,_babel_runtime_helpers_esm_inheritsLoose__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .Z)(EmptyExpression, _Error);

    function EmptyExpression() {
      return _Error.apply(this, arguments) || this;
    }

    return EmptyExpression;
  }( /*#__PURE__*/(0,_babel_runtime_helpers_esm_wrapNativeSuper__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .Z)(Error));

  var blockToExpression = (ev, blockIn) => {
    var errors = [];

    var blockToExpressionInner = (ev, block) => {
      if (!block) {
        throw new EmptyExpression();
      }

      var {
        type,
        value,
        inputs
      } = block;
      console.log("block2e", {
        ev,
        block,
        type,
        value,
        inputs
      });
      if (value !== undefined) // literal
        return {
          type: "Literal",
          value: value,
          raw: value + ""
        };
      var dsl = (0,_blockly_dsl_dsl__WEBPACK_IMPORTED_MODULE_3__/* .resolveDsl */ .u)(dsls, type);

      if (!dsl) {
        console.warn("unknown block " + type, {
          type,
          ev,
          block,
          d: (blockly__WEBPACK_IMPORTED_MODULE_2___default().Blocks)[type]
        });
        errors.push({
          sourceId: block.id,
          message: "unknown block " + type
        });
      } else {
        var _dsl$compileExpressio;

        var definition = (0,_blockly_toolbox__WEBPACK_IMPORTED_MODULE_1__/* .resolveBlockDefinition */ .Pq)(type);
        var res = (_dsl$compileExpressio = dsl.compileExpressionToVM) === null || _dsl$compileExpressio === void 0 ? void 0 : _dsl$compileExpressio.call(dsl, {
          event: ev,
          definition,
          block,
          blockToExpressionInner
        });

        if (res) {
          if (res.errors) res.errors.forEach(e => errors.push(e));
          return res.expr;
        }

        var {
          template
        } = definition;

        if (template === "shadow") {
          var field = inputs[0].fields["value"];
          var v = field.value;
          return {
            type: "Literal",
            value: v,
            raw: v + ""
          };
        }

        errors.push({
          sourceId: block.id,
          message: "unknown block " + type
        });
        console.warn("unsupported expression block " + type, {
          ev,
          block,
          definition
        });
      }

      throw new EmptyExpression();
    };

    return {
      expr: blockToExpressionInner(ev, blockIn),
      errors
    };
  };

  var blockToCommand = (event, block) => {
    var {
      type,
      inputs
    } = block;
    console.debug("block2c", {
      event,
      type,
      block,
      inputs
    });

    switch (type) {
      case "dynamic_if":
        {
          var _inputs$, _inputs$2;

          var thenHandler = {
            commands: [],
            errors: []
          };
          var elseHandler = {
            commands: [],
            errors: []
          };
          var t = (_inputs$ = inputs[1]) === null || _inputs$ === void 0 ? void 0 : _inputs$.child;
          var e = (_inputs$2 = inputs[2]) === null || _inputs$2 === void 0 ? void 0 : _inputs$2.child;

          if (t) {
            addCommands(event, [t].concat((0,_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z)(t.children ? t.children : [])), thenHandler);
          }

          if (e) {
            addCommands(event, [e].concat((0,_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .Z)(e.children ? e.children : [])), elseHandler);
          }

          var exprErrors = undefined;

          try {
            var _inputs$3;

            exprErrors = blockToExpression(event, (_inputs$3 = inputs[0]) === null || _inputs$3 === void 0 ? void 0 : _inputs$3.child);
          } catch (e) {
            if (e instanceof EmptyExpression) {
              exprErrors = {
                expr: {
                  type: "Literal",
                  value: false,
                  raw: "false "
                },
                errors: []
              };
            } else {
              throw e;
            }
          }

          var {
            expr,
            errors
          } = exprErrors;
          var ifThenElse = {
            sourceId: block.id,
            type: "ite",
            expr,
            then: thenHandler.commands,
            else: elseHandler.commands
          };
          console.log("dynamic if");
          return {
            cmd: ifThenElse,
            errors: processErrors(block, errors.concat(thenHandler.errors).concat(elseHandler.errors))
          };
        }
      // more builts

      default:
        {
          var dsl = (0,_blockly_dsl_dsl__WEBPACK_IMPORTED_MODULE_3__/* .resolveDsl */ .u)(dsls, type);

          if (dsl) {
            var _dsl$compileCommandTo;

            var definition = (0,_blockly_toolbox__WEBPACK_IMPORTED_MODULE_1__/* .resolveBlockDefinition */ .Pq)(type);
            var template = definition === null || definition === void 0 ? void 0 : definition.template;
            if (template === "meta") return undefined;
            var dslRes = (_dsl$compileCommandTo = dsl.compileCommandToVM) === null || _dsl$compileCommandTo === void 0 ? void 0 : _dsl$compileCommandTo.call(dsl, {
              event,
              block,
              definition,
              blockToExpression
            });

            if (dslRes) {
              dslRes.errors = processErrors(block, dslRes.errors);
              return dslRes;
            }
          }

          console.warn("unsupported command block " + type, {
            block
          });
          return {
            cmd: undefined,
            errors: [{
              sourceId: block.id,
              message: "unsupported command block " + type
            }]
          };
        }
    }
  };

  var nop = {
    type: "CallExpression",
    arguments: [],
    callee: (0,_jacdac_ts_src_vm_compile__WEBPACK_IMPORTED_MODULE_0__/* .toIdentifier */ .EB)("nop")
  };

  var addCommands = (event, blocks, handler) => {
    blocks === null || blocks === void 0 ? void 0 : blocks.filter(child => !!child).forEach(child => {
      try {
        var {
          cmd,
          errors
        } = blockToCommand(event, child) || {};
        if (cmd) handler.commands.push(cmd);
        errors === null || errors === void 0 ? void 0 : errors.forEach(e => handler.errors.push(e));
      } catch (e) {
        if (e instanceof EmptyExpression) {
          handler.commands.push({
            sourceId: child.id,
            type: "cmd",
            command: nop
          });
        } else {
          console.debug(e);
        }
      }
    });
  };

  var handlers = workspace.blocks.map(top => {
    var _topErrors2;

    var {
      type
    } = top;
    var command;
    var topEvent;
    var topErrors;
    var topMeta = false;

    try {
      var _dsl$compileEventToVM, _topErrors;

      var dsl = (0,_blockly_dsl_dsl__WEBPACK_IMPORTED_MODULE_3__/* .resolveDsl */ .u)(dsls, type);
      var definition = (0,_blockly_toolbox__WEBPACK_IMPORTED_MODULE_1__/* .resolveBlockDefinition */ .Pq)(type);
      var {
        expression,
        errors,
        event,
        meta
      } = (dsl === null || dsl === void 0 ? void 0 : (_dsl$compileEventToVM = dsl.compileEventToVM) === null || _dsl$compileEventToVM === void 0 ? void 0 : _dsl$compileEventToVM.call(dsl, {
        block: top,
        definition,
        blockToExpression
      })) || {};
      command = expression;
      topErrors = errors;
      topEvent = event;
      topMeta = meta; // if dsl didn't compile anything try again

      var {
        template
      } = definition || {};

      if (!command && !((_topErrors = topErrors) !== null && _topErrors !== void 0 && _topErrors.length)) {
        switch (template) {
          case "meta":
            {
              break;
            }

          default:
            {
              topErrors = [{
                sourceId: top.id,
                message: "unsupported handler block " + type
              }];
              console.debug("unsupported handler template " + template + " for " + type, {
                top
              });
              break;
            }
        }
      }
    } catch (e) {
      console.debug(e);

      if (e instanceof EmptyExpression) {
        return undefined;
      } else {
        throw e;
      }
    } // nothing to compile here


    if (!command && !((_topErrors2 = topErrors) !== null && _topErrors2 !== void 0 && _topErrors2.length)) return undefined;
    var handler = {
      commands: [{
        sourceId: top.id,
        type: "cmd",
        command
      }],
      errors: topErrors || [],
      meta: !!topMeta
    };
    addCommands(topEvent, top.children, handler);
    return handler;
  }).filter(handler => !!handler);
  return {
    roles,
    serverRoles,
    handlers
  };
}

/***/ }),

/***/ 41173:
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "iU": function() { return /* binding */ child; }
/* harmony export */ });
/* unused harmony exports title, hydrate, elt */
/* eslint-disable @typescript-eslint/no-explicit-any */
function mkTitle(txt) {
  var t = elt("title");
  t.textContent = txt;
  return t;
}

function title(el, txt) {
  var t = mkTitle(txt);
  el.appendChild(t);
  return t;
}
function hydrate(el, props) {
  for (var k in props) {
    if (k == "title") {
      title(el, props[k]);
    } else el.setAttributeNS(null, k, props[k]);
  }
}
function elt(name, props) {
  var el = document.createElementNS("http://www.w3.org/2000/svg", name);
  if (props) hydrate(el, props);
  return el;
}
function child(parent, name, props) {
  var el = elt(name, props);
  parent.appendChild(el);
  return el;
}

/***/ })

}]);
//# sourceMappingURL=ab6b71bda2c06e0c84c81249075604781c30253a-c5253b0f3d4df69e8ad3.js.map