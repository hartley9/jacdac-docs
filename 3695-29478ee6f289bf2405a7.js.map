{"version":3,"file":"3695-29478ee6f289bf2405a7.js","mappings":"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","sources":["webpack://jacdac-docs/./src/components/dashboard/DashboardDotMatrix.tsx","webpack://jacdac-docs/./src/components/hooks/useArrowKeys.ts","webpack://jacdac-docs/./src/components/hooks/useKeyboardNavigation.ts","webpack://jacdac-docs/./src/components/hooks/useKeyboardNavigationProps.ts"],"sourcesContent":["import React from \"react\"\nimport {\n    DotMatrixReg,\n    DotMatrixVariant,\n} from \"../../../jacdac-ts/src/jdom/constants\"\nimport { DashboardServiceProps } from \"./DashboardServiceWidget\"\nimport { useRegisterUnpackedValue } from \"../../jacdac/useRegisterValue\"\nimport useServiceServer from \"../hooks/useServiceServer\"\nimport useChange from \"../../jacdac/useChange\"\nimport LEDMatrixWidget from \"../widgets/LEDMatrixWidget\"\nimport useRegister from \"../hooks/useRegister\"\n\nexport default function DashboardDotMatrixDisplay(\n    props: DashboardServiceProps\n) {\n    const { service } = props\n\n    const dotsRegister = useRegister(service, DotMatrixReg.Dots)\n    const brightnessRegister = useRegister(service, DotMatrixReg.Brightness)\n    const rowsRegister = useRegister(service, DotMatrixReg.Rows)\n    const columnsRegister = useRegister(service, DotMatrixReg.Columns)\n    const variantRegister = useRegister(service, DotMatrixReg.Variant)\n\n    const [dots] = useRegisterUnpackedValue<[Uint8Array]>(dotsRegister, props)\n    const [brightness = 0] = useRegisterUnpackedValue<[number]>(\n        brightnessRegister,\n        props\n    )\n    const [rows] = useRegisterUnpackedValue<[number]>(rowsRegister, props)\n    const [columns] = useRegisterUnpackedValue<[number]>(columnsRegister, props)\n    const [variant] = useRegisterUnpackedValue<[DotMatrixVariant]>(\n        variantRegister,\n        props\n    )\n    const server = useServiceServer(service)\n    const color = server ? \"secondary\" : \"primary\"\n    useChange(server)\n    const handleChange = (newLeds: Uint8Array) => {\n        dotsRegister.sendSetAsync(newLeds, true)\n    }\n    return (\n        <LEDMatrixWidget\n            leds={dots}\n            brightness={brightness}\n            rows={rows}\n            columns={columns}\n            color={color}\n            onChange={handleChange}\n            dots={variant === DotMatrixVariant.Braille}\n        />\n    )\n}\n","import { KeyboardEvent } from \"react\"\nimport { keyCodeFromEvent } from \"./useFireKey\"\n\nconst LEFT_KEY = 37\nconst UP_KEY = 38\nconst RIGHT_KEY = 39\nconst DOWN_KEY = 40\n\nexport default function useArrowKeys(options: {\n    onLeft?: () => void\n    onRight?: () => void\n    onUp?: () => void\n    onDown?: () => void\n    symmetric?: boolean\n}) {\n    const { onLeft, onUp, onRight, onDown, symmetric } = options\n\n    if (!onLeft && !onUp && !onRight && !onDown) return undefined\n\n    const handlers = {\n        [LEFT_KEY]: onLeft,\n        [RIGHT_KEY]: onRight,\n        [UP_KEY]: onUp || (symmetric && onRight),\n        [DOWN_KEY]: onDown || (symmetric && onLeft),\n    }\n\n    return (e: KeyboardEvent<Element>) => {\n        const charCode = keyCodeFromEvent(e)\n        const handler = handlers[charCode]\n        if (handler) {\n            e.preventDefault()\n            handler()\n        }\n    }\n}\n","export default function useKeyboardNavigation(parentRef: Element) {\n    const query = '[tabindex=\"0\"]'\n    const onMove = (offset: number) => () => {\n        console.log(\"keyboard move\", { offset })\n        const focusable = Array.from<SVGElement>(\n            parentRef?.querySelectorAll(query) || []\n        )\n        if (focusable.length) {\n            const me = focusable.findIndex(f => f === document.activeElement)\n            const next = (me + offset + focusable.length) % focusable.length\n            focusable[next].focus()\n        }\n    }\n    return onMove\n}\n","import useArrowKeys from \"./useArrowKeys\"\nimport useKeyboardNavigation from \"./useKeyboardNavigation\"\n\nexport default function useKeyboardNavigationProps(\n    parentRef: Element,\n    vertical?: boolean\n) {\n    const onMove = useKeyboardNavigation(parentRef)\n\n    const onKeyDown = useArrowKeys({\n        onLeft: !vertical && onMove(-1),\n        onRight: !vertical && onMove(1),\n        onDown: vertical && onMove(1),\n        onUp: vertical && onMove(-1),\n    })\n\n    return {\n        onKeyDown: parentRef && onKeyDown,\n    }\n}\n"],"names":["React","DotMatrixReg","DotMatrixVariant","useRegisterUnpackedValue","useServiceServer","useChange","LEDMatrixWidget","useRegister","DashboardDotMatrixDisplay","props","service","dotsRegister","Dots","brightnessRegister","Brightness","rowsRegister","Rows","columnsRegister","Columns","variantRegister","Variant","dots","brightness","rows","columns","variant","server","color","handleChange","newLeds","sendSetAsync","Braille","keyCodeFromEvent","LEFT_KEY","UP_KEY","RIGHT_KEY","DOWN_KEY","useArrowKeys","options","onLeft","onUp","onRight","onDown","symmetric","undefined","handlers","e","charCode","handler","preventDefault","useKeyboardNavigation","parentRef","query","onMove","offset","console","log","focusable","Array","from","querySelectorAll","length","me","findIndex","f","document","activeElement","next","focus","useKeyboardNavigationProps","vertical","onKeyDown"],"sourceRoot":""}