{"version":3,"file":"353-25b846d409d9a0b311b6.js","mappings":"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","sources":["webpack://jacdac-docs/./src/components/dashboard/DashboardSevenSegmentDisplay.tsx"],"sourcesContent":["import React from \"react\"\nimport { SevenSegmentDisplayReg } from \"../../../jacdac-ts/src/jdom/constants\"\nimport { DashboardServiceProps } from \"./DashboardServiceWidget\"\nimport {\n    useRegisterBoolValue,\n    useRegisterUnpackedValue,\n} from \"../../jacdac/useRegisterValue\"\nimport SvgWidget from \"../widgets/SvgWidget\"\nimport useWidgetTheme from \"../widgets/useWidgetTheme\"\nimport { Grid } from \"@mui/material\"\nimport RegisterInput from \"../RegisterInput\"\nimport LoadingProgress from \"../ui/LoadingProgress\"\nimport useServiceServer from \"../hooks/useServiceServer\"\nimport useRegister from \"../hooks/useRegister\"\n\nexport default function DashboardSevenSegmentDisplay(\n    props: DashboardServiceProps\n) {\n    const { service, visible } = props\n\n    const digitsRegister = useRegister(service, SevenSegmentDisplayReg.Digits)\n    const brightnessRegister = useRegister(\n        service,\n        SevenSegmentDisplayReg.Brightness\n    )\n    const digitCountRegister = useRegister(\n        service,\n        SevenSegmentDisplayReg.DigitCount\n    )\n    const decimalPointRegister = useRegister(\n        service,\n        SevenSegmentDisplayReg.DecimalPoint\n    )\n\n    const [digits] = useRegisterUnpackedValue<[Uint8Array]>(digitsRegister) || [\n        new Uint8Array(0),\n    ]\n    const [brightness] = useRegisterUnpackedValue<[number]>(\n        brightnessRegister,\n        props\n    )\n    const [digitCount] = useRegisterUnpackedValue<[number]>(\n        digitCountRegister,\n        props\n    )\n    const decimalPoint = useRegisterBoolValue(decimalPointRegister, props)\n\n    const server = useServiceServer(service)\n    const color = server ? \"secondary\" : \"primary\"\n    const { active, background } = useWidgetTheme(color)\n\n    if (digitCount === undefined) return <LoadingProgress />\n\n    const md = 4\n    const rs = 4\n    const hs = 32\n    const ws = 28\n    const wd = ws + 2 * rs\n    const hd = 2 * rs\n\n    const w = digitCount * (wd + 4 * md) + md\n    const h = 2 * md + 3 * hd + 2 * hs\n    const opacity = brightness || 0\n\n    /*\n    GFEDCBA DP\n    - A -\n    |   |\n    G   B\n    |   |\n    - F -\n    |   |   -\n    E   C  |DP|\n    - D -   -\n    */\n\n    const VerticalSegment = (props: {\n        digit: number\n        mask: number\n        mx: number\n        my: number\n    }) => {\n        const bit = (props.digit & props.mask) == props.mask\n        return (\n            <>\n                <path\n                    fill={background}\n                    stroke=\"none\"\n                    d={`M ${props.mx} ${\n                        props.my\n                    } l ${-rs} ${rs} v ${hs} l ${rs} ${rs} l ${rs} ${-rs} v ${-hs} Z`}\n                />\n                {bit && (\n                    <path\n                        opacity={opacity}\n                        fill={active}\n                        stroke=\"none\"\n                        d={`M ${props.mx} ${\n                            props.my\n                        } l ${-rs} ${rs} v ${hs} l ${rs} ${rs} l ${rs} ${-rs} v ${-hs} Z`}\n                    />\n                )}\n            </>\n        )\n    }\n    const HorizontalSegment = (props: {\n        digit: number\n        mask: number\n        mx: number\n        my: number\n    }) => {\n        const bit = (props.digit & props.mask) == props.mask\n        return (\n            <>\n                <path\n                    fill={background}\n                    stroke=\"none\"\n                    d={`M ${props.mx} ${\n                        props.my\n                    } l ${rs} ${-rs} h ${ws} l ${rs} ${rs} l ${-rs} ${rs} h ${-ws} Z`}\n                />\n                {bit && (\n                    <path\n                        opacity={opacity}\n                        fill={active}\n                        stroke=\"none\"\n                        d={`M ${props.mx} ${\n                            props.my\n                        } l ${rs} ${-rs} h ${ws} l ${rs} ${rs} l ${-rs} ${rs} h ${-ws} Z`}\n                    />\n                )}\n            </>\n        )\n    }\n\n    const DotSegment = (props: { digit: number }) => {\n        const bit = (props.digit & 0x80) == 0x80\n        const mx = rs + wd + 2 * rs\n        const my = rs + 2 * hd + 2 * hs\n        return (\n            <>\n                <circle\n                    fill={background}\n                    stroke=\"none\"\n                    r={rs}\n                    cx={mx}\n                    cy={my}\n                />\n                {bit && (\n                    <circle\n                        opacity={opacity}\n                        fill={active}\n                        stroke=\"none\"\n                        r={rs}\n                        cx={mx}\n                        cy={my}\n                    />\n                )}\n            </>\n        )\n    }\n\n    const Digit = (dprops: { x: number; y: number; digit: number }) => {\n        const { x, y, digit } = dprops\n        return (\n            <g transform={`translate(${x}, ${y})`}>\n                <VerticalSegment\n                    key=\"G\"\n                    mx={rs}\n                    my={rs}\n                    digit={digit}\n                    mask={0x01}\n                />\n\n                <HorizontalSegment\n                    key=\"F\"\n                    mx={rs}\n                    my={rs + hs + hd}\n                    digit={digit}\n                    mask={0x02}\n                />\n\n                <VerticalSegment\n                    key=\"E\"\n                    mx={rs}\n                    my={rs + hd + hs}\n                    digit={digit}\n                    mask={0x04}\n                />\n\n                <HorizontalSegment\n                    key=\"D\"\n                    mx={rs}\n                    my={rs + 2 * hd + 2 * hs}\n                    digit={digit}\n                    mask={0x08}\n                />\n\n                <VerticalSegment\n                    key=\"C\"\n                    mx={rs + wd}\n                    my={rs + hd + hs}\n                    digit={digit}\n                    mask={0x10}\n                />\n                <VerticalSegment\n                    key=\"B\"\n                    mx={rs + wd}\n                    my={rs}\n                    digit={digit}\n                    mask={0x20}\n                />\n\n                <HorizontalSegment\n                    key=\"A\"\n                    mx={rs}\n                    my={rs}\n                    digit={digit}\n                    mask={0x40}\n                />\n\n                {decimalPoint && <DotSegment digit={digit} />}\n            </g>\n        )\n    }\n\n    return (\n        <Grid container direction=\"column\">\n            <Grid item xs={12}>\n                <SvgWidget width={w} height={h}>\n                    {Array(digitCount)\n                        .fill(0)\n                        .map((_, i) => (\n                            <Digit\n                                key={i}\n                                x={md + (wd + 4 * md) * i}\n                                y={md}\n                                digit={digits?.[i] || 0}\n                            />\n                        ))}\n                </SvgWidget>\n            </Grid>\n            <Grid item>\n                <RegisterInput\n                    register={brightnessRegister}\n                    visible={visible}\n                />\n            </Grid>\n        </Grid>\n    )\n}\n"],"names":["React","SevenSegmentDisplayReg","useRegisterBoolValue","useRegisterUnpackedValue","SvgWidget","useWidgetTheme","Grid","RegisterInput","LoadingProgress","useServiceServer","useRegister","DashboardSevenSegmentDisplay","props","service","visible","digitsRegister","Digits","brightnessRegister","Brightness","digitCountRegister","DigitCount","decimalPointRegister","DecimalPoint","digits","Uint8Array","brightness","digitCount","decimalPoint","server","color","active","background","undefined","md","rs","hs","ws","wd","hd","w","h","opacity","VerticalSegment","bit","digit","mask","mx","my","HorizontalSegment","DotSegment","Digit","dprops","x","y","Array","fill","map","_","i"],"sourceRoot":""}